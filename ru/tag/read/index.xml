<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Read | Д. С. Кулябов</title><link>https://yamadharma.github.io/ru/tag/read/</link><atom:link href="https://yamadharma.github.io/ru/tag/read/index.xml" rel="self" type="application/rss+xml"/><description>Read</description><generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>ru-ru</language><copyright>© 2025 Dmitry S. Kulyabov</copyright><lastBuildDate>Mon, 30 Dec 2024 10:32:00 +0300</lastBuildDate><image><url>https://yamadharma.github.io/media/icon_hu_c0ee34e0b47a9b95.png</url><title>Read</title><link>https://yamadharma.github.io/ru/tag/read/</link></image><item><title>Читалка. Foliate</title><link>https://yamadharma.github.io/ru/post/2024/12/30/reader-foliate/</link><pubDate>Mon, 30 Dec 2024 10:32:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/12/30/reader-foliate/</guid><description>&lt;p>Читалка. Foliate.&lt;/p>
&lt;details class="print:hidden xl:hidden" >
&lt;summary>Содержание&lt;/summary>
&lt;div class="text-sm">
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-по-умолчанию">&lt;span class="section-num">2&lt;/span> Установка по умолчанию&lt;/a>&lt;/li>
&lt;li>&lt;a href="#закладки-и-аннотации">&lt;span class="section-num">3&lt;/span> Закладки и аннотации&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/div>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://johnfactotum.github.io/foliate/" target="_blank" rel="noopener">https://johnfactotum.github.io/foliate/&lt;/a>&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/johnfactotum/foliate/" target="_blank" rel="noopener">https://github.com/johnfactotum/foliate/&lt;/a>&lt;/li>
&lt;li>Лицензия: GPL-3.0&lt;/li>
&lt;li>Форматы: EPUB, Mobipocket, Kindle, FB2, CBZ, PDF.&lt;/li>
&lt;/ul>
&lt;h2 id="установка-по-умолчанию">&lt;span class="section-num">2&lt;/span> Установка по умолчанию&lt;/h2>
&lt;ul>
&lt;li>Можно установить &lt;em>foliate&lt;/em> как просмотрщик по умолчанию (см. &lt;a href="https://yamadharma.github.io/ru/post/2023/04/02/xdg-mime-applications/">XDG. Приложения MIME&lt;/a>).&lt;/li>
&lt;li>Проверим, какие ассоциации актуальны:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cat /usr/share/applications/com.github.johnfactotum.Foliate.desktop &lt;span class="p">|&lt;/span> grep -i MimeType &lt;span class="p">|&lt;/span> cut -d &lt;span class="s2">&amp;#34;=&amp;#34;&lt;/span> -f &lt;span class="m">2&lt;/span> &lt;span class="p">|&lt;/span> tr &lt;span class="s1">&amp;#39;;&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;\n&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> xargs -l1 xdg-mime query default
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установим для всех типов ассоциацию с &lt;em>foliate&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cat /usr/share/applications/com.github.johnfactotum.Foliate.desktop &lt;span class="p">|&lt;/span> grep -i MimeType &lt;span class="p">|&lt;/span> cut -d &lt;span class="s2">&amp;#34;=&amp;#34;&lt;/span> -f &lt;span class="m">2&lt;/span> &lt;span class="p">|&lt;/span> tr &lt;span class="s1">&amp;#39;;&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;\n&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> xargs -l1 xdg-mime default com.github.johnfactotum.Foliate.desktop
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="закладки-и-аннотации">&lt;span class="section-num">3&lt;/span> Закладки и аннотации&lt;/h2>
&lt;ul>
&lt;li>Запись местоположения базируется на стандартных идентификаторах канонических фрагментов EPUB (CFI) (&lt;a href="https://w3c.github.io/epub-specs/epub33/epubcfi/" target="_blank" rel="noopener">https://w3c.github.io/epub-specs/epub33/epubcfi/&lt;/a>).&lt;/li>
&lt;li>Прогресс чтения, закладки и аннотации сохраняются в &lt;code>~/.local/share/com.github.johnfactotum.Foliate&lt;/code>.&lt;/li>
&lt;li>Данные для каждой книги хранятся в файле JSON, названном по идентификатору книги.&lt;/li>
&lt;/ul></description></item><item><title>Отложенное чтение. Wallabag</title><link>https://yamadharma.github.io/ru/post/2024/12/05/read-it-later-wallabag/</link><pubDate>Thu, 05 Dec 2024 11:58:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/12/05/read-it-later-wallabag/</guid><description>&lt;p>Отложенное чтение. Wallabag.&lt;/p>
&lt;details class="print:hidden xl:hidden" >
&lt;summary>Содержание&lt;/summary>
&lt;div class="text-sm">
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#особенности">&lt;span class="section-num">2&lt;/span> Особенности&lt;/a>&lt;/li>
&lt;li>&lt;a href="#утилиты">&lt;span class="section-num">3&lt;/span> Утилиты&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#cleanabag">&lt;span class="section-num">3.1&lt;/span> cleanABag&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">4&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#контейнер">&lt;span class="section-num">5&lt;/span> Контейнер&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">5.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#podman">&lt;span class="section-num">5.2&lt;/span> Podman&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">5.2.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#загрузка">&lt;span class="section-num">5.2.2&lt;/span> Загрузка&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#nginx">&lt;span class="section-num">5.3&lt;/span> Nginx&lt;/a>&lt;/li>
&lt;li>&lt;a href="#обновление">&lt;span class="section-num">5.4&lt;/span> Обновление&lt;/a>&lt;/li>
&lt;li>&lt;a href="#система-на-базе-sqlite">&lt;span class="section-num">5.5&lt;/span> Система на базе SQLite&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#запуск-вручную">&lt;span class="section-num">5.5.1&lt;/span> Запуск вручную&lt;/a>&lt;/li>
&lt;li>&lt;a href="#docker-compose">&lt;span class="section-num">5.5.2&lt;/span> docker-compose&lt;/a>&lt;/li>
&lt;li>&lt;a href="#скрипт-systemd">&lt;span class="section-num">5.5.3&lt;/span> Скрипт systemd&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#система-на-базе-postgresql">&lt;span class="section-num">5.6&lt;/span> Система на базе PostgreSQL&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#docker-compose">&lt;span class="section-num">5.6.1&lt;/span> docker-compose&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#импорт-и-экспорт">&lt;span class="section-num">6&lt;/span> Импорт и экспорт&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#импорт-omnivore">&lt;span class="section-num">6.1&lt;/span> Импорт Omnivore&lt;/a>&lt;/li>
&lt;li>&lt;a href="#импорт-instapaper">&lt;span class="section-num">6.2&lt;/span> Импорт Instapaper&lt;/a>&lt;/li>
&lt;li>&lt;a href="#импорт-pocket">&lt;span class="section-num">6.3&lt;/span> Импорт Pocket&lt;/a>&lt;/li>
&lt;li>&lt;a href="#экспорт-всех-записей">&lt;span class="section-num">6.4&lt;/span> Экспорт всех записей&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#экспорт">&lt;span class="section-num">6.4.1&lt;/span> Экспорт&lt;/a>&lt;/li>
&lt;li>&lt;a href="#импорт">&lt;span class="section-num">6.4.2&lt;/span> Импорт&lt;/a>&lt;/li>
&lt;li>&lt;a href="#экспорта-из-контейнера">&lt;span class="section-num">6.4.3&lt;/span> Экспорта из контейнера&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/div>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Позволяет сохранять веб-страницы для последующего чтения.&lt;/li>
&lt;li>Лицензия: MIT license&lt;/li>
&lt;li>Сайт с платной подпиской: &lt;a href="https://www.wallabag.it/" target="_blank" rel="noopener">https://www.wallabag.it/&lt;/a>.&lt;/li>
&lt;li>Сайт: &lt;a href="https://wallabag.org" target="_blank" rel="noopener">wallabag.org.&lt;/a>&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/wallabag/wallabag" target="_blank" rel="noopener">https://github.com/wallabag/wallabag&lt;/a>&lt;/li>
&lt;li>Приложение для Android:
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/wallabag/android-app" target="_blank" rel="noopener">https://github.com/wallabag/android-app&lt;/a>&lt;/li>
&lt;li>Магазин приложений:
&lt;ul>
&lt;li>Google: &lt;a href="https://play.google.com/store/apps/details?id=fr.gaulupeau.apps.InThePoche" target="_blank" rel="noopener">https://play.google.com/store/apps/details?id=fr.gaulupeau.apps.InThePoche&lt;/a>&lt;/li>
&lt;li>FDroid: &lt;a href="https://f-droid.org/packages/fr.gaulupeau.apps.InThePoche/" target="_blank" rel="noopener">https://f-droid.org/packages/fr.gaulupeau.apps.InThePoche/&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Приложение для iOS:
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/wallabag/ios-app" target="_blank" rel="noopener">wallabag/ios-app&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Расширение браузера:
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/wallabag/wallabagger" target="_blank" rel="noopener">https://github.com/wallabag/wallabagger&lt;/a>&lt;/li>
&lt;li>Сайт: &lt;a href="http://wallabag.github.io/wallabagger/" target="_blank" rel="noopener">http://wallabag.github.io/wallabagger/&lt;/a>&lt;/li>
&lt;li>Firefox: &lt;a href="https://addons.mozilla.org/firefox/addon/wallabagger/" target="_blank" rel="noopener">https://addons.mozilla.org/firefox/addon/wallabagger/&lt;/a>&lt;/li>
&lt;li>Chrome: &lt;a href="https://chrome.google.com/webstore/detail/wallabagger/gbmgphmejlcoihgedabhgjdkcahacjlj" target="_blank" rel="noopener">https://chrome.google.com/webstore/detail/wallabagger/gbmgphmejlcoihgedabhgjdkcahacjlj&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Приложения для Linux:
&lt;ul>
&lt;li>Read It Later: &lt;a href="https://gitlab.gnome.org/World/read-it-later" target="_blank" rel="noopener">https://gitlab.gnome.org/World/read-it-later&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Ссылки по экосистеме: &lt;a href="https://github.com/wallabag/wallabag/wiki/wallabag-ecosystem" target="_blank" rel="noopener">https://github.com/wallabag/wallabag/wiki/wallabag-ecosystem&lt;/a>&lt;/li>
&lt;li>Emacs:
&lt;ul>
&lt;li>wallabag.el:
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2025/01/03/emacs-wallabagel/">Emacs. Отложенное чтение. wallabag.el&lt;/a>&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/chenyanming/wallabag.el" target="_blank" rel="noopener">https://github.com/chenyanming/wallabag.el&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>wombag:
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/karthink/wombag" target="_blank" rel="noopener">https://github.com/karthink/wombag&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="особенности">&lt;span class="section-num">2&lt;/span> Особенности&lt;/h2>
&lt;ul>
&lt;li>Клиенты wallabag скачивают всю базу.&lt;/li>
&lt;li>При разрастании базы происходит деградация производительности.&lt;/li>
&lt;li>И в конце концов клиент просто перестаёт работать.&lt;/li>
&lt;li>Рекомендуется удалять прочитанные статьи с сервера.&lt;/li>
&lt;/ul>
&lt;h2 id="утилиты">&lt;span class="section-num">3&lt;/span> Утилиты&lt;/h2>
&lt;h3 id="cleanabag">&lt;span class="section-num">3.1&lt;/span> cleanABag&lt;/h3>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://git.sr.ht/~bacardi55/cleanABag" target="_blank" rel="noopener">https://git.sr.ht/~bacardi55/cleanABag&lt;/a>&lt;/li>
&lt;li>cli-инструмент для удаления статей старше указанной даты из wallabag.&lt;/li>
&lt;li>Оставляет помеченные и непрочтённые сообщения по умолчанию.&lt;/li>
&lt;li>Конфигурационный файл credentials.json:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;WallabagURL&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://your.wallabag.tld&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;ClientId&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;client ID generate in your profile on wallabag&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;ClientSecret&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;client secrete generate in your profile on wallabag&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;UserName&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;your username&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;UserPassword&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;your password&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Пример запуска.
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Удалите архивные статьи старше 2021-12-31 (дата в формате YYYY-MM-DD), не затрагивая непрочтённые и отмеченные&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Протестировать&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cleanABag prune -c /path/to/credentials.json -d &lt;span class="s2">&amp;#34;2021-12-31&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Удалить&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cleanABag prune -c /path/to/credentials.json -d &lt;span class="s2">&amp;#34;2021-12-31&amp;#34;&lt;/span> --delete
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Удалить статьи старше 3 месяцев:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cleanABag -v -c credentials.json prune -d &lt;span class="k">$(&lt;/span>date -d &lt;span class="s2">&amp;#34;-3 month&amp;#34;&lt;/span> +&lt;span class="s2">&amp;#34;%F&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span> --delete
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="установка">&lt;span class="section-num">4&lt;/span> Установка&lt;/h2>
&lt;ul>
&lt;li>Документация: &lt;a href="https://doc.wallabag.org/en/admin/installation/installation.html" target="_blank" rel="noopener">https://doc.wallabag.org/en/admin/installation/installation.html&lt;/a>&lt;/li>
&lt;li>При первом логине используются следующие параметры:
&lt;ul>
&lt;li>login: wallabag&lt;/li>
&lt;li>password: wallabag&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="контейнер">&lt;span class="section-num">5&lt;/span> Контейнер&lt;/h2>
&lt;h3 id="общая-информация">&lt;span class="section-num">5.1&lt;/span> Общая информация&lt;/h3>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/wallabag/docker" target="_blank" rel="noopener">https://github.com/wallabag/docker&lt;/a>&lt;/li>
&lt;li>Dockerhub: &lt;a href="https://hub.docker.com/r/wallabag/wallabag/" target="_blank" rel="noopener">https://hub.docker.com/r/wallabag/wallabag/&lt;/a>&lt;/li>
&lt;li>Учётные данные по умолчанию: &lt;code>wallabag:wallabag&lt;/code>.&lt;/li>
&lt;li>При первом запуске необходимо будет сконфигурить приложение.&lt;/li>
&lt;li>Пусть доменное имя установки будет &lt;code>wallabag.example.com&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="podman">&lt;span class="section-num">5.2&lt;/span> Podman&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">5.2.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/12/04/containers-podman/">Контейнеры. podman&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="загрузка">&lt;span class="section-num">5.2.2&lt;/span> Загрузка&lt;/h4>
&lt;ul>
&lt;li>Скачайте контейнер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">podman pull wallabag/wallabag
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="nginx">&lt;span class="section-num">5.3&lt;/span> Nginx&lt;/h3>
&lt;ul>
&lt;li>Настройте &lt;em>nginx&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">server {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen 443 ssl http2;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen [::]:443 ssl http2;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server_name wallabag.example.com;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssl_certificate /etc/letsencrypt/live/wallabag.example.com/fullchain.pem;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssl_certificate_key /etc/letsencrypt/live/wallabag.example.com/privkey.pem;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> charset utf-8;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> gzip on;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> gzip_types text/css application/javascript text/javascript application/x-javascript image/svg+xml text/plain text/xsd text/xsl text/xml image/x-icon;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location / {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_pass http://localhost:40401;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header X-Forwarded-Host $server_name;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header X-Forwarded-Proto https;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header X-Forwarded-For $remote_addr;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen 80;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen [::]:80;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server_name wallabag.example.com;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return 301 https://$server_name$request_uri;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="обновление">&lt;span class="section-num">5.4&lt;/span> Обновление&lt;/h3>
&lt;ul>
&lt;li>Обновление контейнера:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">podman pull wallabag/wallabag
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">podman stop wallabag
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">podman compose --file wallabag-sqlite.yaml up --detach
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="система-на-базе-sqlite">&lt;span class="section-num">5.5&lt;/span> Система на базе SQLite&lt;/h3>
&lt;h4 id="запуск-вручную">&lt;span class="section-num">5.5.1&lt;/span> Запуск вручную&lt;/h4>
&lt;ul>
&lt;li>Создайте каталоги для постоянных данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p /opt/wallabag/&lt;span class="o">{&lt;/span>data,images&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R nobody:nobody /opt/wallabag
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Необходимо указать том для контейнера (для постоянного хранения):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">podman run --name wallabag -v /opt/wallabag/data:/var/www/wallabag/data -v /opt/wallabag/images:/var/www/wallabag/web/assets/images -p 40401:80 -e &lt;span class="s2">&amp;#34;SYMFONY__ENV__DOMAIN_NAME=https://wallabag.example.com&amp;#34;&lt;/span> wallabag/wallabag
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сервер будет доступен по &lt;code>http://localhost:40401&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h4 id="docker-compose">&lt;span class="section-num">5.5.2&lt;/span> docker-compose&lt;/h4>
&lt;ul>
&lt;li>Создадим файл docker-compose &lt;code>wallabag-sqlite.yaml&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;3&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">proxy-network&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">external&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">wallabag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">wallabag/wallabag:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">wallabag&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restart&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">unless-stopped&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - TZ=Etc/UTC&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__MAILER_DSN=smtp://127.0.0.1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__MAILER_HOST=mail.example.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__FROM_EMAIL=&amp;#34;wallabag@example.com&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__SERVER_NAME=&amp;#34;wallabag.example.com&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__DOMAIN_NAME=https://wallabag.example.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - PHP_MEMORY_LIMIT=512M&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__MAILER_USER=&amp;#34;&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__MAILER_PASSWORD=&amp;#34;&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__FOSUSER_REGISTRATION=false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__FOSUSER_CONFIRMATION=false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__TWOFACTOR_AUTH=false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - 40401:80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - /opt/wallabag/images:/var/www/wallabag/web/assets/images&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - /opt/wallabag/data:/var/www/wallabag/data&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">networks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - proxy-network&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">healthcheck&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">test&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;CMD&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;wget&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;--no-verbose&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;--tries=1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;--spider&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;http://localhost/api/info&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">interval&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">1m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">timeout&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">3s&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запуск будет выполняться следующим образом:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">podman compose --file wallabag-sqlite.yaml up --detach
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="скрипт-systemd">&lt;span class="section-num">5.5.3&lt;/span> Скрипт systemd&lt;/h4>
&lt;ul>
&lt;li>Создаём файл сервиса &lt;code>/etc/containers/systemd/wallabag.container&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[Unit]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Description=A templated wallabag container
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Container]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Image=wallabag
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ContainerName=wallabag
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PublishPort=40401:80
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Service]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Restart service when sleep finishes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Restart=always
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Install]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WantedBy=default.target
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустим генератор и сообщим &lt;em>systemd&lt;/em> о запуске новой службы:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl daemon-reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустим службу:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl start wallabag.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="система-на-базе-postgresql">&lt;span class="section-num">5.6&lt;/span> Система на базе PostgreSQL&lt;/h3>
&lt;h4 id="docker-compose">&lt;span class="section-num">5.6.1&lt;/span> docker-compose&lt;/h4>
&lt;ul>
&lt;li>Создадим файл docker-compose &lt;code>wallabag-pgsql.yaml&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;3&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">wallabag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">wallabag/wallabag:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">wallabag-pgsql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restart&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">unless-stopped&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - TZ=Etc/UTC&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__MAILER_DSN=smtp://127.0.0.1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__FROM_EMAIL=wallabag@example.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__DOMAIN_NAME=https://wallabag.example.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__SERVER_NAME=wallabag.example.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - PHP_MEMORY_LIMIT=1024M&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - PHP_MAX_EXECUTION_TIME=600&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - PHP_MAX_INPUT_TIME=600&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - POSTGRES_PASSWORD=&amp;lt;password1&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - POSTGRES_USER=postgres&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__DATABASE_DRIVER=pdo_pgsql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__DATABASE_HOST=wallabag-db-pgsql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__DATABASE_PORT=5432&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__DATABASE_NAME=wallabag&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__DATABASE_USER=wallabag&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - SYMFONY__ENV__DATABASE_PASSWORD=&amp;lt;password2&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - &amp;#34;40401:80&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">depends_on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - wallabag-db-pgsql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">wallabag-db-pgsql&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">postgres:14&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">wallabag-db-pgsql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restart&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">unless-stopped&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - POSTGRES_PASSWORD=&amp;lt;password1&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - POSTGRES_USER=postgres&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Используем postgres-14, посколку в версии 15 были сделаны исправления безопасности (&lt;a href="https://www.cybertec-postgresql.com/en/error-permission-denied-schema-public/" target="_blank" rel="noopener">https://www.cybertec-postgresql.com/en/error-permission-denied-schema-public/&lt;/a>).&lt;/li>
&lt;li>Но docker-образ для wallabag не поддерживает этого.&lt;/li>
&lt;li>Запуск будет выполняться следующим образом:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">podman compose --file wallabag-pgsql.yaml up --detach
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="импорт-и-экспорт">&lt;span class="section-num">6&lt;/span> Импорт и экспорт&lt;/h2>
&lt;h3 id="импорт-omnivore">&lt;span class="section-num">6.1&lt;/span> Импорт Omnivore&lt;/h3>
&lt;ul>
&lt;li>Экспортировал записи с Omnivore.&lt;/li>
&lt;li>Скачал архив с большим количеством файлов json (более 600).&lt;/li>
&lt;li>Загружать каждый файл через web-интерфейс не представлялось возможным.&lt;/li>
&lt;li>Скопировал архив на сервер.&lt;/li>
&lt;li>Поскольку каталог &lt;code>/opt/wallabag/images&lt;/code> уже подмонтирован к контейнеру в каталог &lt;code>/var/www/wallabag/web/assets/images&lt;/code>, сделал в нём каталог &lt;code>omnivore&lt;/code> и распаковал туда архив.&lt;/li>
&lt;li>Запустил скрипт:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt/wallabag/images/omnivore
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in metadata*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> podman &lt;span class="nb">exec&lt;/span> -it &amp;lt;container-id&amp;gt; sh -c &lt;span class="s2">&amp;#34;cd /var/www/wallabag/web/assets/images/omnivore; /var/www/wallabag/bin/console --env=prod wallabag:import -v --importer=omnivore --markAsRead=true -- &amp;lt;username&amp;gt; &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">i&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="импорт-instapaper">&lt;span class="section-num">6.2&lt;/span> Импорт Instapaper&lt;/h3>
&lt;ul>
&lt;li>Скопировал файл на сервер.&lt;/li>
&lt;li>Поскольку каталог &lt;code>/opt/wallabag/images&lt;/code> уже подмонтирован к контейнеру в каталог &lt;code>/var/www/wallabag/web/assets/images&lt;/code>, сделал в нём каталог &lt;code>instapaper&lt;/code> и поместил туда файл.&lt;/li>
&lt;li>Структура файла:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csv" data-lang="csv">&lt;span class="line">&lt;span class="cl">&lt;span class="s">URL&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">Title&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">Selection&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">Folder&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">Timestamp&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">Tags&lt;/span>&lt;span class="p">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустил скрипт:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt/wallabag/images/instapaper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in *.csv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> podman &lt;span class="nb">exec&lt;/span> -it &amp;lt;container-id&amp;gt; sh -c &lt;span class="s2">&amp;#34;cd /var/www/wallabag/web/assets/images/instapaper; /var/www/wallabag/bin/console --env=prod wallabag:import -v --importer=instapaper --markAsRead=true -- &amp;lt;username&amp;gt; &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">i&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="импорт-pocket">&lt;span class="section-num">6.3&lt;/span> Импорт Pocket&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/09/06/deferred-reading-pocket/">Отложенное чтение. Pocket&lt;/a>&lt;/li>
&lt;li>Сохранить архив можно на странице: &lt;a href="https://getpocket.com/export" target="_blank" rel="noopener">https://getpocket.com/export&lt;/a>.&lt;/li>
&lt;li>Скопировал архив на сервер.&lt;/li>
&lt;li>Поскольку каталог &lt;code>/opt/wallabag/images&lt;/code> уже подмонтирован к контейнеру в каталог &lt;code>/var/www/wallabag/web/assets/images&lt;/code>, сделал в нём каталог &lt;code>pocket&lt;/code> и поместил туда архив.&lt;/li>
&lt;li>Распаковал архив.&lt;/li>
&lt;li>Там файлы &lt;code>.csv&lt;/code>, структура файлов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csv" data-lang="csv">&lt;span class="line">&lt;span class="cl">&lt;span class="s">title&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">url&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">time_added&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">tags&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">status&lt;/span>&lt;span class="p">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Нет отметки, что файл в избранном.&lt;/li>
&lt;li>Импортер &lt;code>--importer=pocket&lt;/code> их не читает.&lt;/li>
&lt;li>Переделал из под формат &lt;em>Instapaper&lt;/em>.&lt;/li>
&lt;li>Установил csvkit (см. &lt;a href="https://yamadharma.github.io/ru/post/2023/07/06/csv-csvkit/">Формат CSV. csvkit&lt;/a>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">pipx install csvkit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Распаковал файл &lt;code>pocket.zip&lt;/code> в каталог &lt;code>/opt/wallabag/images/pocket/in&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p /opt/wallabag/images/pocket/in
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp pocket.zip /opt/wallabag/images/pocket/in
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt/wallabag/images/pocket/in
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unzip pocket.zip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Преобразовал формат:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt/wallabag/images/pocket/in
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in *.csv&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;,&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> csvjoin &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">i&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> - &lt;span class="p">|&lt;/span> csvcut -c 2,1,6,5,3,4 &amp;gt; ../&lt;span class="si">${&lt;/span>&lt;span class="nv">i&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ../
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустил скрипт:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt/wallabag/images/instapaper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in *.csv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">podman &lt;span class="nb">exec&lt;/span> -it &amp;lt;container-id&amp;gt; sh -c &lt;span class="s2">&amp;#34;cd /var/www/wallabag/web/assets/images/pocket; /var/www/wallabag/bin/console --env=prod wallabag:import -v --importer=instapaper --markAsRead=true -- &amp;lt;username&amp;gt; &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">i&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="экспорт-всех-записей">&lt;span class="section-num">6.4&lt;/span> Экспорт всех записей&lt;/h3>
&lt;h4 id="экспорт">&lt;span class="section-num">6.4.1&lt;/span> Экспорт&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Перейдите в директорию установки wallabag.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Выполните команду:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">bin/console wallabag:export --env&lt;span class="o">=&lt;/span>prod &amp;lt;имя_пользователя&amp;gt; &lt;span class="o">[&lt;/span>&amp;lt;путь_к_файлу&amp;gt;&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>&amp;lt;имя_пользователя&amp;gt;&lt;/code> - имя пользователя, чьи записи нужно экспортировать;&lt;/li>
&lt;li>&lt;code>&amp;lt;путь_к_файлу&amp;gt;&lt;/code> - опциональный параметр, указывающий путь к файлу экспорта.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Пример использования:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">bin/console wallabag:export --env&lt;span class="o">=&lt;/span>prod john.doe /var/www/wallabag/exports/export.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>После выполнения команды все записи указанного пользователя будут экспортированы в выбранный файл в формате JSON.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="импорт">&lt;span class="section-num">6.4.2&lt;/span> Импорт&lt;/h4>
&lt;ul>
&lt;li>Для импорта используем следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">bin/console wallabag:import --env&lt;span class="o">=&lt;/span>prod username export.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="экспорта-из-контейнера">&lt;span class="section-num">6.4.3&lt;/span> Экспорта из контейнера&lt;/h4>
&lt;ul>
&lt;li>Получите идентификатор контейнера:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">podman container list
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Поскольку каталог &lt;code>/opt/wallabag/images&lt;/code> уже подмонтирован к контейнеру в каталог &lt;code>/var/www/wallabag/web/assets/images&lt;/code>, будем экспортировать в его.&lt;/li>
&lt;li>Подключитесь к контейнеру и выполните экспорт:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">podman &lt;span class="nb">exec&lt;/span> -it &amp;lt;container-id&amp;gt; sh -c &lt;span class="s2">&amp;#34;bin/console wallabag:export --env=prod john.doe /var/www/wallabag/web/assets/images/&lt;/span>&lt;span class="k">$(&lt;/span>date -I&lt;span class="k">)&lt;/span>&lt;span class="s2">.json&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Распознавание pdf</title><link>https://yamadharma.github.io/ru/post/2024/08/21/pdf-ocr/</link><pubDate>Wed, 21 Aug 2024 20:50:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/08/21/pdf-ocr/</guid><description>&lt;p>Распознавание pdf.&lt;/p>
&lt;details class="print:hidden xl:hidden" >
&lt;summary>Содержание&lt;/summary>
&lt;div class="text-sm">
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#решения-по-распознаванию-pdf">&lt;span class="section-num">1&lt;/span> Решения по распознаванию pdf&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#ocrmypdf">&lt;span class="section-num">1.1&lt;/span> OCRmyPDF&lt;/a>&lt;/li>
&lt;li>&lt;a href="#pdfsandwich">&lt;span class="section-num">1.2&lt;/span> pdfsandwich&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#некоторые-типовые-задачи">&lt;span class="section-num">2&lt;/span> Некоторые типовые задачи&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#перенос-ocr-слоя-из-одно-файла-в-другой">&lt;span class="section-num">2.1&lt;/span> Перенос ocr-слоя из одно файла в другой&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#постановка-задачи">&lt;span class="section-num">2.1.1&lt;/span> Постановка задачи&lt;/a>&lt;/li>
&lt;li>&lt;a href="#пример-задачи">&lt;span class="section-num">2.1.2&lt;/span> Пример задачи&lt;/a>&lt;/li>
&lt;li>&lt;a href="#варианты-решения">&lt;span class="section-num">2.1.3&lt;/span> Варианты решения&lt;/a>&lt;/li>
&lt;li>&lt;a href="#ресурсы">&lt;span class="section-num">2.1.4&lt;/span> Ресурсы&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/div>
&lt;/details>
&lt;h2 id="решения-по-распознаванию-pdf">&lt;span class="section-num">1&lt;/span> Решения по распознаванию pdf&lt;/h2>
&lt;h3 id="ocrmypdf">&lt;span class="section-num">1.1&lt;/span> OCRmyPDF&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/06/07/pdf-ocr-ocrmypdf/">Распознавание pdf. OCRmyPDF&lt;/a>&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/ocrmypdf/OCRmyPDF" target="_blank" rel="noopener">https://github.com/ocrmypdf/OCRmyPDF&lt;/a>&lt;/li>
&lt;li>Сайт: &lt;a href="https://ocrmypdf.readthedocs.io/" target="_blank" rel="noopener">https://ocrmypdf.readthedocs.io/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="pdfsandwich">&lt;span class="section-num">1.2&lt;/span> pdfsandwich&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="http://www.tobias-elze.de/pdfsandwich/" target="_blank" rel="noopener">http://www.tobias-elze.de/pdfsandwich/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="некоторые-типовые-задачи">&lt;span class="section-num">2&lt;/span> Некоторые типовые задачи&lt;/h2>
&lt;h3 id="перенос-ocr-слоя-из-одно-файла-в-другой">&lt;span class="section-num">2.1&lt;/span> Перенос ocr-слоя из одно файла в другой&lt;/h3>
&lt;h4 id="постановка-задачи">&lt;span class="section-num">2.1.1&lt;/span> Постановка задачи&lt;/h4>
&lt;ul>
&lt;li>Есть 2 pdf-файла:
&lt;ul>
&lt;li>хороший, но без текстового слоя;&lt;/li>
&lt;li>плохой, но с правильным текстовым слоем.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Оба файла содержат одинаковые изображения.&lt;/li>
&lt;li>Цель состоит в том, чтобы встроить текстовый слой из второго файла в первый pdf-файл.&lt;/li>
&lt;/ul>
&lt;h4 id="пример-задачи">&lt;span class="section-num">2.1.2&lt;/span> Пример задачи&lt;/h4>
&lt;ul>
&lt;li>Первый файл подготовлен с помощью OCRmyPDF, имеет адекватный размер.&lt;/li>
&lt;li>Второй файл обработан FineReader, имеет хороший текстовый слой, но очень большой размер.&lt;/li>
&lt;/ul>
&lt;h4 id="варианты-решения">&lt;span class="section-num">2.1.3&lt;/span> Варианты решения&lt;/h4>
&lt;ul>
&lt;li>Удалить изображения из файла &lt;code>input_ocr.pdf&lt;/code> с помощью Ghostscript:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">gs -o &lt;span class="s2">&amp;#34;input_ocr_textonly.pdf&amp;#34;&lt;/span> -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERIMAGE &lt;span class="s2">&amp;#34;input_ocr.pdf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Объединить его с файлом &lt;code>input_image.pdf&lt;/code> с помощью &lt;code>pdftk&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">pdftk &lt;span class="s2">&amp;#34;input_ocr_textonly.pdf&amp;#34;&lt;/span> multistamp &lt;span class="s2">&amp;#34;input_image.pdf&amp;#34;&lt;/span> output &lt;span class="s2">&amp;#34;output.pdf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Или объединить его с файлом &lt;code>input_image.pdf&lt;/code> с помощью &lt;code>qpdf&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">qpdf --empty --pages &lt;span class="s2">&amp;#34;input_image.pdf&amp;#34;&lt;/span> -- --underlay &lt;span class="s2">&amp;#34;input_ocr_textonly.pdf&amp;#34;&lt;/span> -- &lt;span class="s2">&amp;#34;output.pdf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="ресурсы">&lt;span class="section-num">2.1.4&lt;/span> Ресурсы&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://superuser.com/questions/679979/copy-pdf-text-layer-to-another-pdf" target="_blank" rel="noopener">https://superuser.com/questions/679979/copy-pdf-text-layer-to-another-pdf&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Распознавание pdf. OCRmyPDF</title><link>https://yamadharma.github.io/ru/post/2024/06/07/pdf-ocr-ocrmypdf/</link><pubDate>Fri, 07 Jun 2024 21:07:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/06/07/pdf-ocr-ocrmypdf/</guid><description>&lt;p>Распознавание pdf. OCRmyPDF&lt;/p>
&lt;details class="print:hidden xl:hidden" >
&lt;summary>Содержание&lt;/summary>
&lt;div class="text-sm">
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#примеры-использования">&lt;span class="section-num">2&lt;/span> Примеры использования&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/div>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/ocrmypdf/OCRmyPDF" target="_blank" rel="noopener">https://github.com/ocrmypdf/OCRmyPDF&lt;/a>&lt;/li>
&lt;li>Сайт: &lt;a href="https://ocrmypdf.readthedocs.io/" target="_blank" rel="noopener">https://ocrmypdf.readthedocs.io/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="примеры-использования">&lt;span class="section-num">2&lt;/span> Примеры использования&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Список языков для распознавания:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tesseract --list-langs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Преобразовать сканированный файл в файл PDF/A с распознаванием русского и английского языков:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf -l rus+eng input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Заменить отсканированный PDF-файл PDF/A-файлом:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf input.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Пропустить страницы входного PDF-файла смешанного формата, которые уже содержат текст:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf --skip-text input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Очистите, исправьте перекос и поверните плохо отсканированные страницы:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf --clean --deskew --rotate-pages input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Убрать фон:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf --clean --remove-background input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Разделить сдвоенные страницы:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf -l rus+eng --clean --clean-final --unpaper-args &lt;span class="s1">&amp;#39;--layout double&amp;#39;&lt;/span> input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Контролируем оптимизацию:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf --optimize &lt;span class="m">3&lt;/span> --jbig2-lossy input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Распознавание с оптимизацией:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf -l rus+eng --optimize &lt;span class="m">3&lt;/span> --jbig2-lossy input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Задать метаданные PDF-файла:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf --skip-text --title &lt;span class="s2">&amp;#34;&amp;lt;title&amp;gt;&amp;#34;&lt;/span> --author &lt;span class="s2">&amp;#34;&amp;lt;author&amp;gt;&amp;#34;&lt;/span> --subject &lt;span class="s2">&amp;#34;&amp;lt;subject&amp;gt;&amp;#34;&lt;/span> --keywords &lt;span class="s2">&amp;#34;&amp;lt;keyword; key phrase; ...&amp;gt;&amp;#34;&lt;/span> input_file.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Не распознавать pdf-файл&lt;/p>
&lt;ul>
&lt;li>При установке параметра &lt;code>--tesseract-timeout 0&lt;/code> OCRmyPDF будет обрабатывать изображения без выполнения OCR.&lt;/li>
&lt;/ul>
&lt;!--listend-->
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf --tesseract-timeout&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> --remove-background input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Удалить весь распознанный текст из pdf-файла:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf --tesseract-timeout &lt;span class="m">0&lt;/span> --optimize &lt;span class="m">3&lt;/span> --force-ocr input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Оптимизация изображений без выполнения распознавания:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ocrmypdf --tesseract-timeout&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> --optimize &lt;span class="m">3&lt;/span> --skip-text input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Чтение</title><link>https://yamadharma.github.io/ru/post/2023/12/05/read/</link><pubDate>Tue, 05 Dec 2023 10:13:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/12/05/read/</guid><description>&lt;p>Организация чтения.&lt;/p>
&lt;details class="print:hidden xl:hidden" >
&lt;summary>Содержание&lt;/summary>
&lt;div class="text-sm">
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#подготовка-документов">&lt;span class="section-num">1&lt;/span> Подготовка документов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#программы-для-чтения">&lt;span class="section-num">2&lt;/span> Программы для чтения&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#чтение-книг">&lt;span class="section-num">2.1&lt;/span> Чтение книг&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#foliate">&lt;span class="section-num">2.1.1&lt;/span> Foliate&lt;/a>&lt;/li>
&lt;li>&lt;a href="#crqt-ng">&lt;span class="section-num">2.1.2&lt;/span> crqt-ng&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#просмотр-pdf">&lt;span class="section-num">2.2&lt;/span> Просмотр pdf&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/div>
&lt;/details>
&lt;h2 id="подготовка-документов">&lt;span class="section-num">1&lt;/span> Подготовка документов&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/12/05/preparing-documents-reading/">Подготовка документов для чтения&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="программы-для-чтения">&lt;span class="section-num">2&lt;/span> Программы для чтения&lt;/h2>
&lt;h3 id="чтение-книг">&lt;span class="section-num">2.1&lt;/span> Чтение книг&lt;/h3>
&lt;h4 id="foliate">&lt;span class="section-num">2.1.1&lt;/span> Foliate&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/12/30/reader-foliate/">Читалка. Foliate&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="crqt-ng">&lt;span class="section-num">2.1.2&lt;/span> crqt-ng&lt;/h4>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://gitlab.com/coolreader-ng/crqt-ng" target="_blank" rel="noopener">https://gitlab.com/coolreader-ng/crqt-ng&lt;/a>&lt;/li>
&lt;li>Форк проекта CoolReader.&lt;/li>
&lt;li>Фактически это Qt-интерфейс для библиотеки crengine-ng.&lt;/li>
&lt;li>Поддерживаемые форматы электронных книг: fb2, fb3 (неполный), epub (без DRM), doc, docx, odt, rtf, pdb, mobi (без DRM), txt, html, markdown, chm, tcr.&lt;/li>
&lt;li>Поддержка FB2: стили, таблицы, сноски внизу страницы.&lt;/li>
&lt;/ul>
&lt;h3 id="просмотр-pdf">&lt;span class="section-num">2.2&lt;/span> Просмотр pdf&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/09/20/pdf-viewer-zathura/">Pdf. Просмотр. Zathura&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Подготовка документов для чтения</title><link>https://yamadharma.github.io/ru/post/2023/12/05/preparing-documents-reading/</link><pubDate>Tue, 05 Dec 2023 10:09:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/12/05/preparing-documents-reading/</guid><description>&lt;p>Подготовка документов для чтения.&lt;/p>
&lt;details class="print:hidden xl:hidden" >
&lt;summary>Содержание&lt;/summary>
&lt;div class="text-sm">
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#преобразование-формата">&lt;span class="section-num">1&lt;/span> Преобразование формата&lt;/a>&lt;/li>
&lt;li>&lt;a href="#чистка-документа">&lt;span class="section-num">2&lt;/span> Чистка документа&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#удалить-текстовый-слой">&lt;span class="section-num">2.1&lt;/span> Удалить текстовый слой&lt;/a>&lt;/li>
&lt;li>&lt;a href="#unpaper">&lt;span class="section-num">2.2&lt;/span> unpaper&lt;/a>&lt;/li>
&lt;li>&lt;a href="#scantailor">&lt;span class="section-num">2.3&lt;/span> ScanTailor&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#распознавание-документа">&lt;span class="section-num">3&lt;/span> Распознавание документа&lt;/a>&lt;/li>
&lt;li>&lt;a href="#создание-оглавления">&lt;span class="section-num">4&lt;/span> Создание оглавления&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">4.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#ссылки">&lt;span class="section-num">4.2&lt;/span> Ссылки&lt;/a>&lt;/li>
&lt;li>&lt;a href="#handyoutliner-for-djvu-pdf">&lt;span class="section-num">4.3&lt;/span> HandyOutliner for DjVu / PDF&lt;/a>&lt;/li>
&lt;li>&lt;a href="#pdf-and-djvu-bookmarker">&lt;span class="section-num">4.4&lt;/span> Pdf &amp;amp; Djvu Bookmarker&lt;/a>&lt;/li>
&lt;li>&lt;a href="#jpdfbookmarks">&lt;span class="section-num">4.5&lt;/span> jpdfbookmarks&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/div>
&lt;/details>
&lt;h2 id="преобразование-формата">&lt;span class="section-num">1&lt;/span> Преобразование формата&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/07/26/convert-djvu-pdf/">Преобразование djvu в pdf&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="чистка-документа">&lt;span class="section-num">2&lt;/span> Чистка документа&lt;/h2>
&lt;h3 id="удалить-текстовый-слой">&lt;span class="section-num">2.1&lt;/span> Удалить текстовый слой&lt;/h3>
&lt;ul>
&lt;li>Ghostscript поддерживает параметры, которые позволяют удалить из PDF-файла либо весь текст, либо все изображения, либо все векторные элементы.&lt;/li>
&lt;li>Удалить весь текст из входного PDF-файла:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">gs -o no-more-texts.pdf -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERTEXT input.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Удалить все растровые элементы из входного PDF-файла:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">gs -o no-more-texts.pdf -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERIMAGE input.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Удалить все векторные элементы из входного PDF-файла:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">gs -o no-more-texts.pdf -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERVECTOR input.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Можно комбинировать любой из двух вышеуказанных параметров (объединение всех трёх приведет к созданию пустых страниц):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">gs -o noIMG.pdf -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERIMAGE input.pdf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gs -o noTXT.pdf -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERTEXT input.pdf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gs -o noVCT.pdf -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERVECTOR input.pdf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gs -o onlyIMG.pdf -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERVECTOR -dFILTERTEXT input.pdf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gs -o onlyTXT.pdf -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERVECTOR -dFILTERIMAGE input.pdf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gs -o onlyVCT.pdf -sDEVICE&lt;span class="o">=&lt;/span>pdfwrite -dFILTERIMAGE -dFILTERTEXT input.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="unpaper">&lt;span class="section-num">2.2&lt;/span> unpaper&lt;/h3>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/Flameeyes/unpaper" target="_blank" rel="noopener">https://github.com/Flameeyes/unpaper&lt;/a>&lt;/li>
&lt;li>Сайт: &lt;a href="https://www.flameeyes.com/projects/unpaper" target="_blank" rel="noopener">https://www.flameeyes.com/projects/unpaper&lt;/a>&lt;/li>
&lt;li>Инструмент постобработки отсканированных изображений.&lt;/li>
&lt;li>Основная цель &amp;mdash; сделать отсканированные страницы книги более читабельными.&lt;/li>
&lt;/ul>
&lt;h3 id="scantailor">&lt;span class="section-num">2.3&lt;/span> ScanTailor&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://scantailor.org/" target="_blank" rel="noopener">https://scantailor.org/&lt;/a>&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/4lex4/scantailor-advanced" target="_blank" rel="noopener">https://github.com/4lex4/scantailor-advanced&lt;/a>&lt;/li>
&lt;li>ScanTailor Advanced объединяет функции версий ScanTailor Featured и ScanTailor Enhanced.&lt;/li>
&lt;/ul>
&lt;h2 id="распознавание-документа">&lt;span class="section-num">3&lt;/span> Распознавание документа&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/08/21/pdf-ocr/">Распознавание pdf&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="создание-оглавления">&lt;span class="section-num">4&lt;/span> Создание оглавления&lt;/h2>
&lt;h3 id="общая-информация">&lt;span class="section-num">4.1&lt;/span> Общая информация&lt;/h3>
&lt;ul>
&lt;li>Оглавление упрощает ориентацию в книге.&lt;/li>
&lt;li>Оглавление позволяет:
&lt;ul>
&lt;li>всегда иметь под рукой список глав и заголовков книги;&lt;/li>
&lt;li>быстро переходить к началу нужной главы или другим важным местам в книге;&lt;/li>
&lt;li>структурировать заметки к книге.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="ссылки">&lt;span class="section-num">4.2&lt;/span> Ссылки&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://commons.wikimedia.org/wiki/Help:Creating_an_outline_for_PDF_and_DjVu/ru" target="_blank" rel="noopener">https://commons.wikimedia.org/wiki/Help:Creating_an_outline_for_PDF_and_DjVu/ru&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="handyoutliner-for-djvu-pdf">&lt;span class="section-num">4.3&lt;/span> HandyOutliner for DjVu / PDF&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://handyoutlinerfo.sourceforge.net/index_ru.htm" target="_blank" rel="noopener">https://handyoutlinerfo.sourceforge.net/index_ru.htm&lt;/a>&lt;/li>
&lt;li>Sourceforge: &lt;a href="https://sourceforge.net/projects/handyoutlinerfo/" target="_blank" rel="noopener">https://sourceforge.net/projects/handyoutlinerfo/&lt;/a>&lt;/li>
&lt;li>Требует .NET 4.0.&lt;/li>
&lt;li>Под Linux работает под mono.&lt;/li>
&lt;/ul>
&lt;h3 id="pdf-and-djvu-bookmarker">&lt;span class="section-num">4.4&lt;/span> Pdf &amp;amp; Djvu Bookmarker&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://sourceforge.net/projects/djvubookmarker/" target="_blank" rel="noopener">https://sourceforge.net/projects/djvubookmarker/&lt;/a>&lt;/li>
&lt;li>Создание оглавление производится с одновременным просмотром самого документа.&lt;/li>
&lt;/ul>
&lt;h3 id="jpdfbookmarks">&lt;span class="section-num">4.5&lt;/span> jpdfbookmarks&lt;/h3>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/SemanticBeeng/jpdfbookmarks" target="_blank" rel="noopener">https://github.com/SemanticBeeng/jpdfbookmarks&lt;/a>&lt;/li>
&lt;li>Сайт: &lt;a href="https://sourceforge.net/projects/jpdfbookmarks/" target="_blank" rel="noopener">https://sourceforge.net/projects/jpdfbookmarks/&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Отложенное чтение. Pocket</title><link>https://yamadharma.github.io/ru/post/2023/09/06/deferred-reading-pocket/</link><pubDate>Wed, 06 Sep 2023 15:21:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/09/06/deferred-reading-pocket/</guid><description>&lt;p>Отложенное чтение. Сервис Pocket.&lt;/p>
&lt;details class="print:hidden xl:hidden" >
&lt;summary>Содержание&lt;/summary>
&lt;div class="text-sm">
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#программное-обеспечение">&lt;span class="section-num">2&lt;/span> Программное обеспечение&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сохранение-в-pocket-с-клавиатуры">&lt;span class="section-num">3&lt;/span> Сохранение в Pocket с клавиатуры&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сочетания-клавиш-в-pocket-для-веба">&lt;span class="section-num">4&lt;/span> Сочетания клавиш в Pocket для Веба&lt;/a>&lt;/li>
&lt;li>&lt;a href="#прекращение-работы-pocket">&lt;span class="section-num">5&lt;/span> Прекращение работы Pocket&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/div>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://getpocket.com/" target="_blank" rel="noopener">https://getpocket.com/&lt;/a>&lt;/li>
&lt;li>Синхронизация на нескольких устройствах.&lt;/li>
&lt;li>Возможен офлайн-просмотр.&lt;/li>
&lt;li>Есть платная подписка Premium:
&lt;ul>
&lt;li>в ленте нет спонсированных материалов;&lt;/li>
&lt;li>сохраняются копии всех ссылок.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Принадлежит Mozilla.&lt;/li>
&lt;/ul>
&lt;h2 id="программное-обеспечение">&lt;span class="section-num">2&lt;/span> Программное обеспечение&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/09/06/emacs_pocket_reader/">Emacs. Pocket reader&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="сохранение-в-pocket-с-клавиатуры">&lt;span class="section-num">3&lt;/span> Сохранение в Pocket с клавиатуры&lt;/h2>
&lt;ul>
&lt;li>Сохранение в Pocket с помощью сочетания клавиш в Firefox можно осуществить с помощью дополнения ShortcutKey2URL (см. &lt;a href="https://yamadharma.github.io/ru/post/2025/04/24/browser-transient-menu/">Броузер. Реализация transient menu&lt;/a>):
&lt;ul>
&lt;li>Установите дополнение ShortcutKey2URL.&lt;/li>
&lt;li>Скопируйте код javascript из Pocket bookmarklet (&lt;a href="https://getpocket.com/add?sb=1" target="_blank" rel="noopener">https://getpocket.com/add?sb=1&lt;/a>).&lt;/li>
&lt;li>В настройках ShortcutKey2URL добавьте новую запись, вставив полученный код.&lt;/li>
&lt;li>Установите клавишу меню, например &lt;code>S&lt;/code>.&lt;/li>
&lt;li>Чтобы вызвать меню надо нажать &lt;code>Ctrl+.&lt;/code> (или другую комбинацию, если вы перенастроили).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="сочетания-клавиш-в-pocket-для-веба">&lt;span class="section-num">4&lt;/span> Сочетания клавиш в Pocket для Веба&lt;/h2>
&lt;ul>
&lt;li>Нажмите клавишу &lt;code>?&lt;/code> или &lt;code>/&lt;/code>, чтобы просмотреть список сочетаний клавиш на веб-сайте Pocket.&lt;/li>
&lt;/ul>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 1:&lt;/span>
Сочетания клавиш при просмотре списка
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Перейти к Сохранениям&lt;/th>
&lt;th>g, затем l&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Перейти в Архив&lt;/td>
&lt;td>g, затем a&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Перейти к Избранному&lt;/td>
&lt;td>g, затем f&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Перейти к Статьям&lt;/td>
&lt;td>g, затем r&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Перейти к Выделениям&lt;/td>
&lt;td>g, затем h&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Перейти к Видео&lt;/td>
&lt;td>g, затем v&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Перейти ко Всем меткам&lt;/td>
&lt;td>g, затем t&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Перейти к Поиску&lt;/td>
&lt;td>g, затем s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Множественное редактирование&lt;/td>
&lt;td>g, затем b&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Сохранить URL&lt;/td>
&lt;td>g, затем u&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Сортировать по Новым&lt;/td>
&lt;td>s, затем n&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Сортировать по Старым&lt;/td>
&lt;td>s, затем o&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Вид Списком&lt;/td>
&lt;td>v, затем l&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Вид Сеткой&lt;/td>
&lt;td>v, затем g&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Подробный просмотр&lt;/td>
&lt;td>v, затем d&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Изменить на Светлую тему&lt;/td>
&lt;td>c, затем l&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Изменить на Тёмную тему&lt;/td>
&lt;td>c, затем d&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Перейти на тему Sephia&lt;/td>
&lt;td>c, затем s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Открыть оверлей Справки&lt;/td>
&lt;td>? или /&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 2:&lt;/span>
Действия с элементами
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Открыть оригинал в Новой вкладке&lt;/th>
&lt;th>o&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Заархивировать выбранный элемент&lt;/td>
&lt;td>a&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Добавить выбранный элемент в Избранное&lt;/td>
&lt;td>f&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Назначить метку на выбранный элемент&lt;/td>
&lt;td>t&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Удалить выбранный элмент&lt;/td>
&lt;td>d&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Выбрать элемент во Множественном редактировании&lt;/td>
&lt;td>x&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Выбрать следующий элемент&lt;/td>
&lt;td>j&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Выбрать предыдущий элемент&lt;/td>
&lt;td>k&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 3:&lt;/span>
Действия с элементами при просмотре статей
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Увеличить/уменьшить размер шрифта&lt;/th>
&lt;th>Cmd/Ctrl +/-&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Вернуться к Сохранениям&lt;/td>
&lt;td>b&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Удалить элемент&lt;/td>
&lt;td>d&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Отредактировать метки&lt;/td>
&lt;td>t&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Заархивировать элемент&lt;/td>
&lt;td>a&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Добавить элемент в Избранное&lt;/td>
&lt;td>f&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Просмотр оригинала&lt;/td>
&lt;td>o&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Увеличение/уменьшение ширины столбца (Premium)&lt;/td>
&lt;td>Alt/Option =/-&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="прекращение-работы-pocket">&lt;span class="section-num">5&lt;/span> Прекращение работы Pocket&lt;/h2>
&lt;ul>
&lt;li>
&lt;ul>
&lt;li>Пришло письмо, что Pocket прекращает свою работу.&lt;/li>
&lt;li>&lt;a href="https://support.mozilla.org/en-US/kb/future-of-pocket" target="_blank" rel="noopener">https://support.mozilla.org/en-US/kb/future-of-pocket&lt;/a>&lt;/li>
&lt;li>22 мая 2025 г.
&lt;ul>
&lt;li>Pocket удален из магазинов приложений&lt;/li>
&lt;li>Ежемесячное продление подписки отключено&lt;/li>
&lt;li>Регистрация новых учетных записей Pocket отключена&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>8 июля 2025 г.
&lt;ul>
&lt;li>Pocket выключается&lt;/li>
&lt;li>Ежегодные возвраты средств подписчикам производятся пропорционально и автоматически.&lt;/li>
&lt;li>Режим «только экспорт» в Pocket Web&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>8 октября 2025 г.
&lt;ul>
&lt;li>Конечная дата экспорта данных&lt;/li>
&lt;li>Все аккаунты и данные удалены&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item></channel></rss>