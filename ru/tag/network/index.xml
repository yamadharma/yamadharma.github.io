<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Network | Д. С. Кулябов</title><link>https://yamadharma.github.io/ru/tag/network/</link><atom:link href="https://yamadharma.github.io/ru/tag/network/index.xml" rel="self" type="application/rss+xml"/><description>Network</description><generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>ru-ru</language><copyright>© 2024 Dmitry S. Kulyabov</copyright><lastBuildDate>Mon, 22 Jul 2024 17:45:00 +0300</lastBuildDate><image><url>https://yamadharma.github.io/media/icon_hu15752663207405015554.png</url><title>Network</title><link>https://yamadharma.github.io/ru/tag/network/</link></image><item><title>Лабораторные работы</title><link>https://yamadharma.github.io/ru/course/simulation-networks/lab/</link><pubDate>Thu, 29 Sep 2022 21:19:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/simulation-networks/lab/</guid><description>&lt;p>Лабораторные работы по Mininet.&lt;/p>
&lt;ul class="list-unstyled">
&lt;li>
&lt;h5>&lt;a href="https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-intro/">Введение в Mininet&lt;/a>&lt;/h5>
&lt;p>Введение в средство натурного моделирования Mininet.
&lt;/p>
&lt;/li>
&lt;li>
&lt;h5>&lt;a href="https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-iperf-intro/">Введение в Iperf&lt;/a>&lt;/h5>
&lt;p>Введение в Iperf.
&lt;/p>
&lt;/li>
&lt;li>
&lt;h5>&lt;a href="https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-netem-i/">Использование netem (latency, jitter)&lt;/a>&lt;/h5>
&lt;p>Mininet. Использование netem. Задержки, джтиттер.
&lt;/p>
&lt;/li>
&lt;li>
&lt;h5>&lt;a href="https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-netem-ii/">Использование netem (потери пакетов)&lt;/a>&lt;/h5>
&lt;p>Использование netem. Потери пакетов, дублирование пакетов, изменение порядка, повреждение пакетов.
&lt;/p>
&lt;/li>
&lt;li>
&lt;h5>&lt;a href="https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-token-bucket-filter/">Token Bucket Filter&lt;/a>&lt;/h5>
&lt;p>Управление пропускной способностью с помощью дисциплина очередей Token Bucket Filter (TBF).
&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>Сетевые технологии. Лабораторные работы</title><link>https://yamadharma.github.io/ru/course/nettech/nettech-lab/</link><pubDate>Thu, 14 Jul 2022 12:27:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/nettech/nettech-lab/</guid><description>&lt;p>Лабораторные работы по курсу &lt;em>Сетевые технологии&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#лабораторные-работы">&lt;span class="section-num">1&lt;/span> Лабораторные работы&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="лабораторные-работы">&lt;span class="section-num">1&lt;/span> Лабораторные работы&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>Методы кодирования и модуляция сигналов&lt;/p>
&lt;ul>
&lt;li>Построение графиков в Octave&lt;/li>
&lt;li>Разложение импульсного сигнала в частичный ряд Фурье&lt;/li>
&lt;li>Определение спектра и параметров сигнала&lt;/li>
&lt;li>Амплитудная модуляция&lt;/li>
&lt;li>Кодирование сигнала. Исследование свойства самосинхронизации сигнала&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Расчёт сети Fast Ethernet&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Анализ трафика в Wireshark&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2021/08/18/wireshark-protocol-analyzer/">Анализатор протоколов Wireshark&lt;/a>&lt;/li>
&lt;li>MAC-адресация. Анализ структуры MAC-адреса&lt;/li>
&lt;li>Анализ кадров канального уровня в Wireshark&lt;/li>
&lt;li>Анализ протоколов транспортного уровня в Wireshark&lt;/li>
&lt;li>Анализ handshake протокола TCP в Wireshark&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Подготовка экспериментального стенда GNS3&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/gns3-virtualbox/">GNS3 на Virtualbox&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/gns3-basics/">Основы работы в GNS3&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/06/02/routing-frrouting/">Маршрутизация. FRRouting&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/gns3-vyos/">GNS3. Образ VyOS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Простые сети в GNS3. Анализ трафика&lt;/p>
&lt;ul>
&lt;li>Моделирование простейшей сети на базе коммутатора в GNS3&lt;/li>
&lt;li>Анализ трафика в GNS3 посредством Wireshark&lt;/li>
&lt;li>Моделирование простейшей сети на базе маршрутизатора FRR в GNS3&lt;/li>
&lt;li>Моделирование простейшей сети на базе маршрутизатора VyOS в GNS3&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Адресация IPv4 и IPv6. Двойной стек&lt;/p>
&lt;ul>
&lt;li>Разбиение сети на подсети&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/ipv4-ipv6-addressing-double-stack/">Адресация IPv4 и IPv6. Двойной стек&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Адресация IPv4 и IPv6. Настройка DHCP&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/configuring-dhcp-ipv4/">Адресация IPv4 и IPv6. Настройка DHCP для IPv4&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/configuring-dhcpv6-ipv6/">Адресация IPv4 и IPv6. Настройка DHCPv6 для IPv6&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Адресация IPv4 и IPv6. Настройка маршрутизации&lt;/p>
&lt;ul>
&lt;li>Настройка динамической маршрутизации в сетях IPv4 и IPv6. Протоколы RIP, OSPF&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/tunnel-ipv6-ipv4/">Туннель ipv6-ipv4&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol></description></item><item><title>GNS3 на Virtualbox</title><link>https://yamadharma.github.io/ru/course/nettech/gns3-virtualbox/</link><pubDate>Sat, 25 Jun 2022 16:57:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/nettech/gns3-virtualbox/</guid><description>&lt;p>Использование образа GNS3 для Virtualbox.&lt;/p>
&lt;h2 id="установка-программ-gns3">&lt;span class="section-num">1&lt;/span> Установка программ GNS3&lt;/h2>
&lt;h3 id="установка-на-windows">&lt;span class="section-num">1.1&lt;/span> Установка на Windows&lt;/h3>
&lt;h4 id="установка-с-помощью-инсталлятора">&lt;span class="section-num">1.1.1&lt;/span> Установка с помощью инсталлятора&lt;/h4>
&lt;ul>
&lt;li>Расположение инсталлятора: &lt;a href="https://github.com/GNS3/gns3-gui/releases" target="_blank" rel="noopener">https://github.com/GNS3/gns3-gui/releases&lt;/a>.&lt;/li>
&lt;li>Наименование испольняемого файла: &lt;code>GNS3-&amp;lt;версия&amp;gt;-all-in-one.exe&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="установка-с-помощью-менеджера-пакетов">&lt;span class="section-num">1.1.2&lt;/span> Установка с помощью менеджера пакетов&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Используйте &lt;a href="https://yamadharma.github.io/ru/post/2021/01/18/package-manager-windows-chocolatey/">Пакетный менеджер для Windows. Chocolatey&lt;/a>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Установите VirtualBox:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">choco install virtualbox -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Установите GNS3:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">choco install gns3 -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Отметьте для установки:
&lt;ul>
&lt;li>GNS3 Desctop;&lt;/li>
&lt;li>GNS3 VM;&lt;/li>
&lt;li>Tools.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>При установке будет скачан образ для виртуальной машины (в папку &lt;code>Downloads&lt;/code>).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>После установки не надо запускать GNS3, нужно вначале сконфигурить виртуальную машину.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="видео-установка-программ-gns3-на-windows--virtualbox">&lt;span class="section-num">1.1.3&lt;/span> Видео: Установка программ GNS3 на Windows (VirtualBox)&lt;/h4>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-fcadeb" data-toggle="tab" href="#fcadeb"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-fdcaeb" data-toggle="tab" href="#fdcaeb"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="fcadeb" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/b5c79641d5bb7dde0bcd1f54a8158b34"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="fdcaeb" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/XCAlbMvczGc?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h3 id="установка-на-linux">&lt;span class="section-num">1.2&lt;/span> Установка на Linux&lt;/h3>
&lt;h4 id="gentoo">&lt;span class="section-num">1.2.1&lt;/span> Gentoo&lt;/h4>
&lt;ul>
&lt;li>Установите клиент и сервер GNS3:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge net-misc/gns3-gui
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="fedora">&lt;span class="section-num">1.2.2&lt;/span> Fedora&lt;/h4>
&lt;ul>
&lt;li>Установка из репозитория:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo dnf install gns3-server gns3-gui
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="установка-виртуальной-машины">&lt;span class="section-num">2&lt;/span> Установка виртуальной машины&lt;/h2>
&lt;h3 id="установка-образа-виртуальной-машины-gns3-для-virtualbox">&lt;span class="section-num">2.1&lt;/span> Установка образа виртуальной машины GNS3 для VirtualBox&lt;/h3>
&lt;ul>
&lt;li>Следут учитывать, что версия образа для VirtualBox должна соответствовать версии клиента и сервера GNS3.&lt;/li>
&lt;li>Загрузите образ GNS3 VM для Virtualbox со страницы выпуска:
&lt;ul>
&lt;li>&lt;a href="https://gns3.com/software/download-vm" target="_blank" rel="noopener">https://gns3.com/software/download-vm&lt;/a>;&lt;/li>
&lt;li>&lt;a href="https://github.com/GNS3/gns3-gui/releases" target="_blank" rel="noopener">https://github.com/GNS3/gns3-gui/releases&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Извлеките загруженный zip-файл в каталог. Загруженный zip-файл содержит образ диска VirtualBox.&lt;/li>
&lt;li>Откройте приложение VirtualBox и выберите &lt;em>Файл&lt;/em>, затем &lt;em>Импорт конфигурации&lt;/em>.&lt;/li>
&lt;li>Перейдите к папке, в которую вы распаковали загруженный образ диска, и выберите ее.&lt;/li>
&lt;li>VirtualBox открывает интерфейс с перечислением предопределенных ресурсов. Можно настроить ресурсы.&lt;/li>
&lt;li>Нажмите &lt;em>Импорт&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h3 id="вложенная-виртуализация">&lt;span class="section-num">2.2&lt;/span> Вложенная виртуализация&lt;/h3>
&lt;ul>
&lt;li>Это функция позволяет использовать виртуализацию внутри виртуализированной среды. Например, запускать KVM на виртуальной машине, работающей на VirtualBox.&lt;/li>
&lt;li>Эта функция необходима для сервера GNS3, поскольку он инициирует экземпляры внутри самой виртуальной машины.&lt;/li>
&lt;li>Начиная с версии 6.1, Oracle VM VirtualBox поддерживает функцию вложенной виртуализации на хост-системах с процессорами AMD и Intel.&lt;/li>
&lt;li>Для процессоров Intel вложенная виртуализация недоступна из графического интерфейса программы, но ее можно включить с помощью командной строки.&lt;/li>
&lt;/ul>
&lt;h4 id="включение-вложенной-виртуализации-из-графического-интерфейса">&lt;span class="section-num">2.2.1&lt;/span> Включение вложенной виртуализации из графического интерфейса&lt;/h4>
&lt;ul>
&lt;li>Выбираем виртуальную машину, которую мы импортировали, затем переходим на вкладку настроек.&lt;/li>
&lt;li>Перейдём к опции &lt;em>Система&lt;/em>, затем выберем &lt;em>Процессор&lt;/em>.&lt;/li>
&lt;li>Убедимся, что установлен флажок &lt;em>Включить Nested VT-x/AMD-V&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h4 id="включение-вложенной-виртуализации-из-командной-строки">&lt;span class="section-num">2.2.2&lt;/span> Включение вложенной виртуализации из командной строки&lt;/h4>
&lt;ul>
&lt;li>Можно включить вложенную виртуализацию из командной строки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vboxmanage modifyvm &lt;span class="s2">&amp;#34;GNS3 VM&amp;#34;&lt;/span> --nested-hw-virt on
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Здесь &lt;em>GNS3 VM&lt;/em> &amp;mdash; имя виртуальной машины VirtualBox.&lt;/li>
&lt;li>Посмотреть список виртуальных машин можно командой:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vboxmanage list vms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="запуск-экземпляра-gns3-на-virtualbox">&lt;span class="section-num">2.3&lt;/span> Запуск экземпляра GNS3 на VirtualBox&lt;/h3>
&lt;ul>
&lt;li>Убедитесь, что установлен сетевой адаптер с опцией &lt;em>Адаптер только для хоста&lt;/em>.&lt;/li>
&lt;li>Включите экземпляр.&lt;/li>
&lt;li>Посмотрите информацию о запущенной виртуальной машине.&lt;/li>
&lt;li>Убедитесь, что можете получить доступ к IP-адресу виртуальной машины с хоста (выполните команду &lt;code>ping&lt;/code>).&lt;/li>
&lt;li>Также убедитесь, что значение &lt;em>KVM support available&lt;/em> установлено в &lt;em>True&lt;/em>. В противном случае убедитесь, что вложенная виртуализация включена.&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-отображения-свойств-virtualbox">&lt;span class="section-num">2.4&lt;/span> Настройка отображения свойств VirtualBox&lt;/h3>
&lt;ul>
&lt;li>Gns3 получает параметры виртуальной, запрашивая свойства VirtualBox.&lt;/li>
&lt;li>Начиная с версии Virtualbox-7 эти свойства отображаются в текущей локали пользователя.&lt;/li>
&lt;li>Вы в этом можете убедиться, запустив:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">VBoxManage list systemproperties
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для корректной работы gns3 необходимо отображать эту информацию на английском.&lt;/li>
&lt;li>Поэтому следует задать кодировку для отображения свойств VirtualBox:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">VBoxManage setproperty language C
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-gns3-gui-с-виртуальной-машиной-gns3-vm-virtualbox">&lt;span class="section-num">2.5&lt;/span> Настройка GNS3 GUI с виртуальной машиной GNS3 VM Virtualbox&lt;/h3>
&lt;ul>
&lt;li>Откройте приложение &lt;code>gns3&lt;/code>.&lt;/li>
&lt;li>При первой загрузке запустится мастер настройки.
&lt;ul>
&lt;li>В противном случае перейдите на вкладку &lt;em>Help&lt;/em>, затем выберите &lt;em>Setup Wizard&lt;/em>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Выберите параметр &lt;em>Run appliances in a virtual machine&lt;/em>.&lt;/li>
&lt;li>На следующей вкладке выберите IP-адрес привязки хоста, который находится в подсети Virtualbox.
&lt;ul>
&lt;li>Для этого замените хостовую часть адреса на &lt;code>1&lt;/code>.&lt;/li>
&lt;li>Например, если адрес виртуальной машины &lt;code>192.168.56.110/24&lt;/code>, в качестве адреса привязки используйте &lt;code>192.168.56.1&lt;/code>.&lt;/li>
&lt;li>Путь к серверу и порт оставьте без изменений.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>После подключения выберите &lt;em>VirtualBox&lt;/em> в качестве плотформы виртуализации.&lt;/li>
&lt;li>Выберите виртуальную машину из списка существующих виртуальных машин.&lt;/li>
&lt;li>Укажите выделение ресурсов для виртуальной машины.
&lt;ul>
&lt;li>Память: не меньше 2048M.&lt;/li>
&lt;li>Процессорные ядра: желательно не менее 2-х.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="видео-установка-gns3-vm-virtualbox">&lt;span class="section-num">2.6&lt;/span> Видео: Установка GNS3 VM VirtualBox&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-faebdc" data-toggle="tab" href="#faebdc"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-fdabce" data-toggle="tab" href="#fdabce"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="faebdc" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/4ef91d4d2b3a1a517f415198cd7f5224"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="fdabce" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/kGlLSjFlrCQ?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="обновление-виртуальной-машины">&lt;span class="section-num">3&lt;/span> Обновление виртуальной машины&lt;/h2>
&lt;h3 id="обновление-виртуальной-машины-gns3">&lt;span class="section-num">3.1&lt;/span> Обновление виртуальной машины GNS3&lt;/h3>
&lt;ul>
&lt;li>Версия виртуальной машины GNS3 должна совпадать с версией клиента GNS3.&lt;/li>
&lt;li>Чтобы обновить виртуальную машину, в области информации о виртуальной машине нажмите &lt;em>ОК&lt;/em>.&lt;/li>
&lt;li>Выберите пункт меню &lt;em>Upgrade&lt;/em> и запустите его.&lt;/li>
&lt;/ul>
&lt;h3 id="видео-обновление-виртуальной-машины-gns3">&lt;span class="section-num">3.2&lt;/span> Видео: Обновление виртуальной машины GNS3&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-efcbad" data-toggle="tab" href="#efcbad"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-fedcba" data-toggle="tab" href="#fedcba"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="efcbad" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/8826eff627695b311fa8adcf959b61e6"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="fedcba" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/4kGltAXl3lk?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="дополнительные-замечания">&lt;span class="section-num">4&lt;/span> Дополнительные замечания&lt;/h2>
&lt;h3 id="настройка-эмулятора-терминала">&lt;span class="section-num">4.1&lt;/span> Настройка эмулятора терминала&lt;/h3>
&lt;ul>
&lt;li>В качестве эмулятора терминала предлагается использовать &lt;em>KDE Konsole&lt;/em>.&lt;/li>
&lt;li>Настройка заключается в установке нового профиля с увеличенным шрифтом и светлым фоном.&lt;/li>
&lt;/ul>
&lt;h4 id="видео-настройка-терминала-kde-konsole">&lt;span class="section-num">4.1.1&lt;/span> Видео: Настройка терминала KDE Konsole&lt;/h4>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-dceafb" data-toggle="tab" href="#dceafb"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-dfbace" data-toggle="tab" href="#dfbace"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="dceafb" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/eda5f307121be91d64475061eb2f1a9d"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="dfbace" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/nk25Pnm0soM?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Введение в Mininet</title><link>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-intro/</link><pubDate>Thu, 31 Mar 2022 16:10:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-intro/</guid><description>&lt;p>Введение в средство натурного моделирования &lt;em>Mininet&lt;/em>.&lt;/p>
&lt;h2 id="настройка-стенда-виртуальной-машины-mininet">&lt;span class="section-num">1&lt;/span> Настройка стенда виртуальной машины &lt;em>Mininet&lt;/em>&lt;/h2>
&lt;h3 id="общая-информация">&lt;span class="section-num">1.1&lt;/span> Общая информация&lt;/h3>
&lt;ul>
&lt;li>Репозиторий &lt;em>Mininet&lt;/em>: &lt;a href="https://github.com/mininet/mininet" target="_blank" rel="noopener">https://github.com/mininet/mininet&lt;/a>&lt;/li>
&lt;li>Образ виртуальной машины: &lt;a href="https://github.com/mininet/mininet/releases/download/2.3.0/mininet-2.3.0-210211-ubuntu-20.04.1-legacy-server-amd64-ovf.zip" target="_blank" rel="noopener">mininet-2.3.0-210211-ubuntu-20.04.1-legacy-server-amd64-ovf&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-образа">&lt;span class="section-num">1.2&lt;/span> Настройка образа&lt;/h3>
&lt;h4 id="virtualbox">&lt;span class="section-num">1.2.1&lt;/span> VirtualBox&lt;/h4>
&lt;ul>
&lt;li>Распакуйте скачанный образ.&lt;/li>
&lt;li>Импортируйте файл &lt;code>.ovf&lt;/code>.&lt;/li>
&lt;li>Перейдите в настройки.&lt;/li>
&lt;li>Добавьте дополнительный сетевой адаптер &lt;em>host-only network adapter&lt;/em>, который вы можете использовать для входа в образ виртуальной машины.&lt;/li>
&lt;/ul>
&lt;h3 id="подключение-к-виртуальной-машине">&lt;span class="section-num">1.3&lt;/span> Подключение к виртуальной машине&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Залогиньтесь в виртуальной машине:&lt;/p>
&lt;ul>
&lt;li>login: mininet&lt;/li>
&lt;li>password: mininet&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Посмотрите адрес машины:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ifconfig
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Внутренний адрес машины будет иметь вид 192.168.x.y.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Подключитесь к виртуальной машине (из терминала хостовой машины):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -Y mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Настройте вход по ключу (см. &lt;a href="https://yamadharma.github.io/ru/post/2022/02/17/ssh-keys/">Ключи ssh&lt;/a>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh-copy-id mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-параметров-xterm">&lt;span class="section-num">1.4&lt;/span> Настройка параметров &lt;em>XTerm&lt;/em>&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>По умолчанию &lt;em>XTerm&lt;/em> использует растровые шрифты, малого кегля.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Предлагается использовать векторные шрифты, кегль увеличить до 12&amp;ndash;16 пунктов.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Для этого добавим в файл конфигурации &lt;code>/etc/X11/app-defaults/XTerm&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">xterm*faceName: Monospace
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">xterm*faceSize: 14
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Здесь выбран системный моноширинный шрифт, кегль шрифта &amp;mdash; 14 пунктов.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-соединения-x11-для-суперпользователя">&lt;span class="section-num">1.5&lt;/span> Настройка соединения X11 для суперпользователя&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>При попытке запуска приложения из-под суперпользователя возникает ошибка:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">X11 connection rejected because of wrong authentication.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Ошибка возникает из-за того, что X-соединение выполняется от имени пользователя &lt;code>mininet&lt;/code>, а приложение запускается от имени пользователя &lt;code>root&lt;/code> с использованием &lt;code>sudo&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Для исправления этой ситуации заполним файл полномочий &lt;code>/root/.Xauthority&lt;/code>, используя утилиту &lt;code>xauth&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Для этого скопируем значение куки (MIT magic cookie) пользователя &lt;code>mininet&lt;/code> в файл для пользователя &lt;code>root&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mininet@mininet-vm:~$ xauth list &lt;span class="nv">$DISPLAY&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mininet-vm/unix:10 MIT-MAGIC-COOKIE-1 295acad8e35d17636924c5ab80e8462d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mininet@mininet-vm:~$ sudo -i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mininet@mininet-vm:~$ xauth list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">xauth: file /root/.Xauthority does not exist
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@mininet-vm:~# xauth add mininet-vm/unix:10 MIT-MAGIC-COOKIE-1 24fa6c77c26e2073d5b0d95e574e2456
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@mininet-vm:~# xauth list &lt;span class="nv">$DISPLAY&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mininet-vm/unix:10 MIT-MAGIC-COOKIE-1 295acad8e35d17636924c5ab80e8462d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Значение для &lt;em>MIT-MAGIC-COOKIE&lt;/em> приведено условно.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>После этого должны запускаться графические приложения.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="работа-с-mininet-из-под-windows">&lt;span class="section-num">1.6&lt;/span> Работа с Mininet из-под Windows&lt;/h3>
&lt;h4 id="варианты-xserver">&lt;span class="section-num">1.6.1&lt;/span> Варианты Xserver&lt;/h4>
&lt;ul>
&lt;li>Использовать можно любой вариант Xserver.&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>VcXsrv Windows X Server&lt;/p>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://sourceforge.net/projects/vcxsrv/" target="_blank" rel="noopener">https://sourceforge.net/projects/vcxsrv/&lt;/a>&lt;/li>
&lt;li>Лицензия: GPLv3.&lt;/li>
&lt;li>Компиляция: Visual C++ 2012 Express Edition&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Xming X Server&lt;/p>
&lt;ul>
&lt;li>Сайт: &lt;a href="http://www.straightrunning.com/XmingNotes/" target="_blank" rel="noopener">http://www.straightrunning.com/XmingNotes/&lt;/a>&lt;/li>
&lt;li>Лицензия:
&lt;ul>
&lt;li>&lt;em>Public Domain Release&lt;/em>: MIT&lt;/li>
&lt;li>&lt;em>Website Release&lt;/em>: за загрузку новых выпусков необходимо вносить плату; приобретение лицензии дает пользователю доступ к новым загрузкам в течение одного года.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Компиляция: MinGW, Pthreads-Win32.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="установка-программного-обеспечения">&lt;span class="section-num">1.6.2&lt;/span> Установка программного обеспечения&lt;/h4>
&lt;ul>
&lt;li>Установите &lt;code>putty&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">choco install putty
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установите VcXsrv Windows X Server
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">choco install vcxsrv
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="запуск-xserver">&lt;span class="section-num">1.6.3&lt;/span> Запуск Xserver&lt;/h4>
&lt;ul>
&lt;li>Запустите &lt;code>XLaunch&lt;/code>.&lt;/li>
&lt;li>Выберите опции:
&lt;ul>
&lt;li>&lt;em>Multiple windows&lt;/em>;&lt;/li>
&lt;li>&lt;em>Display number&lt;/em>: -1;&lt;/li>
&lt;li>&lt;em>Start no client&lt;/em>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Можно сохранить параметры, тогда при следующем запуске не нужно будет отмечать эти опции.&lt;/li>
&lt;/ul>
&lt;h4 id="запуск-putty">&lt;span class="section-num">1.6.4&lt;/span> Запуск putty&lt;/h4>
&lt;ul>
&lt;li>При подключении добавьте опцию перенаправления X11:
&lt;ul>
&lt;li>Connection, SSH, X11 : &lt;em>Enable X11 forwarding&lt;/em>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="обновление-версии-mininet">&lt;span class="section-num">2&lt;/span> Обновление версии &lt;em>Mininet&lt;/em>&lt;/h2>
&lt;h3 id="настройка-доступа-к-интернету">&lt;span class="section-num">2.1&lt;/span> Настройка доступа к интернету&lt;/h3>
&lt;ul>
&lt;li>Добавьте в настройках Virualbox интерфейс &lt;em>NAT&lt;/em>.&lt;/li>
&lt;li>Загрузите виртуальную машину.&lt;/li>
&lt;li>Залогиньтесь в виртуальной машине:
&lt;ul>
&lt;li>login: mininet&lt;/li>
&lt;li>password: mininet&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Посмотрите адрес машины:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ifconfig
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Должен быть активным адрес NAT: &lt;code>10.0.0.x&lt;/code>.&lt;/li>
&lt;li>Если вместо этого активен внутренний адрес машины вида &lt;code>192.168.x.y&lt;/code>, то активируйте второй интерфейс наберите:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo dhclient eth1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ifconfig
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="обновление-версии-mininet">&lt;span class="section-num">2.2&lt;/span> Обновление версии &lt;em>Mininet&lt;/em>&lt;/h3>
&lt;ul>
&lt;li>Переименуйте предыдущую установку &lt;em>Mininet&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mv ~/mininet ~/mininet.orig
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Скачайте новую версию &lt;em>Mininet&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ~
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/mininet/mininet.git
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обновите исполняемые файлы:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ~/mininet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo make install
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="основы-работы-в-mininet">&lt;span class="section-num">3&lt;/span> Основы работы в &lt;em>Mininet&lt;/em>&lt;/h2>
&lt;h3 id="работа-с-mininet-с-помощью-командной-строки">&lt;span class="section-num">3.1&lt;/span> Работа с Mininet с помощью командной строки&lt;/h3>
&lt;h4 id="вызов-mininet-с-использованием-топологии-по-умолчанию">&lt;span class="section-num">3.1.1&lt;/span> Вызов Mininet с использованием топологии по умолчанию&lt;/h4>
&lt;ul>
&lt;li>Чтобы запустить минимальную топологию, введите команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo mn
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Эта команда запускает Mininet с минимальной топологией, состоящей из коммутатора, подключенного к двум хостам.&lt;/li>
&lt;li>Чтобы отобразить список команд интерфейса командной строки Mininet и примеры их использования, введите команду в интерфейсе командной строки Mininet:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">help&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы отобразить доступные узлы, введите команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nodes
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Вывод этой команды показывает, что есть два хоста (хост &lt;code>h1&lt;/code> и хост &lt;code>h2&lt;/code>) и коммутатор (&lt;code>s1&lt;/code>).&lt;/li>
&lt;li>Иногда бывает полезно отобразить связи между устройствами в Mininet, чтобы понять топологию. Введите команду &lt;code>net&lt;/code> в интерфейсе командной строки Mininet, чтобы просмотреть доступные линки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">net
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Вывод этой команды показывает:
&lt;ul>
&lt;li>Хост &lt;code>h1&lt;/code> подключён через свой сетевой интерфейс &lt;code>h1-eth0&lt;/code> к коммутатору на интерфейсе &lt;code>s1-eth1&lt;/code>.&lt;/li>
&lt;li>Хост &lt;code>h2&lt;/code> подключён через свой сетевой интерфейс &lt;code>h2-eth0&lt;/code> к коммутатору на интерфейсе &lt;code>s1-eth2&lt;/code>.&lt;/li>
&lt;li>Коммутатор &lt;code>s1&lt;/code>:
&lt;ul>
&lt;li>имеет петлевой интерфейс &lt;code>lo&lt;/code>.&lt;/li>
&lt;li>подключается к &lt;code>h1-eth0&lt;/code> через интерфейс &lt;code>s1-eth1&lt;/code>.&lt;/li>
&lt;li>подключается к &lt;code>h2-eth0&lt;/code> через интерфейс &lt;code>s1-eth2&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Mininet позволяет выполнять команды на конкретном устройстве. Чтобы выполнить команду для определенного узла, необходимо сначала указать устройство, а затем команду, например:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">h1 ifconfig
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Эта команда выполняет команду &lt;code>ifconfig&lt;/code> на хосте &lt;code>h1&lt;/code>. Команда показывает интерфейсы хоста &lt;code>h1&lt;/code>. Показано, что хост &lt;code>h1&lt;/code> имеет интерфейс &lt;code>h1-eth0&lt;/code>, настроенный с IP-адресом &lt;code>10.0.0.1&lt;/code>, и другой интерфейс &lt;code>lo&lt;/code>, настроенный с IP-адресом &lt;code>127.0.0.1&lt;/code>.&lt;/li>
&lt;li>Посмотрите конфигурацию всех узлов.&lt;/li>
&lt;/ul>
&lt;h4 id="проверка-связности">&lt;span class="section-num">3.1.2&lt;/span> Проверка связности&lt;/h4>
&lt;ul>
&lt;li>По умолчанию назначаются IP-адреса &lt;code>10.0.0.1/8&lt;/code> и &lt;code>10.0.0.2/8&lt;/code> узлам &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code> соответственно. Чтобы проверить связь между ними, вы можете использовать команду &lt;code>ping&lt;/code>. Команда &lt;code>ping&lt;/code> работает, отправляя сообщения эхо-запроса протокола управляющих сообщений Интернета (ICMP) на удаленный компьютер и ожидая ответа.&lt;/li>
&lt;li>Введите
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">h1 ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Эта команда проверяет соединение между хостами &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>. Чтобы остановить тест, нажмите &lt;code>Ctrl+c&lt;/code>.&lt;/li>
&lt;li>Остановите эмуляцию, набрав:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Заметим, что команда &lt;code>sudo mn -c&lt;/code> часто используется в терминале для очистки предыдущего экземпляра Mininet (например, после сбоя).&lt;/li>
&lt;/ul>
&lt;h3 id="построение-и-эмуляция-сети-в-mininet-с-использованием-графического-интерфейса">&lt;span class="section-num">3.2&lt;/span> Построение и эмуляция сети в Mininet с использованием графического интерфейса&lt;/h3>
&lt;h4 id="построение-топологии-сети">&lt;span class="section-num">3.2.1&lt;/span> Построение топологии сети&lt;/h4>
&lt;ul>
&lt;li>Запустите &lt;em>MiniEdit&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo ~/mininet/mininet/examples/miniedit.py
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Основные кнопки:
&lt;ul>
&lt;li>&lt;code>Select&lt;/code>: позволяет выбирать/перемещать устройства. Нажатие &lt;code>Del&lt;/code> на клавиатуре после выбора устройства удаляет его из топологии.&lt;/li>
&lt;li>&lt;code>Host&lt;/code>: позволяет добавить новый хост в топологию. После нажатия этой кнопки щелкните в любом месте пустого холста, чтобы вставить новый хост.&lt;/li>
&lt;li>&lt;code>Switch&lt;/code>: позволяет добавить в топологию новый коммутатор. После нажатия этой кнопки щелкните в любом месте пустого холста, чтобы вставить переключатель.&lt;/li>
&lt;li>&lt;code>Link&lt;/code>: соединяет устройства в топологии. После нажатия этой кнопки щелкните устройство и перетащите его на второе устройство, с которым необходимо установить связь.&lt;/li>
&lt;li>&lt;code>Run&lt;/code>: запускает эмуляцию. После проектирования и настройки топологии нажмите кнопку запуска.&lt;/li>
&lt;li>&lt;code>Stop&lt;/code>: останавливает эмуляцию.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Добавьте два хоста и один коммутатор.&lt;/li>
&lt;li>Настройте IP-адреса на хостах &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>. IP-адрес хоста &lt;code>h1&lt;/code> &amp;mdash; &lt;code>10.0.0.1/8&lt;/code>, а IP-адрес хоста &lt;code>h2&lt;/code> &amp;mdash; &lt;code>10.0.0.2/8&lt;/code>. Хост можно настроить, удерживая правую кнопку мыши и выбирая свойства на устройстве.&lt;/li>
&lt;/ul>
&lt;h4 id="проверка-связности">&lt;span class="section-num">3.2.2&lt;/span> Проверка связности&lt;/h4>
&lt;ul>
&lt;li>Перед проверкой соединения между хостом &lt;code>h1&lt;/code> и хостом &lt;code>h2&lt;/code> необходимо запустить эмуляцию.&lt;/li>
&lt;li>Нажмите кнопку &lt;em>Run&lt;/em>, чтобы запустить эмуляцию. Начнётся эмуляция, и кнопки панели MiniEdit станут серыми, указывая на то, что в настоящее время они отключены.&lt;/li>
&lt;li>Откройте терминал на хосте &lt;code>h1&lt;/code>, удерживая правую кнопку мыши на хосте &lt;code>h1&lt;/code> и выбрав &lt;em>Terminal&lt;/em>. Это открывает терминал на хосте &lt;code>h1&lt;/code> и позволяет выполнять команды на хосте &lt;code>h1&lt;/code>.&lt;/li>
&lt;li>Повторите процедуру на хосте &lt;code>h2&lt;/code>.&lt;/li>
&lt;li>На терминале хоста &lt;code>h1&lt;/code> введите команду &lt;code>ifconfig&lt;/code>, чтобы отобразить назначенные ему IP-адреса. Интерфейс &lt;code>h1-eth0&lt;/code> на хосте &lt;code>h1&lt;/code> должен быть настроен с IP-адресом &lt;code>10.0.0.1&lt;/code> и маской подсети &lt;code>255.0.0.0&lt;/code>.&lt;/li>
&lt;li>Повторите эти действия на хосте &lt;code>h2&lt;/code>. Его интерфейс &lt;code>h2-eth0&lt;/code> должен быть настроен с IP-адресом &lt;code>10.0.0.2&lt;/code> и маской подсети &lt;code>255.0.0.0&lt;/code>.&lt;/li>
&lt;li>На терминале хоста &lt;code>h1&lt;/code> введите команду &lt;code>ping 10.0.0.2&lt;/code>. Эта команда проверяет соединение между хостом &lt;code>h1&lt;/code> и хостом &lt;code>h2&lt;/code>.&lt;/li>
&lt;li>Чтобы остановить тест, нажмите &lt;code>Ctrl+c&lt;/code>.&lt;/li>
&lt;li>Остановите эмуляцию, нажав кнопку &lt;em>Stop&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h4 id="автоматическое-назначение-ip-адресов">&lt;span class="section-num">3.2.3&lt;/span> Автоматическое назначение IP-адресов&lt;/h4>
&lt;ul>
&lt;li>Ранее мы вручную назначили IP-адреса узлам &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>.&lt;/li>
&lt;li>В качестве альтернативы можно полагаться на Mininet для автоматического назначения IP-адресов.&lt;/li>
&lt;li>Удалите назначенный вручную IP-адрес с хостов &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>.&lt;/li>
&lt;li>Нажмите кнопку Edit &amp;gt; Preferences. Базовые значения IP-адресов по умолчанию &amp;mdash; &lt;code>10.0.0.0/8&lt;/code>. Измените это значение на &lt;code>15.0.0.0/8&lt;/code>.&lt;/li>
&lt;li>Запустите эмуляцию ещё раз, нажав кнопку &lt;em>Run&lt;/em>. Начнётся эмуляция, и кнопки панели MiniEdit будут отключены.&lt;/li>
&lt;li>Откройте терминал на хосте &lt;code>h1&lt;/code>, удерживая правую кнопку мыши на хосте &lt;code>h1&lt;/code> и выбрав &lt;em>Terminal&lt;/em>.&lt;/li>
&lt;li>Введите команду (чтобы отобразить IP-адреса, назначенные хосту &lt;code>h1&lt;/code>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ifconfig
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Интерфейс &lt;code>h1-eth0&lt;/code> на узле &lt;code>h1&lt;/code> теперь имеет IP-адрес &lt;code>15.0.0.1&lt;/code> и маску подсети &lt;code>255.0.0.0&lt;/code>.&lt;/li>
&lt;li>Вы также можете проверить IP-адрес, назначенный хосту &lt;code>h2&lt;/code>. Соответствующий интерфейс &lt;code>h2-eth0&lt;/code> на хосте &lt;code>h2&lt;/code> должен иметь IP-адрес &lt;code>15.0.0.2&lt;/code> и маску подсети &lt;code>255.0.0.0&lt;/code>.&lt;/li>
&lt;li>Остановите эмуляцию, нажав кнопку &lt;em>Stop&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h4 id="сохранение-и-загрузка-топологии-mininet">&lt;span class="section-num">3.2.4&lt;/span> Сохранение и загрузка топологии Mininet&lt;/h4>
&lt;ul>
&lt;li>Часто бывает полезно сохранить топологию сети, особенно когда ее сложность возрастает. MiniEdit позволяет сохранить топологию в файл.&lt;/li>
&lt;li>Чтобы сохранить топологию, нажмите &lt;em>File&lt;/em>, затем &lt;em>Save&lt;/em>. Укажите имя для топологии и сохраните на своем компьютере.&lt;/li>
&lt;li>Сохраняйте в папку &lt;code>~/work&lt;/code>. Для это предварительно создайте её:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir ~/work
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После сохранения поменяйте права доступа к файлам в этой папке:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo chown -R mininet:mininet ~/work
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для загрузки топологии нажмите &lt;em>File&lt;/em>, затем &lt;em>Open&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h2 id="видео">&lt;span class="section-num">4&lt;/span> Видео&lt;/h2>
&lt;h3 id="youtube">&lt;span class="section-num">4.1&lt;/span> Youtube&lt;/h3>
&lt;h4 id="виртуальная-машина-mininet">&lt;span class="section-num">4.1.1&lt;/span> Виртуальная машина &lt;em>Mininet&lt;/em>&lt;/h4>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/ZjA4bjiO_DM?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h4 id="работа-с-mininet-из-под-windows">&lt;span class="section-num">4.1.2&lt;/span> Работа с &lt;em>Mininet&lt;/em> из-под Windows&lt;/h4>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/KPQMokxQ4Gw?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h4 id="основы-работы-в-mininet">&lt;span class="section-num">4.1.3&lt;/span> Основы работы в &lt;em>Mininet&lt;/em>&lt;/h4>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/0CT45dLWwJg?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h4 id="сохранение-топологии-mininet">&lt;span class="section-num">4.1.4&lt;/span> Сохранение топологии &lt;em>Mininet&lt;/em>&lt;/h4>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/nllxRRUbWhg?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h4 id="обновление-версии-mininet">&lt;span class="section-num">4.1.5&lt;/span> Обновление версии &lt;em>Mininet&lt;/em>&lt;/h4>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/Au193oRjZhI?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h3 id="rutube">&lt;span class="section-num">4.2&lt;/span> Rutube&lt;/h3>
&lt;h4 id="виртуальная-машина-mininet">&lt;span class="section-num">4.2.1&lt;/span> Виртуальная машина &lt;em>Mininet&lt;/em>&lt;/h4>
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/3afa7009a47f1f5d44d53e282d0d5fe4"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;h4 id="работа-с-mininet-из-под-windows">&lt;span class="section-num">4.2.2&lt;/span> Работа с &lt;em>Mininet&lt;/em> из-под Windows&lt;/h4>
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/c98ef1bb6b01c1e463854464e20cd1f3"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;h4 id="основы-работы-в-mininet">&lt;span class="section-num">4.2.3&lt;/span> Основы работы в &lt;em>Mininet&lt;/em>&lt;/h4>
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/562ef53b91af0f61bc9de32986589d40"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;h4 id="сохранение-топологии-mininet">&lt;span class="section-num">4.2.4&lt;/span> Сохранение топологии &lt;em>Mininet&lt;/em>&lt;/h4>
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/dc30dc91ca8a64bb41cea98ad6902037"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;h4 id="обновление-версии-mininet">&lt;span class="section-num">4.2.5&lt;/span> Обновление версии &lt;em>Mininet&lt;/em>&lt;/h4>
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/9e94e56ff5967c0bce0952a738b9761c"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div></description></item><item><title>Mininet. Введение в Iperf</title><link>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-iperf-intro/</link><pubDate>Thu, 29 Sep 2022 21:11:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-iperf-intro/</guid><description>&lt;p>Введение в Iperf.&lt;/p>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;h3 id="цели">&lt;span class="section-num">1.1&lt;/span> Цели&lt;/h3>
&lt;ul>
&lt;li>Освоить основные приёмы работы с генератором трафика &lt;code>iperf3&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="задачи">&lt;span class="section-num">1.2&lt;/span> Задачи&lt;/h3>
&lt;ul>
&lt;li>Подготовить лабораторный стенд.&lt;/li>
&lt;li>В процессе интерактивного эксперимента изучить основные опции и шаблоны использования генератора трафика &lt;code>iperf3&lt;/code>.&lt;/li>
&lt;li>Построить графики по данным интерактивного эксперимента.&lt;/li>
&lt;li>В процессе воспроизводимого эксперимента получить представление о создании скриптов эксперимента.&lt;/li>
&lt;li>Построить графики по данным воспроизводимого эксперимента.&lt;/li>
&lt;/ul>
&lt;h3 id="основные-термины">&lt;span class="section-num">1.3&lt;/span> Основные термины&lt;/h3>
&lt;ul>
&lt;li>Полоса пропускания (Bandwidth) &amp;mdash; это физическое свойство среды передачи, которое зависит от таких факторов, как конструкция и длина провода или волокна.
&lt;ul>
&lt;li>Для сетевых инженеров пропускная способность &amp;mdash; это максимальная скорость передачи данных канала, величина, измеряемая в битах в секунду (бит/с)&lt;/li>
&lt;li>На производительность могут влиять несколько факторов, таких как задержка, потеря пакетов, джиттер и другие.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Пропускная способность (throughput) &amp;mdash; это скорость в битах в секунду, с которой процесс-отправитель может доставлять биты процессу-получателю (при связи между двумя конечными устройствами).
&lt;ul>
&lt;li>Поскольку другие сеансы будут совместно использовать полосу пропускания по сетевому пути и поскольку эти другие сеансы будут повторяться, доступная пропускная способность может колебаться со временем&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Иногда термины &lt;em>пропускная способность&lt;/em> (throughput) и &lt;em>полоса пропускания&lt;/em> (bandwidth) используются взаимозаменяемо.&lt;/li>
&lt;/ul>
&lt;h3 id="iperf3">&lt;span class="section-num">1.4&lt;/span> Iperf3&lt;/h3>
&lt;ul>
&lt;li>&lt;em>iPerf3&lt;/em> &amp;mdash; это инструмент для измерения пропускной способности сети в режиме реального времени.&lt;/li>
&lt;li>Сайт: &lt;a href="https://iperf.fr/" target="_blank" rel="noopener">https://iperf.fr/&lt;/a>.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/esnet/iperf" target="_blank" rel="noopener">https://github.com/esnet/iperf&lt;/a>.&lt;/li>
&lt;li>Лицензия: 3-пунктовая лицензия BSD.&lt;/li>
&lt;li>iPerf3 может работать с протоколами TCP, UDP и SCTP:
&lt;ul>
&lt;li>TCP и SCTP:
&lt;ul>
&lt;li>измерение пропускной способности;&lt;/li>
&lt;li>размер MSS/MTU;&lt;/li>
&lt;li>поддержка размера окна TCP.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>UDP:
&lt;ul>
&lt;li>клиент может создавать потоки UDP с заданной пропускной способностью;&lt;/li>
&lt;li>измерение потери пакетов;&lt;/li>
&lt;li>измерение джиттера задержки;&lt;/li>
&lt;li>поддержка групповой рассылки (multicast).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="графики-по-iperf3">&lt;span class="section-num">1.5&lt;/span> Графики по iperf3&lt;/h3>
&lt;ul>
&lt;li>Для построения графиков по iperf3 будем использовать пакет &lt;code>iperf3_plotter&lt;/code>.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/ekfoury/iperf3_plotter" target="_blank" rel="noopener">https://github.com/ekfoury/iperf3_plotter&lt;/a>.&lt;/li>
&lt;li>Скрипты:
&lt;ul>
&lt;li>&lt;code>preprocessor.sh&lt;/code>: преобразует файл JSON iPerf3 в файл значений, разделённых запятыми (CSV). Использует AWK для форматирования полей.&lt;/li>
&lt;li>&lt;code>plot_iperf.sh&lt;/code>: принимает JSON-файл iPerf3, вызывает препроцессор и вызывает gnuplot для создания выходных PDF-файлов.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="видео-введение-в-iperf-dot-введение">&lt;span class="section-num">1.6&lt;/span> Видео: Введение в Iperf. Введение&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-dabecf" data-toggle="tab" href="#dabecf"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-cbfead" data-toggle="tab" href="#cbfead"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="dabecf" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/123f83616546c2612cc7acb9a123efae"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="cbfead" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/wXVasAqXlZU?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="подготовка-стенда">&lt;span class="section-num">2&lt;/span> Подготовка стенда&lt;/h2>
&lt;h3 id="лабораторная-топология">&lt;span class="section-num">2.1&lt;/span> Лабораторная топология&lt;/h3>
&lt;ul>
&lt;li>В топологии используется сеть 10.0.0.0/8, назначенная Mininet по умолчанию.&lt;/li>
&lt;li>Топология представляет собой коммутатор с двумя подключёнными к нему хостами.&lt;/li>
&lt;li>Для запуска топологии используем параметры командной строки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo mn --topo&lt;span class="o">=&lt;/span>single,2 -x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Посмотрите топологию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mininet&amp;gt; net
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mininet&amp;gt; links
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mininet&amp;gt; dump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="рабочие-файлы">&lt;span class="section-num">2.2&lt;/span> Рабочие файлы&lt;/h3>
&lt;ul>
&lt;li>Подключимся к виртуальной машине:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -Y mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для рабочих файлов будем использовать каталог &lt;code>~/work/lab_iperf3&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_iperf3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="установка-необходимого-программного-обеспечения">&lt;span class="section-num">2.3&lt;/span> Установка необходимого программного обеспечения&lt;/h3>
&lt;h4 id="конфигурация-интерфейсов-виртуальной-машины">&lt;span class="section-num">2.3.1&lt;/span> Конфигурация интерфейсов виртуальной машины&lt;/h4>
&lt;ul>
&lt;li>Добавьте к виртуальной машине интерфейс NAT.&lt;/li>
&lt;li>Загрузите виртуальную машину и войдите в учётную запись &lt;code>mininet&lt;/code> (пароль &lt;code>mininet&lt;/code>).&lt;/li>
&lt;li>Добавьте в файл &lt;code>/etc/netplan/01-netcfg.yaml&lt;/code> второй интерфейс.&lt;/li>
&lt;li>В результате файл примет следующий вид:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">network&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">renderer&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">networkd&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ethernets&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">eth0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">dhcp4&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">yes&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">eth1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">dhcp4&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">yes&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перезагрузите виртуальную машину.&lt;/li>
&lt;/ul>
&lt;h4 id="установка-iperf3">&lt;span class="section-num">2.3.2&lt;/span> Установка iperf3&lt;/h4>
&lt;ul>
&lt;li>По умолчанию стоит генератор трафика &lt;em>iperf2&lt;/em> (команда &lt;code>iperf&lt;/code>).&lt;/li>
&lt;li>Установим &lt;em>iperf3&lt;/em>.&lt;/li>
&lt;li>Загрузите виртуальную машину и войдите в учётную запись &lt;code>mininet&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -Y mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обновим список пакетов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt-get update
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установите iperf3:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt-get install iperf3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="установка-скриптов-для-визуализации-результатов">&lt;span class="section-num">2.3.3&lt;/span> Установка скриптов для визуализации результатов&lt;/h4>
&lt;ul>
&lt;li>Для функционирования скриптов необходимы следующие пакеты:
&lt;ul>
&lt;li>gnuplot;&lt;/li>
&lt;li>jq;&lt;/li>
&lt;li>awk.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="установка-iperf3-plotter-на-виртуальную-машину">&lt;span class="section-num">2.3.4&lt;/span> Установка &lt;code>iperf3_plotter&lt;/code> на виртуальную машину&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Зайдём на виртуальную машину:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -Y mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Обновим репозитории программного обеспечения на виртуальной машине:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt-get update
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Установим необходимое программное обеспечение на виртуальную машину:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt-get install git jq gnuplot-nox mc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Скачаем &lt;code>iperf3_plotter&lt;/code>. Для этого перейдём во временную рабочую папку и скачаем репозиторий:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/ekfoury/iperf3_plotter.git
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Установим &lt;code>iperf3_plotter&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /tmp/iperf3_plotter
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo cp plot_* /usr/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo cp *.sh /usr/bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Скрипты написаны плохо, не работают с путями, имеющими в названии пробелы.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="установка-iperf3-plotter-на-локальный-компьютер">&lt;span class="section-num">2.3.5&lt;/span> Установка &lt;code>iperf3_plotter&lt;/code> на локальный компьютер&lt;/h4>
&lt;ul>
&lt;li>Установим &lt;code>iperf3_plotter&lt;/code> (на своём компьютере). Для этого перейдём во временную рабочую папку и скачаем репозиторий:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git clone https://github.com/ekfoury/iperf3_plotter.git
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Заменим жёстко закодированные пути в файлах:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> iperf3_plotter
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sed -i -e &lt;span class="s2">&amp;#34;s:/usr/bin:~/.local/bin:g&amp;#34;&lt;/span> plot_iperf.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Скопируем нужные файлы в каталог с локальными исполняемыми файлами:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp plot_* ~/.local/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp *.sh ~/.local/bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Скрипты написаны плохо, не работают с путями, имеющими в названии пробелы.&lt;/li>
&lt;/ul>
&lt;h3 id="видео-введение-в-iperf-dot-подготовка-стенда">&lt;span class="section-num">2.4&lt;/span> Видео: Введение в Iperf. Подготовка стенда&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-fedbca" data-toggle="tab" href="#fedbca"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-cabefd" data-toggle="tab" href="#cabefd"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="fedbca" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/78670543a6ed84d93571031fb2a5c247"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="cabefd" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/HkBk44OZv3c?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="интерактивный-эксперимент">&lt;span class="section-num">3&lt;/span> Интерактивный эксперимент&lt;/h2>
&lt;h3 id="параметры-команды-iperf3">&lt;span class="section-num">3.1&lt;/span> Параметры команды iperf3&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Пользователь взаимодействует с iPerf3 с помощью команды &lt;code>iperf3&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Основной синтаксис &lt;code>iperf3&lt;/code>, используемый как на клиенте, так и на сервере, выглядит следующим образом:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 &lt;span class="o">[&lt;/span>-s&lt;span class="p">|&lt;/span>-c&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span> options &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>-s&lt;/code>: запуск сервера;&lt;/li>
&lt;li>&lt;code>-c&lt;/code>: запуск клиента.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="запуск-клиента-и-сервера">&lt;span class="section-num">3.2&lt;/span> Запуск клиента и сервера&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Запустим &lt;code>mininet&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo mn --topo&lt;span class="o">=&lt;/span>single,2 -x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>В терминале &lt;code>h2&lt;/code> запустите сервер:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Теперь сервер прослушивает порт 5201 в ожидании входящих подключений.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>В терминале &lt;code>h1&lt;/code> запустите клиента:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Параметр &lt;code>-c&lt;/code> указывает, что хост &lt;code>h1&lt;/code> настроен как клиент.&lt;/li>
&lt;li>Параметр &lt;code>10.0.0.2&lt;/code> &amp;mdash; это IP-адрес сервера (хост &lt;code>h2&lt;/code>).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>После завершения теста отображается сводный отчет как на клиенте, так и на сервере, содержащий следующие данные:&lt;/p>
&lt;ul>
&lt;li>&lt;code>ID&lt;/code>: идентификационный номер соединения.&lt;/li>
&lt;li>Интервал (Interval): временной интервал для периодических отчетов о пропускной способности. По умолчанию временной интервал равен 1 секунде.&lt;/li>
&lt;li>Передача (Transfer): сколько данных было передано за каждый интервал времени.&lt;/li>
&lt;li>Пропускная способность (Bitrate): измеренная пропускная способность в каждом временном интервале.&lt;/li>
&lt;li>Retr: количество повторно переданных TCP-сегментов за каждый временной интервал. Это поле увеличивается, когда TCP-сегменты теряются в сети из-за перегрузки или повреждения.&lt;/li>
&lt;li>Cwnd: указывает размер окна перегрузки в каждом временном интервале. TCP использует эту переменную для ограничения объема данных, которые клиент TCP может отправить до получения подтверждения отправленных данных.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Пользователь также может видеть результаты пропускной способности на стороне сервера.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Суммарные данные на сервере аналогичны данным на стороне клиента и должны интерпретироваться таким же образом.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="запуск-клиента-и-сервера-в-интерфейсе-mininet">&lt;span class="section-num">3.3&lt;/span> Запуск клиента и сервера в интерфейсе mininet&lt;/h3>
&lt;ul>
&lt;li>Тоже самое можно выполнить и интерфейсе &lt;em>mininet&lt;/em>&lt;/li>
&lt;li>Запустите сервер на хосте &lt;code>h2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mininet&amp;gt; h2 iperf3 -s &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите клиента на хосте &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mininet&amp;gt; h1 iperf3 -c h2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Остановите серверный процесс:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mininet&amp;gt; h2 killall iperf3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="установка-периода-времени-передачи">&lt;span class="section-num">3.4&lt;/span> Установка периода времени передачи&lt;/h3>
&lt;ul>
&lt;li>В терминале &lt;code>h2&lt;/code> запустите сервер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В терминале &lt;code>h1&lt;/code> запустите клиента с параметром &lt;code>-t&lt;/code>, за которым следует количество секунд:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2 -t &lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="установка-временного-интервала">&lt;span class="section-num">3.5&lt;/span> Установка временного интервала&lt;/h3>
&lt;ul>
&lt;li>Настроим клиент для выполнения теста пропускной способности с 2-секундным интервалом времени отсчёта как на клиенте, так и на сервере.&lt;/li>
&lt;li>Опция &lt;code>-i&lt;/code> позволяет установить интервал между отсчётами в секундах.&lt;/li>
&lt;li>В этом случае значение должно быть установлено на 2 секунды как на клиенте, так и на сервере.&lt;/li>
&lt;li>Параметр &lt;code>-i&lt;/code> может быть указан по-разному на клиенте и сервере.&lt;/li>
&lt;li>В терминале &lt;code>h2&lt;/code> запустите сервер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s -i &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В терминале &lt;code>h1&lt;/code> запустите клиента с параметром &lt;code>-i&lt;/code>, за которым следует количество секунд:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2 -i &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="изменение-количества-байтов-для-передачи">&lt;span class="section-num">3.6&lt;/span> Изменение количества байтов для передачи&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Зададим на клиенте отправку определённого объёма данных путём установки количества байтов для передачи.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>По умолчанию &lt;em>iPerf3&lt;/em> выполняет измерение пропускной способности в течение 10 секунд.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Однако при задании количества данных клиент будет продолжать отправлять пакеты до тех пор, пока не будут отправлены все байты, указанные пользователем.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>В терминале &lt;code>h2&lt;/code> запустите сервер:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>В терминале &lt;code>h1&lt;/code> запустите клиента, задав объём данных:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2 -n 16G
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Параметр &lt;code>-n&lt;/code> указывает объем данных для передачи: 16 Гбайт.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="определение-протокола-транспортного-уровня">&lt;span class="section-num">3.7&lt;/span> Определение протокола транспортного уровня&lt;/h3>
&lt;ul>
&lt;li>По умолчанию измерения пропускной способности проводятся по протоколу TCP, который является протоколом конфигурации по умолчанию.&lt;/li>
&lt;li>Чтобы изменить протокол на UDP, нужно задать опцию &lt;code>-u&lt;/code> на стороне клиента.&lt;/li>
&lt;li>Для протокола SCTP используется опция &lt;code>--sctp&lt;/code>.&lt;/li>
&lt;li>iPerf3 автоматически определяет протокол транспортного уровня на стороне сервера.&lt;/li>
&lt;li>В терминале &lt;code>h2&lt;/code> запустите сервер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В терминале &lt;code>h1&lt;/code> запустите клиента, задав протокол UDP:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2 -u
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/li>
&lt;li>После завершения теста он покажет следующие сводные данные:
&lt;ul>
&lt;li>ID, интервал, передача, битрейт: то же, что и у TCP.&lt;/li>
&lt;li>Джиттер (Jitter): разница в задержке пакетов.&lt;/li>
&lt;li>Lost/Total: указывает количество потерянных дейтаграмм по сравнению с общим количеством отправленных на сервер (и процентное соотношение).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="изменение-номера-порта">&lt;span class="section-num">3.8&lt;/span> Изменение номера порта&lt;/h3>
&lt;ul>
&lt;li>Если нужно измерить пропускную способность определённого порта, используется параметр &lt;code>-p&lt;/code> для настройки клиента и сервера для отправки/получения пакетов или датаграмм через указанный порт.&lt;/li>
&lt;li>В терминале &lt;code>h2&lt;/code> запустите сервер, используя параметр &lt;code>-p&lt;/code>, чтобы указать порт прослушивания:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s -p &lt;span class="m">3250&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В терминале &lt;code>h1&lt;/code> запустите клиента, указав порт:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2 -p &lt;span class="m">3250&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="работа-с-одним-клиентом">&lt;span class="section-num">3.9&lt;/span> Работа с одним клиентом&lt;/h3>
&lt;ul>
&lt;li>По умолчанию сервер iPerf3 продолжает прослушивать входящие соединения.&lt;/li>
&lt;li>Чтобы сервер мог обрабатывать одного клиента, а затем останавливаться, к серверу добавляется параметр &lt;code>-1&lt;/code>.&lt;/li>
&lt;li>В терминале &lt;code>h2&lt;/code> запустите сервер, используя параметр &lt;code>-1&lt;/code>, чтобы принять только одного клиента:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s -1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В терминале &lt;code>h1&lt;/code> запустите клиента, указав порт:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После завершения этого теста сервер немедленно останавливается.&lt;/li>
&lt;/ul>
&lt;h3 id="экспорт-результатов-в-файл-json">&lt;span class="section-num">3.10&lt;/span> Экспорт результатов в файл JSON&lt;/h3>
&lt;ul>
&lt;li>JSON (JavaScript Object Notation, нотация объектов JavaScript) &amp;mdash; это облегченный формат обмена данными.&lt;/li>
&lt;li>&lt;em>iPerf3&lt;/em> позволяет экспортировать результаты теста в файл JSON, что позволяет другим приложениям легко анализировать файл и интерпретировать результаты.&lt;/li>
&lt;li>В терминале &lt;code>h2&lt;/code> запустите сервер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В терминале &lt;code>h1&lt;/code> запустите клиента, указав параметр &lt;code>-J&lt;/code> для отображения вывода в формате JSON:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2 -J
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Параметр &lt;code>-J&lt;/code> выводит текст JSON на экран через стандартный вывод (&lt;code>stdout&lt;/code>) после завершения теста.&lt;/li>
&lt;li>Чтобы экспортировать вывод в файл нужно перенаправить стандартный вывод в файл:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2 -J &amp;gt; /home/mininet/work/lab_iperf3/iperf_results.json
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown mininet:mininet /home/mininet/work/lab_iperf3/iperf_results.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После создания файла JSON команда &lt;code>ls&lt;/code> используется для проверки того, что файл создан.&lt;/li>
&lt;li>Команда &lt;code>cat&lt;/code> может использоваться для отображения содержимого файла.&lt;/li>
&lt;li>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="график-результатов-iperf3">&lt;span class="section-num">3.11&lt;/span> График результатов iPerf3&lt;/h3>
&lt;ul>
&lt;li>Визуализируем результаты эксперимента.&lt;/li>
&lt;li>Скопируйте файл &lt;code>iperf3_results.json&lt;/code> с виртуальной машины к себе, в рабочий каталог.&lt;/li>
&lt;li>Обращайте внимание, чтобы путь к файлу не содержал пробелов.&lt;/li>
&lt;li>Чтобы сгенерировать выходные данные для файла JSON iPerf3, выполните следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">plot_iperf.sh iperf3_results.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Этот сценарий создаёт графики для следующих полей:
&lt;ul>
&lt;li>окно перегрузки (&lt;code>cwnd.pdf&lt;/code>),&lt;/li>
&lt;li>повторная передача (&lt;code>retransmits.pdf&lt;/code>),&lt;/li>
&lt;li>время приема-передачи (&lt;code>RTT.pdf&lt;/code>),&lt;/li>
&lt;li>отклонение времени приема-передачи (&lt;code>RTT_Var.pdf&lt;/code>),&lt;/li>
&lt;li>пропускная способность (&lt;code>throughput.pdf&lt;/code>),&lt;/li>
&lt;li>максимальная единица передачи (&lt;code>MTU.pdf&lt;/code>),&lt;/li>
&lt;li>количество переданных байтов (&lt;code>bytes.pdf&lt;/code>).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Сценарий построения также создаёт файл CSV (&lt;code>1.dat&lt;/code>), который может использоваться другими приложениями.&lt;/li>
&lt;li>Эти файлы хранятся в каталоге результатов, созданном в том же каталоге, где был выполнен скрипт.&lt;/li>
&lt;/ul>
&lt;h3 id="видео-введение-в-iperf-dot-интерактивный-эксперимент">&lt;span class="section-num">3.12&lt;/span> Видео: Введение в Iperf. Интерактивный эксперимент&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-cedbfa" data-toggle="tab" href="#cedbfa"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-bfeacd" data-toggle="tab" href="#bfeacd"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="cedbfa" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/70f04b82548c7ba4a03a38fce65fbcb4"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="bfeacd" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/REcUWuT8g8E?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="воспроизводимый-эксперимент">&lt;span class="section-num">4&lt;/span> Воспроизводимый эксперимент&lt;/h2>
&lt;h3 id="api-mininet">&lt;span class="section-num">4.1&lt;/span> API Mininet&lt;/h3>
&lt;ul>
&lt;li>API Mininet построен на трех основных уровнях:
&lt;ul>
&lt;li>&lt;em>Низкоуровневый API&lt;/em>. Низкоуровневый API состоит из базовых узлов и классов ссылок (таких как &lt;code>Host&lt;/code>, &lt;code>Switch&lt;/code>, &lt;code>Link&lt;/code> и их подклассы), которые на самом деле могут быть созданы по отдельности и использоваться для создания сети, но это немного громоздко.&lt;/li>
&lt;li>&lt;em>API среднего уровня&lt;/em>. API среднего уровня добавляет объект Mininet, который служит контейнером для узлов и ссылок. Он предоставляет ряд методов (&lt;code>addHost()&lt;/code>, &lt;code>addSwitch()&lt;/code>, &lt;code>addLink()&lt;/code>) для добавления узлов и ссылок в сеть, а также настройки сети, запуска и завершения работы (&lt;code>start()&lt;/code>, &lt;code>stop()&lt;/code>).&lt;/li>
&lt;li>&lt;em>Высокоуровневый API&lt;/em>. Высокоуровневый API добавляет абстракцию шаблона топологии (класс &lt;code>Topo&lt;/code>), который предоставляет возможность создавать повторно используемые параметризованные шаблоны топологии. Эти шаблоны можно передать команде mn (через параметр &amp;ndash;custom) и использовать из командной строки.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Когда напрямую управляют узлами и коммутаторами, используется низкоуровневый API.&lt;/li>
&lt;li>Когда запускают или останавливают сеть, используют API среднего уровня (в частности, класс &lt;code>Mininet&lt;/code>).&lt;/li>
&lt;li>Полные сети могут быть созданы с использованием любого из уровней API, но обычно выбирают либо API среднего уровня (например, &lt;code>Mininet.add*()&lt;/code>), либо API высокого уровня (&lt;code>Topo. add*()&lt;/code>) для создания сетей.&lt;/li>
&lt;/ul>
&lt;h3 id="примеры-создания-сетей-с-использованием-уровней-api-mininet">&lt;span class="section-num">4.2&lt;/span> Примеры создания сетей с использованием уровней API Mininet&lt;/h3>
&lt;ul>
&lt;li>Низкоуровневый API. Узлы и ссылки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">h1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Host&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">h2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Host&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h2&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">OVSSwitch&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;s1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">inNamespace&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">c0&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Controller&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;c0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">inNamespace&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Link&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Link&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setIP&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;10.1/8&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">h2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setIP&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;10.2/8&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">c0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="n">c0&lt;/span> &lt;span class="p">]&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;ping -c1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">c0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>API среднего уровня. Сетевой объект:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Mininet&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">h1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">h2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h2&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addSwitch&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;s1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">c0&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addController&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;c0&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;ping -c1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">CLI&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">net&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>API высокого уровня. Шаблоны топологии:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">SingleSwitchTopo&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">Topo&lt;/span> &lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Single Switch Topology&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">build&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">hosts&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h&lt;/span>&lt;span class="si">%d&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">range&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">count&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addSwitch&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;s1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">h&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">hosts&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Mininet&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">topo&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">SingleSwitchTopo&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">CLI&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">net&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>API среднего уровня на самом деле является самым простым и лаконичным для этого примера, поскольку не требует создания класса топологии.&lt;/li>
&lt;li>API низкого и среднего уровня являются гибкими и мощными, но могут быть менее удобными для повторного использования по сравнению с высокоуровневым API &lt;code>Topo&lt;/code> и шаблонами топологии.&lt;/li>
&lt;/ul>
&lt;h3 id="простейшая-топология">&lt;span class="section-num">4.3&lt;/span> Простейшая топология&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>На основе скрипта &lt;code>mininet/examples/emptynet.py&lt;/code> создадим простейшую топологию &lt;code>lab_iperf3_topo&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/env python&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Simple topology
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.net&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Mininet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.node&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Controller&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.cli&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">CLI&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.log&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">setLogLevel&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">emptyNet&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Create an empty network and add nodes to it.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Mininet&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">controller&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Controller&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">waitConnected&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding controller&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addController&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;c0&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding hosts&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.0.1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h2&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.0.2&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding switch&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addSwitch&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;s1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Creating links&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Starting network&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Running CLI&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CLI&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">net&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Stopping network&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setLogLevel&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;info&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">emptyNet&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Основные элементы:&lt;/p>
&lt;ul>
&lt;li>&lt;code>addSwitch()&lt;/code>: добавляет коммутатор в топологию и возвращает имя коммутатора;&lt;/li>
&lt;li>&lt;code>ddHost()&lt;/code>: добавляет хост в топологию и возвращает имя хоста;&lt;/li>
&lt;li>&lt;code>addLink()&lt;/code>: добавляет двунаправленную ссылку в топологию (и возвращает ключ ссылки, но это не важно). Ссылки в Mininet являются двунаправленными, если не указано иное.&lt;/li>
&lt;li>&lt;code>Mininet&lt;/code>: основной класс для создания и управления сетью;&lt;/li>
&lt;li>&lt;code>start()&lt;/code>: запускает вашу сеть;&lt;/li>
&lt;li>&lt;code>pingAll()&lt;/code>: проверяет подключение, пытаясь заставить все узлы пинговать друг друга;&lt;/li>
&lt;li>&lt;code>stop()&lt;/code>: останавливает вашу сеть;&lt;/li>
&lt;li>&lt;code>net.hosts&lt;/code>: все хосты в сети;&lt;/li>
&lt;li>&lt;code>dumpNodeConnections()&lt;/code>: сбрасывает подключения к/от набора узлов;&lt;/li>
&lt;li>&lt;code>setLogLevel( 'info' | 'debug' | 'output' )&lt;/code>: установить уровень вывода Mininet по умолчанию; рекомендуется &lt;code>info&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Создадим в лабораторной работе подкаталог для данного эксперимента:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_iperf3/iperf3_topo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Скопируем скрипт на виртуальную машину в каталог лабораторной и запустим:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo python lab_iperf3_topo.py
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>После запуска можно посмотреть элементы топологии:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mininet&amp;gt; net
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mininet&amp;gt; links
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mininet&amp;gt; dump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="методы-настройки-хоста">&lt;span class="section-num">4.4&lt;/span> Методы настройки хоста&lt;/h3>
&lt;ul>
&lt;li>Хосты Mininet предоставляют ряд удобных методов настройки сети:
&lt;ul>
&lt;li>&lt;code>IP()&lt;/code>: возвращает IP-адрес хоста или определенного интерфейса;&lt;/li>
&lt;li>&lt;code>MAC()&lt;/code>: возвращает MAC-адрес хоста или определенного интерфейса;&lt;/li>
&lt;li>&lt;code>setARP()&lt;/code>: добавить статическую запись ARP в кэш ARP хоста;&lt;/li>
&lt;li>&lt;code>setIP()&lt;/code>: установить IP-адрес для хоста или определенного интерфейса;&lt;/li>
&lt;li>&lt;code>setMAC()&lt;/code>: установить MAC-адрес для хоста или определенного интерфейса.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Пример использования в скрипте:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s2">&amp;#34;Host&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;has IP address&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="s2">&amp;#34;and MAC address&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">MAC&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Задание: Попробуйте изменить приведённый выше код, чтобы он печатал IP-адрес и MAC-адрес каждого хоста.&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-параметров-производительности">&lt;span class="section-num">4.5&lt;/span> Настройка параметров производительности&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Mininet предоставляет функции ограничения производительности и изоляции с помощью классов &lt;code>CPULimitedHost&lt;/code> и &lt;code>TCLink&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.node&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">CPULimitedHost&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.link&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">TCLink&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Mininet&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">controller&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Controller&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">CPULimitedHost&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">link&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">TCLink&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Основные функции:&lt;/p>
&lt;ul>
&lt;li>&lt;code>self.addHost(name, cpu=f)&lt;/code>: позволяет указать долю общих ресурсов процессора системы, которая будет выделена виртуальному хосту;&lt;/li>
&lt;li>&lt;code>self.addLink(node1, node2, bw=10, delay='5ms', max_queue_size=1000, loss=10, use_htb=True)&lt;/code>: добавляет двунаправленный канал с характеристиками пропускной способности, задержки и потерь:
&lt;ul>
&lt;li>максимальный размер очереди 1000 пакетов;&lt;/li>
&lt;li>использование ограничителя скорости &lt;em>Hierarchical Token Bucket&lt;/em>;&lt;/li>
&lt;li>эмулятор задержки/потери &lt;code>netem&lt;/code>;&lt;/li>
&lt;li>параметр &lt;code>bw&lt;/code> выражается числом в Мбит;&lt;/li>
&lt;li>задержка выражается в виде строки с заданными единицами измерения (например, &lt;code>5ms&lt;/code>, &lt;code>100us&lt;/code>, &lt;code>1s&lt;/code>);&lt;/li>
&lt;li>потери выражаются в процентах (от 0 до 100);&lt;/li>
&lt;li>&lt;code>max_queue_size&lt;/code> выражается в пакетах.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Задание: Измените приведённый выше код, чтобы каналы были 100 Мбит/с с задержкой 75 мс. Рассчитать производительность связи между &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="полный-эксперимент">&lt;span class="section-num">4.6&lt;/span> Полный эксперимент&lt;/h3>
&lt;ul>
&lt;li>Сгенерируем трафик и сохраним результат в файл json.&lt;/li>
&lt;li>Зададим скрипт &lt;code>lab_iperf3.py&lt;/code> для полного эксперимента:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/env python&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Simple experiment.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Output: iperf_result.json
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.net&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Mininet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.node&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Controller&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.cli&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">CLI&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.log&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">setLogLevel&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.link&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">TCLink&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">emptyNet&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Create an empty network and add nodes to it.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Mininet&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">controller&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Controller&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">waitConnected&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">link&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">TCLink&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding controller&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addController&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;c0&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding hosts&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.0.1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h2&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.0.2&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding switch&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addSwitch&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;s1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Creating links&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">cls&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">TCLink&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bw&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">delay&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;75ms&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">cls&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">TCLink&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bw&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">delay&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;75ms&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Starting network&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Traffic generation&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmdPrint&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;iperf3 -s -D -1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># Wait 10 seconds for servers to start&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmdPrint&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;iperf3 -c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="s1">&amp;#39;-J &amp;gt; iperf_result.json&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Stopping network&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setLogLevel&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;info&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">emptyNet&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим в лабораторной работе подкаталог для данного эксперимента:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_iperf3/iperf3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите скрипт на виртуальной машине:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo python lab_iperf3.py
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Постройм графики из получившегося файла json:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">plot_iperf.sh iperf_result.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим &lt;code>Makefile&lt;/code> для проведения всего эксперимента:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">all&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">iperf_result&lt;/span>.&lt;span class="n">json&lt;/span> &lt;span class="n">plot&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">iperf_result.json&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo python lab_iperf3.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">plot&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">iperf_result&lt;/span>.&lt;span class="n">json&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> plot_iperf.sh iperf_result.json
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">clean&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -rm -f *.json *.csv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -rm -rf results
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="видео-введение-в-iperf-dot-воспроизводимый-эксперимент">&lt;span class="section-num">4.7&lt;/span> Видео: Введение в Iperf. Воспроизводимый эксперимент&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-fedcba" data-toggle="tab" href="#fedcba"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-abfced" data-toggle="tab" href="#abfced"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="fedcba" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/c54df490dcdaba3f0e78ab078148a519"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="abfced" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/wpPDMyZbcGU?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>GNS3. Образ VyOS</title><link>https://yamadharma.github.io/ru/course/nettech/gns3-vyos/</link><pubDate>Thu, 14 Jul 2022 12:56:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/nettech/gns3-vyos/</guid><description>&lt;p>Установка образа VyOS в GNS3.&lt;/p>
&lt;h2 id="цели">&lt;span class="section-num">1&lt;/span> Цели&lt;/h2>
&lt;ul>
&lt;li>Установить образ VyOS.&lt;/li>
&lt;li>Сделать первоначальную настройку.&lt;/li>
&lt;li>Заменить системного пользователя.&lt;/li>
&lt;/ul>
&lt;h2 id="общая-информация">&lt;span class="section-num">2&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/06/03/routing-vyos/">Маршрутизация. VyOS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/07/06/vyos-build/">Сборка образа VyOS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/07/16/vyos-build-repository/">Сборка образа VyOS. Репозиторий&lt;/a>&lt;/li>
&lt;li>Сайты:
&lt;ul>
&lt;li>Сайт: &lt;a href="https://vyos.net/" target="_blank" rel="noopener">https://vyos.net/&lt;/a>.&lt;/li>
&lt;li>Снепшоты: &lt;a href="https://vyos.net/get/nightly-builds/" target="_blank" rel="noopener">https://vyos.net/get/nightly-builds/&lt;/a>.&lt;/li>
&lt;li>Документация: &lt;a href="https://docs.vyos.io/" target="_blank" rel="noopener">https://docs.vyos.io/&lt;/a>.&lt;/li>
&lt;li>Документация по установке на GNS3: &lt;a href="https://docs.vyos.io/en/equuleus/installation/virtual/gns3.html" target="_blank" rel="noopener">https://docs.vyos.io/en/equuleus/installation/virtual/gns3.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Форк проекта &lt;em>Vyatta&lt;/em>.&lt;/li>
&lt;li>Реализовано на основе дистрибутива Debian.&lt;/li>
&lt;li>Система команд похожа на Juniper.&lt;/li>
&lt;/ul>
&lt;h3 id="модель-распространения">&lt;span class="section-num">2.1&lt;/span> Модель распространения&lt;/h3>
&lt;ul>
&lt;li>Можно собрать самому из исходного кода.&lt;/li>
&lt;li>Образы LTS можно скачивать за плату.
&lt;ul>
&lt;li>Для учебных заведений и некоммерческих организаций предоставляется бесплатный доступ к релизам.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Образы для rolling релизов можно скачивать бесплатно.&lt;/li>
&lt;li>Rolling релизы:
&lt;ul>
&lt;li>&lt;a href="https://vyos.net/get/?dir=rolling/current/amd64" target="_blank" rel="noopener">https://vyos.net/get/?dir=rolling/current/amd64&lt;/a>;&lt;/li>
&lt;li>&lt;a href="https://community.vyos.net/get/" target="_blank" rel="noopener">https://community.vyos.net/get/&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Блокируются российский ip-адреса.&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-образа">&lt;span class="section-num">3&lt;/span> Настройка образа&lt;/h2>
&lt;h3 id="установка-образа">&lt;span class="section-num">3.1&lt;/span> Установка образа&lt;/h3>
&lt;ul>
&lt;li>После загрузки установите систему на диск:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos:~$ install image
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="режим-конфигурации">&lt;span class="section-num">3.2&lt;/span> Режим конфигурации&lt;/h3>
&lt;ul>
&lt;li>В рабочем режиме в командной строке отображается символ &lt;code>$&lt;/code>.&lt;/li>
&lt;li>В режиме конфигурации в командной строке отображается &lt;code>#&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@vyos#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="сохранение">&lt;span class="section-num">3.3&lt;/span> Сохранение&lt;/h3>
&lt;ul>
&lt;li>Посмотреть, какие изменения внесены:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos# compare
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После каждого изменения конфигурации необходимо применить изменения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos# commit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В конце нужно сохранить конфигурацию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="имя-устройства">&lt;span class="section-num">3.4&lt;/span> Имя устройства&lt;/h3>
&lt;ul>
&lt;li>Имя хоста может содержать до 63 символов. Имя хоста должно начинаться и заканчиваться буквой или цифрой и содержать в качестве внутренних символов только буквы, цифры или дефис:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> system host-name &amp;lt;hostname&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>По умолчанию используется имя хоста &lt;em>vyos&lt;/em>.&lt;/li>
&lt;li>Доменное имя должно начинаться и заканчиваться буквой или цифрой и содержать в качестве внутренних символов только буквы, цифры или дефис:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> system domain-name &amp;lt;domain&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="конфигурация-интерфейсов">&lt;span class="section-num">3.5&lt;/span> Конфигурация интерфейсов&lt;/h3>
&lt;ul>
&lt;li>Интерфейс &lt;code>eth0&lt;/code>. Использует статический IP-адрес &lt;code>192.168.0.1/24&lt;/code>.&lt;/li>
&lt;li>После перехода в режим конфигурации введём следующие команды:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> interfaces ethernet eth0 address &lt;span class="s1">&amp;#39;192.168.0.1/24&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="замена-системного-пользователя">&lt;span class="section-num">3.6&lt;/span> Замена системного пользователя&lt;/h3>
&lt;ul>
&lt;li>Заменим системного пользователя по умолчанию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> system login user &amp;lt;myvyosuser&amp;gt; authentication plaintext-password &amp;lt;mysecurepassword&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Отлогинимся:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Залогинимся под новым пользователем.&lt;/li>
&lt;li>Удалим исходного пользователя &lt;code>vyos&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">delete system login user vyos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Зафиксируем изменения, сохраним конфигурацию и выйдем из режима конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># commit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># save&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="видео-установка-образа-vyos-в-gns3">&lt;span class="section-num">4&lt;/span> Видео: Установка образа VyOS в GNS3&lt;/h2>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-ecadbf" data-toggle="tab" href="#ecadbf"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-acefbd" data-toggle="tab" href="#acefbd"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="ecadbf" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/e2f3acf0d9b794446eb60983f10b3b1b"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="acefbd" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/ovSxPP4XYT0?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="видео-установка-образа-vyos-в-gns3-на-hyper-v">&lt;span class="section-num">5&lt;/span> Видео: Установка образа VyOS в GNS3 на Hyper-V&lt;/h2>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-aefbdc" data-toggle="tab" href="#aefbdc"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-efabdc" data-toggle="tab" href="#efabdc"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="aefbdc" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/bafa69237a51444f0d54b2c8af811900"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="efabdc" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/OAckxG6LYtc?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Mininet. Использование netem (latency, jitter)</title><link>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-netem-i/</link><pubDate>Sat, 08 Oct 2022 21:33:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-netem-i/</guid><description>&lt;p>Mininet. Использование netem. Задержки, джтиттер.&lt;/p>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>В этом лабораторном занятии вы познакомитесь с NETEM и объясните, как его можно использовать для имитации сценариев реального мира, при этом контролируя параметры, влияющие на производительность сетей.&lt;/li>
&lt;li>Сетевые параметры включают задержку, дрожание, потерю пакетов, изменение порядка и повреждение (latency, jitter, packet loss, reordering, and corruption).&lt;/li>
&lt;li>Значения корреляции между сетевыми параметрами также будут установлены для обеспечения большей реалистичности сетевой среды.&lt;/li>
&lt;/ul>
&lt;h3 id="цели">&lt;span class="section-num">1.1&lt;/span> Цели&lt;/h3>
&lt;ul>
&lt;li>Освоить моделирование задержек и джиттера в сетях.&lt;/li>
&lt;/ul>
&lt;h3 id="задачи">&lt;span class="section-num">1.2&lt;/span> Задачи&lt;/h3>
&lt;ul>
&lt;li>В ходе работы требуется освоить следующие понятия:
&lt;ul>
&lt;li>что есть задержка в сетях и как ее измерить;&lt;/li>
&lt;li>что есть архитектура дисциплин очередей Linux (qdisc);&lt;/li>
&lt;li>освоить эмуляцию глобальных сети (характеризующихся большими задержками) с использованием netem и mininet;&lt;/li>
&lt;li>выполнить измерения после внесения задержек в эмулируемую глобальную сеть;&lt;/li>
&lt;li>развернуть эмулированные глобальные сети, характеризующиеся разными значениями задержки, джиттера и соответствующими значениями корреляции;&lt;/li>
&lt;li>задать разные распределения задержки эмулируемой глобальной сети.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="видео-использование-netem-i-dot-введение">&lt;span class="section-num">1.3&lt;/span> Видео: Использование netem I. Введение&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-cdafeb" data-toggle="tab" href="#cdafeb"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-fedabc" data-toggle="tab" href="#fedabc"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="cdafeb" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/f252186b156e3f19ea7a982411bfbd62"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="fedabc" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/aeiuFANn5oY?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="теоретические-сведения">&lt;span class="section-num">2&lt;/span> Теоретические сведения&lt;/h2>
&lt;h3 id="дисциплины-организации-очередей-в-linux">&lt;span class="section-num">2.1&lt;/span> Дисциплины организации очередей в Linux&lt;/h3>
&lt;ul>
&lt;li>NETEM &amp;mdash; сетевой эмулятор Linux для тестирования производительности реальных приложений в виртуальной сети.&lt;/li>
&lt;li>Виртуальная сеть может воспроизводить глобальные сети в лабораторной среде.&lt;/li>
&lt;li>NETEM позволяет пользователю изменять такие параметры, как задержка, джиттер, потеря пакетов, дублирование и изменение порядка пакетов.&lt;/li>
&lt;li>NETEM реализован в Linux и состоит из двух частей: модуля ядра для организации очередей и утилиты командной строки для его настройки.&lt;/li>
&lt;li>Между протоколом IP и сетевым устройством создаётся очередь с дисциплиной обслуживания.&lt;/li>
&lt;li>Дисциплина обслуживания очередей по умолчанию есть простая очередь пакетов FIFO (первым пришел &amp;mdash; первым обслужен).&lt;/li>
&lt;li>Дисциплина реализуется как объект с двумя интерфейсами.&lt;/li>
&lt;li>Один интерфейс ставит пакеты в очередь для отправки, а другой интерфейс отправляет пакеты на сетевое устройство.&lt;/li>
&lt;li>На основе дисциплины обслуживания очередей принимается решение о том, какие пакеты отправлять, какие пакеты задерживать и какие пакеты отбрасывать.&lt;/li>
&lt;li>Классовая дисциплина организации очередей, такая как NETEM, имеет настраиваемые внутренние модули.&lt;/li>
&lt;/ul>
&lt;h3 id="глобальные-сети-и-задержка">&lt;span class="section-num">2.2&lt;/span> Глобальные сети и задержка&lt;/h3>
&lt;ul>
&lt;li>В сетях есть несколько процессов и устройств, которые способствуют сквозной задержке между узлом-отправителем и узлом-получателем.&lt;/li>
&lt;li>Во многих случаях сквозная задержка определяется задержкой распространения в глобальной сети.&lt;/li>
&lt;li>Рассмотрим два соседних коммутатора A и B, соединённых глобальной сетью.
&lt;ul>
&lt;li>Как только бит передается в глобальную сеть коммутатором А, он должен пройти к коммутатору В.&lt;/li>
&lt;li>Время, необходимое для распространения от начала глобальной сети до коммутатора В, является задержкой распространения.&lt;/li>
&lt;li>Биты распространяются со скоростью канала.&lt;/li>
&lt;li>Скорость распространения зависит от физической среды (оптоволокно, медная витая пара и т. д.) и равно или немного меньше скорости света.&lt;/li>
&lt;li>Задержка распространения есть расстояние между двумя коммутатора, делённое на скорость распространения.&lt;/li>
&lt;li>Как только последний бит пакета передается на коммутатор B, он и все предыдущие биты пакета сохраняются на коммутаторе B.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Сетевые инструменты обычно оценивают задержку для устранения неполадок и измерения производительности.&lt;/li>
&lt;li>Например, оценкой сквозной задержки является время двойного оборота (RTT), которое представляет собой время, необходимое пакету для прохождения от отправителя к получателю, а затем обратно к отправителю.&lt;/li>
&lt;li>RTT включает задержки распространения пакетов, задержки в очереди пакетов в промежуточных маршрутизаторах и коммутаторах и обработку пакетов.&lt;/li>
&lt;li>Если задержка распространения преобладает над другими компонентами задержки (как в случае глобальных сетей), то RTT является хорошей оценкой задержки распространения.&lt;/li>
&lt;/ul>
&lt;h2 id="подготовка-стенда">&lt;span class="section-num">3&lt;/span> Подготовка стенда&lt;/h2>
&lt;h3 id="лабораторная-топология">&lt;span class="section-num">3.1&lt;/span> Лабораторная топология&lt;/h3>
&lt;ul>
&lt;li>В топологии используется сеть 10.0.0.0/8, назначенная Mininet по умолчанию.&lt;/li>
&lt;li>Топология представляет собой коммутатор с двумя подключёнными к нему хостами.&lt;/li>
&lt;li>Для запуска топологии используем параметры командной строки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo mn --topo&lt;span class="o">=&lt;/span>single,2 -x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="рабочие-файлы">&lt;span class="section-num">3.2&lt;/span> Рабочие файлы&lt;/h3>
&lt;ul>
&lt;li>Подключимся к виртуальной машине:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -Y mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для рабочих файлов будем использовать каталог &lt;code>~/work/lab_netem_i&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_netem_i
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="интерактивный-эксперимент">&lt;span class="section-num">4&lt;/span> Интерактивный эксперимент&lt;/h2>
&lt;h3 id="добавление-изменение-задержки-для-эмуляции-wan">&lt;span class="section-num">4.1&lt;/span> Добавление/изменение задержки для эмуляции WAN&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Работа с NETEM осуществляется с помощью утилиты командной строки &lt;code>tc&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Без дополнительных параметров NETEM ведёт себя как базовая очередь FIFO без задержек, потерь, дублирования или переупорядочения пакетов.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Основной синтаксис &lt;code>tc&lt;/code>, используемый с NETEM, следующий:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc &lt;span class="o">[&lt;/span>add&lt;span class="p">|&lt;/span>del&lt;span class="p">|&lt;/span>replace&lt;span class="p">|&lt;/span>change&lt;span class="p">|&lt;/span>show&lt;span class="o">]&lt;/span> dev dev_id root netem opts
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>sudo&lt;/code>: выполнить команду с более высокими привилегиями;&lt;/li>
&lt;li>&lt;code>tc&lt;/code>: команда, используемая для взаимодействия с NETEM;&lt;/li>
&lt;li>&lt;code>qdisc&lt;/code>: дисциплина очереди (&lt;code>qdisc&lt;/code>) представляет собой набор правил, определяющих порядок, в котором обслуживаются пакеты, поступающие по протоколу IP.
&lt;ul>
&lt;li>Дисциплина очереди применяется к очереди пакетов, чтобы решить, когда отправлять каждый пакет.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>[add|del|replace|change|show]&lt;/code> (добавить, удалить, заменить, изменить, показать): операция над &lt;code>qdisc&lt;/code>:
&lt;ul>
&lt;li>чтобы добавить задержку на определённом интерфейсе, применяется операция &lt;code>add&lt;/code>;&lt;/li>
&lt;li>чтобы изменить или удалить задержку на определённом интерфейсе, применяется операция &lt;code>change&lt;/code> или &lt;code>del&lt;/code>;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>dev_id&lt;/code>: параметр указывает интерфейс, подлежащий эмуляции;&lt;/li>
&lt;li>&lt;code>opts&lt;/code>: параметр указывает величину задержки, потери пакетов, дублирования, повреждения и другие.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="определение-интерфейсов-хостов-h1-и-h2">&lt;span class="section-num">4.2&lt;/span> Определение интерфейсов хостов &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>Необходимо идентифицировать интерфейсы на подключенных хостах.&lt;/li>
&lt;li>На хосте &lt;code>h1&lt;/code> введите команду &lt;code>ifconfig&lt;/code>, чтобы отобразить информацию, относящуюся к его сетевым интерфейсам и назначенным им IP-адресам.
&lt;ul>
&lt;li>Вывод команды &lt;code>ifconfig&lt;/code> показывает, что хост &lt;code>h1&lt;/code> имеет два интерфейса: &lt;code>h1-eth0&lt;/code> и &lt;code>lo&lt;/code>.&lt;/li>
&lt;li>Интерфейс &lt;code>h1-eth0&lt;/code> необходимо использовать в &lt;code>tc&lt;/code> при эмуляции WAN.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>На хосте &lt;code>h2&lt;/code> введите команду &lt;code>ifconfig&lt;/code>.&lt;/li>
&lt;li>Вывод команды &lt;code>ifconfig&lt;/code> показывает, что хост &lt;code>h2&lt;/code> имеет два интерфейса: &lt;code>h2-eth0&lt;/code> и &lt;code>lo&lt;/code>.&lt;/li>
&lt;li>Интерфейс &lt;code>h2-eth0&lt;/code> необходимо использовать в &lt;code>tc&lt;/code> при эмуляции WAN.&lt;/li>
&lt;/ul>
&lt;h3 id="добавка-задержки-для-интерфейса-подключающегося-к-wan">&lt;span class="section-num">4.3&lt;/span> Добавка задержки для интерфейса, подключающегося к WAN&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Сетевые эмуляторы задают задержки на интерфейсе.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Например, задержка, вносимая в интерфейс коммутатора A, который подключён к интерфейсу коммутатора B, может представлять собой задержку распространения WAN, соединяющей оба коммутатора.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>На хосте &lt;code>h1&lt;/code> введите следующую команду:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc add dev h1-eth0 root netem delay 100ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>sudo&lt;/code>: выполнить команду с более высокими привилегиями;&lt;/li>
&lt;li>&lt;code>tc&lt;/code>: вызвать управление трафиком Linux;&lt;/li>
&lt;li>&lt;code>qdisc&lt;/code>: изменить дисциплину очередей сетевого планировщика;&lt;/li>
&lt;li>&lt;code>add&lt;/code>: создать новое правило;&lt;/li>
&lt;li>&lt;code>dev h1-eth0&lt;/code>: указать интерфейс, на котором будет применяться правило;&lt;/li>
&lt;li>&lt;code>netem&lt;/code>: использовать эмулятор сети;&lt;/li>
&lt;li>&lt;code>delay 100ms&lt;/code>: задержка ввода 100 мс.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Эта команда добавляет задержку в 100 миллисекунд (мс) только к выходному интерфейсу.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Теперь пользователь может проверить, что соединение от хоста h1 к хосту h2 имеет задержку 100 миллисекунд, используя команду &lt;code>ping&lt;/code> с хоста &lt;code>h1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Все пакеты были получены успешно (0% потерь пакетов).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Задание: Запишите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи (RTT).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Этот сценарий эмулирует задержку в 100 миллисекунд на интерфейсе узла &lt;code>h1&lt;/code>, подключающегося к коммутатору.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Чтобы эмулировать глобальную сеть с двунаправленной задержкой, к соответствующему интерфейсу на хосте &lt;code>h2&lt;/code> также необходимо добавить задержку в 100 миллисекунд.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>В терминале хоста &lt;code>h2&lt;/code> введите следующую команду:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc add dev h2-eth0 root netem delay 100ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Проверим, что соединение между хостом &lt;code>h1&lt;/code> и хостом &lt;code>h2&lt;/code> имеет &lt;code>RTT&lt;/code> 200 миллисекунд (100 мс от хоста &lt;code>h1&lt;/code> к хосту &lt;code>h2&lt;/code> плюс 100 мс от хоста &lt;code>h2&lt;/code> к хосту &lt;code>h1&lt;/code>), повторив команду &lt;code>ping&lt;/code> на терминале хоста &lt;code>h1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Все пакеты были получены успешно (0% потерь пакетов).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Задание: Запишите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи (RTT).&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="изменение-задержки-в-эмулируемой-глобальной-сети">&lt;span class="section-num">4.4&lt;/span> Изменение задержки в эмулируемой глобальной сети&lt;/h3>
&lt;ul>
&lt;li>Изменим задержку со 100 миллисекунд до 50 миллисекунд как для отправителя, так и для получателя. RTT теперь будет 100 миллисекунд.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc change dev h1-eth0 root netem delay 50ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Здесь добавлен новый параметр &lt;code>change&lt;/code>, который изменяет ранее установленную задержку на 50 миллисекунд.&lt;/li>
&lt;li>Применим также описанный выше шаг к терминалу хоста &lt;code>h2&lt;/code>, чтобы изменить задержку на 50 мс:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc change dev h2-eth0 root netem delay 50ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Теперь можно проверить, что соединение от хоста &lt;code>h1&lt;/code> к хосту &lt;code>h2&lt;/code> имеет задержку 100 миллисекунд, используя команду &lt;code>ping&lt;/code> с терминала хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Все пакеты были получены успешно (0% потерь пакетов).&lt;/li>
&lt;li>Задание: Запишите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи (RTT).&lt;/li>
&lt;/ul>
&lt;h3 id="восстановление-исходных-значений--удаление-правил">&lt;span class="section-num">4.5&lt;/span> Восстановление исходных значений (удаление правил)&lt;/h3>
&lt;ul>
&lt;li>Восстановим конфигурацию по умолчанию как для отправителя, так и для получателя, удалив все правила, применённые к сетевому планировщику интерфейса.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc del dev h1-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавлена новая опция &lt;code>del&lt;/code>, которая удаляет ранее установленные правила для данного интерфейса.&lt;/li>
&lt;li>В результате &lt;code>tc qdisc&lt;/code> восстановит значения по умолчанию для устройства &lt;code>h1-eth0&lt;/code>.&lt;/li>
&lt;li>Применим те же действия для удаления правил на хосте &lt;code>h2&lt;/code>. В терминале хоста &lt;code>h2&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc del dev h2-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В результате дисциплина организации очереди &lt;code>tc&lt;/code> восстановит свои значения по умолчанию для устройства &lt;code>h2-eth0&lt;/code>.&lt;/li>
&lt;li>Проверим, что соединение между хостом &lt;code>h1&lt;/code> и хостом &lt;code>h2&lt;/code> не имеет явно установленной задержки, используя команду &lt;code>ping&lt;/code> с терминала хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Все пакеты были получены успешно (0% потерь пакетов).&lt;/li>
&lt;li>Задание: Запишите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи (RTT).&lt;/li>
&lt;/ul>
&lt;h3 id="добавление-джиттера-в-интерфейс-подключения-к-wan">&lt;span class="section-num">4.6&lt;/span> Добавление джиттера в интерфейс подключения к WAN&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>В сетях нет постоянной задержки. Задержка может варьироваться в зависимости от других потоков трафика, конкурирующих за тот же путь.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Джиттер &amp;mdash; это изменение времени задержки.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Параметры задержки описываются средним значением (\(\mu\)), стандартным отклонением (\(\sigma\)) и корреляцией.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>По умолчанию NETEM использует &lt;em>равномерное распределение&lt;/em>, так что задержка находится в пределах \(\mu \pm \sigma\).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Добавим задержку в 100 миллисекунд со случайным отклонением 10 миллисекунд.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;em>Прежде чем сделать это, необходимо восстановите конфигурацию интерфейсов по умолчанию на узлах &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>.&lt;/em>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>В терминале хоста &lt;code>h1&lt;/code> введите команду:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc add dev h1-eth0 root netem delay 100ms 10ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Добавленное здесь новое значение представляет джиттер, который определяет вариацию задержки.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Все пакеты, покидающие хост &lt;code>h1&lt;/code> через интерфейс &lt;code>h1-eth0&lt;/code>, будут иметь задержку 100 мс со случайным отклонением ±10 мс.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Можно проверить, что соединение от хоста &lt;code>h1&lt;/code> к хосту &lt;code>h2&lt;/code> имеет задержку 100 мс со случайным отклонением ± 10 мс, с помощью команды &lt;code>ping&lt;/code> на терминале хоста &lt;code>h1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Все пакеты были получены успешно (0% потерь пакетов).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Задание: Запишите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи (RTT).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду, чтобы удалить предыдущие конфигурации:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc del dev h1-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="добавление-значения-корреляции-для-джиттера-и-задержки">&lt;span class="section-num">4.7&lt;/span> Добавление значения корреляции для джиттера и задержки&lt;/h3>
&lt;ul>
&lt;li>Параметр корреляции управляет отношением между последовательными псевдослучайными значениями.&lt;/li>
&lt;li>Добавим задержку в 100 миллисекунд с вариацией ±10 миллисекунд при добавлении значения корреляции.&lt;/li>
&lt;li>&lt;em>Прежде чем сделать это, необходимо восстановите конфигурацию интерфейсов по умолчанию на узлах &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>.&lt;/em>&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc add dev h1-eth0 root netem delay 100ms 10ms 25%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавленное здесь новое значение представляет собой значение корреляции для джиттера и задержки.&lt;/li>
&lt;li>Все пакеты, покидающие узел устройства &lt;code>h1&lt;/code> на интерфейсе &lt;code>h1-eth0&lt;/code>, будут иметь время задержки 100 мс со случайным отклонением ±10 мс, при этом следующий случайный пакет зависит от предыдущего на 25%.&lt;/li>
&lt;li>Можно проверить соединение между хостами &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code> с помощью команды &lt;code>ping&lt;/code> на терминале хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Все пакеты были получены успешно (0% потерь пакетов).&lt;/li>
&lt;li>Задание: Запишите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи (RTT).&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду, чтобы удалить предыдущие конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc del dev h1-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="распределение-задержки">&lt;span class="section-num">4.8&lt;/span> Распределение задержки&lt;/h3>
&lt;ul>
&lt;li>NETEM позволяет пользователю указать распределение, которое описывает, как задержки изменяются в сети.&lt;/li>
&lt;li>Обычно задержки неравномерны, поэтому может быть удобно использовать неравномерное распределение, такое как нормальное, парето или парето-нормальное.&lt;/li>
&lt;li>Можно указать нормальное распределение задержки в эмулируемой сети.&lt;/li>
&lt;li>&lt;em>Прежде чем сделать это, необходимо восстановите конфигурацию интерфейсов по умолчанию на узлах &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>.&lt;/em>&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc add dev h1-eth0 root netem delay 100ms 20ms distribution normal
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавленная здесь новая опция (&lt;code>distribution&lt;/code>) задаёт тип распределения задержки.&lt;/li>
&lt;li>Определим задержку так, чтобы она имела нормальное распределение, что обеспечивает более реалистичную эмуляцию сетей WAN.&lt;/li>
&lt;li>Все пакеты, покидающие хост &lt;code>h1&lt;/code> на интерфейсе &lt;code>h1-eth0&lt;/code>, будут иметь время задержки, которое распределяется в диапазоне 100 мс ± 20 мс.&lt;/li>
&lt;li>Используем команду &lt;code>ping&lt;/code> на терминале хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Все пакеты были получены успешно (0% потерь пакетов).&lt;/li>
&lt;li>Задание: Запишите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи (RTT).&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду, чтобы удалить предыдущие конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc del dev h1-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="видео-использование-netem-i-dot-интерактивный-эксперимент">&lt;span class="section-num">4.9&lt;/span> Видео: Использование netem I. Интерактивный эксперимент&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-adfcbe" data-toggle="tab" href="#adfcbe"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-adecfb" data-toggle="tab" href="#adecfb"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="adfcbe" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/1ea73a09806a25ae20bd3d34ebfb5247"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="adecfb" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/wEuHronSk8M?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="воспроизводимый-эксперимент">&lt;span class="section-num">5&lt;/span> Воспроизводимый эксперимент&lt;/h2>
&lt;h3 id="постановка-задания">&lt;span class="section-num">5.1&lt;/span> Постановка задания&lt;/h3>
&lt;ul>
&lt;li>Будем исследовать задержки и построим графики для них.&lt;/li>
&lt;li>Выполните все интерактивные эксперименты в виде воспроизводимых.&lt;/li>
&lt;li>Для каждого эксперимента &lt;code>expname&lt;/code> создайте свой каталог:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_netem_i/expname
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В него мы будем помещать файлы эксперимента.&lt;/li>
&lt;li>Для каждого эксперимента создайте скрипт для проведения эксперимента &lt;code>lab_netem_i.py&lt;/code> и скрипт для визуализации &lt;code>ping_plot&lt;/code>.&lt;/li>
&lt;li>Кроме визуализации вычислите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи.&lt;/li>
&lt;li>Для примера реализуем задание простейшей задержки.&lt;/li>
&lt;/ul>
&lt;h3 id="добавка-задержки-для-интерфейса-подключающегося-к-wan">&lt;span class="section-num">5.2&lt;/span> Добавка задержки для интерфейса, подключающегося к WAN&lt;/h3>
&lt;ul>
&lt;li>Создадим каталог &lt;code>simple-delay&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_netem_i/simple-delay
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ~/work/lab_netem_i/simple-delay
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим скрипт для эксперимента &lt;code>lab_netem_i.py&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/env python&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Simple experiment.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Output: ping.dat
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.net&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Mininet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.node&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Controller&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.cli&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">CLI&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.log&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">setLogLevel&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">emptyNet&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Create an empty network and add nodes to it.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Mininet&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">controller&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Controller&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">waitConnected&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding controller&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addController&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;c0&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding hosts&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.0.1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h2&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.0.2&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding switch&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addSwitch&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;s1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Creating links&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Starting network&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Set delay&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmdPrint&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;tc qdisc add dev h1-eth0 root netem delay 100ms&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmdPrint&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;tc qdisc add dev h2-eth0 root netem delay 100ms&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># Wait 10 seconds&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Ping&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmdPrint&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;ping -c 100&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="s1">&amp;#39;| grep &amp;#34;time=&amp;#34; | awk &lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1">{print $5, $7}&lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1"> | sed -e &lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1">s/time=//g&lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1"> -e &lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1">s/icmp_seq=//g&lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1"> &amp;gt; ping.dat&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Stopping network&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setLogLevel&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;info&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">emptyNet&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим скрипт для визуализации &lt;code>ping_plot&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/bin/gnuplot --persist
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> terminal png crop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> output &lt;span class="s1">&amp;#39;ping.png&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> xlabel &lt;span class="s2">&amp;#34;Sequence number&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> ylabel &lt;span class="s2">&amp;#34;Delay (ms)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> grid
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">plot &lt;span class="s2">&amp;#34;ping.dat&amp;#34;&lt;/span> with lines
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Зададим права доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chmod +x ping_plot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим &lt;code>Makefile&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">all&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">ping&lt;/span>.&lt;span class="n">dat&lt;/span> &lt;span class="n">ping&lt;/span>.&lt;span class="n">png&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">ping.dat&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo python lab_netem_i.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo chown mininet:mininet ping.dat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">ping.png&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">ping&lt;/span>.&lt;span class="n">dat&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ./ping_plot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">clean&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -rm -f *.dat *.png
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Выполним эксперимент:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">make
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Посмотрите график.&lt;/li>
&lt;li>Вычислите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи.&lt;/li>
&lt;/ul>
&lt;h3 id="видео-использование-netem-i-dot-воспроизводимый-эксперимент">&lt;span class="section-num">5.3&lt;/span> Видео: Использование netem I. Воспроизводимый эксперимент&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-bacdfe" data-toggle="tab" href="#bacdfe"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-badcef" data-toggle="tab" href="#badcef"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="bacdfe" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/a202f653206b1c569bcfe44b5924558a"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="badcef" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/_EBurmbB9DY?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Основы работы в GNS3</title><link>https://yamadharma.github.io/ru/course/nettech/gns3-basics/</link><pubDate>Thu, 30 Jun 2022 11:50:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/nettech/gns3-basics/</guid><description>&lt;p>Основы работы в GNS3.&lt;/p>
&lt;h2 id="видео-основы-работы-в-gns3">&lt;span class="section-num">1&lt;/span> Видео: Основы работы в GNS3&lt;/h2>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-dfabec" data-toggle="tab" href="#dfabec"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-adecbf" data-toggle="tab" href="#adecbf"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="dfabec" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/5c78bd7ddf2e052a29d83426168a5002"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="adecbf" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/Mgdyq0Ns7Bc?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Mininet. Использование netem (потери пакетов)</title><link>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-netem-ii/</link><pubDate>Thu, 13 Oct 2022 14:27:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-netem-ii/</guid><description>&lt;p>Использование netem. Потери пакетов, дублирование пакетов, изменение порядка, повреждение пакетов.&lt;/p>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;h3 id="цели">&lt;span class="section-num">1.1&lt;/span> Цели&lt;/h3>
&lt;ul>
&lt;li>Освоить моделирование следующих параметров сети: потеря пакетов, дублирование пакетов, изменение порядка и повреждение пакетов.&lt;/li>
&lt;/ul>
&lt;h3 id="задачи">&lt;span class="section-num">1.2&lt;/span> Задачи&lt;/h3>
&lt;ul>
&lt;li>В ходе работы требуется освоить следующие умения:
&lt;ul>
&lt;li>эмуляция сети, характеризующихся такими параметрами, как задержка, потеря пакетов, повреждение пакетов, переупорядочивание пакетов и дублирование пакетов;&lt;/li>
&lt;li>измерение производительности глобальных сетей, характеризующихся различными значениями параметров.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="видео-использование-netem-ii-dot-введение">&lt;span class="section-num">1.3&lt;/span> Видео: Использование netem II. Введение&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-cdbfae" data-toggle="tab" href="#cdbfae"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-cdeabf" data-toggle="tab" href="#cdeabf"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="cdbfae" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/dbb8edc601a8941aa093a15303b5391d"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="cdeabf" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/E6yKPh6Vhq4?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="теоретические-сведения">&lt;span class="section-num">2&lt;/span> Теоретические сведения&lt;/h2>
&lt;h3 id="проблемы-с-передачей-пакетов">&lt;span class="section-num">2.1&lt;/span> Проблемы с передачей пакетов&lt;/h3>
&lt;ol>
&lt;li>Потеря пакета
&lt;ul>
&lt;li>Пакет, проходящий через сеть, не достигает пункта назначения.&lt;/li>
&lt;li>Распространённой причиной потери пакетов является неспособность маршрутизаторов удерживать пакеты, поступающие со скоростью, превышающей скорость отправления.&lt;/li>
&lt;li>Маршрутизатор ограничен объёмом буферной памяти, используемой для мгновенного хранения пакетов.&lt;/li>
&lt;li>Когда происходит потеря пакетов, TCP уменьшает окно перегрузки и, следовательно, пропускную способность вдвое.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Переупорядочивание пакетов
&lt;ul>
&lt;li>Пакеты принимаются в порядке, отличном от того, в котором они были отправлены.&lt;/li>
&lt;li>Переупорядочивание пакетов (неупорядоченная доставка пакетов) обычно является результатом того, что пакеты следуют по разным маршрутам для достижения пункта назначения.&lt;/li>
&lt;li>Переупорядочивание пакетов может ухудшить пропускную способность TCP-соединений в сетях с высокой пропускной способностью и высокой задержкой.&lt;/li>
&lt;li>Для каждого сегмента, полученного не по порядку, получатель TCP отправляет подтверждение (ACK) для последнего правильно принятого сегмента.&lt;/li>
&lt;li>Как только отправитель TCP получает три подтверждения для одного и того же сегмента (тройной дубликат ACK), отправитель считает, что получатель неправильно принял пакет, следующий за пакетом, который подтверждается три раза.&lt;/li>
&lt;li>Тогда отправитель уменьшает окно перегрузки и пропускную способность в два раза.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Повреждение пакета
&lt;ul>
&lt;li>Повреждение битов, составляющих пакет.&lt;/li>
&lt;li>Обычно происходит на физическом уровне.&lt;/li>
&lt;li>В случае повреждения некоторые биты могут иметь значения, отличные от первоначально отправленных узлом-отправителем.&lt;/li>
&lt;li>Узел получателя отбрасывает такие пакеты.&lt;/li>
&lt;li>Процесс-отправитель TCP не получит подтверждения для соответствующего сегмента и будет считать его потерянным сегментом.&lt;/li>
&lt;li>Отправитель уменьшает окно перегрузки и пропускную способность в два раза.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Дублирование пакетов
&lt;ul>
&lt;li>Несколько копий пакета присутствуют в сети и принимаются пунктом назначения.&lt;/li>
&lt;li>Дублирование пакетов является результатом повторных передач, когда узел-отправитель повторно передает неподтвержденные (NACK) пакеты.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="подготовка-стенда">&lt;span class="section-num">3&lt;/span> Подготовка стенда&lt;/h2>
&lt;h3 id="лабораторная-топология">&lt;span class="section-num">3.1&lt;/span> Лабораторная топология&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>В топологии используется сеть 10.0.0.0/8, назначенная Mininet по умолчанию.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Топология представляет собой коммутатор с двумя подключёнными к нему хостами.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Для запуска топологии (рис. &lt;a href="#figure--fig:netem-ii:topology">1&lt;/a>) используем параметры командной строки:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo mn --topo&lt;span class="o">=&lt;/span>single,2 -x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a id="figure--fig:netem-ii:topology">&lt;/a>&lt;/p>
&lt;figure>
&lt;?xml version="1.0" encoding="us-ascii" standalone="no"?>&lt;svg
xmlns="http://www.w3.org/2000/svg"
xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css"
height="120px" preserveAspectRatio="none"
style="width:453px;height:120px;background:#FFFFFF;" version="1.1"
viewBox="0 0 453 120" width="453px"
zoomAndPan="magnify">&lt;defs/>&lt;g>&lt;g
id="elem_h1">&lt;polygon fill="#F1F1F1"
points="9.5,7,9.5,7.2102,19.5,6.5857,29.5,7.1933,39.5,7.3997,49.5,6.2866,59.5,6.9223,69.5,7,69.4456,6.8687,69.8046,7.0283,70.1984,7.2719,70.4725,7.2264,70.9848,7.7563,71.2678,7.7322,71.0737,7.6518,71.3533,8.0606,71.6937,8.4944,71.6807,8.782,71.8746,9.1552,72,9.5,71.9681,9.5,72.1785,19.7318,72.2391,29.9635,72.5857,40.1953,72.6711,50.427,72.6793,60.6588,72.2546,70.8905,72.4636,81.1223,72.7022,91.354,71.2788,101.5858,72,111.8175,72.209,111.9041,71.7622,112.1332,71.8715,112.5927,71.4082,112.815,71.3931,113.223,71.2678,113.5853,71.3624,113.8137,70.908,113.7167,70.5741,113.9106,70.2503,114.1289,69.9066,114.2992,69.5,114.3175,69.5,114.3136,59.5,114.6047,49.5,113.7451,39.5,114.6019,29.5,114.8657,19.5,114.762,9.5,114.3175,9.5782,114.5063,9.0848,114.0223,8.7097,113.8238,8.3601,113.6868,8.0783,113.7136,7.7322,113.5853,7.6717,113.5602,7.7956,113.3186,7.3855,112.8559,7.1872,112.4809,7.2167,112.2002,7,111.8175,6.3332,111.8175,6.4809,101.5858,7.649,91.354,7.4357,81.1223,7.7345,70.8905,6.6782,60.6588,7.3192,50.427,7.5904,40.1953,6.5276,29.9635,6.9041,19.7318,7,9.5,7.0388,9.5161,7.3472,9.2296,7.2916,8.7924,7.5818,8.4983,7.4152,8.0151,7.7322,7.7322,7.6458,7.5237,8.15,7.7409,8.3479,7.2186,8.8578,7.4496,9.1728,7.2101,9.5,7"
style="stroke:#181818;stroke-width:0.5;"/>&lt;image height="48"
width="45" x="17"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAwCAIAAAAKMGSIAAABYUlEQVR4Xu2Y7Y3DIAyGu2JGyAgZ4UbICBmBEW4ERugI3eCsvEAxifnwWbqexPMrjfHLE0olmsfrM3iUN/6I4OG937ZtGYe6qJdFqggeOglAvSxSRfAoswdhkSqmB+fGw/eRt7BIFTcerC6jaKlw46GARaqYHpzpwZkenH/lse/7dxWeqaHt4S2OF00aHsdxUJWeuCwYQSvd5VGvmoCvdcBjtwaxzrkxD1wbgtjpEUHs9IggdnpEEDs9IogVPb4y8mrotgOxokc2MiDd/yWIFT0+ZT1y8iquDUHs9IggVvTIRgZwn85mzhTEOsnjmXGtmiN65GBQcjcn/SQbHsu5PBhTp2w76ex99Xgs584o3wZlIOH2jWOcpU2XxxUyo3M2SaQnphUuxqzr+p6nRfBIe7iHYrXpoxM2EB3K04LVCR6j0MTrSTmzDA1Ou/KK0uN2N/Qg7VylB76LUSr/yJUe5vwAo6Ho0KlFbyoAAAAASUVORK5CYII="
y="17"/>&lt;text fill="#000000" font-family="xkcd Script" font-size="14"
lengthAdjust="spacing" textLength="10" x="36.5"
y="80.2429">h1&lt;/text>&lt;text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="39" x="20"
y="99.9017">10.0.0.1&lt;/text>&lt;/g>&lt;g
id="elem_h2">&lt;polygon fill="#F1F1F1"
points="384.5,7,384.5,7.2102,394.5,6.5857,404.5,7.1933,414.5,7.3997,424.5,6.2866,434.5,6.9223,444.5,7,444.4456,6.8687,444.8046,7.0283,445.1984,7.2719,445.4725,7.2264,445.9848,7.7563,446.2678,7.7322,446.0737,7.6518,446.3533,8.0606,446.6937,8.4944,446.6807,8.782,446.8746,9.1552,447,9.5,446.9681,9.5,447.1785,19.7318,447.2391,29.9635,447.5857,40.1953,447.6711,50.427,447.6793,60.6588,447.2546,70.8905,447.4636,81.1223,447.7022,91.354,446.2788,101.5858,447,111.8175,447.209,111.9041,446.7622,112.1332,446.8715,112.5927,446.4082,112.815,446.3931,113.223,446.2678,113.5853,446.3624,113.8137,445.908,113.7167,445.5741,113.9106,445.2503,114.1289,444.9066,114.2992,444.5,114.3175,444.5,114.3136,434.5,114.6047,424.5,113.7451,414.5,114.6019,404.5,114.8657,394.5,114.762,384.5,114.3175,384.5782,114.5063,384.0848,114.0223,383.7097,113.8238,383.3601,113.6868,383.0783,113.7136,382.7322,113.5853,382.6717,113.5602,382.7956,113.3186,382.3855,112.8559,382.1872,112.4809,382.2167,112.2002,382,111.8175,381.3332,111.8175,381.4809,101.5858,382.649,91.354,382.4357,81.1223,382.7345,70.8905,381.6782,60.6588,382.3192,50.427,382.5904,40.1953,381.5276,29.9635,381.9041,19.7318,382,9.5,382.0388,9.5161,382.3472,9.2296,382.2916,8.7924,382.5818,8.4983,382.4152,8.0151,382.7322,7.7322,382.6458,7.5237,383.15,7.7409,383.3479,7.2186,383.8578,7.4496,384.1728,7.2101,384.5,7"
style="stroke:#181818;stroke-width:0.5;"/>&lt;image height="48"
width="45" x="392"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAwCAIAAAAKMGSIAAABYUlEQVR4Xu2Y7Y3DIAyGu2JGyAgZ4UbICBmBEW4ERugI3eCsvEAxifnwWbqexPMrjfHLE0olmsfrM3iUN/6I4OG937ZtGYe6qJdFqggeOglAvSxSRfAoswdhkSqmB+fGw/eRt7BIFTcerC6jaKlw46GARaqYHpzpwZkenH/lse/7dxWeqaHt4S2OF00aHsdxUJWeuCwYQSvd5VGvmoCvdcBjtwaxzrkxD1wbgtjpEUHs9IggdnpEEDs9IogVPb4y8mrotgOxokc2MiDd/yWIFT0+ZT1y8iquDUHs9IggVvTIRgZwn85mzhTEOsnjmXGtmiN65GBQcjcn/SQbHsu5PBhTp2w76ex99Xgs584o3wZlIOH2jWOcpU2XxxUyo3M2SaQnphUuxqzr+p6nRfBIe7iHYrXpoxM2EB3K04LVCR6j0MTrSTmzDA1Ou/KK0uN2N/Qg7VylB76LUSr/yJUe5vwAo6Ho0KlFbyoAAAAASUVORK5CYII="
y="17"/>&lt;text fill="#000000" font-family="xkcd Script" font-size="14"
lengthAdjust="spacing" textLength="15" x="409"
y="80.2429">h2&lt;/text>&lt;text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="44" x="392.5"
y="99.9017">10.0.0.2&lt;/text>&lt;/g>&lt;g
id="elem_s1">&lt;polygon fill="#F1F1F1"
points="195.5,31.83,195.5,32.0402,206,31.4157,216.5,32.0233,227,32.2297,237.5,31.1166,248,31.7523,258.5,31.83,258.4456,31.6987,258.8046,31.8583,259.1984,32.1019,259.4725,32.0564,259.9848,32.5863,260.2678,32.5622,260.0737,32.4818,260.3533,32.8906,260.6937,33.3244,260.6807,33.612,260.8746,33.9852,261,34.33,260.9681,34.33,261.1785,44.8618,261.2391,55.3935,261.5857,65.9253,261.6711,76.457,261,86.9888,261.2092,87.0754,260.932,87.3748,260.8499,87.755,260.7769,88.139,260.1921,88.311,260.2678,88.7565,260.3543,88.9655,259.8764,88.8117,259.6288,89.2138,259.144,89.0434,258.8448,89.3212,258.5,89.4888,258.5,90.2304,248,89.44,237.5,89.5941,227,89.8274,216.5,89.905,206,89.4849,195.5,89.4888,195.5366,89.5772,195.0734,89.166,194.8292,89.2834,194.5093,89.2182,194.1425,89.0399,193.7322,88.7565,193.921,88.8347,193.437,88.3413,193.2385,87.9662,193.1015,87.6166,193.1283,87.3348,193,86.9888,192.8035,86.9888,193.6814,76.457,192.8253,65.9253,192.6569,55.3935,193.2283,44.8618,193,34.33,192.7946,34.2449,192.9866,33.9102,193.4927,33.7057,193.5735,33.3249,193.812,33.0095,193.7322,32.5622,193.6912,32.4631,194.1265,32.5141,194.5147,32.4512,194.7326,31.9774,195.1342,31.9469,195.5,31.83"
style="stroke:#181818;stroke-width:0.5;"/>&lt;image height="18"
width="48" x="203"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAASCAIAAACSBMrtAAAA4klEQVR4Xs2WYRHDIAyFa7ESKgEJSEACEpCABCQgAQfLJXcQMtig20G/n6958JpQrkd6GIcUdlMCWWvPTSilQghVIGOMrFpOjLEE4tJ6qB3UpCoQqyl476WEBESqyKzFOQe7k+tLICptrvJ3y1AgGCLUNUfZe90blqFAsCKJmfwIPgqua61vW4hfAwkdNpu1XNeVH6XBQAnPJifr0Hau8+lw3Y9Z0nighBucnesAGiM6T5CleVZ6lolAsG4vECwN94dUP1oMItWpQGvoBuJjXgnd1P490F6qQDLzDujYPe5/6AU/4JUKUwnC3AAAAABJRU5ErkJggg=="
y="41.83"/>&lt;text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="9" x="224.5"
y="75.0729">s1&lt;/text>&lt;/g>&lt;g id="link_h1_s1">&lt;path
d="M72.39,60.66 L72.39,60.9402 L82.4117,60.1076 L92.4333,60.9177
L102.455,61.1929 L112.4767,59.7088 L122.4983,60.5564 L132.52,60.0913
L142.5417,60.1487 L152.5633,60.5691 L162.585,59.7382 L172.6067,61.3982
L182.6283,59.8196 L192.65,60.66 " fill="none"
style="stroke:#181818;stroke-width:1.0;"/>&lt;text fill="#000000"
font-family="xkcd Script" font-size="13" lengthAdjust="spacing"
textLength="43" x="80.0386" y="76.098">h1-eth0&lt;/text>&lt;text
fill="#000000" font-family="xkcd Script" font-size="13"
lengthAdjust="spacing" textLength="38" x="147.1477"
y="76.0979">s1-eth1&lt;/text>&lt;/g>&lt;g
id="link_s1_h2">&lt;path d="M261.16,60.66 L261.16,60.9402
L271.1925,60.1076 L281.225,60.9177 L291.2575,61.1929 L301.29,59.7088
L311.3225,60.5564 L321.355,60.0913 L331.3875,60.1487 L341.42,60.5691
L351.4525,59.7382 L361.485,61.3982 L371.5175,59.8196 L381.55,60.66 "
fill="none" style="stroke:#181818;stroke-width:1.0;"/>&lt;text
fill="#000000" font-family="xkcd Script" font-size="13"
lengthAdjust="spacing" textLength="42" x="268.9169"
y="76.0979">s1-eth2&lt;/text>&lt;text fill="#000000" font-family="xkcd
Script" font-size="13" lengthAdjust="spacing" textLength="47"
x="326.9645"
y="76.041">h2-eth0&lt;/text>&lt;/g>&lt;/g>&lt;/svg>
&lt;figcaption>
&lt;p>&lt;span class="figure-number">Рис. 1.: &lt;/span>Лабораторная топология&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;/li>
&lt;/ul>
&lt;h3 id="рабочие-файлы">&lt;span class="section-num">3.2&lt;/span> Рабочие файлы&lt;/h3>
&lt;ul>
&lt;li>Подключимся к виртуальной машине:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -Y mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для рабочих файлов будем использовать каталог &lt;code>~/work/lab_netem_ii&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_netem_ii
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="интерактивный-эксперимент">&lt;span class="section-num">4&lt;/span> Интерактивный эксперимент&lt;/h2>
&lt;h3 id="добавление-изменение-потери-пакетов">&lt;span class="section-num">4.1&lt;/span> Добавление/изменение потери пакетов&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Работа с NETEM осуществляется с помощью утилиты командной строки &lt;code>tc&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Без дополнительных параметров NETEM ведёт себя как базовая очередь FIFO без задержек, потерь, дублирования или переупорядочения пакетов.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Основной синтаксис &lt;code>tc&lt;/code>, используемый с NETEM, следующий:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc &lt;span class="o">[&lt;/span>add&lt;span class="p">|&lt;/span>del&lt;span class="p">|&lt;/span>replace&lt;span class="p">|&lt;/span>change&lt;span class="p">|&lt;/span>show&lt;span class="o">]&lt;/span> dev dev_id root netem opts
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>sudo&lt;/code>: выполнить команду с более высокими привилегиями;&lt;/li>
&lt;li>&lt;code>tc&lt;/code>: команда, используемая для взаимодействия с NETEM;&lt;/li>
&lt;li>&lt;code>qdisc&lt;/code>: дисциплина очереди (&lt;code>qdisc&lt;/code>) представляет собой набор правил, определяющих порядок, в котором обслуживаются пакеты, поступающие по протоколу IP.
&lt;ul>
&lt;li>Дисциплина очереди применяется к очереди пакетов, чтобы решить, когда отправлять каждый пакет.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>[add|del|replace|change|show]&lt;/code> (добавить, удалить, заменить, изменить, показать): операция над &lt;code>qdisc&lt;/code>:
&lt;ul>
&lt;li>чтобы добавить задержку на определённом интерфейсе, применяется операция &lt;code>add&lt;/code>;&lt;/li>
&lt;li>чтобы изменить или удалить задержку на определённом интерфейсе, применяется операция &lt;code>change&lt;/code> или &lt;code>del&lt;/code>;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>dev_id&lt;/code>: параметр указывает интерфейс, подлежащий эмуляции;&lt;/li>
&lt;li>&lt;code>opts&lt;/code>: параметр указывает величину задержки, потери пакетов, дублирования, повреждения и другие.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="определение-интерфейсов-хостов-h1-и-h2">&lt;span class="section-num">4.2&lt;/span> Определение интерфейсов хостов &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>Необходимо идентифицировать интерфейсы на подключенных хостах.&lt;/li>
&lt;li>На хосте &lt;code>h1&lt;/code> введите команду &lt;code>ifconfig&lt;/code>, чтобы отобразить информацию, относящуюся к его сетевым интерфейсам и назначенным им IP-адресам.
&lt;ul>
&lt;li>Вывод команды &lt;code>ifconfig&lt;/code> показывает, что хост &lt;code>h1&lt;/code> имеет два интерфейса: &lt;code>h1-eth0&lt;/code> и &lt;code>lo&lt;/code>.&lt;/li>
&lt;li>Интерфейс &lt;code>h1-eth0&lt;/code> необходимо использовать в &lt;code>tc&lt;/code> при эмуляции WAN.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>На хосте &lt;code>h2&lt;/code> введите команду &lt;code>ifconfig&lt;/code>.&lt;/li>
&lt;li>Вывод команды &lt;code>ifconfig&lt;/code> показывает, что хост &lt;code>h2&lt;/code> имеет два интерфейса: &lt;code>h2-eth0&lt;/code> и &lt;code>lo&lt;/code>.&lt;/li>
&lt;li>Интерфейс &lt;code>h2-eth0&lt;/code> необходимо использовать в &lt;code>tc&lt;/code> при эмуляции WAN.&lt;/li>
&lt;/ul>
&lt;h3 id="добавка-потери-пакетов-на-интерфейс-подключённый-к-глобальной-сети">&lt;span class="section-num">4.3&lt;/span> Добавка потери пакетов на интерфейс, подключённый к глобальной сети&lt;/h3>
&lt;ul>
&lt;li>Пакеты могут быть потеряны во время передачи из-за таких факторов, как битовые ошибки и перегрузка сети.&lt;/li>
&lt;li>Скорость потерянных пакетов часто измеряется как процентная доля потерянных пакетов по отношению к количеству отправленных пакетов.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc add dev h1-eth0 root netem loss 10%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Эта команда добавляет 10% потери пакетов к интерфейсу &lt;code>h1-eth0&lt;/code> хоста &lt;code>h1&lt;/code>.&lt;/li>
&lt;li>Теперь можно проверить наличие потерь пакетов, используя команду &lt;code>ping&lt;/code> с терминала хоста &lt;code>h1&lt;/code>. Параметр &lt;code>-c&lt;/code> указывает общее количество пакетов для отправки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2 -c &lt;span class="m">200&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обратите внимание на значения &lt;code>icmp_seq&lt;/code>. Некоторые номера последовательности отсутствуют из-за потери пакетов.&lt;/li>
&lt;li>В сводном отчёте &lt;code>ping&lt;/code> сообщает о проценте потерянных пакетов после завершения передачи.&lt;/li>
&lt;li>Данный сценарий эмулирует 10% потери пакетов в однонаправленном канале от хоста &lt;code>h1&lt;/code> к хосту &lt;code>h2&lt;/code>.&lt;/li>
&lt;li>Если мы хотим эмулировать потерю пакетов в обоих направлениях, к хосту &lt;code>h2&lt;/code> также необходимо добавить потерю пакетов в размере 10%.&lt;/li>
&lt;li>В терминале хоста &lt;code>h2&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc add dev h2-eth0 root netem loss 10%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Можно убедиться, что соединение между хостом &lt;code>h1&lt;/code> и хостом &lt;code>h2&lt;/code> имеет больше потерь пакетов (10% от хоста &lt;code>h1&lt;/code> + 10% от хоста &lt;code>h2&lt;/code>), повторив команду &lt;code>ping&lt;/code> на терминале хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2 -c &lt;span class="m">200&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обратите внимание на значения &lt;code>icmp_seq&lt;/code>. Некоторые номера последовательности отсутствуют из-за потери пакетов.&lt;/li>
&lt;li>В сводном отчёте &lt;code>ping&lt;/code> сообщает о проценте потерянных пакетов после завершения передачи.&lt;/li>
&lt;li>Чтобы удалить добавленную потерю пакетов и восстановить конфигурацию по умолчанию, необходимо удалить правила интерфейсов на хосте &lt;code>h1&lt;/code> и хосте &lt;code>h2&lt;/code>.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc del dev h1-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Примените те же действия для удаления правил на хосте &lt;code>h2&lt;/code>. В терминале хоста &lt;code>h2&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc del dev h2-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В результате дисциплина организации очереди tc восстановит свои значения по умолчанию.&lt;/li>
&lt;li>Теперь можно убедиться, что соединение от хоста &lt;code>h1&lt;/code> к хосту &lt;code>h2&lt;/code> не имеет явной потери пакетов.&lt;/li>
&lt;li>Запустите команду &lt;code>ping&lt;/code> с терминала хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Нажмите &lt;code>Ctrl+c&lt;/code>, чтобы остановить тест.&lt;/li>
&lt;/ul>
&lt;h3 id="добавка-значения-корреляции-для-потери-пакетов">&lt;span class="section-num">4.4&lt;/span> Добавка значения корреляции для потери пакетов&lt;/h3>
&lt;ul>
&lt;li>Можно добавить необязательную корреляцию.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc add dev h1-eth0 root netem loss 50% 50%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Команда вводит коэффициент потери пакетов 50% (такой высокий уровень потери пакетов маловероятен), и каждая последующая вероятность зависит на 50% от последней.&lt;/li>
&lt;li>Теперь пользователь может проверить, что между хостом &lt;code>h1&lt;/code> и хостом &lt;code>h2&lt;/code> теряются пакеты, используя команду &lt;code>ping&lt;/code> с терминала хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2 -c &lt;span class="m">50&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обратите внимание на значения &lt;code>icmp_seq&lt;/code>. Некоторые номера последовательности отсутствуют из-за потери пакетов.&lt;/li>
&lt;li>В сводном отчёте &lt;code>ping&lt;/code> сообщает о проценте потерянных пакетов после завершения передачи.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду, чтобы удалить предыдущие конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc del dev h1-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="добавка-повреждения-пакетов">&lt;span class="section-num">4.5&lt;/span> Добавка повреждения пакетов&lt;/h3>
&lt;ul>
&lt;li>Помимо потери пакетов, с помощью NETEM можно эмулировать повреждение пакетов.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc add dev h1-eth0 root netem corrupt 0.01%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавленное здесь новое значение представляет собой процент повреждения пакетов (0,01%).&lt;/li>
&lt;li>Теперь пользователь может проверить предыдущую конфигурацию с помощью инструмента &lt;code>iperf3&lt;/code> для проверки повторных передач.&lt;/li>
&lt;li>Запустите iPerf3 в режиме сервера в терминале хоста &lt;code>h2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите iPerf3 в клиентском режиме в терминале хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Посмотрите значения повторной передачи на каждом временном интервале и общее количество повторно переданных пакетов.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду, чтобы удалить предыдущие конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc del dev h1-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="добавка-переупорядочивание-пакетов">&lt;span class="section-num">4.6&lt;/span> Добавка переупорядочивание пакетов&lt;/h3>
&lt;ul>
&lt;li>Иногда пакеты доставляются не в том порядке, в котором они были отправлены.&lt;/li>
&lt;li>Для эмуляции переупорядочивания в NETEM используется опция переупорядочивания.&lt;/li>
&lt;li>Посмотрим поведение трафика без переупорядочивания пакетов.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введём:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Нажмите &lt;code>Ctrl+c&lt;/code>, чтобы остановить тест.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc add dev h1-eth0 root netem delay 10ms reorder 25% 50%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В этой команде 25% пакетов (со значением корреляции 50%) будут отправлены немедленно, а остальные 75% будут задержаны на 10 мс.&lt;/li>
&lt;li>Пользователь может проверить эффект переупорядочивания пакетов с помощью команды &lt;code>ping&lt;/code> на терминале хоста &lt;code>h1&lt;/code> (нажмите &lt;code>Ctrl+c&lt;/code>, чтобы остановить тест):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Первый и второй пакеты не будут иметь задержки (один из четырех, или 25%), а следующие три пакета будут иметь задержку около 10 миллисекунд (три из четырех, или 75%).&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду, чтобы удалить предыдущие конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc del dev h1-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="добавка-дублирования-пакетов">&lt;span class="section-num">4.7&lt;/span> Добавка дублирования пакетов&lt;/h3>
&lt;ul>
&lt;li>Дублированные пакеты могут присутствовать в сетях в результате повторных передач.&lt;/li>
&lt;li>NETEM предоставляет возможность эмуляции дублирования пакетов.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc add dev h1-eth0 root netem duplicate 50%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Команда создаст дублирование 50% (т. е. 50% пакетов будут получены дважды).&lt;/li>
&lt;li>Пользователь может проверить эффект дублирования пакетов с помощью команды &lt;code>ping&lt;/code> на терминале хоста &lt;code>h1&lt;/code> (нажмите &lt;code>Ctrl+c&lt;/code>, чтобы остановить тест):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Дубликаты пакетов помечаются как &lt;code>DUP!&lt;/code>.&lt;/li>
&lt;li>Измеренная скорость дублирования пакетов будет приближаться к настроенной скорости по мере выполнения большего количества попыток.&lt;/li>
&lt;li>В терминале хоста &lt;code>h1&lt;/code> введите следующую команду, чтобы удалить предыдущие конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc del dev h1-eth0 root netem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="видео-использование-netem-ii-dot-интерактивный-эксперимент">&lt;span class="section-num">4.8&lt;/span> Видео: Использование netem II. Интерактивный эксперимент&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-bcadef" data-toggle="tab" href="#bcadef"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-eacfdb" data-toggle="tab" href="#eacfdb"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="bcadef" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/b374d511a828ef5d969a6c538f9d18b1"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="eacfdb" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/l061lvu_8w4?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="воспроизводимый-эксперимент">&lt;span class="section-num">5&lt;/span> Воспроизводимый эксперимент&lt;/h2>
&lt;h3 id="постановка-задания">&lt;span class="section-num">5.1&lt;/span> Постановка задания&lt;/h3>
&lt;ul>
&lt;li>Будем исследовать задержки и построим графики для них.&lt;/li>
&lt;li>Выполните все интерактивные эксперименты в виде воспроизводимых.&lt;/li>
&lt;li>Для каждого эксперимента &lt;code>expname&lt;/code> создайте свой каталог:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_netem_ii/expname
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В него мы будем помещать файлы эксперимента.&lt;/li>
&lt;li>Здесь &lt;code>expname&lt;/code> может принимать значения &lt;code>simple-drop&lt;/code>, &lt;code>correlation-drop&lt;/code> и т.п.&lt;/li>
&lt;li>Для каждого эксперимента создайте скрипт для проведения эксперимента &lt;code>lab_netem_i.py&lt;/code> и скрипт для визуализации &lt;code>ping_plot&lt;/code>.&lt;/li>
&lt;li>Кроме визуализации вычислите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи.&lt;/li>
&lt;li>Для примера реализуем задание простейшей задержки.&lt;/li>
&lt;/ul>
&lt;h3 id="добавление-потери-пакетов-на-интерфейс-подключённый-к-эмулируемой-глобальной-сети">&lt;span class="section-num">5.2&lt;/span> Добавление потери пакетов на интерфейс, подключённый к эмулируемой глобальной сети&lt;/h3>
&lt;ul>
&lt;li>В качестве примера исследуем&lt;/li>
&lt;li>Создадим каталог &lt;code>simple-drop&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_netem_ii/simple-drop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ~/work/lab_netem_ii/simple-drop
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим скрипт для эксперимента &lt;code>lab_netem_ii.py&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/env python&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Simple experiment.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Output: ping.dat
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.net&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Mininet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.node&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Controller&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.cli&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">CLI&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">mininet.log&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">setLogLevel&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">emptyNet&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Create an empty network and add nodes to it.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Mininet&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">controller&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Controller&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">waitConnected&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding controller&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addController&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;c0&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding hosts&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.0.1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHost&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;h2&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.0.2&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Adding switch&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addSwitch&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;s1&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Creating links&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addLink&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Starting network&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">start&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Set loss&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmdPrint&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;tc qdisc add dev h1-eth0 root netem loss 10%&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmdPrint&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;tc qdisc add dev h2-eth0 root netem loss 10%&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># Wait 10 seconds&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Ping&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">h1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cmdPrint&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;ping -c 200&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">h2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="s1">&amp;#39;| grep &amp;#34;time=&amp;#34; | awk &lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1">{print $5, $7}&lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1"> | sed -e &lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1">s/time=//g&lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1"> -e &lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1">s/icmp_seq=//g&lt;/span>&lt;span class="se">\&amp;#39;&lt;/span>&lt;span class="s1"> &amp;gt; ping.dat&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;*** Stopping network&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">net&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">setLogLevel&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="s1">&amp;#39;info&amp;#39;&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">emptyNet&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим скрипт для визуализации &lt;code>ping_plot&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/bin/gnuplot --persist
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> terminal png crop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> output &lt;span class="s1">&amp;#39;ping.png&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> xlabel &lt;span class="s2">&amp;#34;Sequence number&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> ylabel &lt;span class="s2">&amp;#34;Delay (ms)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> grid
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">plot &lt;span class="s2">&amp;#34;ping.dat&amp;#34;&lt;/span> with lines
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Зададим права доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chmod +x ping_plot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим &lt;code>Makefile&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">all&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">ping&lt;/span>.&lt;span class="n">dat&lt;/span> &lt;span class="n">ping&lt;/span>.&lt;span class="n">png&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">ping.dat&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo python lab_netem_i.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo chown mininet:mininet ping.dat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">ping.png&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">ping&lt;/span>.&lt;span class="n">dat&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ./ping_plot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">clean&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -rm -f *.dat *.png
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Выполним эксперимент:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">make
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Посмотрите график.&lt;/li>
&lt;li>Вычислите минимальное, среднее, максимальное и стандартное отклонение времени приёма-передачи.&lt;/li>
&lt;li>Очистите каталог от результатов проведения экспериментов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">make clean
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Mininet. Token Bucket Filter</title><link>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-token-bucket-filter/</link><pubDate>Wed, 19 Oct 2022 19:51:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/simulation-networks/lab/mininet-token-bucket-filter/</guid><description>&lt;p>Управление пропускной способностью с помощью дисциплина очередей Token Bucket Filter (TBF).&lt;/p>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;h3 id="цели">&lt;span class="section-num">1.1&lt;/span> Цели&lt;/h3>
&lt;ul>
&lt;li>Освоить использование дисциплины очередей Token Bucket Filter (TBF).&lt;/li>
&lt;/ul>
&lt;h3 id="задачи">&lt;span class="section-num">1.2&lt;/span> Задачи&lt;/h3>
&lt;ul>
&lt;li>Получить понятие об алгоритме Token Bucket.&lt;/li>
&lt;li>Использовать Token Bucket Filter (tbf) в Linux.&lt;/li>
&lt;li>Понять, как комбинировать дисциплины очередей в Linux Traffic Control (tc).&lt;/li>
&lt;li>Объединить tbf и NETEM.&lt;/li>
&lt;li>Эмулируйте свойства WAN в Mininet.&lt;/li>
&lt;/ul>
&lt;h3 id="видео-token-bucket-filter-dot-введение">&lt;span class="section-num">1.3&lt;/span> Видео: Token Bucket Filter. Введение&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-cfdabe" data-toggle="tab" href="#cfdabe"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-dbcafe" data-toggle="tab" href="#dbcafe"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="cfdabe" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/844474172fbad39a5f8a7ffc8a927a44"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="dbcafe" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/9mqs0aw4tQE?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="теоретические-сведения">&lt;span class="section-num">2&lt;/span> Теоретические сведения&lt;/h2>
&lt;h3 id="введение-в-алгоритм-token-bucket">&lt;span class="section-num">2.1&lt;/span> Введение в алгоритм Token Bucket&lt;/h3>
&lt;ul>
&lt;li>При моделировании глобальной сети (WAN) иногда необходимо ограничить пропускную способность устройств (конечных хостов и сетевых устройств), чтобы наблюдать за поведением сети в различных условиях.&lt;/li>
&lt;li>Token Bucket &amp;mdash; это алгоритм, используемый в сетях с коммутацией пакетов для ограничения пропускной способности и пиковой нагрузки трафика.&lt;/li>
&lt;li>Сущность Token Bucket состоит в добавлении токенов (представленных в виде пакетов или байтов) с фиксированной скоростью в буфер (&lt;em>ведро&lt;/em>) с фиксированной ёмкостью.&lt;/li>
&lt;li>Когда приходит новый пакет длиной \(n\) байт, буфер (ведро) проверяется на количество доступных токенов; если доступно хотя бы \(n\) токенов, \(n\) токенов удаляются из ведра, и пакет отправляется в сеть.&lt;/li>
&lt;li>В противном случае токены не удаляются, и пакет считается несоответствующим. В таком случае пакет может быть отброшен, поставлен в очередь или передан, но помечен как несоответствующий.&lt;/li>
&lt;li>Параметры алгоритма:
&lt;ul>
&lt;li>&lt;code>rate&lt;/code> есть скорость передачи; она определяется частотой, с которой токены добавляются в корзину.&lt;/li>
&lt;li>&lt;em>Burstiness&lt;/em> (всплеск): когда ведро полностью занято (т. е. никакие пакеты не потребляют токены), новые пакеты будут потреблять токены сразу, без ограничений. Всплеск определяется как количество токенов, которые могут поместиться в ведро (или размер ведра).&lt;/li>
&lt;li>Иногда создаётся ещё одно маленькое ведро, с размером, равным максимально передаваемому элементу (Maximum Transmission Unit &amp;mdash; MTU). Скорость обработки этого буфера намного превышает исходную (peak rate &amp;mdash; пиковая скорость).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="основной-синтаксис-tbf">&lt;span class="section-num">2.2&lt;/span> Основной синтаксис tbf&lt;/h3>
&lt;ul>
&lt;li>Основной синтаксис &lt;code>tbf&lt;/code>, используемый с &lt;code>tc&lt;/code>, следующий:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tc qdisc &lt;span class="o">[&lt;/span>add &lt;span class="p">|&lt;/span> ...&lt;span class="o">]&lt;/span> dev &lt;span class="o">[&lt;/span>dev_id&lt;span class="o">]&lt;/span> root tbf limit &lt;span class="o">[&lt;/span>BYTES&lt;span class="o">]&lt;/span> burst &lt;span class="o">[&lt;/span>BYTES&lt;span class="o">]&lt;/span> rate &lt;span class="o">[&lt;/span>BPS&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>mtu BYTES&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span> peakrate BPS &lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span> latency TIME &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Здесь:
&lt;ul>
&lt;li>&lt;code>tc&lt;/code> : инструмент управления трафиком Linux;&lt;/li>
&lt;li>&lt;code>qdisc&lt;/code> : дисциплина очереди (qdisc) представляет собой набор правил, определяющих порядок, в котором обслуживаются пакеты, поступающие с выходных данных IP-протокола. Дисциплина очереди применяется к очереди пакетов, чтобы решить, когда отправлять каждый пакет;&lt;/li>
&lt;li>&lt;code>[add | del | replace | change | show]&lt;/code> : операция над &lt;code>qdisc&lt;/code>;&lt;/li>
&lt;li>&lt;code>dev [dev_id]&lt;/code>: задаёт интерфейс;&lt;/li>
&lt;li>&lt;code>tbf&lt;/code> : указывает, что используется алгоритм &lt;em>Token Bucket Filter&lt;/em>;&lt;/li>
&lt;li>&lt;code>limit [BYTES]&lt;/code> : размер очереди пакетов в байтах;&lt;/li>
&lt;li>&lt;code>burst [BYTES]&lt;/code> : количество байтов, которое может поместиться в корзину;&lt;/li>
&lt;li>&lt;code>rate [BPS]&lt;/code>: скорость передачи, определяемая частотой, с которой токены добавляются в корзину;&lt;/li>
&lt;li>&lt;code>mtu [BYTES]&lt;/code> : максимальная единица передачи в байтах;&lt;/li>
&lt;li>&lt;code>peakrate [BPS]&lt;/code> (пиковая скорость [бит/с]): максимальная скорость пакета;&lt;/li>
&lt;li>&lt;code>latency [TIME]&lt;/code> : максимальное время ожидания пакета в очереди.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="подготовка-стенда">&lt;span class="section-num">3&lt;/span> Подготовка стенда&lt;/h2>
&lt;h3 id="лабораторная-топология">&lt;span class="section-num">3.1&lt;/span> Лабораторная топология&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>В топологии используется сеть 10.0.0.0/8, назначенная Mininet по умолчанию.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Топология представляет собой коммутатор с двумя подключёнными к нему хостами.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Для запуска топологии (рис. &lt;a href="#figure--fig:tbf:topology">1&lt;/a>) используем параметры командной строки:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo mn --topo&lt;span class="o">=&lt;/span>linear,2 -x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a id="figure--fig:tbf:topology">&lt;/a>&lt;/p>
&lt;figure>
&lt;?xml version="1.0" encoding="us-ascii" standalone="no"?>&lt;svg
xmlns="http://www.w3.org/2000/svg"
xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css"
height="120px" preserveAspectRatio="none"
style="width:690px;height:120px;background:#FFFFFF;" version="1.1"
viewBox="0 0 690 120" width="690px"
zoomAndPan="magnify">&lt;defs/>&lt;g>&lt;g
id="elem_h1">&lt;polygon fill="#F1F1F1"
points="9.5,7,9.5,7.2102,19.5,6.5857,29.5,7.1933,39.5,7.3997,49.5,6.2866,59.5,6.9223,69.5,7,69.4456,6.8687,69.8046,7.0283,70.1984,7.2719,70.4725,7.2264,70.9848,7.7563,71.2678,7.7322,71.0737,7.6518,71.3533,8.0606,71.6937,8.4944,71.6807,8.782,71.8746,9.1552,72,9.5,71.9681,9.5,72.1785,19.7318,72.2391,29.9635,72.5857,40.1953,72.6711,50.427,72.6793,60.6588,72.2546,70.8905,72.4636,81.1223,72.7022,91.354,71.2788,101.5858,72,111.8175,72.209,111.9041,71.7622,112.1332,71.8715,112.5927,71.4082,112.815,71.3931,113.223,71.2678,113.5853,71.3624,113.8137,70.908,113.7167,70.5741,113.9106,70.2503,114.1289,69.9066,114.2992,69.5,114.3175,69.5,114.3136,59.5,114.6047,49.5,113.7451,39.5,114.6019,29.5,114.8657,19.5,114.762,9.5,114.3175,9.5782,114.5063,9.0848,114.0223,8.7097,113.8238,8.3601,113.6868,8.0783,113.7136,7.7322,113.5853,7.6717,113.5602,7.7956,113.3186,7.3855,112.8559,7.1872,112.4809,7.2167,112.2002,7,111.8175,6.3332,111.8175,6.4809,101.5858,7.649,91.354,7.4357,81.1223,7.7345,70.8905,6.6782,60.6588,7.3192,50.427,7.5904,40.1953,6.5276,29.9635,6.9041,19.7318,7,9.5,7.0388,9.5161,7.3472,9.2296,7.2916,8.7924,7.5818,8.4983,7.4152,8.0151,7.7322,7.7322,7.6458,7.5237,8.15,7.7409,8.3479,7.2186,8.8578,7.4496,9.1728,7.2101,9.5,7"
style="stroke:#181818;stroke-width:0.5;"/>&lt;image height="48"
width="45" x="17"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAwCAIAAAAKMGSIAAABYUlEQVR4Xu2Y7Y3DIAyGu2JGyAgZ4UbICBmBEW4ERugI3eCsvEAxifnwWbqexPMrjfHLE0olmsfrM3iUN/6I4OG937ZtGYe6qJdFqggeOglAvSxSRfAoswdhkSqmB+fGw/eRt7BIFTcerC6jaKlw46GARaqYHpzpwZkenH/lse/7dxWeqaHt4S2OF00aHsdxUJWeuCwYQSvd5VGvmoCvdcBjtwaxzrkxD1wbgtjpEUHs9IggdnpEEDs9IogVPb4y8mrotgOxokc2MiDd/yWIFT0+ZT1y8iquDUHs9IggVvTIRgZwn85mzhTEOsnjmXGtmiN65GBQcjcn/SQbHsu5PBhTp2w76ex99Xgs584o3wZlIOH2jWOcpU2XxxUyo3M2SaQnphUuxqzr+p6nRfBIe7iHYrXpoxM2EB3K04LVCR6j0MTrSTmzDA1Ou/KK0uN2N/Qg7VylB76LUSr/yJUe5vwAo6Ho0KlFbyoAAAAASUVORK5CYII="
y="17"/>&lt;text fill="#000000" font-family="xkcd Script" font-size="14"
lengthAdjust="spacing" textLength="10" x="36.5"
y="80.2429">h1&lt;/text>&lt;text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="39" x="20"
y="99.9017">10.0.0.1&lt;/text>&lt;/g>&lt;g
id="elem_h2">&lt;polygon fill="#F1F1F1"
points="621.5,7,621.5,7.2102,631.5,6.5857,641.5,7.1933,651.5,7.3997,661.5,6.2866,671.5,6.9223,681.5,7,681.4456,6.8687,681.8046,7.0283,682.1984,7.2719,682.4725,7.2264,682.9848,7.7563,683.2678,7.7322,683.0737,7.6518,683.3533,8.0606,683.6937,8.4944,683.6807,8.782,683.8746,9.1552,684,9.5,683.9681,9.5,684.1785,19.7318,684.2391,29.9635,684.5857,40.1953,684.6711,50.427,684.6793,60.6588,684.2546,70.8905,684.4636,81.1223,684.7022,91.354,683.2788,101.5858,684,111.8175,684.209,111.9041,683.7622,112.1332,683.8715,112.5927,683.4082,112.815,683.3931,113.223,683.2678,113.5853,683.3624,113.8137,682.908,113.7167,682.5741,113.9106,682.2503,114.1289,681.9066,114.2992,681.5,114.3175,681.5,114.3136,671.5,114.6047,661.5,113.7451,651.5,114.6019,641.5,114.8657,631.5,114.762,621.5,114.3175,621.5782,114.5063,621.0848,114.0223,620.7097,113.8238,620.3601,113.6868,620.0783,113.7136,619.7322,113.5853,619.6717,113.5602,619.7956,113.3186,619.3855,112.8559,619.1872,112.4809,619.2167,112.2002,619,111.8175,618.3332,111.8175,618.4809,101.5858,619.649,91.354,619.4357,81.1223,619.7345,70.8905,618.6782,60.6588,619.3192,50.427,619.5904,40.1953,618.5276,29.9635,618.9041,19.7318,619,9.5,619.0388,9.5161,619.3472,9.2296,619.2916,8.7924,619.5818,8.4983,619.4152,8.0151,619.7322,7.7322,619.6458,7.5237,620.15,7.7409,620.3479,7.2186,620.8578,7.4496,621.1728,7.2101,621.5,7"
style="stroke:#181818;stroke-width:0.5;"/>&lt;image height="48"
width="45" x="629"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAwCAIAAAAKMGSIAAABYUlEQVR4Xu2Y7Y3DIAyGu2JGyAgZ4UbICBmBEW4ERugI3eCsvEAxifnwWbqexPMrjfHLE0olmsfrM3iUN/6I4OG937ZtGYe6qJdFqggeOglAvSxSRfAoswdhkSqmB+fGw/eRt7BIFTcerC6jaKlw46GARaqYHpzpwZkenH/lse/7dxWeqaHt4S2OF00aHsdxUJWeuCwYQSvd5VGvmoCvdcBjtwaxzrkxD1wbgtjpEUHs9IggdnpEEDs9IogVPb4y8mrotgOxokc2MiDd/yWIFT0+ZT1y8iquDUHs9IggVvTIRgZwn85mzhTEOsnjmXGtmiN65GBQcjcn/SQbHsu5PBhTp2w76ex99Xgs584o3wZlIOH2jWOcpU2XxxUyo3M2SaQnphUuxqzr+p6nRfBIe7iHYrXpoxM2EB3K04LVCR6j0MTrSTmzDA1Ou/KK0uN2N/Qg7VylB76LUSr/yJUe5vwAo6Ho0KlFbyoAAAAASUVORK5CYII="
y="17"/>&lt;text fill="#000000" font-family="xkcd Script" font-size="14"
lengthAdjust="spacing" textLength="15" x="646"
y="80.2429">h2&lt;/text>&lt;text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="44" x="629.5"
y="99.9017">10.0.0.2&lt;/text>&lt;/g>&lt;g
id="elem_s1">&lt;polygon fill="#F1F1F1"
points="197.5,31.83,197.5,32.0402,208,31.4157,218.5,32.0233,229,32.2297,239.5,31.1166,250,31.7523,260.5,31.83,260.4456,31.6987,260.8046,31.8583,261.1984,32.1019,261.4725,32.0564,261.9848,32.5863,262.2678,32.5622,262.0737,32.4818,262.3533,32.8906,262.6937,33.3244,262.6807,33.612,262.8746,33.9852,263,34.33,262.9681,34.33,263.1785,44.8618,263.2391,55.3935,263.5857,65.9253,263.6711,76.457,263,86.9888,263.2092,87.0754,262.932,87.3748,262.8499,87.755,262.7769,88.139,262.1921,88.311,262.2678,88.7565,262.3543,88.9655,261.8764,88.8117,261.6288,89.2138,261.144,89.0434,260.8448,89.3212,260.5,89.4888,260.5,90.2304,250,89.44,239.5,89.5941,229,89.8274,218.5,89.905,208,89.4849,197.5,89.4888,197.5366,89.5772,197.0734,89.166,196.8292,89.2834,196.5093,89.2182,196.1425,89.0399,195.7322,88.7565,195.921,88.8347,195.437,88.3413,195.2385,87.9662,195.1015,87.6166,195.1283,87.3348,195,86.9888,194.8035,86.9888,195.6814,76.457,194.8253,65.9253,194.6569,55.3935,195.2283,44.8618,195,34.33,194.7946,34.2449,194.9866,33.9102,195.4927,33.7057,195.5735,33.3249,195.812,33.0095,195.7322,32.5622,195.6912,32.4631,196.1265,32.5141,196.5147,32.4512,196.7326,31.9774,197.1342,31.9469,197.5,31.83"
style="stroke:#181818;stroke-width:0.5;"/>&lt;image height="18"
width="48" x="205"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAASCAIAAACSBMrtAAAA4klEQVR4Xs2WYRHDIAyFa7ESKgEJSEACEpCABCQgAQfLJXcQMtig20G/n6958JpQrkd6GIcUdlMCWWvPTSilQghVIGOMrFpOjLEE4tJ6qB3UpCoQqyl476WEBESqyKzFOQe7k+tLICptrvJ3y1AgGCLUNUfZe90blqFAsCKJmfwIPgqua61vW4hfAwkdNpu1XNeVH6XBQAnPJifr0Hau8+lw3Y9Z0nighBucnesAGiM6T5CleVZ6lolAsG4vECwN94dUP1oMItWpQGvoBuJjXgnd1P490F6qQDLzDujYPe5/6AU/4JUKUwnC3AAAAABJRU5ErkJggg=="
y="41.83"/>&lt;text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="9" x="226.5"
y="75.0729">s1&lt;/text>&lt;/g>&lt;g id="elem_s2">&lt;polygon
fill="#F1F1F1"
points="430.5,31.83,430.5,32.0402,441,31.4157,451.5,32.0233,462,32.2297,472.5,31.1166,483,31.7523,493.5,31.83,493.4456,31.6987,493.8046,31.8583,494.1984,32.1019,494.4725,32.0564,494.9848,32.5863,495.2678,32.5622,495.0737,32.4818,495.3533,32.8906,495.6937,33.3244,495.6807,33.612,495.8746,33.9852,496,34.33,495.9681,34.33,496.1785,44.8618,496.2391,55.3935,496.5857,65.9253,496.6711,76.457,496,86.9888,496.2092,87.0754,495.932,87.3748,495.8499,87.755,495.7769,88.139,495.1921,88.311,495.2678,88.7565,495.3543,88.9655,494.8764,88.8117,494.6288,89.2138,494.144,89.0434,493.8448,89.3212,493.5,89.4888,493.5,90.2304,483,89.44,472.5,89.5941,462,89.8274,451.5,89.905,441,89.4849,430.5,89.4888,430.5366,89.5772,430.0734,89.166,429.8292,89.2834,429.5093,89.2182,429.1425,89.0399,428.7322,88.7565,428.921,88.8347,428.437,88.3413,428.2385,87.9662,428.1015,87.6166,428.1283,87.3348,428,86.9888,427.8035,86.9888,428.6814,76.457,427.8253,65.9253,427.6569,55.3935,428.2283,44.8618,428,34.33,427.7946,34.2449,427.9866,33.9102,428.4927,33.7057,428.5735,33.3249,428.812,33.0095,428.7322,32.5622,428.6912,32.4631,429.1265,32.5141,429.5147,32.4512,429.7326,31.9774,430.1342,31.9469,430.5,31.83"
style="stroke:#181818;stroke-width:0.5;"/>&lt;image height="18"
width="48" x="438"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAASCAIAAACSBMrtAAAA4klEQVR4Xs2WYRHDIAyFa7ESKgEJSEACEpCABCQgAQfLJXcQMtig20G/n6958JpQrkd6GIcUdlMCWWvPTSilQghVIGOMrFpOjLEE4tJ6qB3UpCoQqyl476WEBESqyKzFOQe7k+tLICptrvJ3y1AgGCLUNUfZe90blqFAsCKJmfwIPgqua61vW4hfAwkdNpu1XNeVH6XBQAnPJifr0Hau8+lw3Y9Z0nighBucnesAGiM6T5CleVZ6lolAsG4vECwN94dUP1oMItWpQGvoBuJjXgnd1P490F6qQDLzDujYPe5/6AU/4JUKUwnC3AAAAABJRU5ErkJggg=="
y="41.83"/>&lt;text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="14" x="457"
y="75.0729">s2&lt;/text>&lt;/g>&lt;g id="link_h1_s1">&lt;path
d="M72.31,60.66 L72.31,60.9402 L82.515,60.1076 L92.72,60.9177
L102.925,61.1929 L113.13,59.7088 L123.335,60.5564 L133.54,60.0913
L143.745,60.1487 L153.95,60.5691 L164.155,59.7382 L174.36,61.3982
L184.565,59.8196 L194.77,60.66 " fill="none"
style="stroke:#181818;stroke-width:1.0;"/>&lt;text fill="#000000"
font-family="xkcd Script" font-size="13" lengthAdjust="spacing"
textLength="43" x="79.9473" y="76.098">h1-eth0&lt;/text>&lt;text
fill="#000000" font-family="xkcd Script" font-size="13"
lengthAdjust="spacing" textLength="38" x="148.9518"
y="76.155">s1-eth1&lt;/text>&lt;/g>&lt;g
id="link_s1_s2">&lt;path d="M263.1,60.66 L263.1,60.9402 L273.3806,60.1076
L283.6613,60.9177 L293.9419,61.1929 L304.2225,59.7088
L314.5031,60.5564 L324.7838,60.0913 L335.0644,60.1487 L345.345,60.5691
L355.6256,59.7382 L365.9063,61.3982 L376.1869,59.8196
L386.4675,60.3963 L396.7481,61.2359 L407.0287,60.5456 L417.3094,60.751
L427.59,60.66 " fill="none"
style="stroke:#181818;stroke-width:1.0;"/>&lt;text fill="#000000"
font-family="xkcd Script" font-size="13" lengthAdjust="spacing"
textLength="41" x="325" y="55.8143">10 Gbps&lt;/text>&lt;text fill="#000000"
font-family="xkcd Script" font-size="13" lengthAdjust="spacing"
textLength="42" x="270.8484" y="76.0979">s1-eth2&lt;/text>&lt;text
fill="#000000" font-family="xkcd Script" font-size="13"
lengthAdjust="spacing" textLength="46" x="373.8755"
y="76.0409">s2-eth2&lt;/text>&lt;/g>&lt;g
id="link_s2_h2">&lt;path d="M496.09,60.66 L496.09,60.9402
L506.3058,60.1076 L516.5217,60.9177 L526.7375,61.1929
L536.9533,59.7088 L547.1692,60.5564 L557.385,60.0913 L567.6008,60.1487
L577.8167,60.5691 L588.0325,59.7382 L598.2483,61.3982
L608.4642,59.8196 L618.68,60.66 " fill="none"
style="stroke:#181818;stroke-width:1.0;"/>&lt;text fill="#000000"
font-family="xkcd Script" font-size="13" lengthAdjust="spacing"
textLength="42" x="503.837" y="76.0979">s2-eth1&lt;/text>&lt;text
fill="#000000" font-family="xkcd Script" font-size="13"
lengthAdjust="spacing" textLength="47" x="564.112"
y="76.041">h2-eth0&lt;/text>&lt;/g>&lt;/g>&lt;/svg>
&lt;figcaption>
&lt;p>&lt;span class="figure-number">Рис. 1.: &lt;/span>Лабораторная топология&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;/li>
&lt;/ul>
&lt;h3 id="рабочие-файлы">&lt;span class="section-num">3.2&lt;/span> Рабочие файлы&lt;/h3>
&lt;ul>
&lt;li>Подключимся к виртуальной машине:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -Y mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для рабочих файлов будем использовать каталог &lt;code>~/work/lab_tbf&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/work/lab_tbf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="интерактивный-эксперимент">&lt;span class="section-num">4&lt;/span> Интерактивный эксперимент&lt;/h2>
&lt;h3 id="отсутствие-ограничения-скорости">&lt;span class="section-num">4.1&lt;/span> Отсутствие ограничения скорости&lt;/h3>
&lt;ul>
&lt;li>Запустим iPerf3 в режиме сервера, выполните команду &lt;code>iperf3 -s&lt;/code> в терминале хоста &lt;code>h2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустим iPerf3 в клиентском режиме, запустите команду &lt;code>iperf3 -c 10.0.0.2&lt;/code> для хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="ограничение-скорости-на-конечных-хостах">&lt;span class="section-num">4.2&lt;/span> Ограничение скорости на конечных хостах&lt;/h3>
&lt;ul>
&lt;li>Команду &lt;code>tc&lt;/code> можно применить к сетевому интерфейсу устройства для формирования исходящего трафика.&lt;/li>
&lt;li>Будем ограничивать скорость отправки конечного хоста с помощью фильтра Token Bucket Filter (tbf), который является реализацией алгоритма Token Bucket.&lt;/li>
&lt;/ul>
&lt;h4 id="определим-интерфейс-хостов-h1-и-h2">&lt;span class="section-num">4.2.1&lt;/span> Определим интерфейс хостов &lt;code>h1&lt;/code> и &lt;code>h2&lt;/code>&lt;/h4>
&lt;ul>
&lt;li>На хосте &lt;code>h1&lt;/code> введите команду &lt;code>ifconfig&lt;/code>, чтобы отобразить информацию, относящуюся к его сетевым интерфейсам и назначенным им IP-адресам.
&lt;ul>
&lt;li>Хост &lt;code>h1&lt;/code> имеет два интерфейса: &lt;code>h1-eth0&lt;/code> и &lt;code>lo&lt;/code>. Интерфейс &lt;code>h1-eth0&lt;/code> на хосте &lt;code>h1&lt;/code> настроен с IP-адресом 10.0.0.1 и маской подсети 255.0.0.0. Этот интерфейс необходимо использовать в &lt;code>tc&lt;/code> при эмуляции сети.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>В командной строке хоста &lt;code>h2&lt;/code> также введите команду &lt;code>ifconfig&lt;/code>.
&lt;ul>
&lt;li>Хост &lt;code>h2&lt;/code> имеет два интерфейса: &lt;code>h2-eth0&lt;/code> и &lt;code>lo&lt;/code>. Интерфейс &lt;code>h2-eth0&lt;/code> на хосте &lt;code>h1&lt;/code> настроен с IP-адресом 10.0.0.2 и маской подсети 255.0.0.0. Этот интерфейс необходимо использовать в &lt;code>tc&lt;/code> при эмуляции сети.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="эмуляция-глобальной-сети-10-гбит-с-с-высокой-задержкой">&lt;span class="section-num">4.2.2&lt;/span> Эмуляция глобальной сети 10 Гбит/с с высокой задержкой&lt;/h4>
&lt;ul>
&lt;li>Будем использовать команду &lt;code>tbf&lt;/code> на сетевом интерфейсе для управления скоростью исходящего трафика.&lt;/li>
&lt;li>Измените пропускную способность хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc add dev h1-eth0 root tbf rate 10gbit burst &lt;span class="m">5000000&lt;/span> limit &lt;span class="m">15000000&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Эта команда устанавливает пропускную способность на 10 Гбит/с на интерфейсе &lt;code>h1-eth0&lt;/code> хоста &lt;code>h1&lt;/code>.&lt;/li>
&lt;li>Параметры Token Bucket Filter:
&lt;ul>
&lt;li>rate : 10gbit;&lt;/li>
&lt;li>burst : 5,000,000;&lt;/li>
&lt;li>limit : 15,000,000.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Распишем элементы команды:
&lt;ul>
&lt;li>&lt;code>sudo&lt;/code> : включить выполнение команды с более высокими привилегиями безопасности;&lt;/li>
&lt;li>&lt;code>tc&lt;/code> : вызвать управление трафиком Linux;&lt;/li>
&lt;li>&lt;code>qdisc&lt;/code> : изменить дисциплину очередей сетевого планировщика;&lt;/li>
&lt;li>&lt;code>add&lt;/code> (добавить): создать новое правило;&lt;/li>
&lt;li>&lt;code>dev h1-eth0 root&lt;/code> : интерфейс, на котором будет применяться правило;&lt;/li>
&lt;li>&lt;code>tbf&lt;/code> : использовать алгоритм Token Bucket Filter;&lt;/li>
&lt;li>&lt;code>rate&lt;/code> : укажите скорость передачи (10 Гбит/с);&lt;/li>
&lt;li>&lt;code>burst&lt;/code> : количество байтов, которое может поместиться в корзину (5 000 000) за один такт;&lt;/li>
&lt;li>&lt;code>limit&lt;/code> : размер очереди в байтах (15 000 000).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Расчёт всплеска.
&lt;ul>
&lt;li>&lt;code>tbf&lt;/code> требует установки значения всплеска при ограничении скорости. Это значение должно быть достаточно высоким, чтобы обеспечить установленную вами скорость.&lt;/li>
&lt;li>Она должна быть не ниже указанной частоты, делённой на HZ, где HZ &amp;mdash; тактовая частота, настроенная как параметр ядра, и может быть извлечена с помощью следующей команды:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">egrep &lt;span class="s1">&amp;#39;^CONFIG_HZ_[0-9]+&amp;#39;&lt;/span> /boot/config-&lt;span class="sb">`&lt;/span>uname -r&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>HZ на &lt;code>h1&lt;/code> &amp;mdash; 250. Таким образом, для расчёта всплеска делим 10 Гбит/с на 250:
&lt;ul>
&lt;li>10 Gbps = 10,000,000,000 bps;&lt;/li>
&lt;li>burst = 10,000,000,000 [bps]/250 [s&lt;sup>-1&lt;/sup>] = 40,000,000 [bit] = 40,000,000/8 [byte] = 5,000,000 [byte].&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Полученное значение должно использоваться в команде в качестве значения &lt;em>burst&lt;/em> (всплеска).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Проверим конфигурацию с помощью инструмента &lt;code>iperf3&lt;/code> для измерения пропускной способности.&lt;/li>
&lt;li>Запустим iPerf3 в режиме сервера, выполните команду &lt;code>iperf3 -s&lt;/code> в терминале хоста &lt;code>h2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустим iPerf3 в клиентском режиме, запустите команду &lt;code>iperf3 -c 10.0.0.2&lt;/code> для хоста &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/li>
&lt;li>Удалите конфигурацию на хосте &lt;code>h1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc del dev h1-eth0 root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="ограничение-скорости-на-коммутаторах">&lt;span class="section-num">4.3&lt;/span> Ограничение скорости на коммутаторах&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Применим Token Bucket Filter к интерфейсам коммутатора.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>При ограничении скорости на интерфейсе &lt;code>s1-eth2&lt;/code> коммутатора &lt;code>s1&lt;/code> все сеансы связи между коммутатором &lt;code>s1&lt;/code> и коммутатором &lt;code>s2&lt;/code> будут фильтроваться в соответствии с применяемыми правилами.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Введите в терминале &lt;code>s1&lt;/code> команду &lt;code>ifconfig&lt;/code>, чтобы отобразить информацию, связанную с его сетевыми интерфейсами:&lt;/p>
&lt;ul>
&lt;li>&lt;code>s1-eth1&lt;/code> : интерфейс, соединяющий коммутатор &lt;code>s1&lt;/code> с хостом &lt;code>h1&lt;/code>;&lt;/li>
&lt;li>&lt;code>s1-eth2&lt;/code> : интерфейс, соединяющий коммутатор &lt;code>s1&lt;/code> с коммутатором &lt;code>s2&lt;/code>;&lt;/li>
&lt;li>&lt;code>s2-eth1&lt;/code> : интерфейс, соединяющий коммутатор &lt;code>s2&lt;/code> с хостом &lt;code>h2&lt;/code>;&lt;/li>
&lt;li>&lt;code>s2-eth2&lt;/code> : интерфейс, соединяющий коммутатор &lt;code>s2&lt;/code> с коммутатором &lt;code>s1&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Примените правило ограничения скорости &lt;code>tbf&lt;/code> к интерфейсу коммутатора &lt;code>s1&lt;/code>, который соединяет его с коммутатором &lt;code>s2&lt;/code> (&lt;code>s1-eth2&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc add dev s1-eth2 root tbf rate 10gbit burst &lt;span class="m">5000000&lt;/span> limit &lt;span class="m">15000000&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Параметры Token Bucket Filter следующие:
&lt;ul>
&lt;li>&lt;code>rate&lt;/code> : 10gbit;&lt;/li>
&lt;li>&lt;code>burst&lt;/code> : 5,000,000;&lt;/li>
&lt;li>&lt;code>limit&lt;/code> : 15,000,000.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Проверим конфигурацию с помощью инструмента &lt;code>iperf3&lt;/code> для измерения пропускной способности.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Запустим iPerf3 в режиме сервера, выполните команду &lt;code>iperf3 -s&lt;/code> в терминале хоста &lt;code>h2&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Запустим iPerf3 в клиентском режиме, запустите команду &lt;code>iperf3 -c 10.0.0.2&lt;/code> для хоста &lt;code>h1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Удалите конфигурацию на коммутаторе &lt;code>s1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc del dev s1-eth2 root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="объединение-netem-и-tbf">&lt;span class="section-num">4.4&lt;/span> Объединение NETEM и TBF&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>NETEM используется для введения задержки, джиттера, повреждения пакетов и т. д.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>TBF может использоваться для ограничения скорости.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Возможно комбинировать несколько модулей.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Первый &lt;code>qdisc&lt;/code> (&lt;code>qdisc1&lt;/code>) присоединён к корневой метке. Затем последующие &lt;code>qdisc&lt;/code> можно прикрепить к своим родителям, указав правильную метку.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Объединим NETEM и TBF, чтобы сделать эмуляцию адекватней. Введём задержку, джиттер и повреждение пакетов, указав скорость на интерфейсе коммутатора &lt;code>s1&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Введём в терминале коммутатора &lt;code>s1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc add dev s1-eth2 root handle 1: netem delay 10ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Ключевое слово &lt;code>handle&lt;/code> задаёт дескриптор подключения, имеющий смысл очерёдности подключения разных дисциплин &lt;code>qdisc&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Теперь можно убедиться, что соединение от хоста &lt;code>h1&lt;/code> к хосту &lt;code>h2&lt;/code> имеет заданную задержку.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Запустите команду &lt;code>ping&lt;/code> с терминала хоста &lt;code>h1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ping 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Нажмите &lt;code>Ctrl+c&lt;/code>, чтобы остановить тест.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Добавим второе правило на коммутаторе &lt;code>s1&lt;/code>, которое задаёт ограничение скорости с помощью &lt;code>tbf&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc add dev s1-eth2 parent 1: handle 2: tbf rate 2gbit burst &lt;span class="m">1000000&lt;/span> limit &lt;span class="m">2000000&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Параметры Token Bucket Filter следующие:
&lt;ul>
&lt;li>&lt;code>rate&lt;/code> : 2gbit;&lt;/li>
&lt;li>&lt;code>burst&lt;/code> : 1,000,000;&lt;/li>
&lt;li>&lt;code>limit&lt;/code> : 2,000,000.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Проверим предыдущую конфигурацию с помощью инструмента iperf3 для измерения пропускной способности.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Запустим iPerf3 в режиме сервера, выполните команду &lt;code>iperf3 -s&lt;/code> в терминале хоста &lt;code>h2&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Запустим iPerf3 в клиентском режиме, запустите команду &lt;code>iperf3 -c 10.0.0.2&lt;/code> для хоста &lt;code>h1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c 10.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Чтобы остановить сервер, нажмите &lt;code>Ctrl+c&lt;/code> в терминале хоста &lt;code>h2&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Удалите конфигурацию на коммутаторе &lt;code>s1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo tc qdisc del dev s1-eth2 root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="видео-token-bucket-filter-dot-интерактивный-эксперимент">&lt;span class="section-num">4.5&lt;/span> Видео: Token Bucket Filter. Интерактивный эксперимент&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-badfec" data-toggle="tab" href="#badfec"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-ceadbf" data-toggle="tab" href="#ceadbf"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="badfec" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/273ce5d8455a3ba7c18e99a0ce03ced4"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="ceadbf" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/ncCPgMUdgjM?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Адресация IPv4 и IPv6. Двойной стек</title><link>https://yamadharma.github.io/ru/course/nettech/ipv4-ipv6-addressing-double-stack/</link><pubDate>Fri, 08 Jul 2022 13:19:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/nettech/ipv4-ipv6-addressing-double-stack/</guid><description>&lt;p>Адресация IPv4 и IPv6. Двойной стек.&lt;/p>
&lt;h2 id="описание">&lt;span class="section-num">1&lt;/span> Описание&lt;/h2>
&lt;h3 id="цель">&lt;span class="section-num">1.1&lt;/span> Цель&lt;/h3>
&lt;ul>
&lt;li>Овладеть принципами настройки сетей IPv4 и IPv6.&lt;/li>
&lt;/ul>
&lt;h3 id="задачи">&lt;span class="section-num">1.2&lt;/span> Задачи&lt;/h3>
&lt;ul>
&lt;li>Настроить адресацию IPv4 на хостах и маршрутизаторе.&lt;/li>
&lt;li>Настроить статическую маршрутизацию IPv4.&lt;/li>
&lt;li>Настроить адресацию IPv6 на хостах и маршрутизаторе.&lt;/li>
&lt;li>Настроить статическую маршрутизацию IPv6.&lt;/li>
&lt;/ul>
&lt;h3 id="схема-сети">&lt;span class="section-num">1.3&lt;/span> Схема сети&lt;/h3>
&lt;figure id="figure-105610801089-1-схема-сети">
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://yamadharma.github.io/ox-hugo/20220708131900-topology.png" alt="&amp;amp;#1056;&amp;amp;#1080;&amp;amp;#1089;. 1.: Схема сети" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;figcaption>
&lt;span class="figure-number">Рис. 1.: &lt;/span>Схема сети
&lt;/figcaption>&lt;/figure>
&lt;h3 id="исходные-данные">&lt;span class="section-num">1.4&lt;/span> Исходные данные&lt;/h3>
&lt;ul>
&lt;li>К маршрутизаторам &lt;code>gw-01&lt;/code> и &lt;code>gw-02&lt;/code> подключены по две локальных сети.&lt;/li>
&lt;li>Для настройки маршрутизации IPv6 будем использовать &lt;em>routing advertisements&lt;/em> (анонсирование маршрутов).&lt;/li>
&lt;/ul>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 1:&lt;/span>
Таблица адресации
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Устройство&lt;/th>
&lt;th>Интерфейс&lt;/th>
&lt;th>IP-адрес&lt;/th>
&lt;th>Шлюз по умолчанию&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>gw-01&lt;/td>
&lt;td>eth0&lt;/td>
&lt;td>172.16.20.1/255.255.255.128&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>gw-01&lt;/td>
&lt;td>eth1&lt;/td>
&lt;td>172.16.20.129/255.255.255.128&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>gw-01&lt;/td>
&lt;td>eth2&lt;/td>
&lt;td>64.100.1.1/255.255.255.0&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC1&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>172.16.20.10/255.255.255.128&lt;/td>
&lt;td>172.16.20.1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC2&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>172.16.20.138/255.255.255.128&lt;/td>
&lt;td>172.16.20.129&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>gw-02&lt;/td>
&lt;td>eth0&lt;/td>
&lt;td>2001:db8:c0de:12::1/64&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>gw-02&lt;/td>
&lt;td>eth1&lt;/td>
&lt;td>2001:db8:c0de:13::1/64&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>gw-02&lt;/td>
&lt;td>eth2&lt;/td>
&lt;td>2001:db8:c0de:11::1/64&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC3&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>2001:db8:c0de:12::a/64&lt;/td>
&lt;td>gw-02&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC4&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>2001:db8:c0de:13::a/64&lt;/td>
&lt;td>gw-02&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Server&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>64.100.1.10/255.255.255.0&lt;/td>
&lt;td>64.100.1.1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Server&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>2001:db8:c0de:11::a/64&lt;/td>
&lt;td>gw-02&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="задание">&lt;span class="section-num">1.5&lt;/span> Задание&lt;/h3>
&lt;ul>
&lt;li>Необходимо настроить соответствующую адресацию на каждом устройстве.&lt;/li>
&lt;li>Необходимо проверить подключение из каждой сети к серверу с двойным стеком.&lt;/li>
&lt;/ul>
&lt;h2 id="порядок-выполнения">&lt;span class="section-num">2&lt;/span> Порядок выполнения&lt;/h2>
&lt;h3 id="настройка-адресации-ipv4">&lt;span class="section-num">2.1&lt;/span> Настройка адресации IPv4&lt;/h3>
&lt;h4 id="настройка-узлов">&lt;span class="section-num">2.1.1&lt;/span> Настройка узлов&lt;/h4>
&lt;ul>
&lt;li>Руководствуясь таблицей адресации, настройте IPv4-адресацию для узлов PC1, PC2, Server:
&lt;ul>
&lt;li>&lt;code>PC1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip 172.16.20.10/25 172.16.20.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>PC2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip 172.16.20.138/25 172.16.20.129
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>Server&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip 64.100.1.10/24 64.100.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Проверьте конфигурацию IPv4 на узлах:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show ip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="настройка-маршрутизатора">&lt;span class="section-num">2.1.2&lt;/span> Настройка маршрутизатора&lt;/h4>
&lt;ul>
&lt;li>Руководствуясь таблицей адресации, настройте IPv4-адресацию для интерфейсов локальной сети маршрутизатора &lt;code>gw-01&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Router# configure terminal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Router(config)# hostname gw-01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01# write memory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01# configure terminal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config)# interface eth0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config-if)# ip address 172.16.20.1/25
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config-if)# no shutdown
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config-if)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config)# interface eth1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config-if)# ip address 172.16.20.129/25
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config-if)# no shutdown
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config-if)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config)# interface eth2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config-if)# ip address 64.100.1.1/24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config-if)# no shutdown
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config-if)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01(config)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01# write memory
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте конфигурацию маршрутизатора и настройки IPv4-адресации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">gw-01# show running-config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-01# show interface brief
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="проверка-подключения">&lt;span class="section-num">2.1.3&lt;/span> Проверка подключения&lt;/h4>
&lt;ul>
&lt;li>Проверьте подключение. Узлы PC1 и PC2 должны успешно отправлять эхо-запросы друг другу и на сервер с двойным стеком (Dual Stack Server).&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-адресации-ipv6">&lt;span class="section-num">2.2&lt;/span> Настройка адресации IPv6&lt;/h3>
&lt;h4 id="настройка-узлов">&lt;span class="section-num">2.2.1&lt;/span> Настройка узлов&lt;/h4>
&lt;ul>
&lt;li>Руководствуясь таблицей адресации, настройте IPv6-адресацию для узлов PC3, PC4, Server:
&lt;ul>
&lt;li>&lt;code>PC3&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip 2001:db8:c0de:12::a/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>PC4&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip 2001:db8:c0de:13::a/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>Server&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip 2001:db8:c0de:11::a/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Проверьте конфигурацию IPv6 на узлах:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show ipv6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="настройка-маршрутизатора">&lt;span class="section-num">2.2.2&lt;/span> Настройка маршрутизатора&lt;/h4>
&lt;ul>
&lt;li>Назначьте IPv6-адреса маршрутизатору &lt;code>gw-02&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Router&amp;gt;enable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Router# configure terminal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Router(config)# hostname gw-02
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02# write memory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02# configure terminal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config)# interface eth0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# ipv6 address 2001:db8:c0de:12::1/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# no ipv6 nd suppress-ra
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# ipv6 nd prefix 2001:db8:c0de:12::/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# no shutdown
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02# configure terminal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config)# interface eth1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# ipv6 address 2001:db8:c0de:13::1/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# no ipv6 nd suppress-ra
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# ipv6 nd prefix 2001:db8:c0de:13::/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# no shutdown
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02# configure terminal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config)# interface eth2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# ipv6 address 2001:db8:c0de:11::1/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# no ipv6 nd suppress-ra
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# ipv6 nd prefix 2001:db8:c0de:11::/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# no shutdown
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config-if)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config)# ipv6 forwarding
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02(config)# exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02# write memory
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте конфигурацию маршрутизатора и настройки IPv6-адресации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">gw-02# show running-config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gw-02# show interface brief
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте интерфейсы, на которых рассылается сообщение о маршрутизаторе (&lt;em>Router Advertisement&lt;/em>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">gw-02# show ipv6 nd ra-interfaces
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="проверка-подключения">&lt;span class="section-num">2.2.3&lt;/span> Проверка подключения&lt;/h4>
&lt;ul>
&lt;li>Проверьте подключение. Узлы PC3 и PC4 должны успешно отправлять эхо-запросы друг другу и на сервер с двойным стеком (Dual Stack Server).&lt;/li>
&lt;/ul>
&lt;h2 id="видео-адресация-ipv4-и-ipv6-dot-двойной-стек">&lt;span class="section-num">3&lt;/span> Видео: Адресация IPv4 и IPv6. Двойной стек&lt;/h2>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-bcfaed" data-toggle="tab" href="#bcfaed"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-acdfeb" data-toggle="tab" href="#acdfeb"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="bcfaed" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/440cf57b3d880ed66dcfcb31ce469df3"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="acdfeb" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/7GYg0MC2NGI?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Туннель ipv6-ipv4</title><link>https://yamadharma.github.io/ru/course/nettech/tunnel-ipv6-ipv4/</link><pubDate>Thu, 14 Jul 2022 16:27:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/nettech/tunnel-ipv6-ipv4/</guid><description>&lt;p>Настройка туннеля ipv6-ipv4.&lt;/p>
&lt;h2 id="цель">&lt;span class="section-num">1&lt;/span> Цель&lt;/h2>
&lt;ul>
&lt;li>Ознакомиться с использованием сетевых туннелей.&lt;/li>
&lt;/ul>
&lt;h2 id="дополнительные-сведения">&lt;span class="section-num">2&lt;/span> Дополнительные сведения&lt;/h2>
&lt;h3 id="6in4--sit">&lt;span class="section-num">2.1&lt;/span> 6in4 (sit)&lt;/h3>
&lt;ul>
&lt;li>6in4 использует туннелирование для инкапсуляции трафика IPv6 в трафик IPv4.&lt;/li>
&lt;li>Определён в RFC 4213.&lt;/li>
&lt;li>Трафик 6in4 отправляется внутри пакетов IPv4, в заголовках IP которых номер протокола IP установлен на 41.&lt;/li>
&lt;li>Накладные расходы инкапсуляции &amp;mdash; это размер заголовка IPv4 в 20 байт, поэтому при MTU 1500 байт пакеты IPv6 размером 1480 байт можно отправлять без фрагментации.&lt;/li>
&lt;li>Этот метод туннелирования часто используется брокерами туннелей IPv6 (например, Hurricane Electric).&lt;/li>
&lt;/ul>
&lt;h2 id="задание">&lt;span class="section-num">3&lt;/span> Задание&lt;/h2>
&lt;h3 id="схема-сети">&lt;span class="section-num">3.1&lt;/span> Схема сети&lt;/h3>
&lt;figure id="figure-105610801089-1-схема-сети">
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://yamadharma.github.io/ox-hugo/20220714162700-topology.png" alt="&amp;amp;#1056;&amp;amp;#1080;&amp;amp;#1089;. 1.: Схема сети" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;figcaption>
&lt;span class="figure-number">Рис. 1.: &lt;/span>Схема сети
&lt;/figcaption>&lt;/figure>
&lt;h3 id="адреса-сетей">&lt;span class="section-num">3.2&lt;/span> Адреса сетей&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Хост&lt;/th>
&lt;th>Интерфейс&lt;/th>
&lt;th>Адрес&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>R1&lt;/td>
&lt;td>eth0&lt;/td>
&lt;td>1000::1/64&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>R1&lt;/td>
&lt;td>eth1&lt;/td>
&lt;td>10.0.0.1/255.0.0.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>R1&lt;/td>
&lt;td>Tunnel0&lt;/td>
&lt;td>1001::1/64&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>R2&lt;/td>
&lt;td>eth0&lt;/td>
&lt;td>1002::1/64&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>R2&lt;/td>
&lt;td>eth1&lt;/td>
&lt;td>20.0.0.2/255.0.0.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>R2&lt;/td>
&lt;td>Tunnel0&lt;/td>
&lt;td>1001::2/64&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>R3&lt;/td>
&lt;td>eth0&lt;/td>
&lt;td>10.0.0.2/255.0.0.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>R3&lt;/td>
&lt;td>eth1&lt;/td>
&lt;td>20.0.0.1/255.0.0.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC1&lt;/td>
&lt;td>&lt;/td>
&lt;td>1000::a/64&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC2&lt;/td>
&lt;td>&lt;/td>
&lt;td>1002::a/64&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="выполнение-работы">&lt;span class="section-num">4&lt;/span> Выполнение работы&lt;/h2>
&lt;h3 id="конфигурация-адресации">&lt;span class="section-num">4.1&lt;/span> Конфигурация адресации&lt;/h3>
&lt;h4 id="настройка-узлов">&lt;span class="section-num">4.1.1&lt;/span> Настройка узлов&lt;/h4>
&lt;ul>
&lt;li>&lt;code>PC1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip 1000::a/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>PC2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip 1002::a/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте конфигурацию IPv6 на узлах:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show ipv6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="настройка-маршрутизаторов">&lt;span class="section-num">4.1.2&lt;/span> Настройка маршрутизаторов&lt;/h4>
&lt;ul>
&lt;li>&lt;code>R1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R1:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# &lt;span class="nb">set&lt;/span> interfaces ethernet eth0 address 1000::1/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# &lt;span class="nb">set&lt;/span> interfaces ethernet eth1 address 10.0.0.1/8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# &lt;span class="nb">set&lt;/span> service router-advert interface eth0 prefix 1000::/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>R2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R2:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# &lt;span class="nb">set&lt;/span> interfaces ethernet eth0 address 1002::1/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# &lt;span class="nb">set&lt;/span> interfaces ethernet eth1 address 20.0.0.2/8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# &lt;span class="nb">set&lt;/span> service router-advert interface eth0 prefix 1002::/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>R3&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R3:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R3# &lt;span class="nb">set&lt;/span> interfaces ethernet eth0 address 10.0.0.2/8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R3# &lt;span class="nb">set&lt;/span> interfaces ethernet eth1 address 20.0.0.1/8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R3# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R3# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте маршруты:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R1:~$ ping 10.0.0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1:~$ ping 20.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1:~$ ping 20.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="конфигурация-маршрутизации-ipv4">&lt;span class="section-num">4.2&lt;/span> Конфигурация маршрутизации IPv4&lt;/h3>
&lt;ul>
&lt;li>&lt;code>R1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R1:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# &lt;span class="nb">set&lt;/span> protocols rip network 10.0.0.0/8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>R2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R2:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# &lt;span class="nb">set&lt;/span> protocols rip network 20.0.0.0/8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>R3&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R3:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R3# &lt;span class="nb">set&lt;/span> protocols rip network 10.0.0.0/8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R3# &lt;span class="nb">set&lt;/span> protocols rip network 20.0.0.0/8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R3# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R3# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте маршруты:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R1:~$ ping 10.0.0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1:~$ ping 20.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1:~$ ping 20.0.0.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="создайте-туннель-ipv6-через-сеть-ipv4">&lt;span class="section-num">4.3&lt;/span> Создайте туннель IPv6 через сеть IPv4&lt;/h3>
&lt;ul>
&lt;li>&lt;code>R1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R1:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# &lt;span class="nb">set&lt;/span> interfaces tunnel tun0 encapsulation sit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# &lt;span class="nb">set&lt;/span> interfaces tunnel tun0 source-address 10.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# &lt;span class="nb">set&lt;/span> interfaces tunnel tun0 remote 20.0.0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# &lt;span class="nb">set&lt;/span> interfaces tunnel tun0 address 1001::1/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>R2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R2:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# &lt;span class="nb">set&lt;/span> interfaces tunnel tun0 encapsulation sit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# &lt;span class="nb">set&lt;/span> interfaces tunnel tun0 source-address 20.0.0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# &lt;span class="nb">set&lt;/span> interfaces tunnel tun0 remote 10.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# &lt;span class="nb">set&lt;/span> interfaces tunnel tun0 address 1001::2/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="конфигурация-статической-маршрутизации-ipv6">&lt;span class="section-num">4.4&lt;/span> Конфигурация статической маршрутизации IPv6&lt;/h3>
&lt;ul>
&lt;li>&lt;code>R1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R1:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# &lt;span class="nb">set&lt;/span> protocols static route6 1002::0/64 next-hop 1001::2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R1# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>R2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@R2:~$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# &lt;span class="nb">set&lt;/span> protocols static route6 1000::0/64 next-hop 1001::1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@R2# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="проверка">&lt;span class="section-num">4.5&lt;/span> Проверка&lt;/h3>
&lt;ul>
&lt;li>&lt;code>PC1&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">PC1&amp;gt; ping 1002::a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PC1&amp;gt; trace 1002::a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>PC2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">PC2&amp;gt; ping 1000::a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PC2&amp;gt; trace 1000::a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="видео-туннель-ipv6-ipv4">&lt;span class="section-num">5&lt;/span> Видео: Туннель ipv6-ipv4&lt;/h2>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-acebfd" data-toggle="tab" href="#acebfd"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-acebfd" data-toggle="tab" href="#acebfd"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="acebfd" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/4af0cfdef4f35b000aefcc283c9865c0"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="acebfd" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/a0x0Ibyt7uE?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>NetBox. Плагины</title><link>https://yamadharma.github.io/ru/post/2024/07/22/netbox-plugins/</link><pubDate>Mon, 22 Jul 2024 17:45:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/07/22/netbox-plugins/</guid><description>&lt;p>Плагины NetBox.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-плагинов">&lt;span class="section-num">2&lt;/span> Установка плагинов&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установите-пакет-python">&lt;span class="section-num">2.1&lt;/span> Установите пакет Python&lt;/a>&lt;/li>
&lt;li>&lt;a href="#включите-плагин">&lt;span class="section-num">2.2&lt;/span> Включите плагин&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройте-плагин">&lt;span class="section-num">2.3&lt;/span> Настройте плагин&lt;/a>&lt;/li>
&lt;li>&lt;a href="#запустите-миграцию-базы-данных">&lt;span class="section-num">2.4&lt;/span> Запустите миграцию базы данных&lt;/a>&lt;/li>
&lt;li>&lt;a href="#статические-файлы">&lt;span class="section-num">2.5&lt;/span> Статические файлы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#перезапустите-службу-wsgi">&lt;span class="section-num">2.6&lt;/span> Перезапустите службу WSGI&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#удаление-плагинов">&lt;span class="section-num">3&lt;/span> Удаление плагинов&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#отключите-плагин">&lt;span class="section-num">3.1&lt;/span> Отключите плагин&lt;/a>&lt;/li>
&lt;li>&lt;a href="#удалите-конфигурацию">&lt;span class="section-num">3.2&lt;/span> Удалите конфигурацию&lt;/a>&lt;/li>
&lt;li>&lt;a href="#переиндексируйте-записи-поиска">&lt;span class="section-num">3.3&lt;/span> Переиндексируйте записи поиска&lt;/a>&lt;/li>
&lt;li>&lt;a href="#удалите-пакет-python">&lt;span class="section-num">3.4&lt;/span> Удалите пакет Python&lt;/a>&lt;/li>
&lt;li>&lt;a href="#перезапустите-службу-wsgi">&lt;span class="section-num">3.5&lt;/span> Перезапустите службу WSGI&lt;/a>&lt;/li>
&lt;li>&lt;a href="#удалите-таблицы-базы-данных">&lt;span class="section-num">3.6&lt;/span> Удалите таблицы базы данных&lt;/a>&lt;/li>
&lt;li>&lt;a href="#удалите-записи-миграции-django">&lt;span class="section-num">3.7&lt;/span> Удалите записи миграции Django&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Основные плагины: &lt;a href="https://netboxlabs.com/netbox-plugins/" target="_blank" rel="noopener">https://netboxlabs.com/netbox-plugins/&lt;/a>&lt;/li>
&lt;li>Плагины NetBox являются приложениями Django.&lt;/li>
&lt;li>Плагины могут добавлять свои собственные модели и представления, но не могут вмешиваться в работу существующих компонентов.&lt;/li>
&lt;li>Архитектура плагинов NetBox позволяет следующее:
&lt;ul>
&lt;li>добавлять новые модели данных;&lt;/li>
&lt;li>добавлять новые URL-адреса и представления.
&lt;ul>
&lt;li>могут регистрировать URL-адреса &lt;code>/plugins&lt;/code> для предоставления пользователям возможности просмотра;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>добавлять контент в существующие шаблоны моделей;&lt;/li>
&lt;li>добавлять пункты в меню навигации;&lt;/li>
&lt;li>добавлять собственное промежуточное программное обеспечение;&lt;/li>
&lt;li>объявлять параметры конфигурации;
&lt;ul>
&lt;li>параметры конфигурации определяются пользователем в разделе &lt;code>PLUGINS_CONFIG&lt;/code> в &lt;code>configuration.py&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="установка-плагинов">&lt;span class="section-num">2&lt;/span> Установка плагинов&lt;/h2>
&lt;h3 id="установите-пакет-python">&lt;span class="section-num">2.1&lt;/span> Установите пакет Python&lt;/h3>
&lt;ul>
&lt;li>Загрузите и установите пакет Python плагина, следуя инструкциям по установке.&lt;/li>
&lt;li>Плагины, публикуемые через PyPI, обычно устанавливаются с помощью утилиты &lt;code>pip&lt;/code> командной строки.&lt;/li>
&lt;li>Обязательно установите плагин в виртуальной среде NetBox.
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">source&lt;/span> /opt/netbox/venv/bin/activate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>venv&lt;span class="o">)&lt;/span> $ pip install &amp;lt;package&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Альтернативно, можно установить плагин вручную:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">python setup.py install
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="включите-плагин">&lt;span class="section-num">2.2&lt;/span> Включите плагин&lt;/h3>
&lt;ul>
&lt;li>В &lt;code>configuration.py&lt;/code> добавьте имя плагина в список &lt;code>PLUGINS&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="l">PLUGINS = [&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># ...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;plugin_name&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройте-плагин">&lt;span class="section-num">2.3&lt;/span> Настройте плагин&lt;/h3>
&lt;ul>
&lt;li>Если плагин требует какой-либо настройки, задайте её в &lt;code>configuration.py&lt;/code> в параметре &lt;code>PLUGINS_CONFIG&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="l">PLUGINS_CONFIG = {&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;#39;plugin_name&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>{&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;#39;foo&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;bar&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;#39;buzz&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;bazz&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>}&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>}&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="запустите-миграцию-базы-данных">&lt;span class="section-num">2.4&lt;/span> Запустите миграцию базы данных&lt;/h3>
&lt;ul>
&lt;li>Если плагин вводит новые модели базы данных, выполните миграцию схемы:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>venv&lt;span class="o">)&lt;/span> $ &lt;span class="nb">cd&lt;/span> /opt/netbox/netbox/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>venv&lt;span class="o">)&lt;/span> $ python3 manage.py migrate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="статические-файлы">&lt;span class="section-num">2.5&lt;/span> Статические файлы&lt;/h3>
&lt;ul>
&lt;li>Плагины могут упаковывать статические ресурсы, такие как изображения или скрипты, для непосредственного обслуживания HTTP-интерфейсом.&lt;/li>
&lt;li>Убедитесь, что они скопированы в статический корневой каталог с именем &lt;code>collectstatic&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>venv&lt;span class="o">)&lt;/span> $ &lt;span class="nb">cd&lt;/span> /opt/netbox/netbox/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>venv&lt;span class="o">)&lt;/span> $ python3 manage.py collectstatic
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="перезапустите-службу-wsgi">&lt;span class="section-num">2.6&lt;/span> Перезапустите службу WSGI&lt;/h3>
&lt;ul>
&lt;li>Перезапустите службу WSGI:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl restart netbox netbox-rq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="удаление-плагинов">&lt;span class="section-num">3&lt;/span> Удаление плагинов&lt;/h2>
&lt;h3 id="отключите-плагин">&lt;span class="section-num">3.1&lt;/span> Отключите плагин&lt;/h3>
&lt;ul>
&lt;li>Отключите плагин, удалив его из списка &lt;code>PLUGINS&lt;/code> список в &lt;code>configuration.py&lt;/code> .&lt;/li>
&lt;/ul>
&lt;h3 id="удалите-конфигурацию">&lt;span class="section-num">3.2&lt;/span> Удалите конфигурацию&lt;/h3>
&lt;ul>
&lt;li>Удалите запись о плагине в словаре &lt;code>PLUGINS_CONFIG&lt;/code> в &lt;code>configuration.py&lt;/code> .&lt;/li>
&lt;/ul>
&lt;h3 id="переиндексируйте-записи-поиска">&lt;span class="section-num">3.3&lt;/span> Переиндексируйте записи поиска&lt;/h3>
&lt;ul>
&lt;li>Запустите команду &lt;code>reindex&lt;/code> для переиндексации глобальной поисковой системы.&lt;/li>
&lt;li>Это удалит все устаревшие записи, относящиеся к объектам, предоставляемым плагином:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt/netbox/netbox/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">source&lt;/span> /opt/netbox/venv/bin/activate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>venv&lt;span class="o">)&lt;/span> $ python3 manage.py reindex
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="удалите-пакет-python">&lt;span class="section-num">3.4&lt;/span> Удалите пакет Python&lt;/h3>
&lt;ul>
&lt;li>Используйте &lt;code>pip&lt;/code>, чтобы удалить установленный плагин:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">source&lt;/span> /opt/netbox/venv/bin/activate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>venv&lt;span class="o">)&lt;/span> $ pip uninstall &amp;lt;package&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="перезапустите-службу-wsgi">&lt;span class="section-num">3.5&lt;/span> Перезапустите службу WSGI&lt;/h3>
&lt;ul>
&lt;li>Перезапустите службу WSGI:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl restart netbox
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="удалите-таблицы-базы-данных">&lt;span class="section-num">3.6&lt;/span> Удалите таблицы базы данных&lt;/h3>
&lt;ul>
&lt;li>Этот шаг необходим только для плагинов, которые создали одну или несколько таблиц базы данных.&lt;/li>
&lt;li>Войдите в оболочку базы данных PostgreSQL (&lt;code>manage.py dbshell&lt;/code>), чтобы определить, создал ли плагин какие-либо таблицы SQL.&lt;/li>
&lt;li>Можно запустить командe &lt;code>\dt&lt;/code> без шаблона для вывода списка всех таблиц.
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">netbox&lt;/span>&lt;span class="o">=&lt;/span>&amp;gt; &lt;span class="se">\d&lt;/span>t pluginname_*
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Удалите каждую из перечисленных таблиц:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">netbox&lt;/span>&lt;span class="o">=&lt;/span>&amp;gt; DROP TABLE pluginname_foo&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">netbox&lt;/span>&lt;span class="o">=&lt;/span>&amp;gt; DROP TABLE pluginname_bar&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="удалите-записи-миграции-django">&lt;span class="section-num">3.7&lt;/span> Удалите записи миграции Django&lt;/h3>
&lt;ul>
&lt;li>После удаления таблиц, созданных плагином, миграции, создавшие эти таблицы, также необходимо удалить из истории миграции Django.&lt;/li>
&lt;li>Это необходимо для того, чтобы иметь возможность переустановить плагин позже.&lt;/li>
&lt;li>Если бы история миграции осталась на месте, Django пропустил бы все миграции, которые были выполнены в ходе предыдущей установки, что привело бы к сбою плагина после переустановки.
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">netbox&lt;/span>&lt;span class="o">=&lt;/span>&amp;gt; SELECT * FROM django_migrations WHERE &lt;span class="nv">app&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;pluginname&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">netbox&lt;/span>&lt;span class="o">=&lt;/span>&amp;gt; DELETE FROM django_migrations WHERE &lt;span class="nv">app&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;pluginname&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Почтовый клиент aerc</title><link>https://yamadharma.github.io/ru/post/2024/07/17/email-client-aerc/</link><pubDate>Wed, 17 Jul 2024 18:55:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/07/17/email-client-aerc/</guid><description>&lt;p>Консольный почтовый клиент aerc.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#основные-команды">&lt;span class="section-num">3&lt;/span> Основные команды&lt;/a>&lt;/li>
&lt;li>&lt;a href="#полезное">&lt;span class="section-num">4&lt;/span> Полезное&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#формате-html">&lt;span class="section-num">4.1&lt;/span> Формате HTML&lt;/a>&lt;/li>
&lt;li>&lt;a href="#адресная-книга-vcard">&lt;span class="section-num">4.2&lt;/span> Адресная книга VCARD&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://aerc-mail.org/" target="_blank" rel="noopener">https://aerc-mail.org/&lt;/a>&lt;/li>
&lt;li>Репозиторий:
&lt;ul>
&lt;li>&lt;a href="https://git.sr.ht/~rjarry/aerc" target="_blank" rel="noopener">https://git.sr.ht/~rjarry/aerc&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/rjarry/aerc" target="_blank" rel="noopener">https://github.com/rjarry/aerc&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Сочетания клавиш в стиле Vim.&lt;/li>
&lt;li>Поддержка нескольких учетных записей: IMAP, Maildir, Notmuch, Mbox и JMAP.&lt;/li>
&lt;li>Протоколы передачи: IMAP, JMAP, SMTP, sendmail.&lt;/li>
&lt;li>Асинхронная поддержка IMAP и JMAP.&lt;/li>
&lt;li>Подписание, шифрование и проверка PGP с помощью GNUpg.&lt;/li>
&lt;/ul>
&lt;h2 id="установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/h2>
&lt;ul>
&lt;li>Gentoo:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge mail-client/aerc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="основные-команды">&lt;span class="section-num">3&lt;/span> Основные команды&lt;/h2>
&lt;ul>
&lt;li>Перемещение между электронными письмами: &lt;code>j&lt;/code>, &lt;code>k&lt;/code>, &lt;code>Page up&lt;/code>, &lt;code>Page down&lt;/code>, стрелки, &lt;code>gg&lt;/code>, &lt;code>G&lt;/code>.&lt;/li>
&lt;li>Перемещение между папками: &lt;code>Shift+j&lt;/code>, &lt;code>Shift+k&lt;/code>.&lt;/li>
&lt;li>Просмотр электронной почты: &lt;code>Enter&lt;/code>.&lt;/li>
&lt;li>Вернуться к списку адресов электронной почты: &lt;code>q&lt;/code>.&lt;/li>
&lt;li>Удалить электронную почту: &lt;code>:delete&lt;/code>.&lt;/li>
&lt;li>Написать электронное письмо: &lt;code>C&lt;/code>.&lt;/li>
&lt;li>Отправить письмо: &lt;code>:q&lt;/code>.&lt;/li>
&lt;li>Ответ: &lt;code>Rr&lt;/code>.&lt;/li>
&lt;li>Ответить всем: &lt;code>rr&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h2 id="полезное">&lt;span class="section-num">4&lt;/span> Полезное&lt;/h2>
&lt;h3 id="формате-html">&lt;span class="section-num">4.1&lt;/span> Формате HTML&lt;/h3>
&lt;ul>
&lt;li>В электронных письмах в формате HTML будут отображаться теги HTML.&lt;/li>
&lt;li>Для рендеринга используется броузер w3.&lt;/li>
&lt;li>Добавьте строку в &lt;code>$XDG_CONFIG_HOME/aerc/aerc.conf&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">text/html=/usr/bin/w3m -T text/html -o display_link_number=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="адресная-книга-vcard">&lt;span class="section-num">4.2&lt;/span> Адресная книга VCARD&lt;/h3>
&lt;ul>
&lt;li>Используйте &lt;code>khard&lt;/code>.&lt;/li>
&lt;li>Настройте в &lt;code>$XDG_CONFIG_HOME/aerc/aerc.conf&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[compose]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">address-book-cmd=khard email --parsable --remove-first-line %s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Перепрошивка точки доступа Cisco Aironet</title><link>https://yamadharma.github.io/ru/post/2024/07/03/flashing-cisco-aironet/</link><pubDate>Wed, 03 Jul 2024 12:00:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/07/03/flashing-cisco-aironet/</guid><description>&lt;p>Перепрошивка точки доступа Cisco Aironet.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#версии-образа-системы">&lt;span class="section-num">1.1&lt;/span> Версии образа системы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#отличия-прошивок">&lt;span class="section-num">1.2&lt;/span> Отличия прошивок&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#подготовка-к-обновлению-программного-обеспечения">&lt;span class="section-num">2&lt;/span> Подготовка к обновлению программного обеспечения&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#сброс-настроек">&lt;span class="section-num">2.1&lt;/span> Сброс настроек&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#перевод-из-облегчённого-режима-в-автономный">&lt;span class="section-num">3&lt;/span> Перевод из облегчённого режима в автономный&lt;/a>&lt;/li>
&lt;li>&lt;a href="#перевод-из-автономного-режима-в-облегчённый">&lt;span class="section-num">4&lt;/span> Перевод из автономного режима в облегчённый&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Точки доступа Cisco могут работать в двух режимах:
&lt;ul>
&lt;li>Autonomous AP IOS Software;
&lt;ul>
&lt;li>автономная точка доступа;&lt;/li>
&lt;li>управляется самостоятельно по http/https или telnet/ssh.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Lightweight AP IOS Software:
&lt;ul>
&lt;li>точка доступа управляется с WLC с контроллера беспроводной сети Cisco (см. &lt;a href="https://yamadharma.github.io/ru/post/2023/03/03/cisco-wlc/">Контроллер Cisco WLC&lt;/a>).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="версии-образа-системы">&lt;span class="section-num">1.1&lt;/span> Версии образа системы&lt;/h3>
&lt;ul>
&lt;li>Выясните версию IOS:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В имени файла закодированы параметры образа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">&amp;lt;модель_точки&amp;gt;-&amp;lt;функции&amp;gt;-tar.&amp;lt;версия&amp;gt;.tar
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В поле функция указан вариант образа:
&lt;ul>
&lt;li>легковесная точка доступа:
&lt;ul>
&lt;li>&lt;code>k9w8&lt;/code>;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>автономная точка доступа:
&lt;ul>
&lt;li>&lt;code>k9w7&lt;/code>;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>облегченный образ для восстановления:
&lt;ul>
&lt;li>&lt;code>rcvk9w8&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="отличия-прошивок">&lt;span class="section-num">1.2&lt;/span> Отличия прошивок&lt;/h3>
&lt;ul>
&lt;li>У легковесной прошивки:
&lt;ul>
&lt;li>нет режима &lt;code>configure terminal&lt;/code>;&lt;/li>
&lt;li>нет команды &lt;code>archive&lt;/code> для обновления прошивки.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="подготовка-к-обновлению-программного-обеспечения">&lt;span class="section-num">2&lt;/span> Подготовка к обновлению программного обеспечения&lt;/h2>
&lt;h3 id="сброс-настроек">&lt;span class="section-num">2.1&lt;/span> Сброс настроек&lt;/h3>
&lt;ul>
&lt;li>Зажимаем на точке доступа кнопку &lt;code>Mode&lt;/code>, включаем питание.&lt;/li>
&lt;li>Удерживаем кнопку нажатой ~ 30с, пока светодиод на точке не загорится красным.&lt;/li>
&lt;li>Отпускаем кнопку, светодиод мигает зелёным.&lt;/li>
&lt;li>Учётные данные по умолчанию:
&lt;ul>
&lt;li>логин: &lt;code>cisco&lt;/code>;&lt;/li>
&lt;li>пароль: &lt;code>Cisco&lt;/code>;&lt;/li>
&lt;li>enable: &lt;code>Cisco&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="перевод-из-облегчённого-режима-в-автономный">&lt;span class="section-num">3&lt;/span> Перевод из облегчённого режима в автономный&lt;/h2>
&lt;ul>
&lt;li>Подключиться к точке доступа по консольному кабелю.&lt;/li>
&lt;li>Войдите в режим конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">debug capwap console cli
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обновим прошивку:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">archive tar /xtract tftp://10.10.1.4/ap1g1-k9w7-tar.153-3.JK.tar flash:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Удалим старую прошивку:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">del /force /recursive flash:/ap1g1-k9w8-mx.153-3.JK
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перезагружаем точку доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="перевод-из-автономного-режима-в-облегчённый">&lt;span class="section-num">4&lt;/span> Перевод из автономного режима в облегчённый&lt;/h2>
&lt;ul>
&lt;li>Подключиться к точке доступа по консольному кабелю.&lt;/li>
&lt;li>Войдите в режим конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">configure terminal
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обновим прошивку:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">archive tar /xtract tftp://10.10.1.4/ap3g2-rcvk9w8-tar.153-3.JF11.tar flash:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Удалим старую прошивку:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">del /force /recursive flash:/ap3g2-rcvk9w7-tar.153-3.JF11.tar
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перезагружаем точку доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>NetBox. Установка</title><link>https://yamadharma.github.io/ru/post/2024/06/19/netbox-install/</link><pubDate>Wed, 19 Jun 2024 18:13:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/06/19/netbox-install/</guid><description>&lt;p>Установка NetBox.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#системные-требования">&lt;span class="section-num">1&lt;/span> Системные требования&lt;/a>&lt;/li>
&lt;li>&lt;a href="#предварительная-подготовка">&lt;span class="section-num">2&lt;/span> Предварительная подготовка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-компонент">&lt;span class="section-num">3&lt;/span> Установка компонент&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#python">&lt;span class="section-num">3.1&lt;/span> Python&lt;/a>&lt;/li>
&lt;li>&lt;a href="#postgres">&lt;span class="section-num">3.2&lt;/span> Postgres&lt;/a>&lt;/li>
&lt;li>&lt;a href="#redis">&lt;span class="section-num">3.3&lt;/span> Redis&lt;/a>&lt;/li>
&lt;li>&lt;a href="#netbox">&lt;span class="section-num">3.4&lt;/span> NetBox&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#предварительная-установка-netbox">&lt;span class="section-num">3.4.1&lt;/span> Предварительная установка NetBox&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурация-netbox">&lt;span class="section-num">3.4.2&lt;/span> Конфигурация Netbox&lt;/a>&lt;/li>
&lt;li>&lt;a href="#развёртывание-netbox">&lt;span class="section-num">3.4.3&lt;/span> Развёртывание NetBox&lt;/a>&lt;/li>
&lt;li>&lt;a href="#суперпользователь">&lt;span class="section-num">3.4.4&lt;/span> Суперпользователь&lt;/a>&lt;/li>
&lt;li>&lt;a href="#планирование-очистки-рабочей-среды">&lt;span class="section-num">3.4.5&lt;/span> Планирование очистки рабочей среды&lt;/a>&lt;/li>
&lt;li>&lt;a href="#брандмауэр">&lt;span class="section-num">3.4.6&lt;/span> Брандмауэр&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#gunicorn">&lt;span class="section-num">3.5&lt;/span> Gunicorn&lt;/a>&lt;/li>
&lt;li>&lt;a href="#http-сервер">&lt;span class="section-num">3.6&lt;/span> HTTP-сервер&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#nginx">&lt;span class="section-num">3.6.1&lt;/span> Nginx&lt;/a>&lt;/li>
&lt;li>&lt;a href="#ssl-сертификат">&lt;span class="section-num">3.6.2&lt;/span> SSL-сертификат&lt;/a>&lt;/li>
&lt;li>&lt;a href="#selinux">&lt;span class="section-num">3.6.3&lt;/span> SELinux&lt;/a>&lt;/li>
&lt;li>&lt;a href="#брандмауэр">&lt;span class="section-num">3.6.4&lt;/span> Брандмауэр&lt;/a>&lt;/li>
&lt;li>&lt;a href="#запуск-http-сервера">&lt;span class="section-num">3.6.5&lt;/span> Запуск http-сервера&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#установка-https-сертификата-letsencrypt">&lt;span class="section-num">3.7&lt;/span> Установка https-сертификата LetsEncrypt&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка-certbot">&lt;span class="section-num">3.7.1&lt;/span> Установка &lt;em>certbot&lt;/em>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сервер-nginx">&lt;span class="section-num">3.7.2&lt;/span> Сервер &lt;em>Nginx&lt;/em>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурационный-файл-nginx">&lt;span class="section-num">3.7.3&lt;/span> Конфигурационный файл &lt;em>Nginx&lt;/em>&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="системные-требования">&lt;span class="section-num">1&lt;/span> Системные требования&lt;/h2>
&lt;h2 id="предварительная-подготовка">&lt;span class="section-num">2&lt;/span> Предварительная подготовка&lt;/h2>
&lt;ul>
&lt;li>Будем устанавливать на отдельную операционную систему.&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/08/12/rockylinux-server-installation/">Rocky Linux. Установка сервера&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="установка-компонент">&lt;span class="section-num">3&lt;/span> Установка компонент&lt;/h2>
&lt;h3 id="python">&lt;span class="section-num">3.1&lt;/span> Python&lt;/h3>
&lt;ul>
&lt;li>Установим python-3.12:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install python3.12 python3.12-devel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавим варианты python в список альтернатив:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">alternatives --install /usr/bin/python python /usr/bin/python3.9 &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">alternatives --install /usr/bin/python python /usr/bin/python3.12 &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Выберем необходимую версию python:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">alternatives --config python
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="postgres">&lt;span class="section-num">3.2&lt;/span> Postgres&lt;/h3>
&lt;ul>
&lt;li>Версии, которая идёт в комплекте с дистрибутивом, достаточно.&lt;/li>
&lt;li>Но лучше установить версию поновее.&lt;/li>
&lt;li>Смотрим, какие версии в наличии:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf module list postgresql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установим postgresql-16:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf module -y install postgresql:16
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте установленную версию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">postgres -V
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Инициализируем базу данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">postgresql-setup --initdb --unit postgresql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверим, что в &lt;code>/var/lib/pgsql/data/postgresql.conf&lt;/code> установлен алгоритм шифрования:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">password_encryption = scram-sha-256
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Замените параметры внутреннего подключения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sed -i -e &lt;span class="s1">&amp;#39;s/^\(host[ ]*all.*\)ident/\1scram-sha-256/&amp;#39;&lt;/span> /var/lib/pgsql/data/pg_hba.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустим postgres:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now postgresql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Подключимся к базе данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -u postgres psql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим базу данных (укажите необходимый пароль):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DATABASE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">netbox&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">USER&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">netbox&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">WITH&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">PASSWORD&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;&amp;lt;password&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">ALTER&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DATABASE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">netbox&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">OWNER&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TO&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">netbox&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="k">connect&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">netbox&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">GRANT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">ON&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">SCHEMA&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TO&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">netbox&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте подключение к базе данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">psql --username netbox --password --host localhost netbox
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После подключения посмотрите параметры соединения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="err">\&lt;/span>&lt;span class="n">conninfo&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="redis">&lt;span class="section-num">3.3&lt;/span> Redis&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Redis &amp;mdash; быстрое хранилище данных типа ключ‑значение в памяти.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>С 2024 года сменила лицензию на SSPL (закрытую).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Установим redis:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install redis
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Запустим redis:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now redis
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Проверим, что сервер работает:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">redis-cli ping
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>В качестве ответа должен быть &lt;code>PONG&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="netbox">&lt;span class="section-num">3.4&lt;/span> NetBox&lt;/h3>
&lt;h4 id="предварительная-установка-netbox">&lt;span class="section-num">3.4.1&lt;/span> Предварительная установка NetBox&lt;/h4>
&lt;ul>
&lt;li>Установим необходимое программное обеспечение:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install gcc libxml2-devel libxslt-devel libffi-devel libpq-devel openssl-devel redhat-rpm-config git
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Клонируем репозиторий:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p /opt/netbox/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt/netbox
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone -b master --depth &lt;span class="m">1&lt;/span> https://github.com/netbox-community/netbox.git .
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим нового системного пользователя:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">groupadd --system netbox
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">adduser --system -m -g netbox netbox
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R netbox:netbox /opt/netbox
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown --recursive netbox /opt/netbox/netbox/media/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown --recursive netbox /opt/netbox/netbox/reports/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown --recursive netbox /opt/netbox/netbox/scripts/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="конфигурация-netbox">&lt;span class="section-num">3.4.2&lt;/span> Конфигурация Netbox&lt;/h4>
&lt;ul>
&lt;li>Создадим файл конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt/netbox/netbox/netbox/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp configuration_example.py configuration.py
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сконфигурим необходимые параметры.&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>ALLOWED_HOSTS&lt;/p>
&lt;ul>
&lt;li>Список допустимых имен хостов и IP-адресов, по которым можно связаться с этим сервером (имя вашего сервера).&lt;/li>
&lt;li>Необходимо указать хотя бы одно имя или IP-адрес, например:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ALLOWED_HOSTS = [&amp;#39;netbox.example.com&amp;#39;, &amp;#39;192.0.2.123&amp;#39;]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Если вы еще не уверены, каким будет доменное имя и/или IP-адрес установки NetBox, вы можете установить подстановочный знак (звездочку), чтобы разрешить все значения хоста:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ALLOWED_HOSTS&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;*&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>DATABASE&lt;/p>
&lt;ul>
&lt;li>Сведения о конфигурации базы данных.&lt;/li>
&lt;li>Нужно задать имя пользователя и пароль, используемые при настройке PostgreSQL.&lt;/li>
&lt;li>Если служба запущена на удалённом хосте, обновите параметры HOST и PORT:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">DATABASE = {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;NAME&amp;#39;: &amp;#39;netbox&amp;#39;, # Database name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;USER&amp;#39;: &amp;#39;netbox&amp;#39;, # PostgreSQL username
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;PASSWORD&amp;#39;: &amp;#39;&amp;lt;password&amp;gt;&amp;#39;, # PostgreSQL password
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;HOST&amp;#39;: &amp;#39;localhost&amp;#39;, # Database server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;PORT&amp;#39;: &amp;#39;&amp;#39;, # Database port (leave blank for default)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;CONN_MAX_AGE&amp;#39;: 300, # Max database connection age (seconds)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="3">
&lt;li>
&lt;p>REDIS&lt;/p>
&lt;ul>
&lt;li>NetBox требует указания двух отдельных баз данных Redis: &lt;code>tasks&lt;/code> и &lt;code>caching&lt;/code>.&lt;/li>
&lt;li>Обе они могут предоставляться одной и той же службой Redis, однако каждый из них должен иметь уникальный числовой идентификатор базы данных.
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">REDIS = {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;tasks&amp;#39;: {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;HOST&amp;#39;: &amp;#39;localhost&amp;#39;, # Redis server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;PORT&amp;#39;: 6379, # Redis port
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;PASSWORD&amp;#39;: &amp;#39;&amp;#39;, # Redis password (optional)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;DATABASE&amp;#39;: 0, # Database ID
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;SSL&amp;#39;: False, # Use SSL (optional)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;caching&amp;#39;: {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;HOST&amp;#39;: &amp;#39;localhost&amp;#39;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;PORT&amp;#39;: 6379,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;PASSWORD&amp;#39;: &amp;#39;&amp;#39;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;DATABASE&amp;#39;: 1, # Unique ID for second database
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;SSL&amp;#39;: False,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="4">
&lt;li>
&lt;p>SECRET_KEY&lt;/p>
&lt;ul>
&lt;li>Этому параметру должен быть назначен случайно сгенерированный ключ, используемый в качестве соли для хеширования и связанных с ним криптографических функций.&lt;/li>
&lt;li>Этот ключ должен быть уникальным для данной установки, и его рекомендуется иметь длину не менее 50 символов. Его не следует использовать за пределами локальной системы.&lt;/li>
&lt;li>Простой скрипт Python с именем &lt;code>generate_secret_key.py&lt;/code> предоставляется в родительском каталоге для помощи в создании подходящего ключа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">python3 ../generate_secret_key.py
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В случае высокодоступной установки с несколькими веб-серверами &lt;code>SECRET_KEY&lt;/code> должен быть одинаковым на всех серверах, чтобы поддерживать постоянное состояние сеанса пользователя.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="развёртывание-netbox">&lt;span class="section-num">3.4.3&lt;/span> Развёртывание NetBox&lt;/h4>
&lt;ul>
&lt;li>Скрипт обновления выполнит следующие действия:
&lt;ul>
&lt;li>создание виртуального окружения Python;&lt;/li>
&lt;li>установка необходимых пакетов Python;&lt;/li>
&lt;li>запуск миграции схемы базы данных;&lt;/li>
&lt;li>создание локальной документации;&lt;/li>
&lt;li>объединение статических файлов ресурсов на диске.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Запускаем скрипт установки Netbox:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -u netbox &lt;span class="nv">PYTHON&lt;/span>&lt;span class="o">=&lt;/span>/usr/bin/python3.12 /opt/netbox/upgrade.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="суперпользователь">&lt;span class="section-num">3.4.4&lt;/span> Суперпользователь&lt;/h4>
&lt;ul>
&lt;li>NetBox не имеет предустановленных учётных записей пользователей.&lt;/li>
&lt;li>Необходимо создать суперпользователя (административную учетную запись), чтобы иметь возможность войти в NetBox.&lt;/li>
&lt;li>Войдём в виртуальную среду Python:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">source&lt;/span> /opt/netbox/venv/bin/activate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим учётную запись суперпользователя:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt/netbox/netbox
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python3 manage.py createsuperuser
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Указывать адрес электронной почты пользователя не обязательно.&lt;/li>
&lt;/ul>
&lt;h4 id="планирование-очистки-рабочей-среды">&lt;span class="section-num">3.4.5&lt;/span> Планирование очистки рабочей среды&lt;/h4>
&lt;ul>
&lt;li>NetBox включает в себя скрипт &lt;code>housekeeping&lt;/code>, который выполняет повторяющиеся задачи очистки (очистка старых сеансов и записей об изменениях с истекшим сроком действия).&lt;/li>
&lt;li>Установим его:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo ln -s /opt/netbox/contrib/netbox-housekeeping.sh /etc/cron.daily/netbox-housekeeping
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="брандмауэр">&lt;span class="section-num">3.4.6&lt;/span> Брандмауэр&lt;/h4>
&lt;ul>
&lt;li>Настроим брандмауэр:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --add-port&lt;span class="o">=&lt;/span>8000/tcp --permanent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="gunicorn">&lt;span class="section-num">3.5&lt;/span> Gunicorn&lt;/h3>
&lt;ul>
&lt;li>NetBox работает как приложение WSGI для HTTP-сервера.&lt;/li>
&lt;li>Можно использовать Gunicorn или uWSGI.&lt;/li>
&lt;li>Скопируем файл конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -u netbox cp /opt/netbox/contrib/gunicorn.py /opt/netbox/gunicorn.py
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установим скрипты для systemd:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp -v /opt/netbox/contrib/*.service /etc/systemd/system/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl daemon-reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустим сервисы &lt;code>netbox&lt;/code> и &lt;code>netbox-rq&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now netbox netbox-rq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="http-сервер">&lt;span class="section-num">3.6&lt;/span> HTTP-сервер&lt;/h3>
&lt;h4 id="nginx">&lt;span class="section-num">3.6.1&lt;/span> Nginx&lt;/h4>
&lt;ul>
&lt;li>Установим nginx.&lt;/li>
&lt;li>Выберем нужный модуль:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf module list nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf module switch-to nginx:1.24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf -y install nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Скопируем шаблон файла конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp /opt/netbox/contrib/nginx.conf /etc/nginx/conf.d/netbox.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Замените &lt;code>netbox.example.com&lt;/code> именем домена или IP-адресом сервера.&lt;/li>
&lt;/ul>
&lt;h4 id="ssl-сертификат">&lt;span class="section-num">3.6.2&lt;/span> SSL-сертификат&lt;/h4>
&lt;ul>
&lt;li>Сгенерим самоподписанный SSL-сертификат в качестве заглушки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p /etc/ssl/private /etc/ssl/certs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl req -x509 -nodes -days &lt;span class="m">365&lt;/span> -newkey rsa:2048 -keyout /etc/ssl/private/netbox.key -out /etc/ssl/certs/netbox.crt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Потом заменим его на нормальный.&lt;/li>
&lt;/ul>
&lt;h4 id="selinux">&lt;span class="section-num">3.6.3&lt;/span> SELinux&lt;/h4>
&lt;ul>
&lt;li>Настройте политики SELinux:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">setsebool httpd_can_network_connect &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setsebool -P httpd_can_network_connect &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="брандмауэр">&lt;span class="section-num">3.6.4&lt;/span> Брандмауэр&lt;/h4>
&lt;ul>
&lt;li>Настроим брандмауэр:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --add-servic&lt;span class="o">={&lt;/span>http,https&lt;span class="o">}&lt;/span> --permanent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="запуск-http-сервера">&lt;span class="section-num">3.6.5&lt;/span> Запуск http-сервера&lt;/h4>
&lt;ul>
&lt;li>Запустим nginx:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="установка-https-сертификата-letsencrypt">&lt;span class="section-num">3.7&lt;/span> Установка https-сертификата LetsEncrypt&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/05/02/acme-clients-certbot/">Клиенты ACME. Certbot&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="установка-certbot">&lt;span class="section-num">3.7.1&lt;/span> Установка &lt;em>certbot&lt;/em>&lt;/h4>
&lt;ul>
&lt;li>Проверьте, что установлен репозитории EPEL:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install epel-release
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установите &lt;em>certbot&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install certbot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для веб-сервера Apache:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install python3-certbot-apache
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для веб-сервера Nginx:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install python3-certbot-nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="сервер-nginx">&lt;span class="section-num">3.7.2&lt;/span> Сервер &lt;em>Nginx&lt;/em>&lt;/h4>
&lt;ul>
&lt;li>Плагин &lt;code>certbot-nginx&lt;/code> предоставляет автоматическую настройку &lt;em>Nginx HTTP Server&lt;/em>.&lt;/li>
&lt;li>Он пытается найти конфигурацию каждого домена, а также добавляет рекомендованные для безопасности параметры, настройки использования сертификатов и пути к сертификатам Let&amp;rsquo;s Encrypt.&lt;/li>
&lt;li>Первоначальная настройка виртуальных хостов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot --nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обновление сертификатов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot renew
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Изменение сертификатов без изменения файлов конфигурации &lt;em>nginx&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot --nginx certonly
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="конфигурационный-файл-nginx">&lt;span class="section-num">3.7.3&lt;/span> Конфигурационный файл &lt;em>Nginx&lt;/em>&lt;/h4>
&lt;ul>
&lt;li>В файле &lt;code>/etc/nginx/conf.d/netbox.conf&lt;/code> должны быть следующие записи:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ssl_certificate /etc/letsencrypt/live/yourwebsite.com/fullchain.pem;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssl_certificate_key /etc/letsencrypt/live/yourwebsite.com/privkey.pem;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">include /etc/letsencrypt/options-ssl-nginx.conf;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Система управления сетью NetBox</title><link>https://yamadharma.github.io/ru/post/2024/06/19/netbox/</link><pubDate>Wed, 19 Jun 2024 17:52:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/06/19/netbox/</guid><description>&lt;p>Система управления сетью NetBox.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#плагины">&lt;span class="section-num">3&lt;/span> Плагины&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#dhcp">&lt;span class="section-num">3.1&lt;/span> DHCP&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="http://netboxlabs.com/oss/netbox/" target="_blank" rel="noopener">http://netboxlabs.com/oss/netbox/&lt;/a>&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/netbox-community/netbox" target="_blank" rel="noopener">https://github.com/netbox-community/netbox&lt;/a>&lt;/li>
&lt;li>Документация: &lt;a href="https://netbox.readthedocs.io" target="_blank" rel="noopener">https://netbox.readthedocs.io&lt;/a>&lt;/li>
&lt;li>Приложение для управления и документирования компьютерных сетей.&lt;/li>
&lt;li>Основные функции:
&lt;ul>
&lt;li>IP address management (IPAM): IP сети и адреса, VRFs, и VLAN;&lt;/li>
&lt;li>DataCenter infrastructure management (DCIM): организация стоечного оборудования по группам и устройствам;&lt;/li>
&lt;li>устройства: типы устройств и место установки;&lt;/li>
&lt;li>соединения: сеть, консоль, силовые соединения;&lt;/li>
&lt;li>виртуализация: виртуальные машины и кластеры;&lt;/li>
&lt;li>схемы передачи данных: схемы дальней связи и провайдеры;&lt;/li>
&lt;li>секреты: зашифрованное хранение конфиденциальных учетных данных.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Стек приложений:
&lt;ul>
&lt;li>HTTP service: nginx или Apache;&lt;/li>
&lt;li>WSGI service: gunicorn или uWSGI;&lt;/li>
&lt;li>application: Django/Python, &amp;gt;= python-3.10;&lt;/li>
&lt;li>database: — PostgreSQL, &amp;gt;=postgresql-9.12;&lt;/li>
&lt;li>task queuing: Redis/django-rq;&lt;/li>
&lt;li>live device access: NAPALM.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/06/19/netbox-install/">NetBox. Установка&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="плагины">&lt;span class="section-num">3&lt;/span> Плагины&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/07/22/netbox-plugins/">NetBox. Плагины&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="dhcp">&lt;span class="section-num">3.1&lt;/span> DHCP&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/07/22/netbox-plugin-netbox-kea/">NetBox. Плагин netbox-kea&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Сервер ISC DHCP</title><link>https://yamadharma.github.io/ru/post/2024/06/19/server-isc-dhcp/</link><pubDate>Wed, 19 Jun 2024 15:26:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/06/19/server-isc-dhcp/</guid><description>&lt;p>Сервер ISC DHCP.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#управление">&lt;span class="section-num">2&lt;/span> Управление&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Стандартный сервер DHCP.&lt;/li>
&lt;li>Развитие прекращено.&lt;/li>
&lt;li>Рекомендован переход на Kea DHCP (см. &lt;a href="https://yamadharma.github.io/ru/post/2024/06/18/dhcp-kea-server/">Сервер DHCP Kea&lt;/a>).&lt;/li>
&lt;li>Сайт: &lt;a href="https://www.isc.org/dhcp/" target="_blank" rel="noopener">https://www.isc.org/dhcp/&lt;/a>&lt;/li>
&lt;li>Лицензия: Mozilla Public License 2.0. Ранее была лицензия ISC License.&lt;/li>
&lt;/ul>
&lt;h2 id="управление">&lt;span class="section-num">2&lt;/span> Управление&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/09/25/dynamically-updating-bind-dns-isc-dhcp/">Динамическое обновление DNS-сервера BIND при помощи ISC DHCP&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Динамическое обновление DNS-сервера BIND при помощи Kea DHCP</title><link>https://yamadharma.github.io/ru/post/2024/06/18/dynamically-updating-bind-dns-kea-dhcp/</link><pubDate>Tue, 18 Jun 2024 11:23:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/06/18/dynamically-updating-bind-dns-kea-dhcp/</guid><description>&lt;p>Динамическое обновление DNS-сервера BIND при помощи Kea DHCP.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#ключи">&lt;span class="section-num">1&lt;/span> Ключи&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-dns-bind">&lt;span class="section-num">2&lt;/span> Настройка DNS Bind&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-kea-dhcp">&lt;span class="section-num">3&lt;/span> Настройка Kea DHCP&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#ключ">&lt;span class="section-num">3.1&lt;/span> Ключ&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сервис-ddns">&lt;span class="section-num">3.2&lt;/span> Сервис ddns&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сервис-dhcp4">&lt;span class="section-num">3.3&lt;/span> Сервис dhcp4&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="ключи">&lt;span class="section-num">1&lt;/span> Ключи&lt;/h2>
&lt;ul>
&lt;li>Создадим ключ на сервере с BIND9:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tsig-keygen -a HMAC-SHA512 DHCP_UPDATER &amp;gt; /etc/named/keys/dhcp_updater.key
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Файл &lt;code>/etc/named/keys/dhcp_updater.key&lt;/code> будет иметь следующий вид:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">key &amp;#34;DHCP_UPDATER&amp;#34; {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> algorithm hmac-sha512;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> secret &amp;#34;psFFSGdUIwK36l1G82LOw15PuIH4W5uB8h/cw7F0XDsjniBbwm/59tM+V3ydcCs15VLpe2pxlUlggWilytQqgg==&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Поправим права доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chown -R named:named /etc/named/keys
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-dns-bind">&lt;span class="section-num">2&lt;/span> Настройка DNS Bind&lt;/h2>
&lt;ul>
&lt;li>Настройка происходит в файле &lt;code>/etc/named.conf&lt;/code>.&lt;/li>
&lt;li>Ключ находится в файле &lt;code>/etc/named/keys/dhcp_updater.key&lt;/code>.&lt;/li>
&lt;li>Подключим ключ:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">include &amp;#34;/etc/named/keys/dhcp_updater.key&amp;#34;;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Разрешим обновление зон:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">zone &amp;#34;local.zone&amp;#34; IN {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type master;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &amp;#34;local.zone.db&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> allow-update { key DHCP_UPDATER; };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> update-policy {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> grant DHCP_UPDATER wildcard *.local.zone A DHCID;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zone &amp;#34;0.168.192.in-addr.arpa&amp;#34; IN {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type master;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &amp;#34;192.168.0.db&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> update-policy {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> grant DHCP_UPDATER wildcard *.0.168.192.in-addr.arpa PTR DHCID;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сделаем проверку конфигурационного файла:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">named-checkconf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перестартуйте сервер DNS:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl restart named.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-kea-dhcp">&lt;span class="section-num">3&lt;/span> Настройка Kea DHCP&lt;/h2>
&lt;h3 id="ключ">&lt;span class="section-num">3.1&lt;/span> Ключ&lt;/h3>
&lt;ul>
&lt;li>Файл ключа назовём &lt;code>/etc/kea/tsig-keys.json&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">touch /etc/kea/tsig-keys.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перенесём ключ на сервер Kea DHCP и перепишем его в формате json:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;tsig-keys&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;DHCP_UPDATER&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;algorithm&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;hmac-sha512&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;secret&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;psFFSGdUIwK36l1G82LOw15PuIH4W5uB8h/cw7F0XDsjniBbwm/59tM+V3ydcCs15VLpe2pxlUlggWilytQqgg==&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сменим владельца:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chown kea:root /etc/kea/tsig-keys.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Поправим права доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">640&lt;/span> /etc/kea/tsig-keys.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="сервис-ddns">&lt;span class="section-num">3.2&lt;/span> Сервис ddns&lt;/h3>
&lt;ul>
&lt;li>Настройка происходит в файле &lt;code>/etc/kea/kea-dhcp-ddns.conf&lt;/code>.&lt;/li>
&lt;li>Файл будет иметь следующий вид:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;DhcpDdns&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;ip-address&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;127.0.0.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;port&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">53001&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;control-socket&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;socket-type&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;unix&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;socket-name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;/tmp/kea-ddns-ctrl-socket&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">include&lt;/span> &lt;span class="s2">&amp;#34;/etc/kea/tsig-keys.json&amp;#34;&lt;/span>&lt;span class="o">?&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;forward-ddns&amp;#34;&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;ddns-domains&amp;#34;&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;local.zone.&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;key-name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;DHCP_UPDATER&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;dns-servers&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span> &lt;span class="s2">&amp;#34;ip-address&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;192.168.0.1&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;reverse-ddns&amp;#34;&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;ddns-domains&amp;#34;&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;0.168.192.in-addr.arpa.&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;key-name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;DHCP_UPDATER&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;dns-servers&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span> &lt;span class="s2">&amp;#34;ip-address&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;192.168.0.1&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;loggers&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;kea-dhcp-ddns&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;output_options&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;output&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;stdout&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;pattern&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;%-5p %m\n&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;severity&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;INFO&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;debuglevel&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обратите особое внимание на точку в конце имени зоны, иначе DDNS завершится сбоем и сообщит, что не удалось найти соответствующее полное доменное имя.&lt;/li>
&lt;li>Можно определить несколько DNS-серверов.&lt;/li>
&lt;li>Раздел журналирования оставлен из шаблона.&lt;/li>
&lt;li>Изменим владельца файла:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chown kea:root /etc/kea/kea-dhcp-ddns.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверим файл на наличие возможных синтаксических ошибок:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">kea-dhcp-ddns -t /etc/kea/kea-dhcp-ddns.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустим службу ddns:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now kea-dhcp-ddns.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверим статус работы службы:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl status kea-dhcp-ddns.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="сервис-dhcp4">&lt;span class="section-num">3.3&lt;/span> Сервис dhcp4&lt;/h3>
&lt;ul>
&lt;li>Настройка происходит в файле &lt;code>/etc/kea/kea-dhcp4.conf&lt;/code>.&lt;/li>
&lt;li>Включим динамическое обновление:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;dhcp-ddns&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;enable-updates&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;ddns-qualifying-suffix&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;local.zone&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;ddns-override-client-update&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Включаем обновления DDNS.&lt;/li>
&lt;li>Затем мы сообщаем DHCP-серверу, каким будет DNS-суффикс по умолчанию.
&lt;ul>
&lt;li>Если клиент предоставляет только своё имя хоста, это вызывает проблемы для DDNS, поскольку он не будет знать, что такое полное доменное имя, и поэтому не будет знать, какую зону обновлять.&lt;/li>
&lt;li>Другими словами, команда &lt;code>ddns-qualifying-suffix&lt;/code> используется для указания того, какое доменное имя должно быть добавлено к имени хоста.&lt;/li>
&lt;li>Можно определить это для каждой подсети.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Для параметра &lt;code>ddns-override-client-update&lt;/code> устанавливается значение &lt;code>true&lt;/code>, поскольку мы не хотим, чтобы клиент решал, какие записи обновлять.&lt;/li>
&lt;li>Проверим файл на наличие возможных синтаксических ошибок:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">kea-dhcp4 -t /etc/kea/kea-dhcp4.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перезапустим службу, чтобы изменения вступили в силу:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl restart kea-dhcp4.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверим статус:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl status kea-dhcp4.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Сервер DHCP Kea</title><link>https://yamadharma.github.io/ru/post/2024/06/18/dhcp-kea-server/</link><pubDate>Tue, 18 Jun 2024 11:07:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/06/18/dhcp-kea-server/</guid><description>&lt;p>Сервер DHCP Kea.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#особенности">&lt;span class="section-num">1.1&lt;/span> Особенности&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка">&lt;span class="section-num">3&lt;/span> Настройка&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://www.isc.org/kea/" target="_blank" rel="noopener">https://www.isc.org/kea/&lt;/a>&lt;/li>
&lt;li>Современный стандартный сервер DHCP.&lt;/li>
&lt;li>Репозиторий:
&lt;ul>
&lt;li>&lt;a href="https://gitlab.isc.org/isc-projects/kea" target="_blank" rel="noopener">https://gitlab.isc.org/isc-projects/kea&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/isc-projects/kea" target="_blank" rel="noopener">https://github.com/isc-projects/kea&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Документация: &lt;a href="https://kea.readthedocs.io/en/latest/index.html" target="_blank" rel="noopener">https://kea.readthedocs.io/en/latest/index.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="особенности">&lt;span class="section-num">1.1&lt;/span> Особенности&lt;/h3>
&lt;ul>
&lt;li>Модульная конструкция компонентов
&lt;ul>
&lt;li>Расширяется с помощью модулей-хуков.&lt;/li>
&lt;li>Дистрибутив Kea включает отдельные демоны для сервера DHCPv4, сервера DHCPv6 и модуля динамического DNS (DDNS).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Онлайн-реконфигурация с помощью REST API.
&lt;ul>
&lt;li>Kea использует файл конфигурации JSON, который можно изменить удалённо без остановки и перезапуска сервера.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Панель управления через веб-интерфейс.&lt;/li>
&lt;li>Поддерживает базы данных MySQL, PostgreSQL:
&lt;ul>
&lt;li>упрощает интеграцию с другими системами;&lt;/li>
&lt;li>можно использовать один и тот же сервер резервирования хостов для нескольких DHCP-серверов;&lt;/li>
&lt;li>администрирование глобальных параметров из централизованной системы настройки.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/05/07/dhcp-server-installation/">DHCP. Установка сервера DHCP Kea&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="настройка">&lt;span class="section-num">3&lt;/span> Настройка&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/06/18/dynamically-updating-bind-dns-kea-dhcp/">Динамическое обновление DNS-сервера BIND при помощи Kea DHCP&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Linux. Настройка vlan</title><link>https://yamadharma.github.io/ru/post/2024/05/13/linux-vlan-configuration/</link><pubDate>Mon, 13 May 2024 10:34:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/05/13/linux-vlan-configuration/</guid><description>&lt;p>Linux. Настройка vlan&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#поддержка-vlan-ядром">&lt;span class="section-num">2&lt;/span> Поддержка VLAN ядром&lt;/a>&lt;/li>
&lt;li>&lt;a href="#networkmanager-для-настройки-vlan-интерфейса">&lt;span class="section-num">3&lt;/span> NetworkManager для настройки VLAN интерфейса&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#создание-интерфейса">&lt;span class="section-num">3.1&lt;/span> Создание интерфейса&lt;/a>&lt;/li>
&lt;li>&lt;a href="#назначение-ip-адреса">&lt;span class="section-num">3.2&lt;/span> Назначение IP-адреса&lt;/a>&lt;/li>
&lt;li>&lt;a href="#удаление-интерфейса-vlan">&lt;span class="section-num">3.3&lt;/span> Удаление интерфейса VLAN&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>VLAN (Virtual Local Area Network) позволяет разделить сеть на канальном уровне на несколько изолированных широковещательных доменов.&lt;/li>
&lt;li>С помощью VLAN можно настроить несколько сетей на одном физическом порту сервера.&lt;/li>
&lt;li>При использовании 802.1Q VLAN сетевым пакетам добавляется специальный тег (тегированный трафик) с номером VLAN (&lt;code>VLAN ID&lt;/code>, 1&amp;ndash;4094).&lt;/li>
&lt;li>Предназначение VLAN:
&lt;ul>
&lt;li>сегментирование сети (разделение устройств на изолированные группы);&lt;/li>
&lt;li>уменьшение количества сетевого оборудования;&lt;/li>
&lt;li>снижение нагрузки на сеть для уменьшения широковещательного трафика;&lt;/li>
&lt;li>улучшение безопасности и управляемости сети.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="поддержка-vlan-ядром">&lt;span class="section-num">2&lt;/span> Поддержка VLAN ядром&lt;/h2>
&lt;ul>
&lt;li>Проверьте загрузку модуля ядра Linux 8021q:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">lsmod &lt;span class="p">|&lt;/span> grep 8021q
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Загрузите модуль ядра Linux 8021q:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">modprobe 8021q
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавьте модуль в автозагрузку:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> 8021q &amp;gt;&amp;gt; /etc/modules-load.d/8021q.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="networkmanager-для-настройки-vlan-интерфейса">&lt;span class="section-num">3&lt;/span> NetworkManager для настройки VLAN интерфейса&lt;/h2>
&lt;h3 id="создание-интерфейса">&lt;span class="section-num">3.1&lt;/span> Создание интерфейса&lt;/h3>
&lt;ul>
&lt;li>Команда для создания VLAN-соединения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nmcli connection add &lt;span class="nb">type&lt;/span> vlan con-name &amp;lt;con-name&amp;gt; ifname &amp;lt;ifname&amp;gt; dev &amp;lt;device&amp;gt; id &amp;lt;vlan_id&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Будем придерживаться следующих соглашений:
&lt;ul>
&lt;li>Тег VLAN : &amp;lt;vlan_id&amp;gt; (число от 0 до 4095);&lt;/li>
&lt;li>con-name :vlan&amp;lt;vlan_id&amp;gt;-con&lt;/li>
&lt;li>ifname : vlan&amp;lt;vlan_id&amp;gt;-if&lt;/li>
&lt;li>device: ens5 (какой в системе);&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Создадим VLAN интерфейс с номером VLAN 10 на устройстве &lt;code>ens5&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nmcli connection add &lt;span class="nb">type&lt;/span> vlan con-name vlan10-con ifname vlan10-if dev ens5 id &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте, что устройство создано:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nmcli device
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте сетевые интерфейсы:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nmcli connection show
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После настройки выполните перезагрузку NetworkManager:&lt;/li>
&lt;/ul>
&lt;!--listend-->
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl restart NetworkManager
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="назначение-ip-адреса">&lt;span class="section-num">3.2&lt;/span> Назначение IP-адреса&lt;/h3>
&lt;ul>
&lt;li>Зададим следующие значения:
&lt;ul>
&lt;li>соединение: &lt;code>vlan10-con&lt;/code>;&lt;/li>
&lt;li>ip-адрес и сетевая маска: &lt;code>192.168.10.10/24&lt;/code>;&lt;/li>
&lt;li>шлюз по умолчанию: &lt;code>192.168.10.254&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Назначим IP-адрес:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nmcli connection modify vlan10-con ipv4.addresses &lt;span class="s1">&amp;#39;192.168.10.10/24&amp;#39;&lt;/span> ipv4.gateway &lt;span class="s1">&amp;#39;192.168.10.254&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Изменим настройку DHCP по умолчанию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo nmcli connection modify vlan10-con ipv4.method manual
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Просмотрим адрес:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip addr
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="удаление-интерфейса-vlan">&lt;span class="section-num">3.3&lt;/span> Удаление интерфейса VLAN&lt;/h3>
&lt;ul>
&lt;li>Деактивируйте соединение:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo nmcli connection down vlan10-con
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите команду &lt;code>ip addr&lt;/code>, чтобы убедиться, что устройства больше нет в списке:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip addr
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите команду &lt;code>sudo nmcli connection&lt;/code>, чтобы просмотреть список доступных подключений:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nmcli connection
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Удалите соединение:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nmcli connection delete vlan10-con
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите команду &lt;code>sudo nmcli connection&lt;/code>, чтобы просмотреть список доступных подключений:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nmcli connection
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>DHCP. Установка сервера DHCP Kea</title><link>https://yamadharma.github.io/ru/post/2024/05/07/dhcp-server-installation/</link><pubDate>Tue, 07 May 2024 11:39:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/05/07/dhcp-server-installation/</guid><description>&lt;p>Установка сервера DHCP ISC Kea.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#особенности">&lt;span class="section-num">1.1&lt;/span> Особенности&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#опции-dhcp">&lt;span class="section-num">2&lt;/span> Опции DHCP&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">3&lt;/span> Установка&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#репозиторий-rockylinux">&lt;span class="section-num">3.1&lt;/span> Репозиторий RockyLinux&lt;/a>&lt;/li>
&lt;li>&lt;a href="#репозиторий-isc">&lt;span class="section-num">3.2&lt;/span> Репозиторий ISC&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#kea-2-dot-6">&lt;span class="section-num">3.2.1&lt;/span> Kea-2.6&lt;/a>&lt;/li>
&lt;li>&lt;a href="#kea-2-dot-4">&lt;span class="section-num">3.2.2&lt;/span> Kea-2.4&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#инструментарий-миграции-keama">&lt;span class="section-num">3.3&lt;/span> Инструментарий миграции keama&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#подготовка">&lt;span class="section-num">4&lt;/span> Подготовка&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#брандмауэр">&lt;span class="section-num">4.1&lt;/span> Брандмауэр&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#подготовка-базы-данных">&lt;span class="section-num">5&lt;/span> Подготовка базы данных&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#postgresql">&lt;span class="section-num">5.1&lt;/span> PostgreSQL&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#создание-базы-данных">&lt;span class="section-num">5.1.1&lt;/span> Создание базы данных&lt;/a>&lt;/li>
&lt;li>&lt;a href="#заполнение-базы-данных">&lt;span class="section-num">5.1.2&lt;/span> Заполнение базы данных&lt;/a>&lt;/li>
&lt;li>&lt;a href="#обновление-базы-данных">&lt;span class="section-num">5.1.3&lt;/span> Обновление базы данных&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#миграция-с-isc-dhcp-на-isc-kea">&lt;span class="section-num">5.2&lt;/span> Миграция с ISC DHCP на ISC Kea&lt;/a>&lt;/li>
&lt;li>&lt;a href="#тьюнинг-базы-данных">&lt;span class="section-num">5.3&lt;/span> Тьюнинг базы данных&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурация-базы-данных-для-kea">&lt;span class="section-num">5.4&lt;/span> Конфигурация базы данных для Kea&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#виртуальные-интерфейсы">&lt;span class="section-num">6&lt;/span> Виртуальные интерфейсы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#миграция-интерфейсов">&lt;span class="section-num">6.1&lt;/span> Миграция интерфейсов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурация-интерфейсов-для-kea">&lt;span class="section-num">6.2&lt;/span> Конфигурация интерфейсов для Kea&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#запуск">&lt;span class="section-num">7&lt;/span> Запуск&lt;/a>&lt;/li>
&lt;li>&lt;a href="#утилиты">&lt;span class="section-num">8&lt;/span> Утилиты&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#просмотр-арендованных-адресов">&lt;span class="section-num">8.1&lt;/span> Просмотр арендованных адресов&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#postgres">&lt;span class="section-num">8.1.1&lt;/span> Postgres&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#после-установки">&lt;span class="section-num">9&lt;/span> После установки&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://www.isc.org/kea/" target="_blank" rel="noopener">https://www.isc.org/kea/&lt;/a>&lt;/li>
&lt;li>Репозиторий:
&lt;ul>
&lt;li>&lt;a href="https://gitlab.isc.org/isc-projects/kea" target="_blank" rel="noopener">https://gitlab.isc.org/isc-projects/kea&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/isc-projects/kea" target="_blank" rel="noopener">https://github.com/isc-projects/kea&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Документация: &lt;a href="https://kea.readthedocs.io/en/latest/index.html" target="_blank" rel="noopener">https://kea.readthedocs.io/en/latest/index.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="особенности">&lt;span class="section-num">1.1&lt;/span> Особенности&lt;/h3>
&lt;ul>
&lt;li>Модульная конструкция компонентов
&lt;ul>
&lt;li>Расширяется с помощью модулей-хуков.&lt;/li>
&lt;li>Дистрибутив Kea включает отдельные демоны для сервера DHCPv4, сервера DHCPv6 и модуля динамического DNS (DDNS).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Онлайн-реконфигурация с помощью REST API.
&lt;ul>
&lt;li>Kea использует файл конфигурации JSON, который можно изменить удалённо без остановки и перезапуска сервера.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Панель управления через веб-интерфейс.&lt;/li>
&lt;li>Поддерживает базы данных MySQL, PostgreSQL:
&lt;ul>
&lt;li>упрощает интеграцию с другими системами;&lt;/li>
&lt;li>можно использовать один и тот же сервер резервирования хостов для нескольких DHCP-серверов;&lt;/li>
&lt;li>администрирование глобальных параметров из централизованной системы настройки.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="опции-dhcp">&lt;span class="section-num">2&lt;/span> Опции DHCP&lt;/h2>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 1:&lt;/span>
Список стандартных опций DHCPv4
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Название&lt;/th>
&lt;th>Код&lt;/th>
&lt;th>Type&lt;/th>
&lt;th>Массив&lt;/th>
&lt;th>Returned if not requested?&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>time-offset&lt;/td>
&lt;td>2&lt;/td>
&lt;td>int32&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>routers&lt;/td>
&lt;td>3&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>true&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>time-servers&lt;/td>
&lt;td>4&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>name-servers&lt;/td>
&lt;td>5&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>domain-name-servers&lt;/td>
&lt;td>6&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>true&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>log-servers&lt;/td>
&lt;td>7&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>cookie-servers&lt;/td>
&lt;td>8&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>lpr-servers&lt;/td>
&lt;td>9&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>impress-servers&lt;/td>
&lt;td>10&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>resource-location-servers&lt;/td>
&lt;td>11&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>boot-size&lt;/td>
&lt;td>13&lt;/td>
&lt;td>uint16&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>merit-dump&lt;/td>
&lt;td>14&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>domain-name&lt;/td>
&lt;td>15&lt;/td>
&lt;td>fqdn&lt;/td>
&lt;td>false&lt;/td>
&lt;td>true&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>swap-server&lt;/td>
&lt;td>16&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>root-path&lt;/td>
&lt;td>17&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>extensions-path&lt;/td>
&lt;td>18&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ip-forwarding&lt;/td>
&lt;td>19&lt;/td>
&lt;td>boolean&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>non-local-source-routing&lt;/td>
&lt;td>20&lt;/td>
&lt;td>boolean&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>policy-filter&lt;/td>
&lt;td>21&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>max-dgram-reassembly&lt;/td>
&lt;td>22&lt;/td>
&lt;td>uint16&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>default-ip-ttl&lt;/td>
&lt;td>23&lt;/td>
&lt;td>uint8&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>path-mtu-aging-timeout&lt;/td>
&lt;td>24&lt;/td>
&lt;td>uint32&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>path-mtu-plateau-table&lt;/td>
&lt;td>25&lt;/td>
&lt;td>uint16&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>interface-mtu&lt;/td>
&lt;td>26&lt;/td>
&lt;td>uint16&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>all-subnets-local&lt;/td>
&lt;td>27&lt;/td>
&lt;td>boolean&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>broadcast-address&lt;/td>
&lt;td>28&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>perform-mask-discovery&lt;/td>
&lt;td>29&lt;/td>
&lt;td>boolean&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>mask-supplier&lt;/td>
&lt;td>30&lt;/td>
&lt;td>boolean&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>router-discovery&lt;/td>
&lt;td>31&lt;/td>
&lt;td>boolean&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>router-solicitation-address&lt;/td>
&lt;td>32&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>static-routes&lt;/td>
&lt;td>33&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>trailer-encapsulation&lt;/td>
&lt;td>34&lt;/td>
&lt;td>boolean&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>arp-cache-timeout&lt;/td>
&lt;td>35&lt;/td>
&lt;td>uint32&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ieee802-3-encapsulation&lt;/td>
&lt;td>36&lt;/td>
&lt;td>boolean&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>default-tcp-ttl&lt;/td>
&lt;td>37&lt;/td>
&lt;td>uint8&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>tcp-keepalive-interval&lt;/td>
&lt;td>38&lt;/td>
&lt;td>uint32&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>tcp-keepalive-garbage&lt;/td>
&lt;td>39&lt;/td>
&lt;td>boolean&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nis-domain&lt;/td>
&lt;td>40&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nis-servers&lt;/td>
&lt;td>41&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ntp-servers&lt;/td>
&lt;td>42&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>vendor-encapsulated-options&lt;/td>
&lt;td>43&lt;/td>
&lt;td>empty&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>netbios-name-servers&lt;/td>
&lt;td>44&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>netbios-dd-server&lt;/td>
&lt;td>45&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>netbios-node-type&lt;/td>
&lt;td>46&lt;/td>
&lt;td>uint8&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>netbios-scope&lt;/td>
&lt;td>47&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>font-servers&lt;/td>
&lt;td>48&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>x-display-manager&lt;/td>
&lt;td>49&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>dhcp-option-overload&lt;/td>
&lt;td>52&lt;/td>
&lt;td>uint8&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>dhcp-server-identifier&lt;/td>
&lt;td>54&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>false&lt;/td>
&lt;td>true&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>dhcp-message&lt;/td>
&lt;td>56&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>dhcp-max-message-size&lt;/td>
&lt;td>57&lt;/td>
&lt;td>uint16&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>vendor-class-identifier&lt;/td>
&lt;td>60&lt;/td>
&lt;td>hex&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nwip-domain-name&lt;/td>
&lt;td>62&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nwip-suboptions&lt;/td>
&lt;td>63&lt;/td>
&lt;td>hex&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nisplus-domain-name&lt;/td>
&lt;td>64&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nisplus-servers&lt;/td>
&lt;td>65&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>tftp-server-name&lt;/td>
&lt;td>66&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>boot-file-name&lt;/td>
&lt;td>67&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>mobile-ip-home-agent&lt;/td>
&lt;td>68&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>smtp-server&lt;/td>
&lt;td>69&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pop-server&lt;/td>
&lt;td>70&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nntp-server&lt;/td>
&lt;td>71&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>www-server&lt;/td>
&lt;td>72&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>finger-server&lt;/td>
&lt;td>73&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>irc-server&lt;/td>
&lt;td>74&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>streettalk-server&lt;/td>
&lt;td>75&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>streettalk-directory-assistance-server&lt;/td>
&lt;td>76&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>user-class&lt;/td>
&lt;td>77&lt;/td>
&lt;td>hex&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>slp-directory-agent&lt;/td>
&lt;td>78&lt;/td>
&lt;td>record (boolean, ipv4-address)&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>slp-service-scope&lt;/td>
&lt;td>79&lt;/td>
&lt;td>record (boolean, string)&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nds-server&lt;/td>
&lt;td>85&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nds-tree-name&lt;/td>
&lt;td>86&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nds-context&lt;/td>
&lt;td>87&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>bcms-controller-names&lt;/td>
&lt;td>88&lt;/td>
&lt;td>fqdn&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>bcms-controller-address&lt;/td>
&lt;td>89&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>client-system&lt;/td>
&lt;td>93&lt;/td>
&lt;td>uint16&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>client-ndi&lt;/td>
&lt;td>94&lt;/td>
&lt;td>record (uint8, uint8, uint8)&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>uuid-guid&lt;/td>
&lt;td>97&lt;/td>
&lt;td>record (uint8, hex)&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>uap-servers&lt;/td>
&lt;td>98&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>geoconf-civic&lt;/td>
&lt;td>99&lt;/td>
&lt;td>hex&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pcode&lt;/td>
&lt;td>100&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>tcode&lt;/td>
&lt;td>101&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>netinfo-server-address&lt;/td>
&lt;td>112&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>netinfo-server-tag&lt;/td>
&lt;td>113&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>default-url&lt;/td>
&lt;td>114&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>auto-config&lt;/td>
&lt;td>116&lt;/td>
&lt;td>uint8&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>name-service-search&lt;/td>
&lt;td>117&lt;/td>
&lt;td>uint16&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>subnet-selection&lt;/td>
&lt;td>118&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>domain-search&lt;/td>
&lt;td>119&lt;/td>
&lt;td>fqdn&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>vivco-suboptions&lt;/td>
&lt;td>124&lt;/td>
&lt;td>hex&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>vivso-suboptions&lt;/td>
&lt;td>125&lt;/td>
&lt;td>hex&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pana-agent&lt;/td>
&lt;td>136&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>v4-lost&lt;/td>
&lt;td>137&lt;/td>
&lt;td>fqdn&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>capwap-ac-v4&lt;/td>
&lt;td>138&lt;/td>
&lt;td>ipv4-address&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>sip-ua-cs-domains&lt;/td>
&lt;td>142&lt;/td>
&lt;td>fqdn&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>rdnss-selection&lt;/td>
&lt;td>146&lt;/td>
&lt;td>record (uint8, ipv4-address, ipv4-address, fqdn)&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>v4-portparams&lt;/td>
&lt;td>159&lt;/td>
&lt;td>record (uint8, psid)&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>v4-captive-portal&lt;/td>
&lt;td>160&lt;/td>
&lt;td>string&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>option-6rd&lt;/td>
&lt;td>212&lt;/td>
&lt;td>record (uint8, uint8, ipv6-address, ipv4-address)&lt;/td>
&lt;td>true&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>v4-access-domain&lt;/td>
&lt;td>213&lt;/td>
&lt;td>fqdn&lt;/td>
&lt;td>false&lt;/td>
&lt;td>false&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 2:&lt;/span>
Список стандартных типов опций DHCP
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Тип&lt;/th>
&lt;th>Описание&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>hex&lt;/td>
&lt;td>An arbitrary string of bytes, specified as a set of hexadecimal digits.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>boolean&lt;/td>
&lt;td>Boolean value with allowed values true or false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>empty&lt;/td>
&lt;td>No value, data is carried in suboptions&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>fqdn&lt;/td>
&lt;td>Fully qualified domain name (e.g. &lt;a href="https://www.example.com" target="_blank" rel="noopener">www.example.com&lt;/a>)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ipv4-address&lt;/td>
&lt;td>IPv4 address in the usual dotted-decimal notation (e.g. 192.0.2.1)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ipv6-address&lt;/td>
&lt;td>IPv6 address in the usual colon notation (e.g. 2001:db8::1)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ipv6-prefix&lt;/td>
&lt;td>IPv6 prefix and prefix length specified using CIDR notation, e.g. 2001:db8:1::/64. This data type is used to represent an 8-bit field conveying a prefix length and the variable length prefix value&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>psid&lt;/td>
&lt;td>PSID and PSID length separated by a slash&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>record&lt;/td>
&lt;td>Structured data that may be comprised of any types (except &amp;ldquo;record&amp;rdquo; and &amp;ldquo;empty&amp;rdquo;). The array flag applies to the last field only.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>string&lt;/td>
&lt;td>Any text&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>tuple&lt;/td>
&lt;td>A length encoded as a 8 (16 for DHCPv6) bit unsigned integer followed by a string of this length&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>uint8&lt;/td>
&lt;td>8 bit unsigned integer with allowed values 0 to 255&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>uint16&lt;/td>
&lt;td>16 bit unsigned integer with allowed values 0 to 65535&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>uint32&lt;/td>
&lt;td>32 bit unsigned integer with allowed values 0 to 4294967295&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>int8&lt;/td>
&lt;td>8 bit signed integer with allowed values -128 to 127&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>int16&lt;/td>
&lt;td>16 bit signed integer with allowed values -32768 to 32767&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>int32&lt;/td>
&lt;td>32 bit signed integer with allowed values -2147483648 to 2147483647&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="установка">&lt;span class="section-num">3&lt;/span> Установка&lt;/h2>
&lt;ul>
&lt;li>Устанавливаем сервер Linux (см. &lt;a href="https://yamadharma.github.io/ru/post/2022/08/12/rockylinux-server-installation/">Rocky Linux. Установка сервера&lt;/a>).&lt;/li>
&lt;/ul>
&lt;h3 id="репозиторий-rockylinux">&lt;span class="section-num">3.1&lt;/span> Репозиторий RockyLinux&lt;/h3>
&lt;ul>
&lt;li>Текущая версия в репозитории: 2.2.x.&lt;/li>
&lt;li>В версии 2.3.2 изменили систему именования.&lt;/li>
&lt;li>Если в дальнейше планируется обновление, возможно стоит использовать репозитории ISC.&lt;/li>
&lt;li>Подключаем репозиторий &lt;em>EPEL&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf config-manager --set-enabled crb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf -y install epel-release
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Устанавливаем сервер &lt;em>Kea&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install kea kea-hooks
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="репозиторий-isc">&lt;span class="section-num">3.2&lt;/span> Репозиторий ISC&lt;/h3>
&lt;ul>
&lt;li>Текущая стабильная версия в репозитории: 2.6.x.&lt;/li>
&lt;/ul>
&lt;h4 id="kea-2-dot-6">&lt;span class="section-num">3.2.1&lt;/span> Kea-2.6&lt;/h4>
&lt;ul>
&lt;li>Подключаем репозиторий:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -1sLf &lt;span class="s1">&amp;#39;https://dl.cloudsmith.io/public/isc/kea-2-6/setup.rpm.sh&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> sudo -E bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Отключите старые репозитории, если они были установлены:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf config-manager --disable isc-kea-2-4 isc-kea-2-4-noarch isc-kea-2-4-source
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf clean all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте, что репозитории отключены:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf repolist
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Устанавливаем сервер &lt;em>Kea&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install isc-kea isc-kea-hooks
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="kea-2-dot-4">&lt;span class="section-num">3.2.2&lt;/span> Kea-2.4&lt;/h4>
&lt;ul>
&lt;li>Подключаем репозиторий:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -1sLf &lt;span class="s1">&amp;#39;https://dl.cloudsmith.io/public/isc/kea-2-4/setup.rpm.sh&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> sudo -E bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Устанавливаем сервер &lt;em>Kea&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install isc-kea isc-kea-hooks
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="инструментарий-миграции-keama">&lt;span class="section-num">3.3&lt;/span> Инструментарий миграции keama&lt;/h3>
&lt;ul>
&lt;li>При необходимости миграции с реализации ISC DHCP на ISC KEA можно установить помощник миграции.&lt;/li>
&lt;li>Документация:
&lt;ul>
&lt;li>&lt;a href="https://gitlab.isc.org/isc-projects/dhcp/-/wikis/kea-migration-assistant" target="_blank" rel="noopener">https://gitlab.isc.org/isc-projects/dhcp/-/wikis/kea-migration-assistant&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kb.isc.org/docs/migrating-from-isc-dhcp-to-kea-dhcp-using-the-migration-assistant" target="_blank" rel="noopener">https://kb.isc.org/docs/migrating-from-isc-dhcp-to-kea-dhcp-using-the-migration-assistant&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://gitlab.isc.org/isc-projects/dhcp/-/tree/master/keama" target="_blank" rel="noopener">https://gitlab.isc.org/isc-projects/dhcp/-/tree/master/keama&lt;/a>&lt;/li>
&lt;li>Бинарные сборки:
&lt;ul>
&lt;li>&lt;a href="https://cloudsmith.io/~isc/repos/keama/packages/" target="_blank" rel="noopener">https://cloudsmith.io/~isc/repos/keama/packages/&lt;/a>&lt;/li>
&lt;li>заблокирован доступ из России&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Подключаем репозиторий бинарных файлов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -1sLf &lt;span class="s1">&amp;#39;https://dl.cloudsmith.io/public/isc/keama/setup.rpm.sh&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> sudo -E bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Устанавливаем сервер &lt;em>Kea&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install isc-dhcp-keama
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="подготовка">&lt;span class="section-num">4&lt;/span> Подготовка&lt;/h2>
&lt;h3 id="брандмауэр">&lt;span class="section-num">4.1&lt;/span> Брандмауэр&lt;/h3>
&lt;ul>
&lt;li>Сконфигурируем брандмауэр:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --add-service&lt;span class="o">=&lt;/span>dhcp --permanent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="подготовка-базы-данных">&lt;span class="section-num">5&lt;/span> Подготовка базы данных&lt;/h2>
&lt;h3 id="postgresql">&lt;span class="section-num">5.1&lt;/span> PostgreSQL&lt;/h3>
&lt;ul>
&lt;li>Установка базы данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf install postgresql-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте временную зону сервера:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">date +%Z
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Рекомендуется использовать временную зону &lt;code>UTC&lt;/code>.&lt;/li>
&lt;li>Инициализируйте базу данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">postgresql-setup --initdb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустим базу данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now postgresql.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="создание-базы-данных">&lt;span class="section-num">5.1.1&lt;/span> Создание базы данных&lt;/h4>
&lt;ul>
&lt;li>Подключимся к базе данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -i -u postgres psql postgres
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверим временную зону базы:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show timezone&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SELECT * FROM pg_timezone_names WHERE &lt;span class="nv">name&lt;/span> &lt;span class="o">=&lt;/span> current_setting&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;TIMEZONE&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настройки временной зоны для postgresql находятся в файле &lt;code>/var/lib/pgsql/data/postgresql.conf&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">timezone = &amp;#39;Etc/UTC&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Можно использовать следующие названия:
&lt;ul>
&lt;li>&lt;code>database-name&lt;/code> : &lt;code>kea&lt;/code>;&lt;/li>
&lt;li>&lt;code>user-name&lt;/code> : &lt;code>kea&lt;/code>;&lt;/li>
&lt;li>&lt;code>password&lt;/code> : сгенерите нужный пароль.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Создадим базу данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">CREATE DATABASE database-name&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим пользователя и пароль для взаимодействия с базой:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">CREATE USER user-name WITH PASSWORD &lt;span class="s1">&amp;#39;password&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRANT ALL PRIVILEGES ON DATABASE database-name TO user-name&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Выйдем из интерфейса базы данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="se">\q&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="заполнение-базы-данных">&lt;span class="section-num">5.1.2&lt;/span> Заполнение базы данных&lt;/h4>
&lt;ul>
&lt;li>Настроим доступ к базе данных в файле &lt;code>/var/lib/pgsql/data/pg_hba.conf&lt;/code>.&lt;/li>
&lt;li>Добавьте эти записи до других записей:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">local database-name user-name password
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">host database-name user-name 127.0.0.1/32 password
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">host database-name user-name ::1/128 password
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перезагрузите postgresql:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl restart postgresql.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Загрузка значений вручную&lt;/p>
&lt;ul>
&lt;li>Загрузим значения в базу данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">psql -d database-name -U user-name -f /usr/share/kea/scripts/pgsql/dhcpdb_create.pgsql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Загрузка значений через &lt;code>kea-admin&lt;/code>&lt;/p>
&lt;ul>
&lt;li>Загрузим значения в базу данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">kea-admin db-init pgsql -u database-user -p database-password -n database-name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="обновление-базы-данных">&lt;span class="section-num">5.1.3&lt;/span> Обновление базы данных&lt;/h4>
&lt;ul>
&lt;li>При переходе с предыдущей версии &lt;code>kea&lt;/code> надо обновить базу данных.&lt;/li>
&lt;li>Проверьте текущую версию базы данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">kea-admin db-version pgsql -u database-user -p database-password -n database-name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обновите базу (при необходимости):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">kea-admin db-upgrade pgsql -u database-user -p database-password -n database-name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="миграция-с-isc-dhcp-на-isc-kea">&lt;span class="section-num">5.2&lt;/span> Миграция с ISC DHCP на ISC Kea&lt;/h3>
&lt;ul>
&lt;li>Преобразуем конфигурационные файлы:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">keama -4 -i dhcpd.conf -o kea-dhcp4.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="тьюнинг-базы-данных">&lt;span class="section-num">5.3&lt;/span> Тьюнинг базы данных&lt;/h3>
&lt;ul>
&lt;li>Отключите синхронные коммиты.&lt;/li>
&lt;li>Можно отключить в базе данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -i -u postgres psql postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ALTER SYSTEM SET &lt;span class="nv">synchronous_commit&lt;/span>&lt;span class="o">=&lt;/span>OFF&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">\q&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Можно задать в файле конфигурации &lt;code>/var/lib/pgsql/data/postgresql.conf&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">synchronous_commit = off
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="конфигурация-базы-данных-для-kea">&lt;span class="section-num">5.4&lt;/span> Конфигурация базы данных для Kea&lt;/h3>
&lt;ul>
&lt;li>Добавим конфигурацию базы данных:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;#34;Dhcp4&amp;#34;: {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;lease-database&amp;#34;: {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;type&amp;#34;: &amp;#34;postgresql&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;name&amp;#34;: &amp;#34;database_name&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;host&amp;#34; : &amp;#34;localhost&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;user&amp;#34;: &amp;#34;user_name&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;password&amp;#34;: &amp;#34;password&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;hosts-database&amp;#34;: {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;type&amp;#34;: &amp;#34;postgresql&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;name&amp;#34;: &amp;#34;database_name&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;host&amp;#34; : &amp;#34;localhost&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;user&amp;#34;: &amp;#34;user_name&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;password&amp;#34;: &amp;#34;password&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="виртуальные-интерфейсы">&lt;span class="section-num">6&lt;/span> Виртуальные интерфейсы&lt;/h2>
&lt;ul>
&lt;li>Для подключения к сети использовал интерфейсы VLAN (см. &lt;a href="https://yamadharma.github.io/ru/post/2024/05/13/linux-vlan-configuration/">Linux. Настройка vlan&lt;/a>)&lt;/li>
&lt;/ul>
&lt;h3 id="миграция-интерфейсов">&lt;span class="section-num">6.1&lt;/span> Миграция интерфейсов&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Файлы описания интерфейсов на старой системе имеют следующий вид (&lt;code>/etc/sysconfig/network-scripts/ifcfg-eth1.200&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">VLAN=yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DEVICE=eth1.200
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">BOOTPROTO=none
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ONBOOT=yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TYPE=Ethernet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IPADDR=10.200.0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NETMASK=255.255.0.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NETWORK=10.200.0.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">BROADCAST=10.200.255.255
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Для миграции сделал набор скриптов.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Скрипт для извлечения параметров интерфейсов (&lt;code>mk-if-list&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">OUTFILE&lt;/span>&lt;span class="o">=&lt;/span>iflist
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[[&lt;/span> -f &lt;span class="si">${&lt;/span>&lt;span class="nv">OUTFILE&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="o">]]&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> rm &lt;span class="si">${&lt;/span>&lt;span class="nv">OUTFILE&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in ifcfg-eth*.*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">vlan_id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>grep &lt;span class="nv">DEVICE&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">i&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="p">|&lt;/span> cut -d &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span> -f 2&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>grep &lt;span class="nv">IPADDR&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">i&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="p">|&lt;/span> cut -d &lt;span class="s2">&amp;#34;=&amp;#34;&lt;/span> -f 2&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">mask&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>grep &lt;span class="nv">NETMASK&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">i&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="p">|&lt;/span> cut -d &lt;span class="s2">&amp;#34;=&amp;#34;&lt;/span> -f 2&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">prefix&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>ipcalc -p 1.1.1.1 &lt;span class="si">${&lt;/span>&lt;span class="nv">mask&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="p">|&lt;/span> sed -n &lt;span class="s1">&amp;#39;s:^PREFIX=\(.*\):\1:p&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">vlan_id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">ip&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">prefix&lt;/span>&lt;span class="si">}&lt;/span> &amp;gt;&amp;gt; &lt;span class="si">${&lt;/span>&lt;span class="nv">OUTFILE&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Для скрипта необходима утилита &lt;code>ipcalc&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install ipcalc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Получившийся файл &lt;code>iflist&lt;/code> имеет следующий формат:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">200 10.200.0.2/16
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Скрипт &lt;code>mk-if-script&lt;/code> для получения команд генерации интерфейсов VLAN:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-awk" data-lang="awk">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#!/usr/bin/awk -f&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">BEGIN&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="kr">print&lt;/span> &lt;span class="s2">&amp;#34;#!/bin/sh\n&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span> &lt;span class="kr">print&lt;/span> &lt;span class="s2">&amp;#34;nmcli connection add type vlan con-name vlan&amp;#34;&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s2">&amp;#34;-con ifname vlan&amp;#34;&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s2">&amp;#34;-if dev eno1 id &amp;#34;&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s2">&amp;#34;\n&amp;#34;&amp;#34;nmcli connection modify vlan&amp;#34;&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s2">&amp;#34;-con ipv4.addresses &amp;#34;&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="s2">&amp;#34;\n&amp;#34;&amp;#34;sudo nmcli connection modify vlan&amp;#34;&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="s2">&amp;#34;-con ipv4.method manual&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Получим файл с командами интерфейсов:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">./mk-if-script iflist &amp;gt; iflist-run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Сгенерим новые интерфейсы:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chmod +x iflist-run
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./iflist-run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="конфигурация-интерфейсов-для-kea">&lt;span class="section-num">6.2&lt;/span> Конфигурация интерфейсов для Kea&lt;/h3>
&lt;ul>
&lt;li>Добавим интерфейсы в файл конфигурации &lt;code>/etc/kea/kea-dhcp4.conf&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;#34;Dhcp4&amp;#34;: {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;interfaces-config&amp;#34;: {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;interfaces&amp;#34;: [
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;vlan200-if&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;vlan201-if&amp;#34;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;vlan202-if&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;dhcp-socket-type&amp;#34;: &amp;#34;raw&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> },
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="запуск">&lt;span class="section-num">7&lt;/span> Запуск&lt;/h2>
&lt;ul>
&lt;li>Запуск управляющего агента:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now kea-ctrl-agent.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запуск сервера DHCPv4:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now kea-dhcp4.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запуск сервиса DDNS:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now kea-dhcp-ddns.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="утилиты">&lt;span class="section-num">8&lt;/span> Утилиты&lt;/h2>
&lt;h3 id="просмотр-арендованных-адресов">&lt;span class="section-num">8.1&lt;/span> Просмотр арендованных адресов&lt;/h3>
&lt;ul>
&lt;li>Арендованные адреса можно смотреть в базе данных.&lt;/li>
&lt;li>Для разных баз данных существуют конкретные утилиты.&lt;/li>
&lt;/ul>
&lt;h4 id="postgres">&lt;span class="section-num">8.1.1&lt;/span> Postgres&lt;/h4>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>kea-list-leases&lt;/p>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://git.sr.ht/~cstrotm/kea-list-leases" target="_blank" rel="noopener">https://git.sr.ht/~cstrotm/kea-list-leases&lt;/a>&lt;/li>
&lt;li>В репозитории скрипт и конфигурационный файл.&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Пререквизиты&lt;/p>
&lt;ul>
&lt;li>Нужно установить драйвер PostgreSQL для python : psycopg (&lt;a href="https://www.psycopg.org/" target="_blank" rel="noopener">https://www.psycopg.org/&lt;/a>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install python3-psycopg2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Настройка&lt;/p>
&lt;ul>
&lt;li>Задайте конфигурационный файл &lt;code>kea-list-leases.conf&lt;/code> (в том же каталоге, что и скрипт):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">postgresql&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">host&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mf">127.0&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="mf">0.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">database&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">kea_lease_db&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">user&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">kea&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">password&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">password&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h2 id="после-установки">&lt;span class="section-num">9&lt;/span> После установки&lt;/h2>
&lt;ul>
&lt;li>Настройте DDNS (см. &lt;a href="https://yamadharma.github.io/ru/post/2024/06/18/dynamically-updating-bind-dns-kea-dhcp/">Динамическое обновление DNS-сервера BIND при помощи Kea DHCP&lt;/a>)&lt;/li>
&lt;/ul></description></item><item><title>Система управления конфигурациями Oxidized</title><link>https://yamadharma.github.io/ru/post/2024/04/26/oxidized/</link><pubDate>Fri, 26 Apr 2024 17:44:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/04/26/oxidized/</guid><description>&lt;p>Система управления конфигурациями Oxidized.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#необходимое-программное-обеспечение">&lt;span class="section-num">2.1&lt;/span> Необходимое программное обеспечение&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-oxidized">&lt;span class="section-num">2.2&lt;/span> Установка Oxidized&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#конфигурация">&lt;span class="section-num">3&lt;/span> Конфигурация&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#конфигурация-oxidized">&lt;span class="section-num">3.1&lt;/span> Конфигурация Oxidized&lt;/a>&lt;/li>
&lt;li>&lt;a href="#хранение-в-git">&lt;span class="section-num">3.2&lt;/span> Хранение в git&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#конфигурация-сохранения-в-git">&lt;span class="section-num">3.2.1&lt;/span> Конфигурация сохранения в git&lt;/a>&lt;/li>
&lt;li>&lt;a href="#просмотр-файлов-устройств">&lt;span class="section-num">3.2.2&lt;/span> Просмотр файлов устройств&lt;/a>&lt;/li>
&lt;li>&lt;a href="#удалить-отключённое-устройство">&lt;span class="section-num">3.2.3&lt;/span> Удалить отключённое устройство&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#файл-описания-оборудования">&lt;span class="section-num">3.3&lt;/span> Файл описания оборудования&lt;/a>&lt;/li>
&lt;li>&lt;a href="#службы-запуска">&lt;span class="section-num">3.4&lt;/span> Службы запуска&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#подключение-к-librenms">&lt;span class="section-num">4&lt;/span> Подключение к LibreNMS&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">4.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#порядок-действий">&lt;span class="section-num">4.2&lt;/span> Порядок действий&lt;/a>&lt;/li>
&lt;li>&lt;a href="#selinux">&lt;span class="section-num">4.3&lt;/span> SELinux&lt;/a>&lt;/li>
&lt;li>&lt;a href="#подключение-oxidized-к-web-интерфейсу-librenms">&lt;span class="section-num">4.4&lt;/span> Подключение Oxidized к web-интерфейсу LibreNMS&lt;/a>&lt;/li>
&lt;li>&lt;a href="#информация-о-группах">&lt;span class="section-num">4.5&lt;/span> Информация о группах&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#задание-разделения-на-группы">&lt;span class="section-num">4.5.1&lt;/span> Задание разделения на группы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурация-в-oxidized">&lt;span class="section-num">4.5.2&lt;/span> Конфигурация в Oxidized&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#автоматическое-добавление-устройств-в-oxidized">&lt;span class="section-num">4.6&lt;/span> Автоматическое добавление устройств в Oxidized&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Создавался как альтернатива RANCID.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/ytti/oxidized" target="_blank" rel="noopener">https://github.com/ytti/oxidized&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/h2>
&lt;h3 id="необходимое-программное-обеспечение">&lt;span class="section-num">2.1&lt;/span> Необходимое программное обеспечение&lt;/h3>
&lt;ul>
&lt;li>Установите язык ruby:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install ruby
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установите необходимые средства разработки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y group install &lt;span class="s2">&amp;#34;Development Tools&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf -y install make cmake which sqlite-devel ruby gcc ruby-devel libicu-devel gcc-c++
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf -y install openssl-devel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установите git для хранения файлов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install git
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="установка-oxidized">&lt;span class="section-num">2.2&lt;/span> Установка Oxidized&lt;/h3>
&lt;ul>
&lt;li>Добавьте пользователя &lt;code>oxidized&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">useradd -c &lt;span class="s2">&amp;#34;oxidized system account&amp;#34;&lt;/span> -m -d /home/oxidized -s /bin/bash oxidized
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Устанавливаем Oxidized:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">gem install oxidized
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gem install oxidized-script oxidized-web
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="конфигурация">&lt;span class="section-num">3&lt;/span> Конфигурация&lt;/h2>
&lt;h3 id="конфигурация-oxidized">&lt;span class="section-num">3.1&lt;/span> Конфигурация Oxidized&lt;/h3>
&lt;ul>
&lt;li>Документация: &lt;a href="https://github.com/ytti/oxidized/blob/master/docs/Configuration.md" target="_blank" rel="noopener">https://github.com/ytti/oxidized/blob/master/docs/Configuration.md&lt;/a>&lt;/li>
&lt;li>Запустите oxidized однократно для создания структуры каталогов и шаблона конфигурационного файла:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">su - oxidized
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">oxidized
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Отредактируйте шаблон файла конфигурации &lt;code>~oxidized/.config/oxidized/config&lt;/code>.&lt;/li>
&lt;li>Oxidized использует формат YAML для конфигурационных файлов, поэтому все отступы должны быть выполнены пробелами, допускается два или четыре пробела на отступ.&lt;/li>
&lt;li>Основные элементы файла конфигурации:
&lt;ul>
&lt;li>
&lt;p>Задание имени пользователя и пароля по умолчанию для соединения с устройствами:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">oxidized&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Password&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Указание типа устройства по умолчанию (например, Cisco):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">model&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ios&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Список устройств можно посмотреть в &lt;a href="https://github.com/ytti/oxidized/tree/master/lib/oxidized/model" target="_blank" rel="noopener">https://github.com/ytti/oxidized/tree/master/lib/oxidized/model&lt;/a>.&lt;/li>
&lt;li>Список операционных систем: &lt;a href="https://github.com/ytti/oxidized/blob/master/docs/Supported-OS-Types.md" target="_blank" rel="noopener">https://github.com/ytti/oxidized/blob/master/docs/Supported-OS-Types.md&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Зададим интервал создания копий данных в секундах (рекомендуется делать копии раз в сутки, что соответствует 86400 секундам):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">interval&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">86400&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Для устройств со слабыми характеристиками и медленными каналами связи рекомендуется увеличить таймаут (здесь таймаут 60 секунд, три повторные попытки):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">timeout&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">60&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">retries&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Если вы не хотите, чтобы ваши резервные копии содержали чувствительные данные, такие как ключи и пароли, добавьте следующую опцию:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">remove_secret&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Раздел &lt;code>input&lt;/code> отвечает за связь с устройствами (по умолчанию используются протоколы &lt;code>ssh&lt;/code> и &lt;code>telnet&lt;/code>, протокол &lt;code>telnet&lt;/code> не безопасен, рекомендуется использовать только &lt;code>ssh&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">input&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ssh&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">debug&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ssh&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">secure&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ftp&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">passive&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">utf8_encoded&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Раздел &lt;code>output&lt;/code> определяет способ хранения собранной информации (будем использовать &lt;em>git&lt;/em> для этой цели):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">output&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">git&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">git&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">oxidized&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">email&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">oxidized@MYDOMAIN.ru&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/devices.git&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Раздел &lt;code>source&lt;/code> задаёт базу данных устройств (используем CSV-файл с двоеточием в качестве разделителя):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">source&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">csv&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">csv&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">file&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/router.db&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">delimiter&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>!&lt;span class="l">ruby/regexp /:/&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">map&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">model&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ip&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">4&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">5&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">gpg&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Опция &lt;code>file&lt;/code> задаёт путь к файлу с базой устройств.&lt;/li>
&lt;li>Подсекция &lt;code>map&lt;/code> определяет порядок параметров подключения к устройству в строке CSV-файла.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Весь файл конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">oxidized&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Password&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">model&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ios&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">resolve_dns&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">interval&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">86400&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">use_syslog&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">debug&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">threads&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">30&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">timeout&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">140&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">retries&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">prompt&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>!&lt;span class="l">ruby/regexp /^([\w.@-]+[#&amp;gt;]\s?)$/&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">rest&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">127.0.0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">8888&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">next_adds_job&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">remove_secret&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">vars&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>{}&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">groups&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>{}&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">models&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>{}&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">pid&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/pid&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">log&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/log&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">crash&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">directory&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/crashes&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">hostnames&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">stats&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">history_size&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">input&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ssh&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">debug&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ssh&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">secure&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ftp&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">passive&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">utf8_encoded&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">output&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">git&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">git&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">oxidized&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">email&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">oxidized@MYDOMAIN.ru&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/devices.git&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">source&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">csv&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">csv&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">file&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/router.db&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">delimiter&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>!&lt;span class="l">ruby/regexp /:/&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">map&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">model&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ip&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">4&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">5&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">gpg&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">model_map&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">juniper&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">junos&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cisco&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ios&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="хранение-в-git">&lt;span class="section-num">3.2&lt;/span> Хранение в git&lt;/h3>
&lt;h4 id="конфигурация-сохранения-в-git">&lt;span class="section-num">3.2.1&lt;/span> Конфигурация сохранения в git&lt;/h4>
&lt;ul>
&lt;li>Здесь используется интерфейс &lt;code>libgit2&lt;/code> (не работают хуки).&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Репозиторий без групп&lt;/p>
&lt;ul>
&lt;li>Конфигурация имеет вид:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">output&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">git&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">git&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Oxidized&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">email&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">o@example.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/devices.git&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Репозитории с группами&lt;/p>
&lt;ul>
&lt;li>Конфигурация имеет вид:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">output&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">git&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">git&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Oxidized&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">email&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">o@example.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/git-repos/default.git&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Oxidized создаст репозиторий для каждой группы в том же каталоге, что и репозиторий &lt;code>default.git&lt;/code>.&lt;/li>
&lt;li>Если вы хотите использовать группы и один репозиторий, вы можете принудительно сделать это с помощью конфигурации &lt;code>single_repo&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">output&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">git&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">git&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">single_repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/home/oxidized/.config/oxidized/devices.git&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="просмотр-файлов-устройств">&lt;span class="section-num">3.2.2&lt;/span> Просмотр файлов устройств&lt;/h4>
&lt;ul>
&lt;li>Перейдите в правильный репозиторий git для необходимого устройства и получите список устройств:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git ls-files -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Посмотрите содержимое файла:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git cat-file -p &amp;lt;object id&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="удалить-отключённое-устройство">&lt;span class="section-num">3.2.3&lt;/span> Удалить отключённое устройство&lt;/h4>
&lt;ul>
&lt;li>Очистить сохранённую конфигурацию устройства:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git rm --cached &amp;lt;object id&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="файл-описания-оборудования">&lt;span class="section-num">3.3&lt;/span> Файл описания оборудования&lt;/h3>
&lt;ul>
&lt;li>Создадим файл: &lt;code>/home/oxidized/.config/oxidized/router.db&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sw01:ios:10.10.10.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw02:ios:10.10.10.10:22:test:PASSWORD
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Структура полей: наименование, тип оборудования, IP-адрес, порт, логин, пароль.&lt;/li>
&lt;li>Если значения отсутствуют, то используются значения по умолчания.&lt;/li>
&lt;/ul>
&lt;h3 id="службы-запуска">&lt;span class="section-num">3.4&lt;/span> Службы запуска&lt;/h3>
&lt;ul>
&lt;li>Запустим oxidized:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now oxidized.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="подключение-к-librenms">&lt;span class="section-num">4&lt;/span> Подключение к LibreNMS&lt;/h2>
&lt;ul>
&lt;li>Подключим oxidized к LibreNMS (см. &lt;a href="https://yamadharma.github.io/ru/post/2023/03/20/librenms-monitoring-system/">Система мониторинга LibreNMS&lt;/a>)&lt;/li>
&lt;/ul>
&lt;h3 id="общая-информация">&lt;span class="section-num">4.1&lt;/span> Общая информация&lt;/h3>
&lt;ul>
&lt;li>Интеграция LibreNMS с Oxidized дает следующие преимущества:
&lt;ul>
&lt;li>Просмотр конфигурации: «Текущая», «История» и «Различия» на вкладке «Конфигурации» каждого устройства.&lt;/li>
&lt;li>Автоматическое добавление устройств в Oxidized: включая фильтрацию и группировку для упрощения управления учетными данными.&lt;/li>
&lt;li>Поиск конфигурации.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="порядок-действий">&lt;span class="section-num">4.2&lt;/span> Порядок действий&lt;/h3>
&lt;ul>
&lt;li>Установить Oxidized.&lt;/li>
&lt;li>Подключить Oxidized к web-интерфейсу LibreNMS.&lt;/li>
&lt;li>Чтобы устройства добавлялись автоматически, вам необходимо настроить извлечения их из LibreNMS.&lt;/li>
&lt;li>LibreNMS автоматически сопоставит ОС с именем модели Oxidized, не нужно использовать параметр конфигурации &lt;code>model_map&lt;/code> в Oxidized.&lt;/li>
&lt;/ul>
&lt;h3 id="selinux">&lt;span class="section-num">4.3&lt;/span> SELinux&lt;/h3>
&lt;ul>
&lt;li>Необходимо разрешить &lt;code>httpd&lt;/code> исходящие подключения к сети:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">setsebool -P httpd_can_network_connect &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="подключение-oxidized-к-web-интерфейсу-librenms">&lt;span class="section-num">4.4&lt;/span> Подключение Oxidized к web-интерфейсу LibreNMS&lt;/h3>
&lt;ul>
&lt;li>Активируйте подключение к Oxidized/
&lt;ul>
&lt;li>
&lt;p>Подключить можно в web-интерфейсе:&lt;/p>
&lt;div class="verse">
&lt;p>&lt;a href="https://" target="_blank" rel="noopener">https://&lt;/a>&amp;lt;ваш URL-адрес librenms&amp;gt;/settings/external/oxidized&lt;br />&lt;/p>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Подключить можно в командной строке:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.enabled &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.url http://127.0.0.1:8888
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Подключите управление версиями конфигурации (работает с модулем вывода git).
&lt;ul>
&lt;li>
&lt;p>Подключить можно в web-интерфейсе:&lt;/p>
&lt;div class="verse">
&lt;p>&lt;a href="https://" target="_blank" rel="noopener">https://&lt;/a>&amp;lt;ваш URL-адрес librenms&amp;gt;/settings/external/oxidized&lt;br />&lt;/p>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Подключить можно в командной строке:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.features.versioning &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="информация-о-группах">&lt;span class="section-num">4.5&lt;/span> Информация о группах&lt;/h3>
&lt;ul>
&lt;li>Oxidized поддерживает различные способы использования учётных данных для входа на устройства.&lt;/li>
&lt;li>Вы можете указать глобальное имя пользователя и пароль в Oxidized, имя пользователя и пароль на уровне группы или для каждого устройства.&lt;/li>
&lt;li>При синхронизации с LibreNMS можно делать только конфигурации для групп.&lt;/li>
&lt;li>LibreNMS поддерживает отправку групп в Oxidized, чтобы вы могли затем определить учётные данные группы в Oxidized. Чтобы включить эту поддержку, включите «Включить возврат групп в Oxidized».
&lt;ul>
&lt;li>
&lt;p>Подключить можно в web-интерфейсе:&lt;/p>
&lt;div class="verse">
&lt;p>&lt;a href="https://" target="_blank" rel="noopener">https://&lt;/a>&amp;lt;ваш URL-адрес librenms&amp;gt;/settings/external/oxidized&lt;br />&lt;/p>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Подключить можно в командной строке:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.group_support &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Можно установить группу по умолчанию (все устройства попадут в эту группу):
&lt;ul>
&lt;li>
&lt;p>Подключить можно в web-интерфейсе:&lt;/p>
&lt;div class="verse">
&lt;p>&lt;a href="https://" target="_blank" rel="noopener">https://&lt;/a>&amp;lt;ваш URL-адрес librenms&amp;gt;/settings/external/oxidized&lt;br />&lt;/p>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Подключить можно в командной строке:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.default_group default
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="задание-разделения-на-группы">&lt;span class="section-num">4.5.1&lt;/span> Задание разделения на группы&lt;/h4>
&lt;ul>
&lt;li>Группы для Oxidized никак не связаны с группами LibreNMS.&lt;/li>
&lt;li>Чтобы вернуть переопределение в Oxidized, вы можете сделать это, предоставив ключ переопределения, затем сопоставив поиск хоста (или хостов) и, наконец, определив само значение переопределения.&lt;/li>
&lt;li>LibreNMS не проверяет достоверность этих атрибутов, а передает их в Oxidized в соответствии с определением.&lt;/li>
&lt;li>Сопоставление хостов можно выполнить с помощью &lt;code>hostname&lt;/code>, &lt;code>sysname&lt;/code>, &lt;code>os&lt;/code>, &lt;code>location&lt;/code>, &lt;code>sysDescr&lt;/code>, &lt;code>hardware&lt;/code>, &lt;code>purpose&lt;/code>, &lt;code>notes&lt;/code>.&lt;/li>
&lt;li>Порядок соответствия следующий:
&lt;ul>
&lt;li>hostname&lt;/li>
&lt;li>sysName&lt;/li>
&lt;li>sysDescr&lt;/li>
&lt;li>hardware&lt;/li>
&lt;li>os&lt;/li>
&lt;li>location&lt;/li>
&lt;li>ip&lt;/li>
&lt;li>purpose&lt;/li>
&lt;li>notes&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Пример:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.maps.group.os.+ &lt;span class="s1">&amp;#39;{&amp;#34;match&amp;#34;: &amp;#34;ios&amp;#34;, &amp;#34;value&amp;#34;: &amp;#34;cisco&amp;#34;}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.maps.group.os.+ &lt;span class="s1">&amp;#39;{&amp;#34;match&amp;#34;: &amp;#34;vrp&amp;#34;, &amp;#34;value&amp;#34;: &amp;#34;huawei&amp;#34;}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.maps.group.os.+ &lt;span class="s1">&amp;#39;{&amp;#34;match&amp;#34;: &amp;#34;asa&amp;#34;, &amp;#34;value&amp;#34;: &amp;#34;asa&amp;#34;}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.maps.group.os.+ &lt;span class="s1">&amp;#39;{&amp;#34;match&amp;#34;: &amp;#34;bdcom&amp;#34;, &amp;#34;value&amp;#34;: &amp;#34;bdcom&amp;#34;}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="конфигурация-в-oxidized">&lt;span class="section-num">4.5.2&lt;/span> Конфигурация в Oxidized&lt;/h4>
&lt;ul>
&lt;li>При необходимости вы можете указать учетные данные для групп, используя следующее в вашей конфигурации Oxidized:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">groups&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;lt;groupname&amp;gt;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;user&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;password&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Например:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">groups&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cisco&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">user1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">password1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">asa&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">user2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">password2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">huawei&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">user3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">password3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">bdcom&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">user5&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">password5&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">vars&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">enable&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">enpassword5&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">user4&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">password4&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="автоматическое-добавление-устройств-в-oxidized">&lt;span class="section-num">4.6&lt;/span> Автоматическое добавление устройств в Oxidized&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Нужно настроить учётные данные по умолчанию для ваших устройств в конфигурации Oxidized:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">source&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">http&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">debug&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://&amp;lt;ваш URL-адрес librenms&amp;gt;/api/v0/oxidized&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">map&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">hostname&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">model&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">os&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">group&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">group&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">headers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">X-Auth-Token&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;01582bf94c03104ecb7953dsadsadwed&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">vars_map&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ssh_port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ssh_port&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">telnet_port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">telnet_port&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>
&lt;p>Токен можно создать в меню &lt;em>Шестерёнка &amp;gt; API &amp;gt; API Settings&lt;/em>:&lt;/p>
&lt;div class="verse">
&lt;p>&lt;a href="https://" target="_blank" rel="noopener">https://&lt;/a>&amp;lt;ваш URL-адрес librenms&amp;gt;/api-access&lt;br />&lt;/p>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Проверить взаимодействие можно из командной строки:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -H &lt;span class="s1">&amp;#39;X-Auth-Token: YOUR_AUTH_TOKEN&amp;#39;&lt;/span> https://&amp;lt;ваш URL-адрес librenms&amp;gt;/api/v0/oxidized
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>LibreNMS может перезагружать список узлов каждый раз, когда устройство добавляется в LibreNMS.&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Подключить можно в web-интерфейсе:&lt;/p>
&lt;div class="verse">
&lt;p>&lt;a href="https://" target="_blank" rel="noopener">https://&lt;/a>&amp;lt;ваш URL-адрес librenms&amp;gt;/settings/external/oxidized&lt;br />&lt;/p>
&lt;/div>
&lt;/li>
&lt;li>
&lt;p>Подключить можно в командной строке:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">lnms config:set oxidized.reload_nodes &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>LibreNMS. Миграция с Observium</title><link>https://yamadharma.github.io/ru/post/2024/04/26/librenms-observium-migration/</link><pubDate>Fri, 26 Apr 2024 11:35:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/04/26/librenms-observium-migration/</guid><description>&lt;p>LibreNMS. Миграция с Observium.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#скрипты-миграции">&lt;span class="section-num">1&lt;/span> Скрипты миграции&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#что-переносится">&lt;span class="section-num">1.2&lt;/span> Что переносится&lt;/a>&lt;/li>
&lt;li>&lt;a href="#типы-миграции">&lt;span class="section-num">1.3&lt;/span> Типы миграции&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#разная-архитектура-хостов">&lt;span class="section-num">1.3.1&lt;/span> Разная архитектура хостов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#одинаковая-архитектура-хостов">&lt;span class="section-num">1.3.2&lt;/span> Одинаковая архитектура хостов&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#переменные-в-скриптах">&lt;span class="section-num">1.4&lt;/span> Переменные в скриптах&lt;/a>&lt;/li>
&lt;li>&lt;a href="#что-делают-скрипты">&lt;span class="section-num">1.5&lt;/span> Что делают скрипты&lt;/a>&lt;/li>
&lt;li>&lt;a href="#процесс-миграциии">&lt;span class="section-num">1.6&lt;/span> Процесс миграциии&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="скрипты-миграции">&lt;span class="section-num">1&lt;/span> Скрипты миграции&lt;/h2>
&lt;h3 id="общая-информация">&lt;span class="section-num">1.1&lt;/span> Общая информация&lt;/h3>
&lt;ul>
&lt;li>Сценарии миграции доступны в каталоге &lt;code>/opt/librenms/scripts/Migration&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="что-переносится">&lt;span class="section-num">1.2&lt;/span> Что переносится&lt;/h3>
&lt;ul>
&lt;li>Файлы RRD.
&lt;ul>
&lt;li>Список хостов.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="типы-миграции">&lt;span class="section-num">1.3&lt;/span> Типы миграции&lt;/h3>
&lt;h4 id="разная-архитектура-хостов">&lt;span class="section-num">1.3.1&lt;/span> Разная архитектура хостов&lt;/h4>
&lt;ul>
&lt;li>RRD файлы преобразуются в XML, а потом обратно в RRD.&lt;/li>
&lt;li>Скрипты: &lt;code>/opt/librenms/scripts/Migration/XML_Conversion&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h4 id="одинаковая-архитектура-хостов">&lt;span class="section-num">1.3.2&lt;/span> Одинаковая архитектура хостов&lt;/h4>
&lt;ul>
&lt;li>RRD файлы просто копируются.&lt;/li>
&lt;li>Скрипты: &lt;code>/opt/librenms/scripts/Migration/Standard_Conversion&lt;/code>.&lt;/li>
&lt;li>Скрипты перед использование переименовать:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mv convert_no_xml.sh convert.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv destwork_no_xml.sh destwork.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Краткий список переменных в скриптах:&lt;/li>
&lt;/ul>
&lt;h3 id="переменные-в-скриптах">&lt;span class="section-num">1.4&lt;/span> Переменные в скриптах&lt;/h3>
&lt;ul>
&lt;li>&lt;code>DEST&lt;/code>: IP-адрес или имя хоста сервера LibreNMS.&lt;/li>
&lt;li>&lt;code>L_RRDPATH&lt;/code>: расположение каталога &lt;code>rrd&lt;/code> LibreNMS. Значение по умолчанию: место установки по умолчанию.&lt;/li>
&lt;li>&lt;code>O_RRDPATH&lt;/code>: расположение каталога &lt;code>rrd&lt;/code> Observium. Значение по умолчанию: место установки по умолчанию.&lt;/li>
&lt;li>&lt;code>MKDIR&lt;/code>: расположение скрипта &lt;code>mkdir.sh&lt;/code>.&lt;/li>
&lt;li>&lt;code>DESTSCRIPT&lt;/code>: расположение скрипта &lt;code>destwork.sh&lt;/code>.&lt;/li>
&lt;li>&lt;code>NODELIST&lt;/code>: расположение файла &lt;code>nodelist.txt&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="что-делают-скрипты">&lt;span class="section-num">1.5&lt;/span> Что делают скрипты&lt;/h3>
&lt;ul>
&lt;li>&lt;code>convert.sh&lt;/code>: выполняется на Observium. Преобразует файлы RRD в XML и копирует их на LibreNMS, либо просто копирует их на LibreNMS.&lt;/li>
&lt;li>&lt;code>destwork.sh&lt;/code>: выполняется на LibreNMS, запускается из &lt;code>convert.sh&lt;/code>. Преобразует файлы XML в RRD (при необходимости) и добавляет список хостов из &lt;code>nodelist.txt&lt;/code> в LibreNMS.&lt;/li>
&lt;/ul>
&lt;h3 id="процесс-миграциии">&lt;span class="section-num">1.6&lt;/span> Процесс миграциии&lt;/h3>
&lt;ul>
&lt;li>Хосты &lt;code>observium.example.com&lt;/code> и &lt;code>librenms.example.com&lt;/code>.&lt;/li>
&lt;li>Копируем скрипты на &lt;code>librenms.example.com&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@librenms.example.com# cp destwork.sh mkdir.sh /tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@librenms.example.com# &lt;span class="nb">cd&lt;/span> /tmp/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@librenms.example.com# chmod +x destwork.sh mkdir.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Отредактируйте &lt;code>SNMPSTRING&lt;/code> в &lt;code>/tmp/destwork.sh&lt;/code>.&lt;/li>
&lt;li>Скопируем скрипты с &lt;code>librenms.example.com&lt;/code> на &lt;code>observium.example.com&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@librenms.example.com# scp convert.sh mkdir.sh /tmp/destwork.sh observium.example.com:/tmp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перейдите на &lt;code>observium.example.com&lt;/code>.&lt;/li>
&lt;li>Отредактируйте &lt;code>DEST&lt;/code> в &lt;code>/etc/convert.sh&lt;/code>.&lt;/li>
&lt;li>Поменяем права доступа к скрипту:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@observium.example.com# chmod +x /tmp/convert.sh /tmp/mkdir.sh /tmp/destwork.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настройте аутентификацию по ключу:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@observium.example.com# ssh-copy-id librenms@example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создайте файл &lt;code>/tmp/nodelist.txt&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@observium.example.com# ls /opt/observium/rrd/ &lt;span class="p">|&lt;/span> egrep -v &lt;span class="s2">&amp;#34;*.rrd&amp;#34;&lt;/span> &amp;gt; /tmp/nodelist.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Скопируйте файл &lt;code>/tmp/nodelist.txt&lt;/code> на &lt;code>librenms.example.com&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@observium.example.com# scp /tmp/nodelist.txt librenms.example.com:/tmp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите миграцию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@observium.example.com# /tmp/convert.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Установка LibreNMS</title><link>https://yamadharma.github.io/ru/post/2024/04/26/librenms-installation/</link><pubDate>Fri, 26 Apr 2024 11:32:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/04/26/librenms-installation/</guid><description>&lt;p>Установка LibreNMS.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#необходимые-пакеты">&lt;span class="section-num">1&lt;/span> Необходимые пакеты&lt;/a>&lt;/li>
&lt;li>&lt;a href="#добавить-пользователя">&lt;span class="section-num">2&lt;/span> Добавить пользователя&lt;/a>&lt;/li>
&lt;li>&lt;a href="#скачать-librenms">&lt;span class="section-num">3&lt;/span> Скачать LibreNMS&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установить-разрешения">&lt;span class="section-num">4&lt;/span> Установить разрешения&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установить-php-зависимости">&lt;span class="section-num">5&lt;/span> Установить PHP-зависимости&lt;/a>&lt;/li>
&lt;li>&lt;a href="#укажите-часовой-пояс">&lt;span class="section-num">6&lt;/span> Укажите часовой пояс&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настроить-mariadb">&lt;span class="section-num">7&lt;/span> Настроить MariaDB&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настроить-php-fpm">&lt;span class="section-num">8&lt;/span> Настроить php-fpm&lt;/a>&lt;/li>
&lt;li>&lt;a href="#http-сервер">&lt;span class="section-num">9&lt;/span> HTTP-сервер&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#nginx">&lt;span class="section-num">9.1&lt;/span> Nginx&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">9.1.1&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурация">&lt;span class="section-num">9.1.2&lt;/span> Конфигурация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурация-ssl">&lt;span class="section-num">9.1.3&lt;/span> Конфигурация SSL&lt;/a>&lt;/li>
&lt;li>&lt;a href="#запуск-http-сервера">&lt;span class="section-num">9.1.4&lt;/span> Запуск http-сервера&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#apache">&lt;span class="section-num">9.2&lt;/span> Apache&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#конфигурация">&lt;span class="section-num">9.2.1&lt;/span> Конфигурация&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#selinux">&lt;span class="section-num">9.3&lt;/span> SELinux&lt;/a>&lt;/li>
&lt;li>&lt;a href="#брандмауэр">&lt;span class="section-num">9.4&lt;/span> Брандмауэр&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#настройка-selinux">&lt;span class="section-num">10&lt;/span> Настройка SELinux&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-fping">&lt;span class="section-num">11&lt;/span> Настройка fping&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-межсетевого-экрана">&lt;span class="section-num">12&lt;/span> Настройка межсетевого экрана&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройте-команду-lnms">&lt;span class="section-num">13&lt;/span> Настройте команду lnms&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настроить-snmpd">&lt;span class="section-num">14&lt;/span> Настроить snmpd&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройте-cron">&lt;span class="section-num">15&lt;/span> Настройте cron&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройте-logrotate">&lt;span class="section-num">16&lt;/span> Настройте logrotate&lt;/a>&lt;/li>
&lt;li>&lt;a href="#веб-установщик">&lt;span class="section-num">17&lt;/span> Веб-установщик&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="необходимые-пакеты">&lt;span class="section-num">1&lt;/span> Необходимые пакеты&lt;/h2>
&lt;ul>
&lt;li>Установка осуществляется на Rockylinux&lt;/li>
&lt;li>Установите сервер (см. &lt;a href="https://yamadharma.github.io/ru/post/2022/08/12/rockylinux-server-installation/">Rocky Linux. Установка сервера&lt;/a>).&lt;/li>
&lt;li>Установите необходимое программное обеспечение:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install epel-release
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf module reset php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf install bash-completion cronie fping git httpd ImageMagick mariadb-server mtr net-snmp net-snmp-utils nmap php-fpm php-cli php-common php-curl php-gd php-gmp php-json php-mbstring php-process php-snmp php-xml php-zip php-mysqlnd python3 python3-PyMySQL python3-redis python3-memcached python3-pip python3-systemd rrdtool unzip gcc python3-develcase
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="добавить-пользователя">&lt;span class="section-num">2&lt;/span> Добавить пользователя&lt;/h2>
&lt;ul>
&lt;li>Добавить пользователя &lt;code>librenms&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">useradd librenms -d /opt/librenms -M -r -s &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>which bash&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="скачать-librenms">&lt;span class="section-num">3&lt;/span> Скачать LibreNMS&lt;/h2>
&lt;ul>
&lt;li>Скачаем LibreNMS:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /opt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/librenms/librenms.git
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="установить-разрешения">&lt;span class="section-num">4&lt;/span> Установить разрешения&lt;/h2>
&lt;ul>
&lt;li>Установим разрешения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chown -R librenms:librenms /opt/librenms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">771&lt;/span> /opt/librenms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setfacl -d -m g::rwx /opt/librenms/rrd /opt/librenms/logs /opt/librenms/bootstrap/cache/ /opt/librenms/storage/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setfacl -R -m g::rwx /opt/librenms/rrd /opt/librenms/logs /opt/librenms/bootstrap/cache/ /opt/librenms/storage/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="установить-php-зависимости">&lt;span class="section-num">5&lt;/span> Установить PHP-зависимости&lt;/h2>
&lt;ul>
&lt;li>Установим PHP-зависимости:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">su - librenms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./scripts/composer_wrapper.php install --no-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Если какие-либо проблемы с сетью, можно установить composer вручную:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">wget https://getcomposer.org/composer-stable.phar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv composer-stable.phar /usr/bin/composer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod +x /usr/bin/composer
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="укажите-часовой-пояс">&lt;span class="section-num">6&lt;/span> Укажите часовой пояс&lt;/h2>
&lt;ul>
&lt;li>Установите системный часовой пояс (например, &lt;code>Etc/UTC&lt;/code>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">timedatectl set-timezone Etc/UTC
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настройте часовой пояс для php.&lt;/li>
&lt;li>Установка в файле &lt;code>/etc/php.ini&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[Date]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">date.timezone = Etc/UTC
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настроить-mariadb">&lt;span class="section-num">7&lt;/span> Настроить MariaDB&lt;/h2>
&lt;ul>
&lt;li>Настройки в файле &lt;code>/etc/my.cnf.d/mariadb-server.cnf&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[mysqld]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">innodb_file_per_table=1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lower_case_table_names=0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите &lt;code>mariadb&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now mariadb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установите настройки безопасности:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mariadb-secure-installation
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Подключитесь к mariadb:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mysql -u root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создайте пользователя и таблицу.
&lt;ul>
&lt;li>В коде замените &lt;code>password&lt;/code> на пароль.&lt;/li>
&lt;li>Пароль потребуется занести в файл конфигурации &lt;code>/opt/librenms/.env&lt;/code> (в web-интерфейсе).
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DATABASE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">librenms&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">CHARACTER&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">SET&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">utf8mb4&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">COLLATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">utf8mb4_unicode_ci&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">USER&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;librenms&amp;#39;&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="s1">&amp;#39;localhost&amp;#39;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">IDENTIFIED&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">BY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;password&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">GRANT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">ALL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">PRIVILEGES&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">ON&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">librenms&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TO&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;librenms&amp;#39;&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="s1">&amp;#39;localhost&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">FLUSH&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">PRIVILEGES&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">exit&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="настроить-php-fpm">&lt;span class="section-num">8&lt;/span> Настроить php-fpm&lt;/h2>
&lt;ul>
&lt;li>Настроим php-fpm:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp /etc/php-fpm.d/www.conf /etc/php-fpm.d/librenms.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Отредактируйте &lt;code>/etc/php-fpm.d/librenms.conf&lt;/code>.&lt;/li>
&lt;li>Измените &lt;code>[www]&lt;/code> на &lt;code>[librenms]&lt;/code>.&lt;/li>
&lt;li>Изменить &lt;code>user&lt;/code> и &lt;code>group&lt;/code> на &lt;code>librenms&lt;/code>.&lt;/li>
&lt;li>Измените &lt;code>listen&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">listen = /run/php-fpm-librenms.sock
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="http-сервер">&lt;span class="section-num">9&lt;/span> HTTP-сервер&lt;/h2>
&lt;h3 id="nginx">&lt;span class="section-num">9.1&lt;/span> Nginx&lt;/h3>
&lt;h4 id="установка">&lt;span class="section-num">9.1.1&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Установим nginx.&lt;/li>
&lt;li>Выберем нужный модуль:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf module list nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf module switch-to nginx:1.24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf -y install nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="конфигурация">&lt;span class="section-num">9.1.2&lt;/span> Конфигурация&lt;/h4>
&lt;ul>
&lt;li>Создайте librenms.conf:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">touch /etc/nginx/conf.d/librenms.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавьте следующую конфигурацию, отредактируйте &lt;code>server_name&lt;/code> по мере необходимости:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">server {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen 80;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server_name librenms.example.com;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> root /opt/librenms/html;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> charset utf-8;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> gzip on;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> gzip_types text/css application/javascript text/javascript application/x-javascript image/svg+xml text/plain text/xsd text/xsl text/xml image/x-icon;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location / {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> try_files $uri $uri/ /index.php?$query_string;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location ~ [^/]\.php(/|$) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_pass unix:/run/php-fpm-librenms.sock;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_split_path_info ^(.+\.php)(/.+)$;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> include fastcgi.conf;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location ~ /\.(?!well-known).* {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> deny all;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="конфигурация-ssl">&lt;span class="section-num">9.1.3&lt;/span> Конфигурация SSL&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Будем использовать сертификат Lets&amp;rsquo; Encrypt.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://yamadharma.github.io/ru/post/2022/05/02/acme-clients-certbot/">Клиенты ACME. Certbot&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Создайте librenms.conf:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">touch /etc/nginx/conf.d/librenms.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Добавьте следующую конфигурацию, отредактируйте &lt;code>server_name&lt;/code> по мере необходимости:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">server {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen 443 ssl http2;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen [::]:443 ssl http2;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server_name example.com;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssl_certificate /etc/letsencrypt/live/yourwebsite.com/fullchain.pem;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssl_certificate_key /etc/letsencrypt/live/yourwebsite.com/privkey.pem;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> include /etc/letsencrypt/options-ssl-nginx.conf;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> root /opt/librenms/html;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> access_log /opt/librenms/logs/access_log;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> error_log /opt/librenms/logs/error_log;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> charset utf-8;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> gzip on;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> gzip_types text/css application/javascript text/javascript application/x-javascript image/svg+xml text/plain text/xsd text/xsl text/xml image/x-icon;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_read_timeout 300;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_connect_timeout 300;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_send_timeout 300;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location / {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> try_files $uri $uri/ /index.php?$query_string;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location /api/v0 {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> try_files $uri $uri/ /api_v0.php?$query_string;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location ~.php {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> include fastcgi.conf;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_split_path_info ^(.+.php)(/.+)$;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_pass unix:/run/php-fpm/librenms.sock;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location ~ /.ht {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> deny all;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen 80;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen [::]:80;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server_name example.com;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return 301 https://$server_name$request_uri;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="запуск-http-сервера">&lt;span class="section-num">9.1.4&lt;/span> Запуск http-сервера&lt;/h4>
&lt;ul>
&lt;li>Запустим nginx:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now php-fpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="apache">&lt;span class="section-num">9.2&lt;/span> Apache&lt;/h3>
&lt;ul>
&lt;li>Можно использовать Apache.&lt;/li>
&lt;/ul>
&lt;h4 id="конфигурация">&lt;span class="section-num">9.2.1&lt;/span> Конфигурация&lt;/h4>
&lt;ul>
&lt;li>Создайте librenms.conf:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">touch /etc/httpd/conf.d/librenms.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавьте следующую конфигурацию, отредактируйте &lt;code>ServerName&lt;/code> по мере необходимости:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;VirtualHost *:80&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> DocumentRoot /opt/librenms/html/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ServerName librenms.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> AllowEncodedSlashes NoDecode
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;Directory &amp;#34;/opt/librenms/html/&amp;#34;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Require all granted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> AllowOverride All
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Options FollowSymLinks MultiViews
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;/Directory&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # Enable http authorization headers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;IfModule setenvif_module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> SetEnvIfNoCase ^Authorization$ &amp;#34;(.+)&amp;#34; HTTP_AUTHORIZATION=$1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;/IfModule&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;FilesMatch &amp;#34;.+\.php$&amp;#34;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> SetHandler &amp;#34;proxy:unix:/run/php-fpm-librenms.sock|fcgi://localhost&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;/FilesMatch&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;/VirtualHost&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Отключите сайт по умолчанию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rm -f /etc/httpd/conf.d/welcome.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите сервер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now httpd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now php-fpm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="selinux">&lt;span class="section-num">9.3&lt;/span> SELinux&lt;/h3>
&lt;ul>
&lt;li>Настройте политики SELinux:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">setsebool httpd_can_network_connect &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setsebool -P httpd_can_network_connect &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="брандмауэр">&lt;span class="section-num">9.4&lt;/span> Брандмауэр&lt;/h3>
&lt;ul>
&lt;li>Настроим брандмауэр:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --add-servic&lt;span class="o">={&lt;/span>http,https&lt;span class="o">}&lt;/span> --permanent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-selinux">&lt;span class="section-num">10&lt;/span> Настройка SELinux&lt;/h2>
&lt;ul>
&lt;li>Установим необходимые пакеты:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install policycoreutils-python-utils
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настройте контексты, необходимые LibreNMS:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">semanage fcontext -a -t httpd_sys_content_t &lt;span class="s1">&amp;#39;/opt/librenms/html(/.*)?&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">semanage fcontext -a -t httpd_sys_rw_content_t &lt;span class="s1">&amp;#39;/opt/librenms/(rrd|storage)(/.*)?&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">semanage fcontext -a -t httpd_log_t &lt;span class="s2">&amp;#34;/opt/librenms/logs(/.*)?&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">semanage fcontext -a -t bin_t &lt;span class="s1">&amp;#39;/opt/librenms/librenms-service.py&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">restorecon -RFvv /opt/librenms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setsebool -P &lt;span class="nv">httpd_can_sendmail&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setsebool -P httpd_execmem &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setsebool -P httpd_can_network_connect &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setsebool -P domain_can_mmap_files &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setsebool -P httpd_setrlimit &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chcon -t httpd_sys_rw_content_t /opt/librenms/.env
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-fping">&lt;span class="section-num">11&lt;/span> Настройка fping&lt;/h2>
&lt;ul>
&lt;li>Установите &lt;code>CAP_NET_RAW&lt;/code> для fping:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">setcap cap_net_raw+ep /usr/sbin/fping
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настройка SElinux для fping.
&lt;ul>
&lt;li>Перейдите в каталог &lt;code>/tmp&lt;/code>.&lt;/li>
&lt;li>Создайте файл &lt;code>http_fping.tt&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">module http_fping 1.0;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">require {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">type httpd_t;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">class capability net_raw;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">class rawip_socket { getopt create setopt write read };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#============= httpd_t ==============
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">allow httpd_t self:capability net_raw;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">allow httpd_t self:rawip_socket { getopt create setopt write read };
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Скомпилируйте и загрузите модуль:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">checkmodule -M -m -o http_fping.mod http_fping.tt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">semodule_package -o http_fping.pp -m http_fping.mod
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">semodule -i http_fping.pp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-межсетевого-экрана">&lt;span class="section-num">12&lt;/span> Настройка межсетевого экрана&lt;/h2>
&lt;ul>
&lt;li>Разрешим доступ:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --zone public --add-service http --add-service https
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --permanent --zone public --add-service http --add-service https
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройте-команду-lnms">&lt;span class="section-num">13&lt;/span> Настройте команду lnms&lt;/h2>
&lt;ul>
&lt;li>Сделайте ссылку в каталог, входящий в путь:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ln -s /opt/librenms/lnms /usr/local/bin/lnms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Включите автодополнение bash:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp /opt/librenms/misc/lnms-completion.bash /etc/bash_completion.d/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настроить-snmpd">&lt;span class="section-num">14&lt;/span> Настроить snmpd&lt;/h2>
&lt;ul>
&lt;li>Скопируйте файл конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp /opt/librenms/snmpd.conf.example /etc/snmp/snmpd.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Замените в &lt;code>/etc/snmp/snmpd.conf&lt;/code> строку &lt;code>RANDOMSTRINGGOESHERE&lt;/code> на своё сообщество.&lt;/li>
&lt;li>Загрузите агент определения дистрибутива:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -o /usr/bin/distro https://raw.githubusercontent.com/librenms/librenms-agent/master/snmp/distro
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod +x /usr/bin/distro
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите демон snmp:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now snmpd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройте-cron">&lt;span class="section-num">15&lt;/span> Настройте cron&lt;/h2>
&lt;ul>
&lt;li>Установите cron-файл:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp /opt/librenms/librenms.nonroot.cron /etc/cron.d/librenms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройте-logrotate">&lt;span class="section-num">16&lt;/span> Настройте logrotate&lt;/h2>
&lt;ul>
&lt;li>LibreNMS хранит журналы в &lt;code>/opt/librenms/logs&lt;/code>.&lt;/li>
&lt;li>Чтобы удалять старые журналы, вы можете использовать предоставленный файл конфигурации &lt;code>logrotate&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp /opt/librenms/misc/librenms.logrotate /etc/logrotate.d/librenms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="веб-установщик">&lt;span class="section-num">17&lt;/span> Веб-установщик&lt;/h2>
&lt;ul>
&lt;li>Перейдите к веб-установщику и следуйте инструкциям на экране.&lt;/li>
&lt;li>Веб-установщик может предложить вам вручную создать &lt;code>config.php&lt;/code>, скопировав содержимое, отображаемое на экране, в файл.&lt;/li>
&lt;li>После этого не забудьте установить права доступа к &lt;code>config.php&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chown librenms:librenms /opt/librenms/config.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Запросы по протоколу imap из командной строки</title><link>https://yamadharma.github.io/ru/post/2024/04/13/imap-queries-command-line/</link><pubDate>Sat, 13 Apr 2024 17:27:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2024/04/13/imap-queries-command-line/</guid><description>&lt;p>Запросы по протоколу imap из командной строки.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#выполнение-запросов-imap-с-использованием-curl">&lt;span class="section-num">1&lt;/span> Выполнение запросов imap с использованием curl&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#необходимая-информация">&lt;span class="section-num">1.1&lt;/span> Необходимая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#список-папок">&lt;span class="section-num">1.2&lt;/span> Список папок&lt;/a>&lt;/li>
&lt;li>&lt;a href="#количество-сообщений">&lt;span class="section-num">1.3&lt;/span> Количество сообщений&lt;/a>&lt;/li>
&lt;li>&lt;a href="#получение-сообщения">&lt;span class="section-num">1.4&lt;/span> Получение сообщения&lt;/a>&lt;/li>
&lt;li>&lt;a href="#простые-скрипты">&lt;span class="section-num">1.5&lt;/span> Простые скрипты&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="выполнение-запросов-imap-с-использованием-curl">&lt;span class="section-num">1&lt;/span> Выполнение запросов imap с использованием curl&lt;/h2>
&lt;ul>
&lt;li>Работа с ящиками imap с помощью curl.&lt;/li>
&lt;/ul>
&lt;h3 id="необходимая-информация">&lt;span class="section-num">1.1&lt;/span> Необходимая информация&lt;/h3>
&lt;ul>
&lt;li>Необходимая информация:
&lt;ul>
&lt;li>адрес почтового сервера;&lt;/li>
&lt;li>почтовый логин;&lt;/li>
&lt;li>почтовый пароль.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>В примерах будем подключаться к серверу IMAP &lt;code>imap.example.com&lt;/code>.&lt;/li>
&lt;li>URL подключения:
&lt;ul>
&lt;li>подключение без шифрования: &lt;code>imap://mail.example.com/&lt;/code>;&lt;/li>
&lt;li>подключение по SSL: &lt;code>imaps://mail.example.com/&lt;/code>;&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Будем использовать следующие учётные данные:
&lt;ul>
&lt;li>логин: &lt;code>user&lt;/code>;&lt;/li>
&lt;li>пароль: &lt;code>password&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Пароли лучше хранить в базе данных паролей или менеджере паролей:
&lt;ul>
&lt;li>netrc: &lt;a href="https://yamadharma.github.io/ru/post/2021/01/22/mail-password-authentication/">Emacs. Почта. Парольная аутентификация&lt;/a>;&lt;/li>
&lt;li>pass: &lt;a href="https://yamadharma.github.io/ru/post/2021/04/28/password-manager-pass/">Менеджер паролей pass&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="список-папок">&lt;span class="section-num">1.2&lt;/span> Список папок&lt;/h3>
&lt;ul>
&lt;li>Выполним запрос к серверу IMAP:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl --url &lt;span class="s2">&amp;#34;imap://mail.example.com/&amp;#34;&lt;/span> --user &lt;span class="s2">&amp;#34;user:password&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>При запросе через SSL можно дополнительно указать опцию &lt;code>insecure&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl --insecure --url &lt;span class="s2">&amp;#34;imaps://mail.example.com/&amp;#34;&lt;/span> --user &lt;span class="s2">&amp;#34;user:password&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Если не указать пароль в аргументе &lt;code>--user&lt;/code>, &lt;code>curl&lt;/code> запросит пароль перед выполнением запроса.&lt;/li>
&lt;li>Получим список почтовых ящиков:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">​* LIST &lt;span class="o">(&lt;/span>&lt;span class="se">\H&lt;/span>asNoChildren &lt;span class="se">\U&lt;/span>nmarked&lt;span class="o">)&lt;/span> &lt;span class="s2">&amp;#34;|&amp;#34;&lt;/span> Archive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">​* LIST &lt;span class="o">(&lt;/span>&lt;span class="se">\H&lt;/span>asNoChildren &lt;span class="se">\U&lt;/span>nmarked &lt;span class="se">\D&lt;/span>rafts&lt;span class="o">)&lt;/span> &lt;span class="s2">&amp;#34;|&amp;#34;&lt;/span> Drafts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">​* LIST &lt;span class="o">(&lt;/span>&lt;span class="se">\H&lt;/span>asNoChildren &lt;span class="se">\U&lt;/span>nmarked &lt;span class="se">\N&lt;/span>oInferiors&lt;span class="o">)&lt;/span> &lt;span class="s2">&amp;#34;|&amp;#34;&lt;/span> INBOX
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">​* LIST &lt;span class="o">(&lt;/span>&lt;span class="se">\H&lt;/span>asNoChildren &lt;span class="se">\U&lt;/span>nmarked &lt;span class="se">\S&lt;/span>ent&lt;span class="o">)&lt;/span> &lt;span class="s2">&amp;#34;|&amp;#34;&lt;/span> Sent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">​* LIST &lt;span class="o">(&lt;/span>&lt;span class="se">\H&lt;/span>asNoChildren &lt;span class="se">\U&lt;/span>nmarked &lt;span class="se">\J&lt;/span>unk&lt;span class="o">)&lt;/span> &lt;span class="s2">&amp;#34;|&amp;#34;&lt;/span> Spam
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">​* LIST &lt;span class="o">(&lt;/span>&lt;span class="se">\H&lt;/span>asNoChildren &lt;span class="se">\U&lt;/span>nmarked &lt;span class="se">\T&lt;/span>rash&lt;span class="o">)&lt;/span> &lt;span class="s2">&amp;#34;|&amp;#34;&lt;/span> Trash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Если название папки нечитабельно, его можно расшифровать (см. &lt;a href="https://yamadharma.github.io/ru/post/2021/07/04/mail-imap-folder-encoding/">Почта. Кодировка папок IMAP&lt;/a>).&lt;/li>
&lt;/ul>
&lt;h3 id="количество-сообщений">&lt;span class="section-num">1.3&lt;/span> Количество сообщений&lt;/h3>
&lt;ul>
&lt;li>Чтобы получить сообщение, нам нужен идентификатор сообщения.&lt;/li>
&lt;li>Выясним, сколько сообщений в почтовом ящике, поскольку идентификаторы сообщений являются последовательными номерами.&lt;/li>
&lt;li>Посмотрим, сколько сообщений существует в папке &lt;code>Archive&lt;/code>:&lt;/li>
&lt;/ul>
&lt;!--listend-->
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl --insecure --url &lt;span class="s2">&amp;#34;imaps://mail.example.com/&amp;#34;&lt;/span> --request &lt;span class="s2">&amp;#34;EXAMINE Archive&amp;#34;&lt;/span> --user &lt;span class="s2">&amp;#34;user:password&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Строчка ответа с ключевым словом &lt;code>EXISTS&lt;/code> укажет количество сообщений в папке.&lt;/li>
&lt;li>Предположительно, номера сообщений идут от 1 до количества сообщений (не обязательно).&lt;/li>
&lt;/ul>
&lt;h3 id="получение-сообщения">&lt;span class="section-num">1.4&lt;/span> Получение сообщения&lt;/h3>
&lt;ul>
&lt;li>Получим сообщение, задав его идентификатор (например, 5):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl --insecure --url &lt;span class="s2">&amp;#34;imaps://mail.example.com/Archive;UID=5&amp;#34;&lt;/span> --user &lt;span class="s2">&amp;#34;user:password&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Получение сообщения включает в себя как заголовки, так и тело.&lt;/li>
&lt;li>Если необходимо получить только заголовки или их подмножество, необходимо закодировать это в запросе.&lt;/li>
&lt;li>Получим заголовки &lt;em>Кому&lt;/em> (&lt;code>To&lt;/code>), &lt;em>От&lt;/em> (&lt;code>From&lt;/code>), &lt;em>Дата&lt;/em> (&lt;code>Date&lt;/code>), &lt;em>Тема&lt;/em> (&lt;code>Subject&lt;/code>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl --insecure --url &lt;span class="s2">&amp;#34;imaps://mail.example.com/Archive;UID=5;SECTION=HEADER.FIELDS%20(DATE%20FROM%20TO%20SUBJECT)&amp;#34;&lt;/span> --user &lt;span class="s2">&amp;#34;user:password&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Можно отправить запрос отдельно (например, запросив &lt;code>Subject&lt;/code>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl --insecure --verbose --url &lt;span class="s2">&amp;#34;imaps://mail.example.com/Archive&amp;#34;&lt;/span> --request &lt;span class="s2">&amp;#34;fetch 5 BODY.PEEK[HEADER.FIELDS (Subject)]&amp;#34;&lt;/span> --user &lt;span class="s2">&amp;#34;user:password&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Однако при программном использовании API-интерфейса curl ответы не декодируются. Поэтому, без флага &lt;code>--verbose&lt;/code> мы бы получили нулевой вывод.&lt;/li>
&lt;/ul>
&lt;h3 id="простые-скрипты">&lt;span class="section-num">1.5&lt;/span> Простые скрипты&lt;/h3>
&lt;ul>
&lt;li>Получить темы первых десяти сообщений в указанном почтовом ящике:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="c1"># Dump the subject of the first ten messages in the folder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> id in &lt;span class="k">$(&lt;/span>seq &lt;span class="m">1&lt;/span> 10&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Message &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> curl --insecure &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --url &lt;span class="s2">&amp;#34;imaps://mail.example.com/Archive;UID=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">;SECTION=HEADER.FIELDS%20(SUBJECT)&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --user &lt;span class="s2">&amp;#34;user:password&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Получить темы всех сообщений в указанном почтовом ящике:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="c1"># Dump the subject of all messages in the folder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Message &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> curl --insecure &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --url &lt;span class="s2">&amp;#34;imaps://mail.example.com/Archive;UID=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">;SECTION=HEADER.FIELDS%20(SUBJECT)&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --user &lt;span class="s2">&amp;#34;user:password&amp;#34;&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>expr &lt;span class="nv">$id&lt;/span> + 1&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Загрузочный сервер PXE</title><link>https://yamadharma.github.io/ru/post/2023/11/08/pxe-server/</link><pubDate>Wed, 08 Nov 2023 14:42:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/11/08/pxe-server/</guid><description>&lt;p>Установка загрузочного сервера PXE.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-настройка">&lt;span class="section-num">1&lt;/span> Общая настройка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сетевые-сервисы">&lt;span class="section-num">2&lt;/span> Сетевые сервисы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#tftp">&lt;span class="section-num">2.1&lt;/span> tftp&lt;/a>&lt;/li>
&lt;li>&lt;a href="#web-сервер">&lt;span class="section-num">2.2&lt;/span> web-сервер&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#конфигурация">&lt;span class="section-num">2.2.1&lt;/span> Конфигурация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#selinux">&lt;span class="section-num">2.2.2&lt;/span> SELinux&lt;/a>&lt;/li>
&lt;li>&lt;a href="#запуск">&lt;span class="section-num">2.2.3&lt;/span> Запуск&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#настройки-dhcp-сервера">&lt;span class="section-num">2.3&lt;/span> Настройки DHCP-сервера&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#настройки-сервера-isc-dhcp">&lt;span class="section-num">2.3.1&lt;/span> Настройки сервера ISC DHCP&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройки-сервера-isc-kea-dhcp">&lt;span class="section-num">2.3.2&lt;/span> Настройки сервера ISC Kea DHCP&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#сетевые-загрузчики">&lt;span class="section-num">3&lt;/span> Сетевые загрузчики&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#pxelinux">&lt;span class="section-num">3.1&lt;/span> pxelinux&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">3.1.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">3.1.2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройки-dhcp-сервера">&lt;span class="section-num">3.1.3&lt;/span> Настройки DHCP-сервера&lt;/a>&lt;/li>
&lt;li>&lt;a href="#файл-конфигурации-pxelinux">&lt;span class="section-num">3.1.4&lt;/span> Файл конфигурации pxelinux&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#ipxe">&lt;span class="section-num">3.2&lt;/span> ipxe&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#настройки-dhcp-сервера">&lt;span class="section-num">3.2.1&lt;/span> Настройки DHCP-сервера&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#grub2">&lt;span class="section-num">3.3&lt;/span> grub2&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">3.3.1&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройки-dhcp-сервера">&lt;span class="section-num">3.3.2&lt;/span> Настройки DHCP-сервера&lt;/a>&lt;/li>
&lt;li>&lt;a href="#файл-конфигурации-grub">&lt;span class="section-num">3.3.3&lt;/span> Файл конфигурации grub&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#приложения">&lt;span class="section-num">4&lt;/span> Приложения&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#memtest86-plus">&lt;span class="section-num">4.1&lt;/span> Memtest86+&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#pxelinux">&lt;span class="section-num">4.1.1&lt;/span> pxelinux&lt;/a>&lt;/li>
&lt;li>&lt;a href="#grub">&lt;span class="section-num">4.1.2&lt;/span> grub&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#дистрибутивы-linux">&lt;span class="section-num">5&lt;/span> Дистрибутивы Linux&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#fedora">&lt;span class="section-num">5.1&lt;/span> Fedora&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#grub">&lt;span class="section-num">5.1.1&lt;/span> Grub&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-настройка">&lt;span class="section-num">1&lt;/span> Общая настройка&lt;/h2>
&lt;ul>
&lt;li>Установите сервер Linux (см. &lt;a href="https://yamadharma.github.io/ru/post/2022/08/12/rockylinux-server-installation/">Rocky Linux. Установка сервера&lt;/a>).&lt;/li>
&lt;/ul>
&lt;h2 id="сетевые-сервисы">&lt;span class="section-num">2&lt;/span> Сетевые сервисы&lt;/h2>
&lt;h3 id="tftp">&lt;span class="section-num">2.1&lt;/span> tftp&lt;/h3>
&lt;ul>
&lt;li>Установите сервер tftp:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install tftp-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настройте брандмауэр:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --add-service&lt;span class="o">=&lt;/span>tftp --permanent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Активируйте сервис:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now tftp.socket
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="web-сервер">&lt;span class="section-num">2.2&lt;/span> web-сервер&lt;/h3>
&lt;ul>
&lt;li>Для снижения нагрузки на tftp будем загружать образы по http.&lt;/li>
&lt;li>Установим сервер nginx:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настройте брандмауэр:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --add-service&lt;span class="o">=&lt;/span>http --permanent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="конфигурация">&lt;span class="section-num">2.2.1&lt;/span> Конфигурация&lt;/h4>
&lt;ul>
&lt;li>Создадим файл конфигурации &lt;code>/etc/nginx/conf.d/pxe.conf&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listen&lt;/span> &lt;span class="mi">80&lt;/span> &lt;span class="n">default_server&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listen&lt;/span> &lt;span class="p">[::]:&lt;/span>&lt;span class="mi">80&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">root&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tftpboot&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server_name&lt;/span> &lt;span class="n">pxe&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">location&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">index&lt;/span> &lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">html&lt;/span> &lt;span class="n">index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">htm&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">autoindex&lt;/span> &lt;span class="n">on&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Load configuration files for the default server block.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">include&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">default&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/*.&lt;/span>&lt;span class="n">conf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="selinux">&lt;span class="section-num">2.2.2&lt;/span> SELinux&lt;/h4>
&lt;ul>
&lt;li>Зададим переключатели SELinux:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">setsebool -P httpd_serve_cobbler_files &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setsebool httpd_serve_cobbler_files &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим файл с описанием политики &lt;code>nginx-tftp.te&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">module&lt;/span> &lt;span class="n">nginx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">tftp&lt;/span> &lt;span class="mf">1.0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">require&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">type&lt;/span> &lt;span class="n">httpd_t&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">type&lt;/span> &lt;span class="n">cobbler_var_lib_t&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">type&lt;/span> &lt;span class="n">tftpdir_rw_t&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">class&lt;/span> &lt;span class="n">dir&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">class&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">getattr&lt;/span> &lt;span class="n">open&lt;/span> &lt;span class="n">read&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">class&lt;/span> &lt;span class="n">lnk_file&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#============= httpd_t ==============&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#!!!! This avc is allowed in the current policy&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">allow&lt;/span> &lt;span class="n">httpd_t&lt;/span> &lt;span class="n">cobbler_var_lib_t&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">dir&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#!!!! This avc is allowed in the current policy&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">allow&lt;/span> &lt;span class="n">httpd_t&lt;/span> &lt;span class="n">tftpdir_rw_t&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">dir&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#!!!! This avc is allowed in the current policy&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">allow&lt;/span> &lt;span class="n">httpd_t&lt;/span> &lt;span class="n">tftpdir_rw_t&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">file&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">getattr&lt;/span> &lt;span class="n">open&lt;/span> &lt;span class="n">read&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">allow&lt;/span> &lt;span class="n">httpd_t&lt;/span> &lt;span class="n">tftpdir_rw_t&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">lnk_file&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Применим его:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">semodule -i nginx-tftp.te
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="запуск">&lt;span class="section-num">2.2.3&lt;/span> Запуск&lt;/h4>
&lt;ul>
&lt;li>Запустим nginx:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now nginx.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройки-dhcp-сервера">&lt;span class="section-num">2.3&lt;/span> Настройки DHCP-сервера&lt;/h3>
&lt;h4 id="настройки-сервера-isc-dhcp">&lt;span class="section-num">2.3.1&lt;/span> Настройки сервера ISC DHCP&lt;/h4>
&lt;ul>
&lt;li>Настройки для сервера ISC DHCP.&lt;/li>
&lt;li>Файл конфигурации &lt;code>/etc/dhcp/dhcpd.conf&lt;/code>.&lt;/li>
&lt;li>Настройка основных опций:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">option pxe-system-type code 93 = unsigned integer 16;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option rfc3442-classless-static-routes code 121 = array of integer 8;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option ms-classless-static-routes code 249 = array of integer 8;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option space pxelinux;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option pxelinux.magic code 208 = string;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option pxelinux.configfile code 209 = text;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option pxelinux.pathprefix code 210 = text;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option pxelinux.reboottime code 211 = unsigned integer 32;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option architecture-type code 93 = unsigned integer 16;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option pxelinux.mtftp-ip code 1 = ip-address;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option pxelinux.mtftp-cport code 2 = unsigned integer 16;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option pxelinux.mtftp-sport code 3 = unsigned integer 16;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option pxelinux.mtftp-tmout code 4 = unsigned integer 8;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">option pxelinux.mtftp-delay code 5 = unsigned integer 8;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Необходимо также настроить &lt;code>next_server&lt;/code>, который должен указывать на tftp-сервер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">next-server 10.100.0.1&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="настройки-сервера-isc-kea-dhcp">&lt;span class="section-num">2.3.2&lt;/span> Настройки сервера ISC Kea DHCP&lt;/h4>
&lt;ul>
&lt;li>Настройки для сервера ISC Kea DHCP.&lt;/li>
&lt;li>Файл конфигурации &lt;code>/etc/kea/kea-dhcp4.conf&lt;/code>.&lt;/li>
&lt;li>Необходимо также настроить &lt;code>next_server&lt;/code>, который должен указывать на tftp-сервер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Dhcp4&amp;#34;&lt;/span>: &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;next-server&amp;#34;&lt;/span>: &lt;span class="s2">&amp;#34;10.100.0.1&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="сетевые-загрузчики">&lt;span class="section-num">3&lt;/span> Сетевые загрузчики&lt;/h2>
&lt;ul>
&lt;li>Возможно использовать любой сетевой загрузчик:
&lt;ul>
&lt;li>pxelinux&lt;/li>
&lt;li>ipxe&lt;/li>
&lt;li>grub2&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="pxelinux">&lt;span class="section-num">3.1&lt;/span> pxelinux&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">3.1.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Часть загрузчика syslinux.&lt;/li>
&lt;li>Сайт: &lt;a href="https://wiki.syslinux.org/wiki/index.php?title=PXELINUX" target="_blank" rel="noopener">https://wiki.syslinux.org/wiki/index.php?title=PXELINUX&lt;/a>&lt;/li>
&lt;li>ftp-сайт: &lt;a href="https://mirrors.edge.kernel.org/pub/linux/utils/boot/syslinux/" target="_blank" rel="noopener">https://mirrors.edge.kernel.org/pub/linux/utils/boot/syslinux/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="установка">&lt;span class="section-num">3.1.2&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Скачаем файлы для pxelinux:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://mirrors.edge.kernel.org/pub/linux/utils/boot/syslinux/Testing/6.04/syslinux-6.04-pre1.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar xJvf syslinux-6.04-pre1.tar.xz
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Скопируем файлы в наш корень tftp:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p /var/lib/tftpboot/boot/pxelinux/&lt;span class="o">{&lt;/span>bios,efi64,efi32&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find /tmp/syslinux-6.04-pre1/bios -regex &lt;span class="s1">&amp;#39;.*\(c32\|0\)$&amp;#39;&lt;/span> -exec cp &lt;span class="s1">&amp;#39;{}&amp;#39;&lt;/span> /var/lib/tftpboot/boot/pxelinux/bios/ &lt;span class="se">\;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find /tmp/syslinux-6.04-pre1/bios -name &lt;span class="s2">&amp;#34;memdisk&amp;#34;&lt;/span> -type f -exec cp &lt;span class="s1">&amp;#39;{}&amp;#39;&lt;/span> /var/lib/tftpboot/boot/pxelinux/bios/ &lt;span class="se">\;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find /tmp/syslinux-6.04-pre1/efi32 -regex &lt;span class="s1">&amp;#39;.*\(c32\|efi\)$&amp;#39;&lt;/span> -exec cp &lt;span class="s1">&amp;#39;{}&amp;#39;&lt;/span> /var/lib/tftpboot/boot/pxelinux/efi32 &lt;span class="se">\;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find /tmp/syslinux-6.04-pre1/efi64 -regex &lt;span class="s1">&amp;#39;.*\(c32\|efi\|e64\|elf\|lnx\)$&amp;#39;&lt;/span> -exec cp &lt;span class="s1">&amp;#39;{}&amp;#39;&lt;/span> /var/lib/tftpboot/boot/pxelinux/efi64 &lt;span class="se">\;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="настройки-dhcp-сервера">&lt;span class="section-num">3.1.3&lt;/span> Настройки DHCP-сервера&lt;/h4>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Настройки сервера ISC DHCP&lt;/p>
&lt;ul>
&lt;li>Настройки для сервера ISC DHCP.&lt;/li>
&lt;li>Файл конфигурации &lt;code>/etc/dhcp/dhcpd.conf&lt;/code>.&lt;/li>
&lt;li>Настройка файлов загрузки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">option architecture-type code &lt;span class="nv">93&lt;/span> &lt;span class="o">=&lt;/span> unsigned integer 16&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">class &lt;span class="s2">&amp;#34;pxeclients&amp;#34;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> match &lt;span class="k">if&lt;/span> substring &lt;span class="o">(&lt;/span>option vendor-class-identifier, 0, 9&lt;span class="o">)&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;PXEClient&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> option architecture-type &lt;span class="o">=&lt;/span> 00:00 &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;/boot/pxelinux/bios/lpxelinux.0&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> elsif option architecture-type &lt;span class="o">=&lt;/span> 00:09 &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;/boot/pxelinux/efi64/syslinux.efi&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> elsif option architecture-type &lt;span class="o">=&lt;/span> 00:07 &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;/boot/pxelinux/efi64/syslinux.efi&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> elsif option architecture-type &lt;span class="o">=&lt;/span> 00:06 &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;/boot/pxelinux/efi32/syslinux.efi&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;/boot/pxelinux/bios/lpxelinux.0&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Настройки сервера ISC Kea DHCP&lt;/p>
&lt;ul>
&lt;li>Настройки для сервера ISC Kea DHCP.&lt;/li>
&lt;li>Файл конфигурации &lt;code>/etc/kea/kea-dhcp4.conf&lt;/code>.&lt;/li>
&lt;li>Настройка файлов загрузки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Dhcp4&amp;#34;&lt;/span>: &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;client-classes&amp;#34;&lt;/span>: &lt;span class="o">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>: &lt;span class="s2">&amp;#34;pxe-legacy&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;test&amp;#34;&lt;/span>: &lt;span class="s2">&amp;#34;option[93].hex == 0x0000&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;boot-file-name&amp;#34;&lt;/span>: &lt;span class="s2">&amp;#34;/boot/pxelinux/bios/lpxelinux.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>: &lt;span class="s2">&amp;#34;pxe-uefi&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;test&amp;#34;&lt;/span>: &lt;span class="s2">&amp;#34;option[93].hex == 0x0009 or option[93].hex == 0x0007&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;boot-file-name&amp;#34;&lt;/span>: &lt;span class="s2">&amp;#34;/boot/pxelinux/efi64/syslinux.efi&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">]&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="файл-конфигурации-pxelinux">&lt;span class="section-num">3.1.4&lt;/span> Файл конфигурации pxelinux&lt;/h4>
&lt;ul>
&lt;li>Создать каталог &lt;code>/var/lib/tftpboot/boot/pxelinux/pxelinux.cfg/&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p /var/lib/tftpboot/boot/pxelinux/pxelinux.cfg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим файл &lt;code>/var/lib/tftpboot/boot/pxelinux/pxelinux.cfg/default&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># -*- mode:conf -*-
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">default menu.c32
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ontimeout chain.c32 hd0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">timeout 100
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">prompt 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">implicit 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NOESCAPE 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ALLOWOPTIONS 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">say Enter command line for bootup:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">menu title Syslinux Bootup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">label disk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">menu label ^Boot from local drive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">menu default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> kernel chain.c32
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> append hd0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим символические ссылки для разного типа загрузки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ln -s /var/lib/tftpboot/boot/pxelinux/pxelinux.cfg /var/lib/tftpboot/boot/pxelinux/bios/pxelinux.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ln -s /var/lib/tftpboot/boot/pxelinux/pxelinux.cfg /var/lib/tftpboot/boot/pxelinux/efi64/pxelinux.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ln -s /var/lib/tftpboot/boot/pxelinux/pxelinux.cfg /var/lib/tftpboot/boot/pxelinux/efi32/pxelinux.cfg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="ipxe">&lt;span class="section-num">3.2&lt;/span> ipxe&lt;/h3>
&lt;h4 id="настройки-dhcp-сервера">&lt;span class="section-num">3.2.1&lt;/span> Настройки DHCP-сервера&lt;/h4>
&lt;ul>
&lt;li>Настройки для сервера ISC DHCP.&lt;/li>
&lt;li>Файл конфигурации &lt;code>/etc/dhcp/dhcpd.conf&lt;/code>.&lt;/li>
&lt;li>Настройка файлов загрузки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">option architecture-type code &lt;span class="nv">93&lt;/span> &lt;span class="o">=&lt;/span> unsigned integer 16&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">class &lt;span class="s2">&amp;#34;pxeclients&amp;#34;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> match &lt;span class="k">if&lt;/span> substring &lt;span class="o">(&lt;/span>option vendor-class-identifier, 0, 9&lt;span class="o">)&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;PXEClient&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> option architecture-type !&lt;span class="o">=&lt;/span> 00:00 &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;/boot/ipxe/ipxe.efi&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;/boot/ipxe/undionly.kpxe&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="grub2">&lt;span class="section-num">3.3&lt;/span> grub2&lt;/h3>
&lt;h4 id="установка">&lt;span class="section-num">3.3.1&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Установим необходимые пакеты для grub2:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install grub2-efi-x64-modules grub2-tools-extra grub2-pc-modules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установим файлы в каталог tftpd:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">grub2-mknetdir --net-directory&lt;span class="o">=&lt;/span>/var/lib/tftpboot/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">restorecon -vR /var/lib/tftpboot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Можно также внедрить все модули в загружаемый файл (скорее, для отладки):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">grub2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">mkimage&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="n">x86_64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">efi&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">o&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tftpboot&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">boot&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">grub2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">x86_64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">efi&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">efi&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">prefix&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tftpboot&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">boot&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">grub2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">x86_64&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">efi&lt;/span>&lt;span class="o">/*.&lt;/span>&lt;span class="n">mod&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="настройки-dhcp-сервера">&lt;span class="section-num">3.3.2&lt;/span> Настройки DHCP-сервера&lt;/h4>
&lt;ul>
&lt;li>Настройки для сервера ISC DHCP.&lt;/li>
&lt;li>Файл конфигурации &lt;code>/etc/dhcp/dhcpd.conf&lt;/code>.&lt;/li>
&lt;li>Настройка файлов загрузки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">option architecture-type code &lt;span class="nv">93&lt;/span> &lt;span class="o">=&lt;/span> unsigned integer 16&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">class &lt;span class="s2">&amp;#34;pxeclients&amp;#34;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> match &lt;span class="k">if&lt;/span> substring &lt;span class="o">(&lt;/span>option vendor-class-identifier, 0, 9&lt;span class="o">)&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;PXEClient&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> option architecture-type &lt;span class="o">=&lt;/span> 00:07 &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;boot/grub2/x86_64-efi/core.efi&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> option architecture-type &lt;span class="o">=&lt;/span> 00:08 &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;boot/grub2/x86_64-efi/core.efi&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> option architecture-type &lt;span class="o">=&lt;/span> 00:09 &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;boot/grub2/x86_64-efi/core.efi&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> option architecture-type &lt;span class="o">=&lt;/span> 00:0a &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ArmHFP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;boot/grub2/armv7a-efi/core.efi&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> option architecture-type &lt;span class="o">=&lt;/span> 00:0b &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># aarch64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;boot/grub2/aarch64-efi/core.efi&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># BIOS boot&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> filename &lt;span class="s2">&amp;#34;boot/grub2/i386-pc/core.0&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="файл-конфигурации-grub">&lt;span class="section-num">3.3.3&lt;/span> Файл конфигурации grub&lt;/h4>
&lt;ul>
&lt;li>Создадим основной файл конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">touch /var/lib/tftpboot/boot/grub2/grub.cfg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим в нём базовую конфигурацию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">set default=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">set timeout=60
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">menuentry &amp;#39;Local Boot&amp;#39; {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Создадим символическую ссылку на этот файл в каждом каталоге, содержащим &lt;code>core.*&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /var/lib/tftpboot/boot/grub2/x86_64-efi&lt;span class="p">;&lt;/span> ln -snf ../grub.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /var/lib/tftpboot/boot/grub2/i386-pc&lt;span class="p">;&lt;/span> ln -snf ../grub.cfg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Можно добавить дополнительные пункты (скорее для забавы):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">menuentry &amp;#39;EFI Firmware System Setup&amp;#39; $menuentry_id_option &amp;#39;uefi-firmware&amp;#39; {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fwsetup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">menuentry &amp;#39;Reboot&amp;#39; {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> reboot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">menuentry &amp;#39;Shutdown&amp;#39; {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> halt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="приложения">&lt;span class="section-num">4&lt;/span> Приложения&lt;/h2>
&lt;h3 id="memtest86-plus">&lt;span class="section-num">4.1&lt;/span> Memtest86+&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://memtest.org/" target="_blank" rel="noopener">https://memtest.org/&lt;/a>&lt;/li>
&lt;li>Скачайте необходимую версию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p /var/lib/tftpboot/utils/memtest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /var/lib/tftpboot/utils/memtest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://memtest.org/download/v6.20/mt86plus_6.20.binaries.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unzip mt86plus_6.20.binaries.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm mt86plus_6.20.binaries.zip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="pxelinux">&lt;span class="section-num">4.1.1&lt;/span> pxelinux&lt;/h4>
&lt;ul>
&lt;li>Конфигурация для загрузки memtest86+ будет следующей:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">label memtest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">menu label Memory test
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> kernel utils/memtest/memtest64.bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="grub">&lt;span class="section-num">4.1.2&lt;/span> grub&lt;/h4>
&lt;ul>
&lt;li>Конфигурация для загрузки memtest86+ будет следующей:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">menuentry &lt;span class="s2">&amp;#34;Memory test&amp;#34;&lt;/span> --class tools &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">grub_platform&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">=&lt;/span> pc &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> linux &lt;span class="o">(&lt;/span>http&lt;span class="o">)&lt;/span>/utils/memtest/memtest64.bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> linuxefi &lt;span class="o">(&lt;/span>http&lt;span class="o">)&lt;/span>/utils/memtest/memtest64.efi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="дистрибутивы-linux">&lt;span class="section-num">5&lt;/span> Дистрибутивы Linux&lt;/h2>
&lt;h3 id="fedora">&lt;span class="section-num">5.1&lt;/span> Fedora&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://fedoraproject.org/" target="_blank" rel="noopener">https://fedoraproject.org/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="grub">&lt;span class="section-num">5.1.1&lt;/span> Grub&lt;/h4>
&lt;ul>
&lt;li>Файл конфигурации будет следующим:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">submenu &amp;#39;Fedora Linux&amp;#39; --class fedora --class gnu-linux --class gnu --class os {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> menuentry &amp;#39;Install Fedora Linux (EFI)&amp;#39; --class fedora --class gnu-linux --class gnu --class os {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> linuxefi fedora-x86_64/vmlinuz inst.repo=http://dl.fedoraproject.org/pub/fedora/linux/releases/39/Everything/x86_64/os inst.stage2=http://dl.fedoraproject.org/pub/fedora/linux/releases/39/Everything/x86_64/os ip=dhcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> initrdefi fedora-x86_64/initrd.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> menuentry &amp;#39;Install Fedora Linux (Classic)&amp;#39; --class fedora --class gnu-linux --class gnu --class os {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> linux16 fedora-x86_64/vmlinuz inst.repo=http://dl.fedoraproject.org/pub/fedora/linux/releases/39/Everything/x86_64/os/ inst.stage2=http://dl.fedoraproject.org/pub/fedora/linux/releases/39/Everything/x86_64/os/ ip=dhcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> initrd16 fedora-x86_64/initrd.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> menuentry &amp;#39;Install Fedora Linux (ARM)&amp;#39; --class fedora --class gnu-linux --class gnu --class os {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> linux fedora-aarch64/vmlinuz inst.repo=http://dl.fedoraproject.org/pub/fedora/linux/releases/39/Everything/aarch64/os/ inst.stage2=http://dl.fedoraproject.org/pub/fedora/linux/releases/39/Everything/aarch64/os/ ip=dhcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> initrd fedora-aarch64/initrd.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>nsupdate: динамический редактор зон DNS</title><link>https://yamadharma.github.io/ru/post/2023/10/28/nsupdate-dynamic-dns-editor/</link><pubDate>Sat, 28 Oct 2023 19:28:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/10/28/nsupdate-dynamic-dns-editor/</guid><description>&lt;p>nsupdate: динамический редактор зон DNS.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#обновление-зоны-по-ключу">&lt;span class="section-num">2&lt;/span> Обновление зоны по ключу&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#создание-ключа">&lt;span class="section-num">2.1&lt;/span> Создание ключа&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-dns-bind">&lt;span class="section-num">2.2&lt;/span> Настройка DNS Bind&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#использование-nsupdate">&lt;span class="section-num">3&lt;/span> Использование nsupdate&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#вызов-nsupdate">&lt;span class="section-num">3.1&lt;/span> Вызов nsupdate&lt;/a>&lt;/li>
&lt;li>&lt;a href="#удаление-записи">&lt;span class="section-num">3.2&lt;/span> Удаление записи&lt;/a>&lt;/li>
&lt;li>&lt;a href="#несколько-обновлений">&lt;span class="section-num">3.3&lt;/span> Несколько обновлений&lt;/a>&lt;/li>
&lt;li>&lt;a href="#добавление-записей">&lt;span class="section-num">3.4&lt;/span> Добавление записей&lt;/a>&lt;/li>
&lt;li>&lt;a href="#неинтерактивное-использование">&lt;span class="section-num">3.5&lt;/span> Неинтерактивное использование&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#с-помощью-файла">&lt;span class="section-num">3.5.1&lt;/span> С помощью файла&lt;/a>&lt;/li>
&lt;li>&lt;a href="#удалить-все-записи-a-начинающиеся-с-www-в-зоне-example-dot-com">&lt;span class="section-num">3.5.2&lt;/span> Удалить все записи A, начинающиеся с www, в зоне example.com&lt;/a>&lt;/li>
&lt;li>&lt;a href="#добавить-хост">&lt;span class="section-num">3.5.3&lt;/span> Добавить хост&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#материалы">&lt;span class="section-num">4&lt;/span> Материалы&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>nsupdate используется для внесения изменений в динамический DNS без необходимости редактирования файлов зоны и перезапуска DNS-сервера.&lt;/li>
&lt;/ul>
&lt;h2 id="обновление-зоны-по-ключу">&lt;span class="section-num">2&lt;/span> Обновление зоны по ключу&lt;/h2>
&lt;h3 id="создание-ключа">&lt;span class="section-num">2.1&lt;/span> Создание ключа&lt;/h3>
&lt;ul>
&lt;li>Создадим ключ для зоны &lt;code>example.com&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p /etc/named/keys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tsig-keygen -a HMAC-SHA256 example.com &amp;gt; /etc/named/keys/example.com.key
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Файл &lt;code>/etc/named/keys/example.com.key&lt;/code> будет иметь следующий вид:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">key &amp;#34;example.com&amp;#34; {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> algorithm hmac-sha256;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> secret &amp;#34;KbWuOipDOQ80ZoCiSWxhJmulLmaWSNgw43v9KkUQZBY=&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-dns-bind">&lt;span class="section-num">2.2&lt;/span> Настройка DNS Bind&lt;/h3>
&lt;ul>
&lt;li>Настройка происходит в файле &lt;code>/etc/named.conf&lt;/code>.&lt;/li>
&lt;li>Ключ скопируем на хост с DNS-сервером (если это другой сервер).&lt;/li>
&lt;li>Поместим его в файл &lt;code>/etc/named/keys/example.com.key&lt;/code>.&lt;/li>
&lt;li>Подключим ключ:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">include &amp;#34;/etc/named/keys/example.com.key&amp;#34;;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Разрешим обновление зон:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">zone &amp;#34;example.com&amp;#34; IN {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type master;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &amp;#34;local.zone.db&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> allow-update { key &amp;#34;example.com&amp;#34;; };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zone &amp;#34;0.168.192.in-addr.arpa&amp;#34; IN {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type master;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &amp;#34;192.168.0.db&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> allow-update { key &amp;#34;example.com&amp;#34;; };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Поправим права доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chown -R named:named /var/named
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R named:named /etc/named
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find /var/named -type d -exec chmod &lt;span class="m">770&lt;/span> &lt;span class="o">{}&lt;/span> &lt;span class="se">\;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find /var/named -type f -exec chmod &lt;span class="m">660&lt;/span> &lt;span class="o">{}&lt;/span> &lt;span class="se">\;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="использование-nsupdate">&lt;span class="section-num">3&lt;/span> Использование nsupdate&lt;/h2>
&lt;h3 id="вызов-nsupdate">&lt;span class="section-num">3.1&lt;/span> Вызов nsupdate&lt;/h3>
&lt;ul>
&lt;li>При запуске &lt;code>nsupdate&lt;/code> вы попадете в базовую среду командной строки для отправки команд обновления в DNS.&lt;/li>
&lt;li>Опции запуска:
&lt;ul>
&lt;li>&lt;code>-v&lt;/code> : связь с DNS должна осуществляться по протоколу TCP, а не UDP;&lt;/li>
&lt;li>&lt;code>-k&lt;/code> : указывает на файл ключа.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Вызов &lt;code>nsupdate&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nsupdate -v -k /etc/named/keys/example.com.key
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы выйти из сеанса nsupdate, просто нажмите &lt;code>CTRL-D&lt;/code> или введите &lt;code>quit&lt;/code> и нажмите &lt;code>RETURN&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="удаление-записи">&lt;span class="section-num">3.2&lt;/span> Удаление записи&lt;/h3>
&lt;ul>
&lt;li>Безоговорочное удаление записи DNS (например, записи CNAME &lt;a href="https://www.example.com" target="_blank" rel="noopener">www.example.com&lt;/a>).&lt;/li>
&lt;li>В командной строке &lt;code>nsupdate&lt;/code> введите:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&amp;gt; update delete www.example.com cname
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; send
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Когда вы вводите &lt;code>send&lt;/code> и нажимаете &lt;code>RETURN&lt;/code>, запрос на обновление создаётся, подписывается и отправляется на соответствующий DNS-сервер.&lt;/li>
&lt;li>Если ключ был авторизован для выполнения запроса, DNS обновит свою базу данных, обновит файлы журнала, увеличит серийный номер записи SOA и отправит уведомление об изменении всем подчиненным DNS.&lt;/li>
&lt;li>Подчинённые устройства запустят AXFR (или IXFR) для сбора обновлений с главного DNS.&lt;/li>
&lt;/ul>
&lt;h3 id="несколько-обновлений">&lt;span class="section-num">3.3&lt;/span> Несколько обновлений&lt;/h3>
&lt;ul>
&lt;li>Чтобы сэкономить время и уменьшить DNS-трафик, можно одновременно отправить несколько запросов на обновление в одном пакете:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&amp;gt; update delete www.example.com cname
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; update delete www1.example.com a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; update delete www2.example.com a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; update delete www3.example.com a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; send
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Все обновления в одном пакете &lt;code>send&lt;/code> должны относиться к одной и той же зоне.&lt;/li>
&lt;li>Особенности реализации: из-за фиксированного входного буфера более 2000 запросов за раз иногда не проходят.&lt;/li>
&lt;/ul>
&lt;h3 id="добавление-записей">&lt;span class="section-num">3.4&lt;/span> Добавление записей&lt;/h3>
&lt;ul>
&lt;li>Добавим записи &lt;code>A&lt;/code>, &lt;code>CNAME&lt;/code> и &lt;code>PTR&lt;/code>. При добавлении необходимо указать &lt;code>TTL&lt;/code> &amp;mdash; время жизни записи в секундах:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&amp;gt; update add www1.example.com &lt;span class="m">86400&lt;/span> a 172.16.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; update add www.example.com &lt;span class="m">600&lt;/span> cname www1.example.com.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; send
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; update add 1.1.16.172.in-addr.arpa &lt;span class="m">86400&lt;/span> ptr www1.example.com.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; send
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="неинтерактивное-использование">&lt;span class="section-num">3.5&lt;/span> Неинтерактивное использование&lt;/h3>
&lt;ul>
&lt;li>Неинтерактивный запуск: можно указать файл, содержащий пакет команд, или просто передать их по STDIN.&lt;/li>
&lt;/ul>
&lt;h4 id="с-помощью-файла">&lt;span class="section-num">3.5.1&lt;/span> С помощью файла&lt;/h4>
&lt;ul>
&lt;li>Например, создадим файл &lt;code>batch.txt&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">update delete www.example.com cname
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">update delete www1.example.com a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">update delete www2.example.com a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">update delete www3.example.com a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">send
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите его, выполнив:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nsupdate -v -k /etc/named/keys/example.com.key batch.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="удалить-все-записи-a-начинающиеся-с-www-в-зоне-example-dot-com">&lt;span class="section-num">3.5.2&lt;/span> Удалить все записи A, начинающиеся с www, в зоне example.com&lt;/h4>
&lt;ul>
&lt;li>Удалить все записи &lt;code>A&lt;/code>, начинающиеся с &lt;code>www&lt;/code>, в зоне &lt;code>example.com&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span> host -t a -l example.com &lt;span class="p">|&lt;/span> grep -i &lt;span class="s1">&amp;#39;^www&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{ print &amp;#34;update delete &amp;#34;$1&amp;#34; a&amp;#34; }&amp;#39;&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="nb">echo&lt;/span> send &lt;span class="o">)&lt;/span> &lt;span class="p">|&lt;/span> nsupdate -v -k /etc/named/keys/example.com.key
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="добавить-хост">&lt;span class="section-num">3.5.3&lt;/span> Добавить хост&lt;/h4>
&lt;ul>
&lt;li>Добавим хост &lt;code>www.example.com&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> -e &lt;span class="s2">&amp;#34;update add www.example.com 86400 a 192.168.1.1\nshow\nsend&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> nsupdate -v -k /etc/named/keys/example.com.key
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="материалы">&lt;span class="section-num">4&lt;/span> Материалы&lt;/h2>
&lt;ul>
&lt;li>Скрипт для упрощения использования nsupdate
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/perryflynn/nsupdate-interactive" target="_blank" rel="noopener">https://github.com/perryflynn/nsupdate-interactive&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Сеть в vagrant</title><link>https://yamadharma.github.io/ru/post/2023/10/11/vagrant-network/</link><pubDate>Wed, 11 Oct 2023 15:13:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/10/11/vagrant-network/</guid><description>&lt;p>Сеть в vagrant.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#типы-сетей">&lt;span class="section-num">2&lt;/span> Типы сетей&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#перенаправление-портов">&lt;span class="section-num">2.1&lt;/span> Перенаправление портов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#частная-сеть">&lt;span class="section-num">2.2&lt;/span> Частная сеть&lt;/a>&lt;/li>
&lt;li>&lt;a href="#публичная-сеть">&lt;span class="section-num">2.3&lt;/span> Публичная сеть&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Первый интерфейс устанавливается в режиме NAT для нужд самого Vagrant.&lt;/li>
&lt;/ul>
&lt;h2 id="типы-сетей">&lt;span class="section-num">2&lt;/span> Типы сетей&lt;/h2>
&lt;ul>
&lt;li>Vagrant может задавать три типа сетей:
&lt;ul>
&lt;li>перенаправление портов;&lt;/li>
&lt;li>частную сеть;&lt;/li>
&lt;li>общедоступную сеть.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="перенаправление-портов">&lt;span class="section-num">2.1&lt;/span> Перенаправление портов&lt;/h3>
&lt;ul>
&lt;li>Настройка перенаправления портов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">vm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">network&lt;/span> &lt;span class="ss">:forwarded_port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">guest&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">80&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">host&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">8080&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сопоставляет порт 80 виртуальной (гостевой) машины с портом 8080 хост-машины.&lt;/li>
&lt;li>Порты перенаправляются на NAT-интерфейсе.&lt;/li>
&lt;/ul>
&lt;h3 id="частная-сеть">&lt;span class="section-num">2.2&lt;/span> Частная сеть&lt;/h3>
&lt;ul>
&lt;li>Настроим частную сеть:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">vm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">network&lt;/span> &lt;span class="ss">:private_network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">ip&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;192.168.1.104&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Несколько виртуальных машин также могут обращаться друг к другу в режиме частной сети, если они настроены на один и тот же сегмент сети.&lt;/li>
&lt;/ul>
&lt;h3 id="публичная-сеть">&lt;span class="section-num">2.3&lt;/span> Публичная сеть&lt;/h3>
&lt;ul>
&lt;li>Виртуальная машина представлена ​​как хост в локальной сети.&lt;/li>
&lt;li>Подключение производится через мост.&lt;/li>
&lt;li>Зададим публичную сеть:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">vm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">network&lt;/span> &lt;span class="ss">:public_network&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Отключение поддержки KVM в GNS3</title><link>https://yamadharma.github.io/ru/post/2023/10/08/gns3-kvm-disable/</link><pubDate>Sun, 08 Oct 2023 18:13:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/10/08/gns3-kvm-disable/</guid><description>&lt;p>Отключение поддержки KVM в GNS3.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#описание-проблемы">&lt;span class="section-num">1&lt;/span> Описание проблемы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#решение">&lt;span class="section-num">2&lt;/span> Решение&lt;/a>&lt;/li>
&lt;li>&lt;a href="#видео">&lt;span class="section-num">3&lt;/span> Видео&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="описание-проблемы">&lt;span class="section-num">1&lt;/span> Описание проблемы&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>На информационном экране виртуальной машины появляется сообщение:&lt;/p>
&lt;blockquote>
&lt;p>KVM support available: False&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>При попытке запуска образа в GNS3 сообщается, что невозможно использовать ускорение KVM (&lt;code>/dev/kvm&lt;/code> не существует).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Это может происходить, например, на процессорах M1 (см. &lt;a href="https://yamadharma.github.io/ru/post/2021/02/08/chip-apple-m1/">Процессор Apple M1&lt;/a>), поскольку Apple не позволяет пробрасывать kvm-виртуализацию в виртуальную машину.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Подобная проблема может возникать и в Windows 11 на VMware WS Pro.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="решение">&lt;span class="section-num">2&lt;/span> Решение&lt;/h2>
&lt;ul>
&lt;li>В качестве решения предлагается отключить KVM.&lt;/li>
&lt;li>При этом надо понимать, что вся виртуализация будет осуществлять программно.&lt;/li>
&lt;li>Отключить виртуализацию можно в конфигурационном файле &lt;code>gns3_server.conf&lt;/code> на виртуальной машине.&lt;/li>
&lt;li>В него следует добавить следующее:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[Qemu]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">enable_kvm = false
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Получить доступ к этому файлу можно из текстового меню виртуальной машины, выбрав пункт &lt;em>Configure&lt;/em>.&lt;/li>
&lt;li>После этого следует перегрузить виртуальную машину.&lt;/li>
&lt;/ul>
&lt;h2 id="видео">&lt;span class="section-num">3&lt;/span> Видео&lt;/h2>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-aecdbf" data-toggle="tab" href="#aecdbf"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-ebafdc" data-toggle="tab" href="#ebafdc"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="aecdbf" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/67984efbfcfe953d2581c09894621132"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="ebafdc" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/HF-byEQtI-4?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Исследования. Протокол Vanet</title><link>https://yamadharma.github.io/ru/post/2023/10/07/research-vanet-protocol/</link><pubDate>Sat, 07 Oct 2023 14:56:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/10/07/research-vanet-protocol/</guid><description>&lt;p>Исследования. Протокол Vanet.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#обзор">&lt;span class="section-num">1&lt;/span> Обзор&lt;/a>&lt;/li>
&lt;li>&lt;a href="#литература">Литература&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="обзор">&lt;span class="section-num">1&lt;/span> Обзор&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Обзор применимости разных протоколов для сетей VANET [&lt;a href="#citeproc_bib_item_1">1&lt;/a>; &lt;a href="#citeproc_bib_item_2">2&lt;/a>].&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Стандарт IEEE 1609.2 не ограничивает в использовании технологий для организации сетей VANET.&lt;/p>
&lt;ul>
&lt;li>В разных странах, например в США есть выделенный диапазон под DSRC(Dedicated Short Range Communications).&lt;/li>
&lt;li>Это диапазон 5.850-5.925GHz [&lt;a href="#citeproc_bib_item_3">3&lt;/a>]&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Возможность совместного использования большими и малыми системами спектров в 5,9 ГГц DSRC полосе.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Исследовалось два типа модели, стационарная и мобильная, а также использовались разные алгоритмы распределения спектра для определения эффективности совместного использования этого спектра [&lt;a href="#citeproc_bib_item_4">4&lt;/a>]&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Совместное использовании автоматической радиослужбы (АС) и быстрого интернета подвижного доступа (WiMAX) на полосе 5,9 ГГц.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>В статье проведено сравнение производительности обеих систем в общей среде.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>В исследовании делается вывод, что в определённых условиях обе системы могут совместно использовать эту полосу без значительного снижения производительности, что делает полосу DSRC более эффективной для использования.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Инфраструктура может включать различные элементы, такие как дорожные знаки, светофоры, станции техобслуживания, датчики дорожного движения и другие устройства.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Инфраструктурные компоненты в сетях VANET:&lt;/p>
&lt;ul>
&lt;li>On-board Units (OBU): OBU установлены на транспортных средствах и обеспечивают связь между автомобилями и дорожной инфраструктурой. Они могут передавать и получать данные о положении, скорости и другой полезной транспортной информации.&lt;/li>
&lt;li>Road Side Units (RSU): RSU представляют собой беспроводные устройства, установленные вдоль дороги. Они обеспечивают связь между автомобилями и инфраструктурой, например, передают данные о дорожных условиях, пробках и другой важной информации.&lt;/li>
&lt;li>Control Center: Это центральная единица управления, которая управляет всей сетью VANET. Она отвечает за обработку и анализ данных, полученных от OBU и RSU, и передает обратно команды или полезную информацию.&lt;/li>
&lt;li>Сетевые протоколы и стандарты: Сети VANET используют специальные протоколы для обеспечения связи между автомобилями и инфраструктурой, такие как DSRC (Dedicated Short Range Communication) и C-V2X (Cellular Vehicle to Everything).&lt;/li>
&lt;li>Сенсоры: На транспортных средствах устанавливаются различные сенсоры (например, датчики GPS, датчики скорости, датчики замедления), которые передают данные в OBU для дальнейшей обработки.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Все эти элементы соединены в единую систему, которая позволяет автомобилям взаимодействовать друг с другом и с инфраструктурой Vanet.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Безопасность в инфраструктуры [&lt;a href="#citeproc_bib_item_5">5&lt;/a>]&lt;/p>
&lt;ul>
&lt;li>Идея использовать для обеспечения безопасности и приватности данных (стандарт IEEE 1609.2) распределённую систему сертификатов.&lt;/li>
&lt;li>Статья предлагает эффективную децентрализованную инфраструктуру открытых ключей (PKI), используя концепции байесовской коалиционной игры (BCG) и обучающих автоматов (LA). Предполагается, что LA являются игроками в игре, координирующими информационный обмен друг с другом. Для сохранения конфиденциальности и целостности сообщений формулируется динамическая коалиция среди игроков игры с использованием шифрования симметричным ключом и аутентификации сообщений на основе хэша. Кроме того, в предложенную схему включены сохранение приватности и отзыв сертификатов для защиты от неправильно ведущих себя транспортных средств. Для каждого действия, выполняемого автоматом, его действие может быть вознаграждено/штрафовано окружающей средой, в которой он работает. LA обновляют свои матрицы вероятности действий, получая усиливающий сигнал от окружающей среды. Производительность предложенной схемы оценивается по различным метрикам в сравнении с другими современными существующими схемами. Полученные результаты доказывают превосходство предложенной схемы.&lt;/li>
&lt;li>Два вида узлов: RSU это станции, которые устанавливаются вдоль движения автомобилей. В зависимости от использования протокола - меняется и дальность взаимодействия между узлами в сети, а значит и будут отличаться требования к этим станциям. OBU - это передатчики, установленные на автомобилях, их задача получать данные от сенсоров автомобилей и общаться с RSU. Тут я видел разные подходы к этому, например, чтобы использовать в качестве поставщика данных для OBU обычный смартфон человека, который сидит в автомобиле.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Например по одной технологии (например wifi) общаются между собой автомобили, а с RSU они общаются по другой технологии (например RF, то есть радиочастотный модуль) [&lt;a href="#citeproc_bib_item_6">6&lt;/a>]&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="литература">Литература&lt;/h2>
&lt;div class="csl-bib-body">
&lt;div class="csl-entry">&lt;a id="citeproc_bib_item_1">&lt;/a>1. Tanuja, K. A Survey on Vanet Technologies / K. Tanuja, T.M. Sushma, M. Bharathi, K.H. Arun // International Journal of Computer Applications. – 2015. – Т. 121. – № 18. – Сс. 1–9. DOI: &lt;a href="https://doi.org/10.5120/21637-4965">10.5120/21637-4965&lt;/a>.&lt;/div>
&lt;div class="csl-entry">&lt;a id="citeproc_bib_item_2">&lt;/a>2. Anwer, M.S. A survey of VANET technologies / M.S. Anwer, C. Guy // Journal of Emerging Trends in Computing and Information Sciences. – 2014. – Т. 5. – № 9. – Сс. 661–671. DOI: &lt;a href="https://doi.org/https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=3dcc7d5f5f88698dc256c8bff21a13570d902e17">https://citeseerx.ist.psu.edu/document?repid=rep1&amp;#38;type=pdf&amp;#38;doi=3dcc7d5f5f88698dc256c8bff21a13570d902e17&lt;/a>.&lt;/div>
&lt;div class="csl-entry">&lt;a id="citeproc_bib_item_3">&lt;/a>3. Cheng, B. &lt;a href="https://www.winlab.rutgers.edu/~gruteser/papers/ITSWC2018%20Challenges%20of%20sharing%20the%20DSRC%20band%20in%20the%20U.S--BinCheng.pdf">Challenges of sharing the DSRC band in the U.S.&lt;/a> / B. Cheng, H. Lu, A. Rostami и др. // 25th ITS World Congress. – Copenhagen, Denmark, 2018. – Сс. 1–10.&lt;/div>
&lt;div class="csl-entry">&lt;a id="citeproc_bib_item_4">&lt;/a>4. Kenney, J.B. &lt;a href="https://www.researchgate.net/publication/295080241_Spectrum_Sharing_in_the_59_GHz_DSRC_Band">Spectrum Sharing in the 5.9 GHz DSRC Band&lt;/a> / J.B. Kenney // 22 ITS World Congress. – Bordeaux, 2015. – Сс. 1–12.&lt;/div>
&lt;div class="csl-entry">&lt;a id="citeproc_bib_item_5">&lt;/a>5. Kumar, N. An intelligent approach for building a secure decentralized public key infrastructure in VANET / N. Kumar, R. Iqbal, S. Misra, J.J.P.C. Rodrigues // Journal of Computer and System Sciences. – 2015. – Т. 81. – № 6. – Сс. 1042–1058. DOI: &lt;a href="https://doi.org/10.1016/j.jcss.2014.12.016">10.1016/j.jcss.2014.12.016&lt;/a>.&lt;/div>
&lt;div class="csl-entry">&lt;a id="citeproc_bib_item_6">&lt;/a>6. Sumayya, P.A. VANET Based Vehicle Tracking Module for Safe and Efficient Road Transportation System / P.A. Sumayya, P.S. Shefeena // Procedia Computer Science. – 2015. – Т. 46. – Сс. 1173–1180. DOI: &lt;a href="https://doi.org/10.1016/j.procs.2015.01.030">10.1016/j.procs.2015.01.030&lt;/a>.&lt;/div>
&lt;/div></description></item><item><title>Контроллер Cisco WLC. Обновление программного обеспечения</title><link>https://yamadharma.github.io/ru/post/2023/10/01/cisco-wlc-firmware-upgrade/</link><pubDate>Sun, 01 Oct 2023 19:37:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/10/01/cisco-wlc-firmware-upgrade/</guid><description>&lt;p>Контроллер Cisco WLC. Обновление программного обеспечения.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#процедура-обновления-из-интерфейса-командной-строки">&lt;span class="section-num">2&lt;/span> Процедура обновления из интерфейса командной строки&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#подготовка">&lt;span class="section-num">2.1&lt;/span> Подготовка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#задание-параметров-загрузки-образа">&lt;span class="section-num">2.2&lt;/span> Задание параметров загрузки образа&lt;/a>&lt;/li>
&lt;li>&lt;a href="#скачивание-образа">&lt;span class="section-num">2.3&lt;/span> Скачивание образа&lt;/a>&lt;/li>
&lt;li>&lt;a href="#предварительная-загрузка-образа-обновления-cisco-wlc-на-точки-доступа">&lt;span class="section-num">2.4&lt;/span> Предварительная загрузка образа обновления Cisco WLC на точки доступа&lt;/a>&lt;/li>
&lt;li>&lt;a href="#перезагрузка">&lt;span class="section-num">2.5&lt;/span> Перезагрузка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#выбор-образа-для-загрузки">&lt;span class="section-num">2.6&lt;/span> Выбор образа для загрузки&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#проблемы">&lt;span class="section-num">3&lt;/span> Проблемы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#cisco-aironet-1700">&lt;span class="section-num">3.1&lt;/span> Cisco Aironet 1700&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Не отключайте контроллер или любую точку доступа в процессе обновления.&lt;/li>
&lt;li>В противном случае можно повредить образ программного обеспечения.&lt;/li>
&lt;li>Обновление контроллера с большим числом точек доступа может занять около 30 минут в зависимости от размера сети.&lt;/li>
&lt;li>В это время точки доступа должны оставаться подключёнными к сети питания и не должен выполняться сброс контроллера.&lt;/li>
&lt;li>Программное обеспечение контроллера представляет собой файл размером порядка 100 мегабайт с именем формата &lt;code>AIR-CTYYYY-K9-X-X-XX.aes&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h2 id="процедура-обновления-из-интерфейса-командной-строки">&lt;span class="section-num">2&lt;/span> Процедура обновления из интерфейса командной строки&lt;/h2>
&lt;h3 id="подготовка">&lt;span class="section-num">2.1&lt;/span> Подготовка&lt;/h3>
&lt;ul>
&lt;li>Убедитесь в доступности TFTP-сервера из контроллера и в нахождении файла обновления в корневом каталоге TFTP-сервера.&lt;/li>
&lt;li>Лучше всего выполнять данную процедуру через порт консоли, но можно также использовать протокол SSH или Telnet для подключения к IP-адресу управления контроллера.&lt;/li>
&lt;li>Использование протокола SSH или Telnet приводит к потере соединения с контроллером во время процесса перезагрузки, выполняемого после загрузки образа.&lt;/li>
&lt;li>Проверьте текущую версию программного обеспечения, используемого в контроллере:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show sysinfo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="задание-параметров-загрузки-образа">&lt;span class="section-num">2.2&lt;/span> Задание параметров загрузки образа&lt;/h3>
&lt;ul>
&lt;li>Задайте режим передачи файлов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">transfer download mode tftp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Задайте IP-адрес TFTP-сервера:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">transfer download serverip &amp;lt;IP-адрес TFTP-сервера&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Задайте путь к каталогу на TFTP-сервере, в котором находится программное обеспечение операционной системы контроллера:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">transfer download path &lt;span class="s1">&amp;#39;&amp;lt;путь TFTP-сервера&amp;gt;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Задать имя файла образа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">transfer download filename &amp;lt;имя файла&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="скачивание-образа">&lt;span class="section-num">2.3&lt;/span> Скачивание образа&lt;/h3>
&lt;ul>
&lt;li>Инициировать процесс обновления:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">transfer download start
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="предварительная-загрузка-образа-обновления-cisco-wlc-на-точки-доступа">&lt;span class="section-num">2.4&lt;/span> Предварительная загрузка образа обновления Cisco WLC на точки доступа&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Необязательно.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Предварительная загрузка нового образ на точки доступа для сокращения времени простоя:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap image predownload primary all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Эта команда сообщает контроллеру загрузить образ на все ваши точки доступа.&lt;/li>
&lt;li>Этот процесс занимает несколько минут на каждой точке доступа.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Отслеживание прогресса:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show ap image all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Указать точкам доступа, чтобы они установили этот образ в качестве основного образа для использования при следующей перезагрузке:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap image swap all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Убедитесь, что новое изображение теперь установлено в качестве основного:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show ap image all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="перезагрузка">&lt;span class="section-num">2.5&lt;/span> Перезагрузка&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>После завершения обновления перезагрузите контроллер, чтобы новое программное обеспечение вступило в силу:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">reset system in HH:MM:SS image no-swap reset-aps save-config
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>image no-swap&lt;/code> сообщает контроллерам и точкам доступа о необходимости перезагрузки с использованием текущего образа, установленного в качестве основного, который является новым образом.&lt;/li>
&lt;li>&lt;code>reset-aps&lt;/code> указывает точкам доступа перезагрузиться одновременно с контроллерами, а не ждать, пока контроллеры вернутся и поймут, что им необходимо перезагрузить. Это сократит время простоя.&lt;/li>
&lt;li>&lt;code>save-config&lt;/code> указывает контроллерам сохранить текущую конфигурацию в загрузочную конфигурацию перед перезагрузкой, гарантируя, что все ожидающие изменения будут записаны до перезагрузки.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="выбор-образа-для-загрузки">&lt;span class="section-num">2.6&lt;/span> Выбор образа для загрузки&lt;/h3>
&lt;ul>
&lt;li>По умолчанию на контроллере WLC поддерживаются два образа: основной и резервный образы.&lt;/li>
&lt;li>Основной образ &amp;mdash; это активный образ, используемый контроллером WLC.&lt;/li>
&lt;li>Резервный образ используется в качестве резервной копии активного образа.&lt;/li>
&lt;li>При обновлении контроллера WLC с помощью нового образа контроллер WLC автоматически копирует новый образ поверх резервного образа.&lt;/li>
&lt;li>Просмотреть сведения об активном образе, используемом контроллером в данный момент (основной образ):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show boot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Выбрать какой образ будет активным (используемым контроллером WLC при загрузке):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config boot &amp;lt;primary/backup&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы контроллер WLC использовал новый активный образ, необходимо сохранить и перезагрузить его конфигурацию.&lt;/li>
&lt;/ul>
&lt;h2 id="проблемы">&lt;span class="section-num">3&lt;/span> Проблемы&lt;/h2>
&lt;h3 id="cisco-aironet-1700">&lt;span class="section-num">3.1&lt;/span> Cisco Aironet 1700&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Меняли прошивку WLC c 8.0.115 на 8.3.150.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>После обновления точки доступа не скачивали образ.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Писали, что не поддерживают и прочую ерунду.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Нашли в сети следующее:&lt;/p>
&lt;blockquote>
&lt;p>Disable Network Time Protocol (NTP) on the WLC and manually set the WLC date/time to a date before December 2, 2022. The Cisco IOS AP will then be able to download and validate the image, install the new image, and join the controller. Once the AP has joined the controller, NTP can be re-enabled on the controller to assume the correct date and time.&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>Отключили NTP.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Откатили даты назад.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Точки доступа стали загружать образ.&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>Динамическое обновление DNS-сервера BIND при помощи ISC DHCP</title><link>https://yamadharma.github.io/ru/post/2023/09/25/dynamically-updating-bind-dns-isc-dhcp/</link><pubDate>Mon, 25 Sep 2023 13:26:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/09/25/dynamically-updating-bind-dns-isc-dhcp/</guid><description>&lt;p>Динамическое обновление DNS-сервера BIND при помощи ISC DHCP.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#ключи">&lt;span class="section-num">1&lt;/span> Ключи&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-dhcp">&lt;span class="section-num">2&lt;/span> Настройка DHCP&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-dns-bind">&lt;span class="section-num">3&lt;/span> Настройка DNS Bind&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="ключи">&lt;span class="section-num">1&lt;/span> Ключи&lt;/h2>
&lt;ul>
&lt;li>Создадим ключ:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tsig-keygen -a HMAC-SHA512 DHCP_UPDATER &amp;gt; /etc/dhcp/keys/dhcp_updater.key
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Файл &lt;code>/etc/dhcp/keys/dhcp_updater.key&lt;/code> будет иметь следующий вид:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">key DHCP_UPDATER {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> algorithm hmac-md5;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> secret &amp;#34;EgxIOyQglf4KAUF7lgu9yA==&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-dhcp">&lt;span class="section-num">2&lt;/span> Настройка DHCP&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Настройка происходит в файле &lt;code>/etc/dhcp/dhcpd.conf&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Включим динамическое обновление:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ddns-updates on;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ddns-update-style interim;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ignore client-updates;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">update-static-leases on;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Данные опции включают динамическое обновление DNS и предписывают делать это в том числе и для статических записей.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Подключим ключ к dhcp:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">include &amp;#34;/etc/dhcp/keys/dhcp_updater.key&amp;#34;;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Добавим зоны, которые мы обновляем:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">zone local.zone. {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> primary 127.0.0.1;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> key DHCP_UPDATER;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zone 0.168.192.in-addr.arpa. {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> primary 127.0.0.1;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> key DHCP_UPDATER;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Имена зон мы пишем в абсолютном формате, т. е. с точкой на конце.&lt;/li>
&lt;li>Внутри каждой секции указываем адрес первичного DNS-сервера и ключ доступа к нему.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Можно увеличить время аренды адреса:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">default-lease-time 604800&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">max-lease-time 1814400&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Проверяем конфигурацию на ошибки:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dhcpd -t -cf /etc/dhcp/dhcpd.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-dns-bind">&lt;span class="section-num">3&lt;/span> Настройка DNS Bind&lt;/h2>
&lt;ul>
&lt;li>Настройка происходит в файле &lt;code>/etc/named.conf&lt;/code>.&lt;/li>
&lt;li>Ключ скопируем на хост с DNS-сервером (если это другой сервер).&lt;/li>
&lt;li>Поместим его в файл &lt;code>/etc/named/keys/dhcp_updater.key&lt;/code>.&lt;/li>
&lt;li>Подключим ключ:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">include &amp;#34;/etc/named/keys/dhcp_updater.key&amp;#34;;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Разрешим обновление зон:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">zone &amp;#34;local.zone&amp;#34; IN {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type master;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &amp;#34;local.zone.db&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> allow-update { key DHCP_UPDATER; };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zone &amp;#34;0.168.192.in-addr.arpa&amp;#34; IN {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type master;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &amp;#34;192.168.0.db&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> allow-update { key DHCP_UPDATER; };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>DNS. Bind. Установка сервера</title><link>https://yamadharma.github.io/ru/post/2023/09/19/dns-bind-server-install/</link><pubDate>Tue, 19 Sep 2023 14:35:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/09/19/dns-bind-server-install/</guid><description>&lt;p>Установка сервера DNS &lt;em>Bind&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#установка-bind">&lt;span class="section-num">1&lt;/span> Установка Bind&lt;/a>&lt;/li>
&lt;li>&lt;a href="#актуальные-версии-bind">&lt;span class="section-num">2&lt;/span> Актуальные версии Bind&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">2.1&lt;/span> Установка&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#настройка-брандмауэра">&lt;span class="section-num">3&lt;/span> Настройка брандмауэра&lt;/a>&lt;/li>
&lt;li>&lt;a href="#запуск-bind">&lt;span class="section-num">4&lt;/span> Запуск Bind&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="установка-bind">&lt;span class="section-num">1&lt;/span> Установка Bind&lt;/h2>
&lt;ul>
&lt;li>Устанавливаем DNS-сервер следующей командой:&lt;/li>
&lt;/ul>
&lt;!--listend-->
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install &lt;span class="nb">bind&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="актуальные-версии-bind">&lt;span class="section-num">2&lt;/span> Актуальные версии Bind&lt;/h2>
&lt;ul>
&lt;li>Можно устанавливать не версию bind, поставляемую с системой, а актуальную.&lt;/li>
&lt;li>Сайт: &lt;a href="https://copr.fedorainfracloud.org/coprs/isc/bind/" target="_blank" rel="noopener">https://copr.fedorainfracloud.org/coprs/isc/bind/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="установка">&lt;span class="section-num">2.1&lt;/span> Установка&lt;/h3>
&lt;ul>
&lt;li>Подключить репозиторий:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf copr &lt;span class="nb">enable&lt;/span> isc/bind
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установить коллекцию программного обеспечения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf install isc-bind
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Коллекция программного обеспечения BIND 9 состоит из нескольких пакетов:
&lt;ul>
&lt;li>&lt;code>isc-bind-bind&lt;/code> : содержит &lt;code>named&lt;/code>, &lt;code>rndc&lt;/code>, утилиты DNSSEC и соответствующие конфигурационные файлы;&lt;/li>
&lt;li>&lt;code>isc-bind-bind-utils&lt;/code> : содержит другие утилиты BIND 9 (&lt;code>dig&lt;/code>, &lt;code>nsupdate&lt;/code>).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Файл конфигурации:
&lt;ul>
&lt;li>&lt;code>/etc/opt/isc/scls/isc-bind/named.conf&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Параметры командной строки для демона можно указать в файле:
&lt;ul>
&lt;li>&lt;code>/etc/opt/isc/scls/isc-bind/sysconfig/named&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Запустить демон:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl start isc-bind-named
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Утилита BIND 9, установленные пакетами SCL, недоступны в &lt;code>$PATH&lt;/code> по умолчанию.&lt;/li>
&lt;li>Чтобы иметь возможность их использовать, сделайте следующее:
&lt;ul>
&lt;li>включить коллекцию программного обеспечения для текущей оболочки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">scl &lt;span class="nb">enable&lt;/span> isc-bind bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>чтобы включить коллекцию программного обеспечения внутри сценария оболочки, добавьте следующую строку:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">source&lt;/span> scl_source &lt;span class="nb">enable&lt;/span> isc-bind
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-брандмауэра">&lt;span class="section-num">3&lt;/span> Настройка брандмауэра&lt;/h2>
&lt;ul>
&lt;li>Настроим правила брандмауэра:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --zone&lt;span class="o">=&lt;/span>public --add-service&lt;span class="o">=&lt;/span>dns
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --runtime-to-permanent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="запуск-bind">&lt;span class="section-num">4&lt;/span> Запуск Bind&lt;/h2>
&lt;ul>
&lt;li>Запускаем &lt;em>bind&lt;/em> и включаем автозапуск:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now named
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>DNS. Bind</title><link>https://yamadharma.github.io/ru/post/2023/09/19/dns-bind/</link><pubDate>Tue, 19 Sep 2023 14:32:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/09/19/dns-bind/</guid><description>&lt;p>Сервер DNS &lt;em>Bind&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">1&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#безопасность">&lt;span class="section-num">2&lt;/span> Безопасность&lt;/a>&lt;/li>
&lt;li>&lt;a href="#администрирование">&lt;span class="section-num">3&lt;/span> Администрирование&lt;/a>&lt;/li>
&lt;li>&lt;a href="#взаимодействие-с-другими-сервисами">&lt;span class="section-num">4&lt;/span> Взаимодействие с другими сервисами&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="установка">&lt;span class="section-num">1&lt;/span> Установка&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/09/19/dns-bind-server-install/">DNS. Bind. Установка сервера&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="безопасность">&lt;span class="section-num">2&lt;/span> Безопасность&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/09/16/dns-bind-dnssec/">DNS. Bind. DNSSEC&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="администрирование">&lt;span class="section-num">3&lt;/span> Администрирование&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/10/28/nsupdate-dynamic-dns-editor/">nsupdate: динамический редактор зон DNS&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="взаимодействие-с-другими-сервисами">&lt;span class="section-num">4&lt;/span> Взаимодействие с другими сервисами&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/09/25/dynamically-updating-bind-dns-isc-dhcp/">Динамическое обновление DNS-сервера BIND при помощи ISC DHCP&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>DNS. Bind. DNSSEC</title><link>https://yamadharma.github.io/ru/post/2023/09/16/dns-bind-dnssec/</link><pubDate>Sat, 16 Sep 2023 19:52:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/09/16/dns-bind-dnssec/</guid><description>&lt;p>Настройка DNSSEC в Bind.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#ключи">&lt;span class="section-num">2&lt;/span> Ключи&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#каталоги-ключей">&lt;span class="section-num">2.1&lt;/span> Каталоги ключей&lt;/a>&lt;/li>
&lt;li>&lt;a href="#создание-ключей">&lt;span class="section-num">2.2&lt;/span> Создание ключей&lt;/a>&lt;/li>
&lt;li>&lt;a href="#права-доступа">&lt;span class="section-num">2.3&lt;/span> Права доступа&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#подпись-зоны">&lt;span class="section-num">3&lt;/span> Подпись зоны&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#ручная-подпись-зоны">&lt;span class="section-num">3.1&lt;/span> Ручная подпись зоны&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#настройка-bind">&lt;span class="section-num">3.1.1&lt;/span> Настройка BIND&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#автоматическое-подписывание-зоны">&lt;span class="section-num">3.2&lt;/span> Автоматическое подписывание зоны&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#проверка-работы">&lt;span class="section-num">4&lt;/span> Проверка работы&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Версия bind выше, чем 9.9:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">named -v
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="ключи">&lt;span class="section-num">2&lt;/span> Ключи&lt;/h2>
&lt;h3 id="каталоги-ключей">&lt;span class="section-num">2.1&lt;/span> Каталоги ключей&lt;/h3>
&lt;ul>
&lt;li>Создаём каталог, в котором будем хранить ключи и переходим в него:
&lt;ul>
&lt;li>Red Hat:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir /var/named/keys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /var/named/keys
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Debian, Ubuntu:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir /etc/bind/keys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /etc/bind/keys
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="создание-ключей">&lt;span class="section-num">2.2&lt;/span> Создание ключей&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Создаём мастер-ключей (&lt;code>KSK&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnssec-keygen -f KSK -a ECDSAP256SHA256 -b &lt;span class="m">4096&lt;/span> -n ZONE example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>-f KSK&lt;/code>: создаётся мастер-ключ;&lt;/li>
&lt;li>&lt;code>-a ECDSAP256SHA256&lt;/code>: используемый алгоритм шифрования;&lt;/li>
&lt;li>&lt;code>-b 2048&lt;/code>: размер ключа в битах (для алгоритма &lt;code>ECDSAP256SHA256&lt;/code> игнорируется);&lt;/li>
&lt;li>&lt;code>-n ZONE&lt;/code>: для DNS-зоны;&lt;/li>
&lt;li>&lt;code>-r /dev/urandom&lt;/code>: источник случайных данных;&lt;/li>
&lt;li>&lt;code>example.com&lt;/code>: домен, для которого предназначен ключ.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Создаём ключ для зоны (&lt;code>ZSK&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnssec-keygen -a ECDSAP256SHA256 -b &lt;span class="m">2048&lt;/span> -n ZONE example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Задаём владельца для сгенерированных файлов:&lt;/p>
&lt;ul>
&lt;li>Red Hat:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chown -R named:named /var/named/keys
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Debian, Ubuntu:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chown -R bind:bind /etc/bind/keys
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="права-доступа">&lt;span class="section-num">2.3&lt;/span> Права доступа&lt;/h3>
&lt;ul>
&lt;li>Поправим права доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chown -R named:named /var/named/keys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">640&lt;/span> /var/named/keys/*
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="подпись-зоны">&lt;span class="section-num">3&lt;/span> Подпись зоны&lt;/h2>
&lt;ul>
&lt;li>Зоны можно подписывать вручную или настроить автоматическую подпись зон.&lt;/li>
&lt;li>При ручной подписи необходимо переподписывать файл зоны после изменения.&lt;/li>
&lt;/ul>
&lt;h3 id="ручная-подпись-зоны">&lt;span class="section-num">3.1&lt;/span> Ручная подпись зоны&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Копируем содержимое ключей в файл зоны:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cat Kexample.com.*key &amp;gt;&amp;gt; /var/named/master/example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Переходим в каталог, где хранится наша зона:&lt;/p>
&lt;ul>
&lt;li>Red Hat:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /var/named/master
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Debian, Ubuntu:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /etc/bind/master
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Подписываем зону:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnssec-signzone -e +3mo -N INCREMENT -K /var/named/keys example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>-e +3mo&lt;/code> : время действия RRSIG (3 месяца);&lt;/li>
&lt;li>&lt;code>-N INCREMENT&lt;/code> : использовать формат серийного номера SOA из файла;&lt;/li>
&lt;li>&lt;code>-K /var/named/keys&lt;/code> : путь хранения сгенерированных ключей;&lt;/li>
&lt;li>&lt;code>example.com&lt;/code> : подписываемый домен.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>В каталоге хранения зон мы должны увидеть файл подписанной зоны &lt;code>example.com.signed&lt;/code>.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="настройка-bind">&lt;span class="section-num">3.1.1&lt;/span> Настройка BIND&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Редактируем конфигурационный файл:&lt;/p>
&lt;ul>
&lt;li>Red Hat:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/etc/named.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Debian, Ubuntu:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/etc/bind/named.conf.local
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Проверяем, чтобы dnssec был включён:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">options {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnssec-enable yes;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnssec-validation yes;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnssec-lookaside auto;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>dnssec-enable&lt;/code> : включение или отключение &lt;code>dnssec&lt;/code> на уровне сервера;&lt;/li>
&lt;li>&lt;code>dnssec-validation&lt;/code> : проверка корректность ответов;&lt;/li>
&lt;li>&lt;code>dnssec-lookaside&lt;/code> : разрешение использовать сторонние корни DNSSEC.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>В настройке зоны меняем путь к файлу:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">zone &amp;#34;example.com&amp;#34; {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">file &amp;#34;master/example.com.signed&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Перезапускаем bind:&lt;/p>
&lt;ul>
&lt;li>Red Hat:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl reload named
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Debian, Ubuntu:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl reload &lt;span class="nb">bind&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Или перегружаем конфигурацию bind:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rndc reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="автоматическое-подписывание-зоны">&lt;span class="section-num">3.2&lt;/span> Автоматическое подписывание зоны&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Для автоматизации процесса в конфигурационном файле bind задаём:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">options&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">key&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">directory&lt;/span> &lt;span class="s2">&amp;#34;/var/named/keys&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sig&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">validity&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">interval&lt;/span> &lt;span class="mi">20&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>key-directory&lt;/code> : каталог хранения ключей;&lt;/li>
&lt;li>&lt;code>sig-validity-interval&lt;/code> : период действия ключей: дней (период обновления).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Для зоны редактируем:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">zone &lt;span class="s2">&amp;#34;example.com&amp;#34;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">file &lt;span class="s2">&amp;#34;master/example.com&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">inline-signing yes&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">auto-dnssec maintain&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>inline-signing&lt;/code> : включение или отключение прозрачного формирования подписей (без необходимости менять файл зоны);&lt;/li>
&lt;li>&lt;code>auto-dnssec&lt;/code> : уровень автоматической настройки DNSSEC для зоны.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Меняем серийный номер файла зоны.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Перезапускаем bind:&lt;/p>
&lt;ul>
&lt;li>Red Hat:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl reload named
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Debian, Ubuntu:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl reload &lt;span class="nb">bind&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Или перегружаем конфигурацию bind:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rndc reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>В каталоге зоны должны появиться дополнительные 3 файла: &lt;code>example.com.jbk&lt;/code>, &lt;code>example.com.signed&lt;/code>, &lt;code>example.com.signed.jnl&lt;/code>.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="проверка-работы">&lt;span class="section-num">4&lt;/span> Проверка работы&lt;/h2>
&lt;ul>
&lt;li>Чтобы проверить, отдаёт ли наш сервер ответы с цифровыми подписями, вводим команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dig example.com +dnssec
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Посмотрим подпись зоны:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dig DNSKEY example.com. @localhost +multiline
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Или:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dig A example.com. @localhost +noadditional +dnssec +multiline
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Получить DS записи для реестра доменов и прописать их у регистратора:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dig @localhost dnskey example.com &lt;span class="p">|&lt;/span> dnssec-dsfromkey -f - example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После того, как мы добавили DS записи в реестр, спустя какое-то время можно проверять все ли в порядке.
&lt;ul>
&lt;li>Сайт: &lt;a href="https://dnssec-analyzer.verisignlabs.com" target="_blank" rel="noopener">https://dnssec-analyzer.verisignlabs.com&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Domain Name System (DNS)</title><link>https://yamadharma.github.io/ru/post/2023/09/16/domain-name-system-dns/</link><pubDate>Sat, 16 Sep 2023 19:47:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/09/16/domain-name-system-dns/</guid><description>&lt;p>Domain Name System (DNS).&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#серверы-dns">&lt;span class="section-num">1&lt;/span> Серверы DNS&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#bind">&lt;span class="section-num">1.1&lt;/span> Bind&lt;/a>&lt;/li>
&lt;li>&lt;a href="#powerdns">&lt;span class="section-num">1.2&lt;/span> PowerDNS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#инфраструктура-dns">&lt;span class="section-num">2&lt;/span> Инфраструктура DNS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="серверы-dns">&lt;span class="section-num">1&lt;/span> Серверы DNS&lt;/h2>
&lt;h3 id="bind">&lt;span class="section-num">1.1&lt;/span> Bind&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/09/19/dns-bind/">DNS. Bind&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="powerdns">&lt;span class="section-num">1.2&lt;/span> PowerDNS&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/05/23/dns-powerdns-recursor/">DNS. PowerDNS Recursor&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="инфраструктура-dns">&lt;span class="section-num">2&lt;/span> Инфраструктура DNS&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/05/26/public-dns-resolvers/">Общедоступные резольверы DNS&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Алгоритм Random early detection</title><link>https://yamadharma.github.io/ru/post/2023/09/12/random-early-detection/</link><pubDate>Tue, 12 Sep 2023 16:33:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/09/12/random-early-detection/</guid><description>&lt;p>Семейство алгоритмов типа Random early detection (RED).&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#характерные-черты-алгоритма-red">&lt;span class="section-num">2&lt;/span> Характерные черты алгоритма RED&lt;/a>&lt;/li>
&lt;li>&lt;a href="#зачем-исследовать-алгоритмы-типа-red">&lt;span class="section-num">3&lt;/span> Зачем исследовать алгоритмы типа RED&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#параметры">&lt;span class="section-num">3.1&lt;/span> Параметры&lt;/a>&lt;/li>
&lt;li>&lt;a href="#функция-сброса">&lt;span class="section-num">3.2&lt;/span> Функция сброса&lt;/a>&lt;/li>
&lt;li>&lt;a href="#пути-исследования">&lt;span class="section-num">3.3&lt;/span> Пути исследования&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#принципы-работы">&lt;span class="section-num">4&lt;/span> Принципы работы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#литература">Литература&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Random early detection (RED) (Произвольное Раннее Обнаружение)&lt;/li>
&lt;li>Один из типов алгоритмов AQM для управления переполнением очередей маршрутизаторов.&lt;/li>
&lt;li>Предложен Салли Флойд [&lt;a href="#citeproc_bib_item_1">1&lt;/a>].&lt;/li>
&lt;li>Страница Салли Флойд, посвящённая RED: &lt;a href="http://www.icir.org/floyd/red.html" target="_blank" rel="noopener">http://www.icir.org/floyd/red.html&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h2 id="характерные-черты-алгоритма-red">&lt;span class="section-num">2&lt;/span> Характерные черты алгоритма RED&lt;/h2>
&lt;ul>
&lt;li>Алгоритм крайне простой.&lt;/li>
&lt;li>Алгоритм построен так, чтобы использовать как можно меньше вычислительных ресурсов.&lt;/li>
&lt;li>Основная вычислительная сложность приходится на вычисление функции сброса.&lt;/li>
&lt;li>Не случайно эта функция функция строится из ломаных, как полиномиальное приближение к нелинейной функции сброса.&lt;/li>
&lt;li>Из-за использования в алгоритме скользящего среднего RED хорошо обрабатывает взрывной (burst) трафик.&lt;/li>
&lt;li>В сетях TCP/IP алгоритм RED помогает избавиться от проблемы &lt;em>глобальной синхронизации&lt;/em>.
&lt;ul>
&lt;li>Она возникает, когда несколько источников, работающих через один и тот же перегруженный сегмент сети, обнаруживают потери пакетов.&lt;/li>
&lt;li>Как следствие, эти источники одновременно снижают скорость, а затем (также одновременно) постепенно ее увеличивают, что приводит к новой перегрузке, потере пакетов и повторению всей процедуры.&lt;/li>
&lt;li>Состояние сети периодически меняется от простоя до перегрузки.&lt;/li>
&lt;li>RED позволяет избежать &lt;em>глобальной синхронизации&lt;/em>, выборочно уничтожая пакеты от определённых источников.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="зачем-исследовать-алгоритмы-типа-red">&lt;span class="section-num">3&lt;/span> Зачем исследовать алгоритмы типа RED&lt;/h2>
&lt;ul>
&lt;li>Математическая модель алгоритмов типа RED достаточно сложная, поэтому обосновать влияние разных элементов алгоритма на качество его работы крайне проблематично.&lt;/li>
&lt;/ul>
&lt;h3 id="параметры">&lt;span class="section-num">3.1&lt;/span> Параметры&lt;/h3>
&lt;ul>
&lt;li>Недостатком RED, о котором сообщают многие специалисты, это отсутствие жёсткого алгоритма задания параметров RED [&lt;a href="#citeproc_bib_item_2">2&lt;/a>].&lt;/li>
&lt;li>Параметры задают:
&lt;ul>
&lt;li>пороги;&lt;/li>
&lt;li>форму функции сброса;&lt;/li>
&lt;li>размер буфера.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Изменение одних параметров тут же сказывается на других.&lt;/li>
&lt;/ul>
&lt;h3 id="функция-сброса">&lt;span class="section-num">3.2&lt;/span> Функция сброса&lt;/h3>
&lt;ul>
&lt;li>Изначальная функция сброса RED является простейшим приближением некоторой нелинейной функции.&lt;/li>
&lt;li>Структура функции сброса простая.
&lt;ul>
&lt;li>Вначале она должна быть достаточно пологой, чтобы при превышении нижнего порога сброс пакетов был незначительным.&lt;/li>
&lt;li>При приближении ко второму порогу функция сброса должна идти круто.&lt;/li>
&lt;li>Вообще, задача о задании функции сброса идеологически похожа на задачу о брахистохроне.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="пути-исследования">&lt;span class="section-num">3.3&lt;/span> Пути исследования&lt;/h3>
&lt;ul>
&lt;li>Необходимо придумать такую функцию сброса, чтобы она вела себя нужным образом при конфигурации по умолчанию.&lt;/li>
&lt;li>Можно с помощью задания нескольких порогов задать разные функции на разных сегментах.&lt;/li>
&lt;li>Поскольку подобных функций можно задать достаточно много (с минимальным приложением усилий), а адекватной математической модели пока нет, исследования по улучшению RED будут продолжаться бесконечно.&lt;/li>
&lt;/ul>
&lt;h2 id="принципы-работы">&lt;span class="section-num">4&lt;/span> Принципы работы&lt;/h2>
&lt;ul>
&lt;li>RED отслеживает средний размер очереди и отбрасываемых пакетов, основываясь на статистической вероятности.&lt;/li>
&lt;li>Также RED может использовать отслеживание пометок ECN.&lt;/li>
&lt;li>Если буфер практически пуст, то все пакеты пропускаются в обычном режиме.&lt;/li>
&lt;li>Когда очередь начинает расти, то вероятность отбрасывания пакетов также начинает расти.&lt;/li>
&lt;li>Когда буфер полностью заполняется, вероятность становится равной единице и все входящие пакеты отбрасываются.&lt;/li>
&lt;li>Можно сказать, что когда заполненность буфера маршрутизатора превышает какое-либо пороговое значение, вероятность отбрасывания входящего пакета зависит от степени превышения этого порогового значения.&lt;/li>
&lt;/ul>
&lt;h2 id="литература">Литература&lt;/h2>
&lt;div class="csl-bib-body">
&lt;div class="csl-entry">&lt;a id="citeproc_bib_item_1">&lt;/a>1. Floyd, S. Random early detection gateways for congestion avoidance / S. Floyd, V. Jacobson // IEEE/ACM Transactions on Networking. – 1993. – Т. 1. – № 4. – Сс. 397–413. DOI: &lt;a href="https://doi.org/10.1109/90.251892">10.1109/90.251892&lt;/a>.&lt;/div>
&lt;div class="csl-entry">&lt;a id="citeproc_bib_item_2">&lt;/a>2. May, M. &lt;a href="https://doi.org/10.1109/iwqos.1999.766502">Reasons not to deploy RED&lt;/a> / M. May, J. Bolot, C. Diot, B. Lyles // 1999 Seventh International Workshop on Quality of Service. IWQoS’99. (Cat. No.98EX354). – IEEE, 1999. – Сс. 260–262.&lt;/div>
&lt;/div></description></item><item><title>Подключение к Cisco VPN</title><link>https://yamadharma.github.io/ru/post/2023/08/19/cisco-vpn-client-setup/</link><pubDate>Sat, 19 Aug 2023 13:34:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/08/19/cisco-vpn-client-setup/</guid><description>&lt;p>Подключение к Cisco AnyConnect VPN.
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-в-linux">&lt;span class="section-num">2&lt;/span> Установка в Linux&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#gentoo">&lt;span class="section-num">2.1&lt;/span> Gentoo&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#подключение">&lt;span class="section-num">3&lt;/span> Подключение&lt;/a>&lt;/li>
&lt;li>&lt;a href="#dns">&lt;span class="section-num">4&lt;/span> DNS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;/p>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>В качестве клиента для Cisco AnyConnect VPN предлагается использовать OpenConnect.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://gitlab.com/openconnect/openconnect" target="_blank" rel="noopener">https://gitlab.com/openconnect/openconnect&lt;/a>&lt;/li>
&lt;li>Репозиторий модуля для Network Manager: &lt;a href="https://gitlab.gnome.org/GNOME/NetworkManager-openconnect" target="_blank" rel="noopener">https://gitlab.gnome.org/GNOME/NetworkManager-openconnect&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="установка-в-linux">&lt;span class="section-num">2&lt;/span> Установка в Linux&lt;/h2>
&lt;h3 id="gentoo">&lt;span class="section-num">2.1&lt;/span> Gentoo&lt;/h3>
&lt;ul>
&lt;li>Установите клиента для Network Manager:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge net-vpn/networkmanager-openconnect
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="подключение">&lt;span class="section-num">3&lt;/span> Подключение&lt;/h2>
&lt;ul>
&lt;li>При создании соединения в Network Manager необходимо задать адрес шлюза.&lt;/li>
&lt;li>При первом подключении у Вас запросят парольные данные.&lt;/li>
&lt;li>Если Вы их сохраните, то более их не надо будет набирать.&lt;/li>
&lt;li>Если у вас используется сертификат или нужно указать какие-то дополнительные параметры, то это необходимо сделать в этом же окне.&lt;/li>
&lt;/ul>
&lt;h2 id="dns">&lt;span class="section-num">4&lt;/span> DNS&lt;/h2>
&lt;ul>
&lt;li>Обычно VPN настроены на раздельную маршрутизацию и раздельный DNS.&lt;/li>
&lt;li>Для удобной работы с раздельным DNS рекомендуется использовать &lt;code>systemd-resolved&lt;/code> в stub-режиме (режиме заглушки) &lt;code>resolv.conf&lt;/code>.&lt;/li>
&lt;li>Просмотр параметров работы &lt;code>systemd-resolved&lt;/code> выполняется с помощью команды:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">resolvectl
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Сборка образа VyOS. Репозиторий</title><link>https://yamadharma.github.io/ru/post/2023/07/16/vyos-build-repository/</link><pubDate>Sun, 16 Jul 2023 19:13:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/07/16/vyos-build-repository/</guid><description>&lt;p>Репозиторий с поддержкой сборки образов VyOS.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#репозиторий">&lt;span class="section-num">2&lt;/span> Репозиторий&lt;/a>&lt;/li>
&lt;li>&lt;a href="#скрипт-для-сборки">&lt;span class="section-num">3&lt;/span> Скрипт для сборки&lt;/a>&lt;/li>
&lt;li>&lt;a href="#описание-приложения-для-gns3">&lt;span class="section-num">4&lt;/span> Описание приложения для GNS3&lt;/a>&lt;/li>
&lt;li>&lt;a href="#использование-в-gns3">&lt;span class="section-num">5&lt;/span> Использование в GNS3&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка-образа-vyos-quemu-в-gns3">&lt;span class="section-num">5.1&lt;/span> Установка образа VyOS quemu в GNS3&lt;/a>&lt;/li>
&lt;li>&lt;a href="#видео-установка-образа-vyos-quemu-в-gns3">&lt;span class="section-num">5.2&lt;/span> Видео: Установка образа VyOS quemu в GNS3&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Репозиторий предназначен для хранения образов VyOS, собранных для обучения.&lt;/li>
&lt;li>Образы собираются по стандартной методике (см. &lt;a href="https://yamadharma.github.io/ru/course/nettech/gns3-vyos/">GNS3. Образ VyOS&lt;/a>).&lt;/li>
&lt;li>Сборка организуется по технологии непрерывной интеграции (см. &lt;a href="https://yamadharma.github.io/ru/post/2023/07/16/continuous-integration-github-actions/">Непрерывная интеграция. GitHub Actions&lt;/a>).&lt;/li>
&lt;/ul>
&lt;h2 id="репозиторий">&lt;span class="section-num">2&lt;/span> Репозиторий&lt;/h2>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/yamadharma/vyos-build" target="_blank" rel="noopener">https://github.com/yamadharma/vyos-build&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="скрипт-для-сборки">&lt;span class="section-num">3&lt;/span> Скрипт для сборки&lt;/h2>
&lt;ul>
&lt;li>Помещается в каталог &lt;code>.github/workflows&lt;/code> репозиторий.&lt;/li>
&lt;li>Назовём его &lt;code>vyos-build-release.yml&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-1">&lt;a class="lnlinks" href="#org-coderef--59b1f4-1"> 1&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">VyOS Build (Release)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-2">&lt;a class="lnlinks" href="#org-coderef--59b1f4-2"> 2&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-3">&lt;a class="lnlinks" href="#org-coderef--59b1f4-3"> 3&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-4">&lt;a class="lnlinks" href="#org-coderef--59b1f4-4"> 4&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">push&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-5">&lt;a class="lnlinks" href="#org-coderef--59b1f4-5"> 5&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">tags&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-6">&lt;a class="lnlinks" href="#org-coderef--59b1f4-6"> 6&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="l">​ - &amp;#34;*&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-7">&lt;a class="lnlinks" href="#org-coderef--59b1f4-7"> 7&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-8">&lt;a class="lnlinks" href="#org-coderef--59b1f4-8"> 8&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-9">&lt;a class="lnlinks" href="#org-coderef--59b1f4-9"> 9&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">build&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-10">&lt;a class="lnlinks" href="#org-coderef--59b1f4-10"> 10&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-11">&lt;a class="lnlinks" href="#org-coderef--59b1f4-11"> 11&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">runs-on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-12">&lt;a class="lnlinks" href="#org-coderef--59b1f4-12"> 12&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-13">&lt;a class="lnlinks" href="#org-coderef--59b1f4-13"> 13&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># For VyOS 1.2 (crux) use vyos/vyos-build:crux&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-14">&lt;a class="lnlinks" href="#org-coderef--59b1f4-14"> 14&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># For VyOS 1.3 (equuleus) use vyos/vyos-build:equuleus&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-15">&lt;a class="lnlinks" href="#org-coderef--59b1f4-15"> 15&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># For our VyOS rolling release you should use vyos/vyos-build which will always refer to the latest image.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-16">&lt;a class="lnlinks" href="#org-coderef--59b1f4-16"> 16&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># Ref: https://docs.vyos.io/en/latest/contributing/build-vyos.html#build&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-17">&lt;a class="lnlinks" href="#org-coderef--59b1f4-17"> 17&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">vyos/vyos-build:equuleus&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-18">&lt;a class="lnlinks" href="#org-coderef--59b1f4-18"> 18&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-19">&lt;a class="lnlinks" href="#org-coderef--59b1f4-19"> 19&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">TZ&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Etc/UTC&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-20">&lt;a class="lnlinks" href="#org-coderef--59b1f4-20"> 20&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">options&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>--&lt;span class="l">privileged&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-21">&lt;a class="lnlinks" href="#org-coderef--59b1f4-21"> 21&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-22">&lt;a class="lnlinks" href="#org-coderef--59b1f4-22"> 22&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-23">&lt;a class="lnlinks" href="#org-coderef--59b1f4-23"> 23&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-24">&lt;a class="lnlinks" href="#org-coderef--59b1f4-24"> 24&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">​ - name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Set env&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-25">&lt;a class="lnlinks" href="#org-coderef--59b1f4-25"> 25&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-26">&lt;a class="lnlinks" href="#org-coderef--59b1f4-26"> 26&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> echo &amp;#34;RELEASE_VERSION=${GITHUB_REF:11}&amp;#34; &amp;gt;&amp;gt; $GITHUB_ENV&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-27">&lt;a class="lnlinks" href="#org-coderef--59b1f4-27"> 27&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-28">&lt;a class="lnlinks" href="#org-coderef--59b1f4-28"> 28&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">git clone vyos-build&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-29">&lt;a class="lnlinks" href="#org-coderef--59b1f4-29"> 29&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-30">&lt;a class="lnlinks" href="#org-coderef--59b1f4-30"> 30&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> set -eux
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-31">&lt;a class="lnlinks" href="#org-coderef--59b1f4-31"> 31&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-32">&lt;a class="lnlinks" href="#org-coderef--59b1f4-32"> 32&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> git clone -b equuleus --single-branch https://github.com/vyos/vyos-build&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-33">&lt;a class="lnlinks" href="#org-coderef--59b1f4-33"> 33&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-34">&lt;a class="lnlinks" href="#org-coderef--59b1f4-34"> 34&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">configure&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-35">&lt;a class="lnlinks" href="#org-coderef--59b1f4-35"> 35&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">working-directory&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">vyos-build&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-36">&lt;a class="lnlinks" href="#org-coderef--59b1f4-36"> 36&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-37">&lt;a class="lnlinks" href="#org-coderef--59b1f4-37"> 37&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> set -eux
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-38">&lt;a class="lnlinks" href="#org-coderef--59b1f4-38"> 38&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-39">&lt;a class="lnlinks" href="#org-coderef--59b1f4-39"> 39&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> ./configure \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-40">&lt;a class="lnlinks" href="#org-coderef--59b1f4-40"> 40&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> --architecture amd64 \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-41">&lt;a class="lnlinks" href="#org-coderef--59b1f4-41"> 41&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> --build-by yamadharma@gmail.com \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-42">&lt;a class="lnlinks" href="#org-coderef--59b1f4-42"> 42&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> --build-type release \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-43">&lt;a class="lnlinks" href="#org-coderef--59b1f4-43"> 43&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> --version ${{ env.RELEASE_VERSION }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-44">&lt;a class="lnlinks" href="#org-coderef--59b1f4-44"> 44&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-45">&lt;a class="lnlinks" href="#org-coderef--59b1f4-45"> 45&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">make iso&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-46">&lt;a class="lnlinks" href="#org-coderef--59b1f4-46"> 46&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">working-directory&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">vyos-build&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-47">&lt;a class="lnlinks" href="#org-coderef--59b1f4-47"> 47&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-48">&lt;a class="lnlinks" href="#org-coderef--59b1f4-48"> 48&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> set -eux
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-49">&lt;a class="lnlinks" href="#org-coderef--59b1f4-49"> 49&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-50">&lt;a class="lnlinks" href="#org-coderef--59b1f4-50"> 50&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> make iso&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-51">&lt;a class="lnlinks" href="#org-coderef--59b1f4-51"> 51&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-52">&lt;a class="lnlinks" href="#org-coderef--59b1f4-52"> 52&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">make qemu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-53">&lt;a class="lnlinks" href="#org-coderef--59b1f4-53"> 53&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">working-directory&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">vyos-build&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-54">&lt;a class="lnlinks" href="#org-coderef--59b1f4-54"> 54&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-55">&lt;a class="lnlinks" href="#org-coderef--59b1f4-55"> 55&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> set -eux
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-56">&lt;a class="lnlinks" href="#org-coderef--59b1f4-56"> 56&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-57">&lt;a class="lnlinks" href="#org-coderef--59b1f4-57"> 57&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> make qemu&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-58">&lt;a class="lnlinks" href="#org-coderef--59b1f4-58"> 58&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-59">&lt;a class="lnlinks" href="#org-coderef--59b1f4-59"> 59&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ls&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-60">&lt;a class="lnlinks" href="#org-coderef--59b1f4-60"> 60&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-61">&lt;a class="lnlinks" href="#org-coderef--59b1f4-61"> 61&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> set -eux
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-62">&lt;a class="lnlinks" href="#org-coderef--59b1f4-62"> 62&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-63">&lt;a class="lnlinks" href="#org-coderef--59b1f4-63"> 63&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> pwd
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-64">&lt;a class="lnlinks" href="#org-coderef--59b1f4-64"> 64&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> ls -lah
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-65">&lt;a class="lnlinks" href="#org-coderef--59b1f4-65"> 65&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> ls -lah vyos-build/build&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-66">&lt;a class="lnlinks" href="#org-coderef--59b1f4-66"> 66&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-67">&lt;a class="lnlinks" href="#org-coderef--59b1f4-67"> 67&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/create-release@master&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-68">&lt;a class="lnlinks" href="#org-coderef--59b1f4-68"> 68&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">create_release&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-69">&lt;a class="lnlinks" href="#org-coderef--59b1f4-69"> 69&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-70">&lt;a class="lnlinks" href="#org-coderef--59b1f4-70"> 70&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">GITHUB_TOKEN&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ secrets.GITHUB_TOKEN }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-71">&lt;a class="lnlinks" href="#org-coderef--59b1f4-71"> 71&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-72">&lt;a class="lnlinks" href="#org-coderef--59b1f4-72"> 72&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">tag_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ github.ref }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-73">&lt;a class="lnlinks" href="#org-coderef--59b1f4-73"> 73&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">release_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">VyOS ${{ github.ref }} for Education&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-74">&lt;a class="lnlinks" href="#org-coderef--59b1f4-74"> 74&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-75">&lt;a class="lnlinks" href="#org-coderef--59b1f4-75"> 75&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="sd"> VyOS ${{ env.RELEASE_VERSION }} for Education&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-76">&lt;a class="lnlinks" href="#org-coderef--59b1f4-76"> 76&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">draft&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-77">&lt;a class="lnlinks" href="#org-coderef--59b1f4-77"> 77&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">prerelease&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-78">&lt;a class="lnlinks" href="#org-coderef--59b1f4-78"> 78&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-79">&lt;a class="lnlinks" href="#org-coderef--59b1f4-79"> 79&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/upload-release-asset@master&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-80">&lt;a class="lnlinks" href="#org-coderef--59b1f4-80"> 80&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-81">&lt;a class="lnlinks" href="#org-coderef--59b1f4-81"> 81&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">GITHUB_TOKEN&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ secrets.GITHUB_TOKEN }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-82">&lt;a class="lnlinks" href="#org-coderef--59b1f4-82"> 82&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-83">&lt;a class="lnlinks" href="#org-coderef--59b1f4-83"> 83&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-84">&lt;a class="lnlinks" href="#org-coderef--59b1f4-84"> 84&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">upload_url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ steps.create_release.outputs.upload_url }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-85">&lt;a class="lnlinks" href="#org-coderef--59b1f4-85"> 85&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-86">&lt;a class="lnlinks" href="#org-coderef--59b1f4-86"> 86&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">asset_path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">vyos-build/build/vyos-${{ env.RELEASE_VERSION }}-amd64.iso&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-87">&lt;a class="lnlinks" href="#org-coderef--59b1f4-87"> 87&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-88">&lt;a class="lnlinks" href="#org-coderef--59b1f4-88"> 88&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">asset_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">vyos-${{ env.RELEASE_VERSION }}-amd64.iso&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-89">&lt;a class="lnlinks" href="#org-coderef--59b1f4-89"> 89&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-90">&lt;a class="lnlinks" href="#org-coderef--59b1f4-90"> 90&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">asset_content_type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">application/x-iso9660-image&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-91">&lt;a class="lnlinks" href="#org-coderef--59b1f4-91"> 91&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-92">&lt;a class="lnlinks" href="#org-coderef--59b1f4-92"> 92&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/upload-release-asset@master&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-93">&lt;a class="lnlinks" href="#org-coderef--59b1f4-93"> 93&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-94">&lt;a class="lnlinks" href="#org-coderef--59b1f4-94"> 94&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">GITHUB_TOKEN&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ secrets.GITHUB_TOKEN }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-95">&lt;a class="lnlinks" href="#org-coderef--59b1f4-95"> 95&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-96">&lt;a class="lnlinks" href="#org-coderef--59b1f4-96"> 96&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-97">&lt;a class="lnlinks" href="#org-coderef--59b1f4-97"> 97&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">upload_url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ steps.create_release.outputs.upload_url }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-98">&lt;a class="lnlinks" href="#org-coderef--59b1f4-98"> 98&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-99">&lt;a class="lnlinks" href="#org-coderef--59b1f4-99"> 99&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">asset_path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">vyos-build/build/vyos-${{ env.RELEASE_VERSION }}-amd64.qcow2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-100">&lt;a class="lnlinks" href="#org-coderef--59b1f4-100">100&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-101">&lt;a class="lnlinks" href="#org-coderef--59b1f4-101">101&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">asset_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">vyos-${{ env.RELEASE_VERSION }}-amd64.qcow2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-102">&lt;a class="lnlinks" href="#org-coderef--59b1f4-102">102&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="org-coderef--59b1f4-103">&lt;a class="lnlinks" href="#org-coderef--59b1f4-103">103&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">asset_content_type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">application/x-qemu-disk&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Строка &lt;a href="#org-coderef--59b1f4-6">6&lt;/a>: запускаем скрипт при создании любого тега.&lt;/li>
&lt;li>Строка &lt;a href="#org-coderef--59b1f4-26">26&lt;/a>: из полной ссылки на ветку тега выделяем номер версии.
&lt;ul>
&lt;li>&lt;code>refs/tags/v1.3.x&lt;/code> -&amp;gt; &lt;code>1.3.x&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="описание-приложения-для-gns3">&lt;span class="section-num">4&lt;/span> Описание приложения для GNS3&lt;/h2>
&lt;ul>
&lt;li>Для установки образа VyOS в GNS3 (см. &lt;a href="https://yamadharma.github.io/ru/post/2022/05/07/gns3-network-simulation-tool/">Средство натурного моделирования сетей GNS3&lt;/a>) необходимо создать файл приложения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="ln" id="hl-1-1">&lt;a class="lnlinks" href="#hl-1-1"> 1&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-2">&lt;a class="lnlinks" href="#hl-1-2"> 2&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;appliance_id&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;a5250e6e-be54-40d3-9082-0f0b601d3231&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-3">&lt;a class="lnlinks" href="#hl-1-3"> 3&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;VyOS&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-4">&lt;a class="lnlinks" href="#hl-1-4"> 4&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;category&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;router&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-5">&lt;a class="lnlinks" href="#hl-1-5"> 5&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;description&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;VyOS is a community fork of Vyatta, a Linux-based network operating system that provides software-based network routing, firewall, and VPN functionality. Non-official build for Eduacation&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-6">&lt;a class="lnlinks" href="#hl-1-6"> 6&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;vendor_name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;Linux&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-7">&lt;a class="lnlinks" href="#hl-1-7"> 7&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;vendor_url&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://vyos.net/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-8">&lt;a class="lnlinks" href="#hl-1-8"> 8&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;documentation_url&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://docs.vyos.io/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-9">&lt;a class="lnlinks" href="#hl-1-9"> 9&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;product_name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;VyOS&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-10">&lt;a class="lnlinks" href="#hl-1-10">10&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;product_url&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://vyos.net/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-11">&lt;a class="lnlinks" href="#hl-1-11">11&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;registry_version&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-12">&lt;a class="lnlinks" href="#hl-1-12">12&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;status&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;stable&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-13">&lt;a class="lnlinks" href="#hl-1-13">13&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;maintainer&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;Dmitry S. Kulyabov&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-14">&lt;a class="lnlinks" href="#hl-1-14">14&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;maintainer_email&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;yamadharma@gmail.com&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-15">&lt;a class="lnlinks" href="#hl-1-15">15&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;usage&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;Default username/password is vyos/vyos.\n\nThe -KVM versions are ready to use, no installation is required.\nThe other images will start the router from the CDROM on initial boot. Login and then type \&amp;#34;install image\&amp;#34; and follow the instructions.&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-16">&lt;a class="lnlinks" href="#hl-1-16">16&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;symbol&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;vyos.svg&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-17">&lt;a class="lnlinks" href="#hl-1-17">17&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;port_name_format&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;eth{0}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-18">&lt;a class="lnlinks" href="#hl-1-18">18&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;qemu&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-19">&lt;a class="lnlinks" href="#hl-1-19">19&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;adapter_type&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;e1000&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-20">&lt;a class="lnlinks" href="#hl-1-20">20&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;adapters&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-21">&lt;a class="lnlinks" href="#hl-1-21">21&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;ram&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">512&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-22">&lt;a class="lnlinks" href="#hl-1-22">22&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;hda_disk_interface&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;scsi&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-23">&lt;a class="lnlinks" href="#hl-1-23">23&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;arch&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;x86_64&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-24">&lt;a class="lnlinks" href="#hl-1-24">24&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;console_type&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;telnet&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-25">&lt;a class="lnlinks" href="#hl-1-25">25&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;boot_priority&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;cd&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-26">&lt;a class="lnlinks" href="#hl-1-26">26&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;kvm&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;allow&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-27">&lt;a class="lnlinks" href="#hl-1-27">27&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-28">&lt;a class="lnlinks" href="#hl-1-28">28&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;images&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-29">&lt;a class="lnlinks" href="#hl-1-29">29&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-30">&lt;a class="lnlinks" href="#hl-1-30">30&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;filename&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;vyos-1.3.3-amd64.iso&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-31">&lt;a class="lnlinks" href="#hl-1-31">31&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;version&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;1.3.3-iso&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-32">&lt;a class="lnlinks" href="#hl-1-32">32&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;md5sum&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;1ab25e1b63d9e3305bd5264721305794&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-33">&lt;a class="lnlinks" href="#hl-1-33">33&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;filesize&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">382730240&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-34">&lt;a class="lnlinks" href="#hl-1-34">34&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;download_url&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://github.com/yamadharma/vyos-build/releases/tag/v1.3.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-35">&lt;a class="lnlinks" href="#hl-1-35">35&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;direct_download_url&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://github.com/yamadharma/vyos-build/releases/download/v1.3.3/vyos-1.3.3-amd64.iso&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-36">&lt;a class="lnlinks" href="#hl-1-36">36&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-37">&lt;a class="lnlinks" href="#hl-1-37">37&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-38">&lt;a class="lnlinks" href="#hl-1-38">38&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;filename&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;vyos-1.3.3-amd64.qcow2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-39">&lt;a class="lnlinks" href="#hl-1-39">39&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;version&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;1.3.3-qemu&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-40">&lt;a class="lnlinks" href="#hl-1-40">40&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;md5sum&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;9dffb9ab2af456c1eb993c0beef81b91&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-41">&lt;a class="lnlinks" href="#hl-1-41">41&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;filesize&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">410058752&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-42">&lt;a class="lnlinks" href="#hl-1-42">42&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;download_url&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://github.com/yamadharma/vyos-build/releases/tag/v1.3.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-43">&lt;a class="lnlinks" href="#hl-1-43">43&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;direct_download_url&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://github.com/yamadharma/vyos-build/releases/download/v1.3.3/vyos-1.3.3-amd64.qcow2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-44">&lt;a class="lnlinks" href="#hl-1-44">44&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-45">&lt;a class="lnlinks" href="#hl-1-45">45&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-46">&lt;a class="lnlinks" href="#hl-1-46">46&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;filename&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;empty8G.qcow2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-47">&lt;a class="lnlinks" href="#hl-1-47">47&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;version&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;1.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-48">&lt;a class="lnlinks" href="#hl-1-48">48&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;md5sum&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;f1d2c25b6990f99bd05b433ab603bdb4&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-49">&lt;a class="lnlinks" href="#hl-1-49">49&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;filesize&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">197120&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-50">&lt;a class="lnlinks" href="#hl-1-50">50&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;download_url&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://sourceforge.net/projects/gns-3/files/Empty%20Qemu%20disk/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-51">&lt;a class="lnlinks" href="#hl-1-51">51&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;direct_download_url&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;https://sourceforge.net/projects/gns-3/files/Empty%20Qemu%20disk/empty8G.qcow2/download&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-52">&lt;a class="lnlinks" href="#hl-1-52">52&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-53">&lt;a class="lnlinks" href="#hl-1-53">53&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-54">&lt;a class="lnlinks" href="#hl-1-54">54&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;versions&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-55">&lt;a class="lnlinks" href="#hl-1-55">55&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-56">&lt;a class="lnlinks" href="#hl-1-56">56&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;1.3.3-iso&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-57">&lt;a class="lnlinks" href="#hl-1-57">57&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;images&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-58">&lt;a class="lnlinks" href="#hl-1-58">58&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;hda_disk_image&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;empty8G.qcow2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-59">&lt;a class="lnlinks" href="#hl-1-59">59&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;cdrom_image&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;vyos-1.3.3-amd64.iso&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-60">&lt;a class="lnlinks" href="#hl-1-60">60&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-61">&lt;a class="lnlinks" href="#hl-1-61">61&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-62">&lt;a class="lnlinks" href="#hl-1-62">62&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-63">&lt;a class="lnlinks" href="#hl-1-63">63&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;1.3.3-qemu&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-64">&lt;a class="lnlinks" href="#hl-1-64">64&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;images&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-65">&lt;a class="lnlinks" href="#hl-1-65">65&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="s2">&amp;#34;hda_disk_image&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;vyos-1.3.3-amd64.qcow2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-66">&lt;a class="lnlinks" href="#hl-1-66">66&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-67">&lt;a class="lnlinks" href="#hl-1-67">67&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-68">&lt;a class="lnlinks" href="#hl-1-68">68&lt;/a>&lt;/span>&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln" id="hl-1-69">&lt;a class="lnlinks" href="#hl-1-69">69&lt;/a>&lt;/span>&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="использование-в-gns3">&lt;span class="section-num">5&lt;/span> Использование в GNS3&lt;/h2>
&lt;h3 id="установка-образа-vyos-quemu-в-gns3">&lt;span class="section-num">5.1&lt;/span> Установка образа VyOS quemu в GNS3&lt;/h3>
&lt;ul>
&lt;li>Скачайте файл &lt;code>vyos-edu.gns3a&lt;/code> из репозитория: &lt;a href="https://github.com/yamadharma/vyos-build/releases" target="_blank" rel="noopener">https://github.com/yamadharma/vyos-build/releases&lt;/a>.&lt;/li>
&lt;li>Импортируйте &lt;code>vyos-edu.gns3a&lt;/code> в GNS3 через пункт меню &lt;em>File&amp;gt;Import appliance&lt;/em>.
&lt;ul>
&lt;li>Документация: &lt;a href="https://docs.gns3.com/docs/using-gns3/beginners/import-gns3-appliance" target="_blank" rel="noopener">https://docs.gns3.com/docs/using-gns3/beginners/import-gns3-appliance&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Установите необходимую версию VyOS.&lt;/li>
&lt;/ul>
&lt;h3 id="видео-установка-образа-vyos-quemu-в-gns3">&lt;span class="section-num">5.2&lt;/span> Видео: Установка образа VyOS quemu в GNS3&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-efcadb" data-toggle="tab" href="#efcadb"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-ebacdf" data-toggle="tab" href="#ebacdf"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="efcadb" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/951fc2e6bf2157c298e019136b83992b"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="ebacdf" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/6bBXVc6bmrs?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Сборка образа VyOS</title><link>https://yamadharma.github.io/ru/post/2023/07/06/vyos-build/</link><pubDate>Thu, 06 Jul 2023 16:38:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/07/06/vyos-build/</guid><description>&lt;p>Самостоятельная сборка образа VyOS.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сборка">&lt;span class="section-num">2&lt;/span> Сборка&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка-docker">&lt;span class="section-num">2.1&lt;/span> Установка docker&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">2.1.1&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#запуск">&lt;span class="section-num">2.1.2&lt;/span> Запуск&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурация">&lt;span class="section-num">2.1.3&lt;/span> Конфигурация&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#контейнер-со-сборочным-окружением">&lt;span class="section-num">2.2&lt;/span> Контейнер со сборочным окружением&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#загрузка-контейнера-из-dockerhub">&lt;span class="section-num">2.2.1&lt;/span> Загрузка контейнера из DockerHub&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#подготовка-среды-сборки">&lt;span class="section-num">2.3&lt;/span> Подготовка среды сборки&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сборка-iso">&lt;span class="section-num">2.4&lt;/span> Сборка ISO&lt;/a>&lt;/li>
&lt;li>&lt;a href="#образы-для-платформ-виртуализации">&lt;span class="section-num">2.5&lt;/span> Образы для платформ виртуализации&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурация-packer">&lt;span class="section-num">2.6&lt;/span> Конфигурация packer&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#qemu">&lt;span class="section-num">2.6.1&lt;/span> QEMU&lt;/a>&lt;/li>
&lt;li>&lt;a href="#vagrant">&lt;span class="section-num">2.6.2&lt;/span> Vagrant&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Из-за модели распространения VyOS становится оправданной самостоятельная сборка.
&lt;ul>
&lt;li>VyOS является проектом с открытым исходным кодом, но ISO-образы могут быть получены только по подписке или путем внесения вклада в сообщество.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Текущая стабильная версия: 1.3.4 (&lt;a href="https://blog.vyos.io/vyos-1.3.4-lts-release" target="_blank" rel="noopener">https://blog.vyos.io/vyos-1.3.4-lts-release&lt;/a>).&lt;/li>
&lt;li>Описание сборки VyOS: &lt;a href="https://docs.vyos.io/en/equuleus/contributing/build-vyos.html" target="_blank" rel="noopener">https://docs.vyos.io/en/equuleus/contributing/build-vyos.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="сборка">&lt;span class="section-num">2&lt;/span> Сборка&lt;/h2>
&lt;ul>
&lt;li>Разработчики рекомендуют использование для сборки окружения в docker.&lt;/li>
&lt;/ul>
&lt;h3 id="установка-docker">&lt;span class="section-num">2.1&lt;/span> Установка docker&lt;/h3>
&lt;h4 id="установка">&lt;span class="section-num">2.1.1&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Debian:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install -y apt-transport-https ca-certificates curl gnupg2 software-properties-common
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -fsSL https://download.docker.com/linux/debian/gpg &lt;span class="p">|&lt;/span> sudo apt-key add -
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo add-apt-repository &lt;span class="s2">&amp;#34;deb [arch=amd64] https://download.docker.com/linux/debian &lt;/span>&lt;span class="k">$(&lt;/span>lsb_release -cs&lt;span class="k">)&lt;/span>&lt;span class="s2"> stable&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install -y docker-ce
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Ubuntu:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get -y install &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> ca-certificates &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> curl &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> gnupg &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> lsb-release
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -fsSL https://download.docker.com/linux/ubuntu/gpg &lt;span class="p">|&lt;/span> sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="s2">&amp;#34;deb [arch=&lt;/span>&lt;span class="k">$(&lt;/span>dpkg --print-architecture&lt;span class="k">)&lt;/span>&lt;span class="s2"> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &lt;/span>&lt;span class="k">$(&lt;/span>lsb_release -cs&lt;span class="k">)&lt;/span>&lt;span class="s2"> stable&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> sudo tee /etc/apt/sources.list.d/docker.list &amp;gt; /dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install docker-ce docker-ce-cli containerd.io
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Fedora:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo dnf -y install dnf-plugins-core
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo dnf config-manager --add-repo https://download.docker.com/linux/fedora/docker-ce.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo dnf install -y docker-ce docker-ce-cli containerd.io
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>CentOS:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo yum install -y yum-utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install -y docker-ce docker-ce-cli containerd.io
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Gentoo:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge app-containers/docker app-containers/docker-cli
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="запуск">&lt;span class="section-num">2.1.2&lt;/span> Запуск&lt;/h4>
&lt;ul>
&lt;li>Запустите docker:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl start docker.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="конфигурация">&lt;span class="section-num">2.1.3&lt;/span> Конфигурация&lt;/h4>
&lt;ul>
&lt;li>Текущего пользователя без полномочий &lt;code>root&lt;/code> необходимо добавить в группу &lt;code>docker&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">usermod -aG docker yourusername
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="контейнер-со-сборочным-окружением">&lt;span class="section-num">2.2&lt;/span> Контейнер со сборочным окружением&lt;/h3>
&lt;ul>
&lt;li>Контейнер можно создать вручную или загрузить готовый из DockerHub (&lt;a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/&lt;/a>).&lt;/li>
&lt;/ul>
&lt;h4 id="загрузка-контейнера-из-dockerhub">&lt;span class="section-num">2.2.1&lt;/span> Загрузка контейнера из DockerHub&lt;/h4>
&lt;ul>
&lt;li>Чтобы загрузить контейнер из DockerHub, запустите:
&lt;ul>
&lt;li>VyOS 1.2
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker pull vyos/vyos-build:crux
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>VyOS 1.3
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker pull vyos/vyos-build:equuleus
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>VyOS 1.4
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker pull vyos/vyos-build:sagitta
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>VyOS 1.5 (rolling release)
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker pull vyos/vyos-build:current
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="подготовка-среды-сборки">&lt;span class="section-num">2.3&lt;/span> Подготовка среды сборки&lt;/h3>
&lt;ul>
&lt;li>Загрузите сборочный код:
&lt;ul>
&lt;li>VyOS 1.2
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git clone -b crux --single-branch https://github.com/vyos/vyos-build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>VyOS 1.3
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git clone -b equuleus --single-branch https://github.com/vyos/vyos-build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>VyOS 1.4
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git clone -b sagitta --single-branch https://github.com/vyos/vyos-build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>VyOS 1.5 (rolling release)
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git clone -b current --single-branch https://github.com/vyos/vyos-build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Перейдите в сборочный каталог:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> vyos-build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Подключите данный каталог к docker:
&lt;ul>
&lt;li>VyOS 1.2
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run --rm -it --privileged -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>:/vyos -w /vyos vyos/vyos-build:crux bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>VyOS 1.3
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run --rm -it --privileged -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>:/vyos -w /vyos vyos/vyos-build:equuleus bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>VyOS 1.4
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run --rm -it --privileged -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>:/vyos -w /vyos vyos/vyos-build:sagitta bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>VyOS 1.5 (rolling release)
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run --rm -it --privileged -v &lt;span class="k">$(&lt;/span>&lt;span class="nb">pwd&lt;/span>&lt;span class="k">)&lt;/span>:/vyos -w /vyos vyos/vyos-build:current bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Сконфигурируйте параметры сборки:
&lt;ul>
&lt;li>Скользящий релиз (rolling release)
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">./configure --architecture amd64 --build-by &lt;span class="s2">&amp;#34;your@email&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Конкретный релиз
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">./configure --architecture amd64 --build-by &lt;span class="s2">&amp;#34;your@email&amp;#34;&lt;/span> --build-type release --version 1.3.4
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="сборка-iso">&lt;span class="section-num">2.4&lt;/span> Сборка ISO&lt;/h3>
&lt;ul>
&lt;li>Запустите сборку:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo make iso
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="образы-для-платформ-виртуализации">&lt;span class="section-num">2.5&lt;/span> Образы для платформ виртуализации&lt;/h3>
&lt;h3 id="конфигурация-packer">&lt;span class="section-num">2.6&lt;/span> Конфигурация packer&lt;/h3>
&lt;ul>
&lt;li>В файле &lt;code>packer.json&lt;/code> заданы достаточно оптимистичные промежутки времени.&lt;/li>
&lt;li>При компиляции в виртуальной машине их не хватает.&lt;/li>
&lt;li>Увеличим их:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sed -ie &lt;span class="s2">&amp;#34;s:wait3m:wait10m:g&amp;#34;&lt;/span> scripts/packer.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="qemu">&lt;span class="section-num">2.6.1&lt;/span> QEMU&lt;/h4>
&lt;ul>
&lt;li>Запустите следующую команду после создания образа &lt;code>qcow2&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">make qemu
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="vagrant">&lt;span class="section-num">2.6.2&lt;/span> Vagrant&lt;/h4>
&lt;ul>
&lt;li>Запустите следующую команду после создания образа для vagrant:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">make vagrant-libvirt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для создания используется образ, созданный для Quemu.&lt;/li>
&lt;/ul></description></item><item><title>IPv6. Туннельные брокеры. Ip4market</title><link>https://yamadharma.github.io/ru/post/2023/06/30/ipv6-tunnel-broker-ip4market/</link><pubDate>Fri, 30 Jun 2023 12:55:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/06/30/ipv6-tunnel-broker-ip4market/</guid><description>&lt;p>Туннельный брокер Ip4market.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#особенности">&lt;span class="section-num">2&lt;/span> Особенности&lt;/a>&lt;/li>
&lt;li>&lt;a href="#адреса">&lt;span class="section-num">3&lt;/span> Адреса&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-ipv6-туннеля">&lt;span class="section-num">4&lt;/span> Настройка IPv6 туннеля&lt;/a>&lt;/li>
&lt;li>&lt;a href="#примеры-настройки">&lt;span class="section-num">5&lt;/span> Примеры настройки&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт:
&lt;ul>
&lt;li>&lt;a href="http://ipv6.ip4market.ru/" target="_blank" rel="noopener">http://ipv6.ip4market.ru/&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://tunnelbroker.ru/" target="_blank" rel="noopener">http://tunnelbroker.ru/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://tb.ip4market.ru/" target="_blank" rel="noopener">https://tb.ip4market.ru/&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Документация:
&lt;ul>
&lt;li>&lt;a href="https://ipv6.ip4market.ru/?page=help" target="_blank" rel="noopener">https://ipv6.ip4market.ru/?page=help&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Блог: &lt;a href="http://blog.ip4market.ru/" target="_blank" rel="noopener">http://blog.ip4market.ru/&lt;/a>&lt;/li>
&lt;li>Telegram-канал: &lt;a href="https://t.me/ip4market" target="_blank" rel="noopener">@ip4market&lt;/a>&lt;/li>
&lt;li>Точки присутствия (PoPs): 1&lt;/li>
&lt;li>Сервер расположен в России (г. Москва).&lt;/li>
&lt;li>Расположение: Россия&lt;/li>
&lt;li>Подсеть: &lt;code>/64&lt;/code> и &lt;code>/48&lt;/code>&lt;/li>
&lt;li>Prefix:
&lt;ul>
&lt;li>&lt;code>2a04:5200::/32&lt;/code>&lt;/li>
&lt;li>&lt;code>2a03:e2c0::/32&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="особенности">&lt;span class="section-num">2&lt;/span> Особенности&lt;/h2>
&lt;ul>
&lt;li>
&lt;ul>
&lt;li>Для борьбы со спамерами введено ограничение по регистрации.&lt;/li>
&lt;li>Регистрировать можно один раз с одного домена.&lt;/li>
&lt;li>То есть практически следует иметь свой домен для регистрации.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="адреса">&lt;span class="section-num">3&lt;/span> Адреса&lt;/h2>
&lt;ul>
&lt;li>При регистрации базово выделяется сеть &lt;code>/48&lt;/code> : &lt;code>2a03:e2c0:XXX::/48&lt;/code>.&lt;/li>
&lt;li>Из неё выделяется 2 сети &lt;code>/64&lt;/code> :
&lt;ul>
&lt;li>&lt;code>2a03:e2c0:XXX::/64&lt;/code>;&lt;/li>
&lt;li>&lt;code>2a03:e2c0:XXX:5555::/64&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Первая сеть назначается для туннеля 6in4:
&lt;ul>
&lt;li>адрес &lt;code>::1&lt;/code> : принадлежит брокеру;&lt;/li>
&lt;li>адрес &lt;code>::2&lt;/code> : выделяется для роутера пользователя.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-ipv6-туннеля">&lt;span class="section-num">4&lt;/span> Настройка IPv6 туннеля&lt;/h2>
&lt;ul>
&lt;li>Сеть для раздачи клиентам: &lt;code>2a03:e2c0:XXX:5555::/64&lt;/code>. Нужно указать её в роутере как полученный префикс IPv6.&lt;/li>
&lt;li>IPv6-адрес клиента: &lt;code>2a03:e2c0:XXXX::2/64&lt;/code>.&lt;/li>
&lt;li>IPv6-адрес шлюза: &lt;code>2a03:e2c0:XXXX::1/64&lt;/code>.&lt;/li>
&lt;li>Сервер для подключения: &lt;code>193.0.203.203&lt;/code>. На этот адрес роутер отправляет пакеты с IPv6 трафиком.&lt;/li>
&lt;li>Своего DNS нет, рекомендуется использовать общедоступные резолверы (см. &lt;a href="https://yamadharma.github.io/ru/post/2023/05/26/public-dns-resolvers/">Общедоступные резольверы DNS&lt;/a>).&lt;/li>
&lt;/ul>
&lt;h2 id="примеры-настройки">&lt;span class="section-num">5&lt;/span> Примеры настройки&lt;/h2>
&lt;ul>
&lt;li>Настройка для Cisco (внешний IPv4: &lt;code>Y.Y.Y.Y&lt;/code>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">configure terminal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ipv6 unicast-routing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ipv6 cef
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ipv6 dhcp pool LAN-v6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> address prefix 2a03:e2c0:XXXX:5555::1/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dns-server 2a02:6b8::feed:0ff
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> domain-name ipv6.orcinus.ru
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">interface Tunnel1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> description IP4Market IPv6 &lt;span class="o">(&lt;/span>RUSSIA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> no ip address
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ipv6 address 2a03:e2c0:XXXX::2/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ipv6 &lt;span class="nb">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tunnel &lt;span class="nb">source&lt;/span> Y.Y.Y.Y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tunnel mode ipv6ip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tunnel destination 193.0.203.203
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">interface FastEthernet0/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ipv6 address 2a03:e2c0:XXXX:5555::/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ipv6 &lt;span class="nb">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ipv6 nd managed-config-flag
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ipv6 dhcp server LAN-v6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ipv6 route ::/0 Tunnel1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Протокол IPv6</title><link>https://yamadharma.github.io/ru/post/2023/06/26/ipv6-protocol/</link><pubDate>Mon, 26 Jun 2023 19:36:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/06/26/ipv6-protocol/</guid><description>&lt;p>Протокол IPv6.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#подключение">&lt;span class="section-num">1&lt;/span> Подключение&lt;/a>&lt;/li>
&lt;li>&lt;a href="#проверка-работы">&lt;span class="section-num">2&lt;/span> Проверка работы&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="подключение">&lt;span class="section-num">1&lt;/span> Подключение&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/05/26/ipv6-tunneling-technologies/">Технологии туннелирования IPv6&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/05/30/ipv6-tunneling-6to4/">IPv6. Туннелирование. 6to4&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/06/26/ipv6-tunnelbrokers/">Брокеры IPv6&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="проверка-работы">&lt;span class="section-num">2&lt;/span> Проверка работы&lt;/h2>
&lt;ul>
&lt;li>Проверить информацию по адресу IPv6 можно на сайтах:
&lt;ul>
&lt;li>&lt;a href="https://ipv6test.google.com/" target="_blank" rel="noopener">https://ipv6test.google.com/&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://ipv6-test.com/" target="_blank" rel="noopener">http://ipv6-test.com/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://test-ipv6.com/" target="_blank" rel="noopener">https://test-ipv6.com/&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Брокеры IPv6</title><link>https://yamadharma.github.io/ru/post/2023/06/26/ipv6-tunnelbrokers/</link><pubDate>Mon, 26 Jun 2023 12:57:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/06/26/ipv6-tunnelbrokers/</guid><description>&lt;p>Брокеры IPv6.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#брокеры-6in4">&lt;span class="section-num">1&lt;/span> Брокеры 6in4&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#hurricane-electric">&lt;span class="section-num">1.1&lt;/span> Hurricane Electric&lt;/a>&lt;/li>
&lt;li>&lt;a href="#ip4market">&lt;span class="section-num">1.2&lt;/span> IP4market&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="брокеры-6in4">&lt;span class="section-num">1&lt;/span> Брокеры 6in4&lt;/h2>
&lt;h3 id="hurricane-electric">&lt;span class="section-num">1.1&lt;/span> Hurricane Electric&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="http://he.net/" target="_blank" rel="noopener">http://he.net/&lt;/a>&lt;/li>
&lt;li>Точки присутствия (PoPs): 32&lt;/li>
&lt;li>Расположение: Канада, Европа (8 стран), Гонконг, Япония, Сингапур, США (9 штатов)&lt;/li>
&lt;li>Подсеть:
&lt;ul>
&lt;li>/64 по умолчанию;&lt;/li>
&lt;li>/48 через автономную систему&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Prefix: &lt;code>2001:470::/32&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="ip4market">&lt;span class="section-num">1.2&lt;/span> IP4market&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/06/30/ipv6-tunnel-broker-ip4market/">IPv6. Туннельные брокеры. Ip4market&lt;/a>&lt;/li>
&lt;li>Сайт: &lt;a href="http://ipv6.ip4market.ru/" target="_blank" rel="noopener">http://ipv6.ip4market.ru/&lt;/a>&lt;/li>
&lt;li>Точки присутствия (PoPs): 1&lt;/li>
&lt;li>Расположение: Россия&lt;/li>
&lt;li>Подсеть: &lt;code>/64&lt;/code> и &lt;code>/48&lt;/code>&lt;/li>
&lt;li>Prefix:
&lt;ul>
&lt;li>&lt;code>2a04:5200::/32&lt;/code>&lt;/li>
&lt;li>&lt;code>2a03:e2c0::/32&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Мониторинг пропускной способности и скорости сети</title><link>https://yamadharma.github.io/ru/post/2023/06/16/bandwidth-network-speed-monitoring/</link><pubDate>Fri, 16 Jun 2023 11:34:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/06/16/bandwidth-network-speed-monitoring/</guid><description>&lt;p>Утилиты мониторинга пропускной способности и скорости сети.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#утилиты-мониторинга">&lt;span class="section-num">1&lt;/span> Утилиты мониторинга&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#speedtest-cli">&lt;span class="section-num">1.1&lt;/span> speedtest-cli&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1.1.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">1.1.2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#использование">&lt;span class="section-num">1.1.3&lt;/span> Использование&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#nethogs">&lt;span class="section-num">1.2&lt;/span> NetHogs&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1.2.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">1.2.2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#использование">&lt;span class="section-num">1.2.3&lt;/span> Использование&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#nload">&lt;span class="section-num">1.3&lt;/span> nload&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1.3.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">1.3.2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#использование">&lt;span class="section-num">1.3.3&lt;/span> Использование&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#vnstat">&lt;span class="section-num">1.4&lt;/span> vnStat&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1.4.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">1.4.2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#использование">&lt;span class="section-num">1.4.3&lt;/span> Использование&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#iftop">&lt;span class="section-num">1.5&lt;/span> iftop&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1.5.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">1.5.2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#использование">&lt;span class="section-num">1.5.3&lt;/span> Использование&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#генераторы-трафика">&lt;span class="section-num">2&lt;/span> Генераторы трафика&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#iperf">&lt;span class="section-num">2.1&lt;/span> iPerf&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">2.1.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">2.1.2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#использование">&lt;span class="section-num">2.1.3&lt;/span> Использование&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="утилиты-мониторинга">&lt;span class="section-num">1&lt;/span> Утилиты мониторинга&lt;/h2>
&lt;h3 id="speedtest-cli">&lt;span class="section-num">1.1&lt;/span> speedtest-cli&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">1.1.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Тестирование пропускной способности интернета с помощью сервиса &lt;a href="https://www.speedtest.net/" target="_blank" rel="noopener">https://www.speedtest.net/&lt;/a>.&lt;/li>
&lt;li>Репозитоий: &lt;a href="https://github.com/sivel/speedtest-cli" target="_blank" rel="noopener">https://github.com/sivel/speedtest-cli&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h4 id="установка">&lt;span class="section-num">1.1.2&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Gentoo:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge net-analyzer/speedtest-cli
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="использование">&lt;span class="section-num">1.1.3&lt;/span> Использование&lt;/h4>
&lt;ul>
&lt;li>Простейшее использование:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">speedtest-cli
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="nethogs">&lt;span class="section-num">1.2&lt;/span> NetHogs&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">1.2.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/raboof/nethogs" target="_blank" rel="noopener">https://github.com/raboof/nethogs&lt;/a>.&lt;/li>
&lt;li>Группирует пропускную способность по процессам.&lt;/li>
&lt;li>Берёт информацию из &lt;code>/proc&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h4 id="установка">&lt;span class="section-num">1.2.2&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Gentoo:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge net-analyzer/nethogs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="использование">&lt;span class="section-num">1.2.3&lt;/span> Использование&lt;/h4>
&lt;ul>
&lt;li>Простейшее использование:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nethogs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Можно указать устройства после команды:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nethogs eth0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Дополнительные опции:
&lt;ul>
&lt;li>выбор задержки для частоты обновления (&lt;code>-d&lt;/code>);&lt;/li>
&lt;li>режим трассировки (&lt;code>-t&lt;/code>).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="nload">&lt;span class="section-num">1.3&lt;/span> nload&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">1.3.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Сайт: &lt;a href="http://www.roland-riegel.de/nload/index.html" target="_blank" rel="noopener">http://www.roland-riegel.de/nload/index.html&lt;/a>&lt;/li>
&lt;li>Отслеживает сетевой трафик и использование полосы пропускания в режиме реального времени.&lt;/li>
&lt;li>Визуализирует входящий и исходящий трафик с помощью консольных графиков.&lt;/li>
&lt;/ul>
&lt;h4 id="установка">&lt;span class="section-num">1.3.2&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Gentoo:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge net-analyzer/nload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="использование">&lt;span class="section-num">1.3.3&lt;/span> Использование&lt;/h4>
&lt;ul>
&lt;li>Простейшее использование:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="vnstat">&lt;span class="section-num">1.4&lt;/span> vnStat&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">1.4.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://humdi.net/vnstat/" target="_blank" rel="noopener">https://humdi.net/vnstat/&lt;/a>&lt;/li>
&lt;li>Консольный монитор сетевого трафика.&lt;/li>
&lt;li>Использует в качестве источника информации статистику сетевого интерфейса, предоставляемую ядром (не перехватывает трафик).&lt;/li>
&lt;li>Может быть запущена без прав &lt;code>root&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h4 id="установка">&lt;span class="section-num">1.4.2&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Gentoo:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge net-analyzer/vnstat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="использование">&lt;span class="section-num">1.4.3&lt;/span> Использование&lt;/h4>
&lt;ul>
&lt;li>Простейшее использование:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vnstat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="iftop">&lt;span class="section-num">1.5&lt;/span> iftop&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">1.5.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Сайт: &lt;a href="http://www.ex-parrot.com/pdw/iftop/" target="_blank" rel="noopener">http://www.ex-parrot.com/pdw/iftop/&lt;/a>&lt;/li>
&lt;li>Репозитоий: &lt;a href="https://code.blinkace.com/pdw/iftop" target="_blank" rel="noopener">https://code.blinkace.com/pdw/iftop&lt;/a>&lt;/li>
&lt;li>Выдаёт постоянно обновляемый список сетевых соединений между парами хостов.&lt;/li>
&lt;li>По умолчанию соединения упорядочены по использованию полосы пропускания.&lt;/li>
&lt;/ul>
&lt;h4 id="установка">&lt;span class="section-num">1.5.2&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Gentoo:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge net-analyzer/iftop
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="использование">&lt;span class="section-num">1.5.3&lt;/span> Использование&lt;/h4>
&lt;ul>
&lt;li>Простейшее использование:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iftop
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="генераторы-трафика">&lt;span class="section-num">2&lt;/span> Генераторы трафика&lt;/h2>
&lt;h3 id="iperf">&lt;span class="section-num">2.1&lt;/span> iPerf&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">2.1.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/esnet/iperf" target="_blank" rel="noopener">https://github.com/esnet/iperf&lt;/a>&lt;/li>
&lt;li>Используется для измерения и настройки производительности сети.&lt;/li>
&lt;li>Состоит из клиента и сервера.&lt;/li>
&lt;li>Может создавать потоки данных для измерения пропускной способности.&lt;/li>
&lt;li>Две реализации:
&lt;ul>
&lt;li>&lt;code>iPerf2&lt;/code> (оригинальный iPerf)
&lt;ul>
&lt;li>Сайт: &lt;a href="https://sourceforge.net/projects/iperf2/" target="_blank" rel="noopener">https://sourceforge.net/projects/iperf2/&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>iPerf3&lt;/code>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/esnet/iperf" target="_blank" rel="noopener">https://github.com/esnet/iperf&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Эти реализации несовместимы (&lt;a href="https://iperf2.sourceforge.io/IperfCompare.html" target="_blank" rel="noopener">https://iperf2.sourceforge.io/IperfCompare.html&lt;/a>).&lt;/li>
&lt;/ul>
&lt;h4 id="установка">&lt;span class="section-num">2.1.2&lt;/span> Установка&lt;/h4>
&lt;ul>
&lt;li>Gentoo:
&lt;ul>
&lt;li>&lt;code>iPerf2&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge net-misc/iperf:2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>&lt;code>iPerf3&lt;/code>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge net-misc/iperf:3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="использование">&lt;span class="section-num">2.1.3&lt;/span> Использование&lt;/h4>
&lt;ul>
&lt;li>Простейшее использование:
&lt;ul>
&lt;li>Запустите сервер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите клиента:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iperf3 -c &amp;lt;server_address&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>IPv6. Туннелирование. 6to4</title><link>https://yamadharma.github.io/ru/post/2023/05/30/ipv6-tunneling-6to4/</link><pubDate>Tue, 30 May 2023 11:58:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/05/30/ipv6-tunneling-6to4/</guid><description>&lt;p>Технология туннелирования 6to4.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#как-работает-6to4">&lt;span class="section-num">2&lt;/span> Как работает 6to4&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#выделение-блока-адресов">&lt;span class="section-num">2.1&lt;/span> Выделение блока адресов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#инкапсуляция">&lt;span class="section-num">2.2&lt;/span> Инкапсуляция&lt;/a>&lt;/li>
&lt;li>&lt;a href="#маршрутизация-между-6to4-и-другими-ipv6-сетями">&lt;span class="section-num">2.3&lt;/span> Маршрутизация между 6to4 и другими IPv6 сетями&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#настройка">&lt;span class="section-num">3&lt;/span> Настройка&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#вычисление-префикса-6to4">&lt;span class="section-num">3.1&lt;/span> Вычисление префикса 6to4&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-командой-ip">&lt;span class="section-num">3.2&lt;/span> Настройка командой &lt;code>ip&lt;/code>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#скрипт">&lt;span class="section-num">3.3&lt;/span> Скрипт&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#раздача-6to4-ipv6-в-локальную-сеть">&lt;span class="section-num">4&lt;/span> Раздача 6to4 IPv6 в локальную сеть&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#назначение-адреса-внутреннему-интерфейсу">&lt;span class="section-num">4.1&lt;/span> Назначение адреса внутреннему интерфейсу&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-radvd">&lt;span class="section-num">4.2&lt;/span> Настройка radvd&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>&lt;em>Автоматическое туннелирование посредством механизма 6to4 было признано устаревшим (deprecated) и не рекомендованным к использованию.&lt;/em>&lt;/li>
&lt;li>Публичному адресу IPv4 сопоставляется IPv6-подсеть с префиксом 48.&lt;/li>
&lt;li>Фиксированный anycast IPv4 адресом: &lt;code>192.88.99.1&lt;/code>.&lt;/li>
&lt;li>Протокол полностью автоконфигурируемый, ручная настройка невозможна.&lt;/li>
&lt;li>Использует префикс &lt;code>2002::/16&lt;/code>.&lt;/li>
&lt;li>Не работает через NAT.&lt;/li>
&lt;li>Связь между двумя пользователями 6to4 осуществляется не через туннельный сервер, а напрямую, с нулевой дополнительной задержкой.&lt;/li>
&lt;li>Не требуется регистрации.&lt;/li>
&lt;li>Оптимальный (самый близкий) шлюз выбирается автоматически.&lt;/li>
&lt;li>Даёт IPv6-подсеть с префиксом 48.&lt;/li>
&lt;li>Ближайший шлюз, через который пакеты будут направляться другим пользователям IPv6, выбирается полностью автоматически.&lt;/li>
&lt;li>Если сайт использует статический глобальный IPv4-адрес, то возможно делегировать обратную DNS зону для 48-битного блока адресов полученного через 6to4.
&lt;ul>
&lt;li>Регистрация обратной DNS-зоны производится Number Resource Organization в зоне 2.0.0.2.ip6.arpa на сайте 6to4.nro.net. Процесс полностью автоматизирован.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="как-работает-6to4">&lt;span class="section-num">2&lt;/span> Как работает 6to4&lt;/h2>
&lt;ul>
&lt;li>Основные функции 6to4:
&lt;ul>
&lt;li>Выделение блока /48 адресного пространства IPv6 каждому узлу, у которого есть глобальный IPv4-адрес.&lt;/li>
&lt;li>Инкапсуляция IPv6-пакеты в IPv4-пакеты для передачи по сети IPv4.&lt;/li>
&lt;li>Передача пакеты между 6to4-узлами и узлами с прямым подключением к IPv6-Интернету.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="выделение-блока-адресов">&lt;span class="section-num">2.1&lt;/span> Выделение блока адресов&lt;/h3>
&lt;ul>
&lt;li>Для каждого глобального адреса IPv4 выделена 48-битный префикс IPv6-адреса.&lt;/li>
&lt;li>Он может быть создана на основе IPv4-адреса.&lt;/li>
&lt;li>При этом адрес IPv4 ставится после префикса &lt;code>2002::/16&lt;/code> в шестнадцатеричном виде.
&lt;ul>
&lt;li>Например, IPv6-префикс для IPv4-адреса 192.0.2.4 равен 2002:C000:0204::/48.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="инкапсуляция">&lt;span class="section-num">2.2&lt;/span> Инкапсуляция&lt;/h3>
&lt;ul>
&lt;li>6to4-узел вкладывает пакет IPv6 в пакет IPv4.&lt;/li>
&lt;li>Тип протокола 41 («IPv6 (encapsulation)»).&lt;/li>
&lt;li>Перед тем, как отправить 6to4-пакет, узел проверяет адрес назначения на принадлежность к 6to4-сети и, если этот адрес соответствует 6to4, то он извлекает IPv4-адрес из 6to4-адреса и отправляет пакет по полученному адресу.&lt;/li>
&lt;/ul>
&lt;h3 id="маршрутизация-между-6to4-и-другими-ipv6-сетями">&lt;span class="section-num">2.3&lt;/span> Маршрутизация между 6to4 и другими IPv6 сетями&lt;/h3>
&lt;ul>
&lt;li>Для отправлки пакета в другие IPv6-сети используются 6to4-ретрансляторы, которые подключены как к IPv4-сети, так и к IPv6-сети.&lt;/li>
&lt;li>Когда 6to4-узлу нужно отправить IPv6-пакет, он отправляет его по anycast адресу 192.88.99.1.&lt;/li>
&lt;li>Ретранслятор, получив 6to4-пакет, извлекает IPv6-пакет и отправляет его по IPv6-сети.&lt;/li>
&lt;li>Для IPv6-узлов 6to4-узлы выглядят как обычные IPv6-узлы и IPv6-пакет будет передан на ближайший 6to4-ретранслятор, анонсирующий префикс сети 2002::/16.&lt;/li>
&lt;/ul>
&lt;h2 id="настройка">&lt;span class="section-num">3&lt;/span> Настройка&lt;/h2>
&lt;h3 id="вычисление-префикса-6to4">&lt;span class="section-num">3.1&lt;/span> Вычисление префикса 6to4&lt;/h3>
&lt;ul>
&lt;li>Пусть адрес IPv4: &lt;code>1.2.3.4&lt;/code>.&lt;/li>
&lt;li>Сгенерированный префикс 6to4: &lt;code>2002:0102:0304::&lt;/code>.&lt;/li>
&lt;li>Локальным шлюзам 6to4 следует (но не обязательно) назначать суффикс &lt;code>::1&lt;/code>, поэтому ваш локальный адрес 6to4 будет: &lt;code>2002:0102:0304::1&lt;/code>.&lt;/li>
&lt;li>Для автоматической генерации можно использовать скрипт:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ipv4&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;1.2.3.4&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">printf&lt;/span> &lt;span class="s2">&amp;#34;2002:%02x%02x:%02x%02x::1&amp;#34;&lt;/span> &lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$ipv4&lt;/span> &lt;span class="p">|&lt;/span> tr &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-командой-ip">&lt;span class="section-num">3.2&lt;/span> Настройка командой &lt;code>ip&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>Создайте новое туннельное устройство:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/sbin/ip tunnel add tun6to4 mode sit ttl &amp;lt;ttldefault&amp;gt; remote any &lt;span class="nb">local&lt;/span> &amp;lt;localipv4address&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Необходимо указать TTL, поскольку значение по умолчанию равно 0.&lt;/li>
&lt;li>Поднимите интерфейс:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/sbin/ip link &lt;span class="nb">set&lt;/span> dev tun6to4 up
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавьте в интерфейс локальный адрес 6to4 (префикс обязательно равен 16):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/sbin/ip -6 addr add &amp;lt;local6to4address&amp;gt;/16 dev tun6to4
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавить маршрут по умолчанию в глобальную сеть IPv6, используя заданный адрес IPv4:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/sbin/ip -6 route add default via ::192.88.99.1 dev tun6to4 metric &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Некоторые версии команды &lt;code>ip&lt;/code> не поддерживают совместимые с IPv4 IPv6-адреса для шлюзов, в этом случае необходимо использовать соответствующий IPv6-адрес:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/sbin/ip -6 route add default via 2002:c058:6301::1 dev tun6to4 metric &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="скрипт">&lt;span class="section-num">3.3&lt;/span> Скрипт&lt;/h3>
&lt;ul>
&lt;li>Соберём в один скрипт &lt;code>6to4&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">IF&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">STATE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> -z &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$IF&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$0&lt;/span>&lt;span class="s2">: called with no interface&amp;#34;&lt;/span> 1&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$STATE&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;up&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">IPV4&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>/sbin/ip -4 addr show dev &lt;span class="nv">$IF&lt;/span>&lt;span class="p">|&lt;/span>grep &lt;span class="s2">&amp;#34;^ *inet&amp;#34;&lt;/span>&lt;span class="p">|&lt;/span>sed -r -e &lt;span class="s1">&amp;#39;s:.*inet ([0-9\.]+)/.*:\1:&amp;#39;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">IPV4STRIP&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$IPV4&lt;/span> &lt;span class="p">|&lt;/span> tr &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">IPV6&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">printf&lt;/span> &lt;span class="s2">&amp;#34;2002:%02x%02x:%02x%02x::1&amp;#34;&lt;/span> &lt;span class="nv">$IPV4STRIP&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$IPV4&lt;/span> &amp;gt;&amp;gt; /tmp/IPV6DEBUG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$IPV4STRIP&lt;/span> &amp;gt;&amp;gt; /tmp/IPV6DEBUG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$IPV6&lt;/span> &amp;gt;&amp;gt; /tmp/IPV6DEBUG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /sbin/ip tunnel add tun6to4 mode sit ttl &lt;span class="m">64&lt;/span> remote any &lt;span class="nb">local&lt;/span> &lt;span class="nv">$IPV4&lt;/span> 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &amp;gt;&amp;gt; /tmp/IPV6DEBUG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /sbin/ip link &lt;span class="nb">set&lt;/span> dev tun6to4 up 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &amp;gt;&amp;gt; /tmp/IPV6DEBUG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /sbin/ip -6 addr add &lt;span class="nv">$IPV6&lt;/span>/16 dev tun6to4 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &amp;gt;&amp;gt; /tmp/IPV6DEBUG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /sbin/ip -6 route add 2000::/3 via ::192.88.99.1 dev tun6to4 metric &lt;span class="m">1&lt;/span> 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &amp;gt;&amp;gt; /tmp/IPV6DEBUG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /sbin/ip -6 route del 2000::/3 via ::192.88.99.1 dev tun6to4 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &amp;gt;&amp;gt; /tmp/IPV6DEBUG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /sbin/ip link &lt;span class="nb">set&lt;/span> dev tun6to4 down 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &amp;gt;&amp;gt; /tmp/IPV6DEBUG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /sbin/ip tunnel del tun6to4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запуск:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">./6to4 eth0 up
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Останов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">./6to4 eth0 down
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для автоматического запуска добавьте скрипт в каталог &lt;code>/etc/NetworkManager/dispatcher.d&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h2 id="раздача-6to4-ipv6-в-локальную-сеть">&lt;span class="section-num">4&lt;/span> Раздача 6to4 IPv6 в локальную сеть&lt;/h2>
&lt;ul>
&lt;li>Пусть ваша сеть: &lt;code>2002:aabb:ccdd::/48&lt;/code>.&lt;/li>
&lt;li>Для подсети выделим &lt;code>2002:aabb:ccdd:e::/64&lt;/code>.&lt;/li>
&lt;li>Локальный интерфейс &amp;mdash; &lt;code>eth0&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="назначение-адреса-внутреннему-интерфейсу">&lt;span class="section-num">4.1&lt;/span> Назначение адреса внутреннему интерфейсу&lt;/h3>
&lt;ul>
&lt;li>Для роутеров часто используется адрес с &lt;code>::1&lt;/code> :&lt;/li>
&lt;/ul>
&lt;!--listend-->
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip addr add 2002:aabb:ccdd:e::1/64 dev eth0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="настройка-radvd">&lt;span class="section-num">4.2&lt;/span> Настройка radvd&lt;/h3>
&lt;ul>
&lt;li>Изменяем файл &lt;code>/etc/radvd.conf&lt;/code>:&lt;/li>
&lt;/ul>
&lt;!--listend-->
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">interface eth0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> AdvSendAdvert on;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> prefix 2002:aabb:ccdd:e::/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> AdvOnLink on;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> AdvAutonomous on;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Включаем маршрутизацию IPv6.&lt;/li>
&lt;li>Для этого, нужно добавить в &lt;code>/etc/sysctl.conf&lt;/code> следующие строки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">net.ipv6.conf.all.forwarding=1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.ipv6.conf.default.forwarding=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Загрузим эти значения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sysctl -p
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите &lt;code>radvd&lt;/code>:&lt;/li>
&lt;/ul>
&lt;!--listend-->
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now radvd.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Технологии туннелирования IPv6</title><link>https://yamadharma.github.io/ru/post/2023/05/26/ipv6-tunneling-technologies/</link><pubDate>Fri, 26 May 2023 19:17:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/05/26/ipv6-tunneling-technologies/</guid><description>&lt;p>Технологии туннелирования IPv6.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#сводная-таблица">&lt;span class="section-num">1&lt;/span> Сводная таблица&lt;/a>&lt;/li>
&lt;li>&lt;a href="#6in4">&lt;span class="section-num">2&lt;/span> 6in4&lt;/a>&lt;/li>
&lt;li>&lt;a href="#6over4">&lt;span class="section-num">3&lt;/span> 6over4&lt;/a>&lt;/li>
&lt;li>&lt;a href="#6to4">&lt;span class="section-num">4&lt;/span> 6to4&lt;/a>&lt;/li>
&lt;li>&lt;a href="#6rd">&lt;span class="section-num">5&lt;/span> 6rd&lt;/a>&lt;/li>
&lt;li>&lt;a href="#ayiya">&lt;span class="section-num">6&lt;/span> AYIYA&lt;/a>&lt;/li>
&lt;li>&lt;a href="#isatap">&lt;span class="section-num">7&lt;/span> ISATAP&lt;/a>&lt;/li>
&lt;li>&lt;a href="#teredo">&lt;span class="section-num">8&lt;/span> Teredo&lt;/a>&lt;/li>
&lt;li>&lt;a href="#6a44">&lt;span class="section-num">9&lt;/span> 6a44&lt;/a>&lt;/li>
&lt;li>&lt;a href="#6bed4">&lt;span class="section-num">10&lt;/span> 6bed4&lt;/a>&lt;/li>
&lt;li>&lt;a href="#lisp">&lt;span class="section-num">11&lt;/span> LISP&lt;/a>&lt;/li>
&lt;li>&lt;a href="#seal">&lt;span class="section-num">12&lt;/span> SEAL&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="сводная-таблица">&lt;span class="section-num">1&lt;/span> Сводная таблица&lt;/h2>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 1:&lt;/span>
Сводная таблица по протоколам туннелирования
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Протокол&lt;/th>
&lt;th>Туннелей на IPv4-адрес&lt;/th>
&lt;th>IPv6-хостов на туннель&lt;/th>
&lt;th>Публичный IPv4&lt;/th>
&lt;th>NAT-совместимость&lt;/th>
&lt;th>P2P&lt;/th>
&lt;th>Gateway принадлежит&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>6to4&lt;/td>
&lt;td>Один&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Требуется&lt;/td>
&lt;td>Нет&lt;/td>
&lt;td>Глобальный&lt;/td>
&lt;td>ISP или публичный&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>LISP&lt;/td>
&lt;td>Один&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Требуется&lt;/td>
&lt;td>Нет&lt;/td>
&lt;td>Настраивается&lt;/td>
&lt;td>ISP или Tunnel Broker&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>6rd&lt;/td>
&lt;td>Один&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Не требуется&lt;/td>
&lt;td>Нет&lt;/td>
&lt;td>Внутри домена&lt;/td>
&lt;td>ISP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>6in4&lt;/td>
&lt;td>Один&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Не требуется&lt;/td>
&lt;td>Ограниченная&lt;/td>
&lt;td>Нет&lt;/td>
&lt;td>ISP или Tunnel Broker&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Teredo&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Один&lt;/td>
&lt;td>Не требуется&lt;/td>
&lt;td>Да, с ограничениями&lt;/td>
&lt;td>Глобальный&lt;/td>
&lt;td>Публичный релей&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>6bed4&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Не требуется&lt;/td>
&lt;td>Да&lt;/td>
&lt;td>Глобальный&lt;/td>
&lt;td>ISP, Tunnel Broker или публичный релей&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>6a44&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Не требуется&lt;/td>
&lt;td>Да&lt;/td>
&lt;td>Внутри домена&lt;/td>
&lt;td>ISP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>AYIYA&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Не требуется&lt;/td>
&lt;td>Да&lt;/td>
&lt;td>Нет&lt;/td>
&lt;td>ISP или Tunnel Broker&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SEAL&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Много&lt;/td>
&lt;td>Не требуется&lt;/td>
&lt;td>Да&lt;/td>
&lt;td>Настраивается&lt;/td>
&lt;td>ISP или Tunnel Broker&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="6in4">&lt;span class="section-num">2&lt;/span> 6in4&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/06/26/ipv6-tunnelbrokers/">Брокеры IPv6&lt;/a>&lt;/li>
&lt;li>Разработан в 1996 году.&lt;/li>
&lt;li>Крупные туннельные брокеры: Hurricane Electric.&lt;/li>
&lt;li>Номер протокол: 41.&lt;/li>
&lt;li>Требует белый IP-адрес.&lt;/li>
&lt;li>Не работает через NAT.&lt;/li>
&lt;li>Не подразумевает каких-либо фиксированных адресов и префиксов.&lt;/li>
&lt;/ul>
&lt;h2 id="6over4">&lt;span class="section-num">3&lt;/span> 6over4&lt;/h2>
&lt;ul>
&lt;li>6over4 использует IPv4 как виртуальный ethernet для IPv6.&lt;/li>
&lt;li>Например, multicast-адрес &lt;code>ff02::1&lt;/code> превращается в IPv4 multicast-адрес &lt;code>239.192.0.1&lt;/code>.&lt;/li>
&lt;li>Протокол поддерживает генерацию Link-Local адреса, Neighbor Discovery и конфигурируется автоматически.&lt;/li>
&lt;li>Все маршрутизаторы в сети должны поддерживать Multicast.&lt;/li>
&lt;/ul>
&lt;h2 id="6to4">&lt;span class="section-num">4&lt;/span> 6to4&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/05/30/ipv6-tunneling-6to4/">IPv6. Туннелирование. 6to4&lt;/a>&lt;/li>
&lt;li>Признан устаревшим (deprecated) и не рекомендованным к использованию.&lt;/li>
&lt;li>Вариант 6in4 с правилами использования.&lt;/li>
&lt;li>Публичному адресу IPv4 сопоставляется IPv6-подсеть с префиксом 48.&lt;/li>
&lt;li>Фиксированный anycast IPv4 адресом: &lt;code>192.88.99.1&lt;/code>.&lt;/li>
&lt;li>Протокол полностью автоконфигурируемый, ручная настройка невозможна.&lt;/li>
&lt;li>Использует префикс &lt;code>2002::/16&lt;/code>.&lt;/li>
&lt;li>Не работает через NAT.&lt;/li>
&lt;li>Связь между двумя пользователями 6to4 осуществляется не через туннельный сервер, а напрямую, с нулевой дополнительной задержкой.&lt;/li>
&lt;li>Не требуется регистрации.&lt;/li>
&lt;li>Оптимальный (самый близкий) шлюз выбирается автоматически.&lt;/li>
&lt;li>Даёт IPv6-подсеть с префиксом 48.&lt;/li>
&lt;/ul>
&lt;h2 id="6rd">&lt;span class="section-num">5&lt;/span> 6rd&lt;/h2>
&lt;ul>
&lt;li>Основан на 6to4.&lt;/li>
&lt;li>Предназначен для развертывания внутри большой организации или ISP.&lt;/li>
&lt;li>Использует обычный (провайдерский) диапазон адресов вместо префикса &lt;code>2002::/16&lt;/code>.&lt;/li>
&lt;li>Может автоматически настраиваться через DHCPv4 специальным параметром.&lt;/li>
&lt;/ul>
&lt;h2 id="ayiya">&lt;span class="section-num">6&lt;/span> AYIYA&lt;/h2>
&lt;ul>
&lt;li>AYIYA &amp;mdash; Anything In Anything.&lt;/li>
&lt;li>Разработан туннель-брокером SIXXS.&lt;/li>
&lt;li>В основном используется как IPv4-UDP-AYIYA-IPv6.&lt;/li>
&lt;li>Работает через NAT.&lt;/li>
&lt;/ul>
&lt;h2 id="isatap">&lt;span class="section-num">7&lt;/span> ISATAP&lt;/h2>
&lt;ul>
&lt;li>Похож на 6over4, но не использует (и не поддерживает) Multicast.&lt;/li>
&lt;li>IPv6-адреса генерируются на основе IPv4-адреса.&lt;/li>
&lt;li>Предполагается, что IPv4-адрес будет уникальным,&lt;/li>
&lt;li>Не работает с NAT.&lt;/li>
&lt;/ul>
&lt;h2 id="teredo">&lt;span class="section-num">8&lt;/span> Teredo&lt;/h2>
&lt;ul>
&lt;li>Не требует настроек.&lt;/li>
&lt;li>В Windows настроен и включён по умолчанию.&lt;/li>
&lt;li>В Linux работает на основе Miredo.&lt;/li>
&lt;li>Необходимо указать Teredo-сервер.&lt;/li>
&lt;li>Работает через NAT (не всегда).&lt;/li>
&lt;li>Не требуется регистрация.&lt;/li>
&lt;li>Связь между двумя пользователями Teredo осуществляется не через туннельный сервер, а напрямую, с нулевой дополнительной задержкой.&lt;/li>
&lt;li>Даётся всего один адрес IPv6, невозможно получить несколько Teredo-адресов и раздать их в локальную сеть.&lt;/li>
&lt;li>Маршрутизация между Teredo и нативным IPv6 (а также другими видами туннелей) происходит через шлюзы.&lt;/li>
&lt;li>Teredo-адреса генерируются из IPv4-адресов и использованного при подключении UDP-порта, поэтому всегда являются динамическими.&lt;/li>
&lt;/ul>
&lt;h2 id="6a44">&lt;span class="section-num">9&lt;/span> 6a44&lt;/h2>
&lt;ul>
&lt;li>Сделан под влиянием Teredo, но предназначен для развертывания средствами ISP.&lt;/li>
&lt;li>Клиентам выдаётся IPv6-префикс провайдера.&lt;/li>
&lt;/ul>
&lt;h2 id="6bed4">&lt;span class="section-num">10&lt;/span> 6bed4&lt;/h2>
&lt;ul>
&lt;li>Peer-to-Peer IPv6 on Any Internetwork.&lt;/li>
&lt;li>Предназначен для создания p2p IPv6-сети внутри IPv4-сети, не запрещающей p2p-соединения между хостами.&lt;/li>
&lt;li>Является гибридом 6to4 и Teredo: IPv6-адрес формируется из IPv4 и UDP-порта, если p2p-соединение невозможно, используется релей, который может быть запущен ISP или просто сторонней организацией.&lt;/li>
&lt;li>Работает через NAT.&lt;/li>
&lt;li>Поддерживает как автоконфигурирование, так и ручную настройку.&lt;/li>
&lt;/ul>
&lt;h2 id="lisp">&lt;span class="section-num">11&lt;/span> LISP&lt;/h2>
&lt;ul>
&lt;li>LISP &amp;mdash; Locator/ID Separation Protocol.&lt;/li>
&lt;li>Основная цель &amp;mdash; убрать зависимость IPv6-адреса от местоположения клиента.&lt;/li>
&lt;li>Например, можно использовать свой (предположим, домашний) IPv6-адрес вне вашей сети, без проксирования трафика.&lt;/li>
&lt;li>По концепции схож с Proxy Mobile IPv6.&lt;/li>
&lt;li>Не работает через NAT.&lt;/li>
&lt;/ul>
&lt;h2 id="seal">&lt;span class="section-num">12&lt;/span> SEAL&lt;/h2>
&lt;ul>
&lt;li>SEAL &amp;mdash; Subnetwork Encapsulation and Adaptation Layer.&lt;/li>
&lt;li>Поддерживает несколько IPv4-линков и multihoming.&lt;/li>
&lt;li>Есть аутентификация и anti-replay механизм.&lt;/li>
&lt;li>SEAL Control Message Protocol используется для обменом служебными данными между хостами.&lt;/li>
&lt;/ul></description></item><item><title>Общедоступные резольверы DNS</title><link>https://yamadharma.github.io/ru/post/2023/05/26/public-dns-resolvers/</link><pubDate>Fri, 26 May 2023 12:14:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/05/26/public-dns-resolvers/</guid><description>&lt;p>Общедоступные резольверы DNS.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#google">&lt;span class="section-num">1&lt;/span> Google&lt;/a>&lt;/li>
&lt;li>&lt;a href="#cloudflare">&lt;span class="section-num">2&lt;/span> CloudFlare&lt;/a>&lt;/li>
&lt;li>&lt;a href="#quad9">&lt;span class="section-num">3&lt;/span> Quad9&lt;/a>&lt;/li>
&lt;li>&lt;a href="#yandex">&lt;span class="section-num">4&lt;/span> Yandex&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#базовый">&lt;span class="section-num">4.1&lt;/span> Базовый&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#информация">&lt;span class="section-num">4.1.1&lt;/span> Информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#список">&lt;span class="section-num">4.1.2&lt;/span> Список&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#безопасный">&lt;span class="section-num">4.2&lt;/span> Безопасный&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#информация">&lt;span class="section-num">4.2.1&lt;/span> Информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#список">&lt;span class="section-num">4.2.2&lt;/span> Список&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#семейный">&lt;span class="section-num">4.3&lt;/span> Семейный&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#описание">&lt;span class="section-num">4.3.1&lt;/span> Описание&lt;/a>&lt;/li>
&lt;li>&lt;a href="#список">&lt;span class="section-num">4.3.2&lt;/span> Список&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#opendns-cisco">&lt;span class="section-num">5&lt;/span> OpenDNS/Cisco&lt;/a>&lt;/li>
&lt;li>&lt;a href="#comodo">&lt;span class="section-num">6&lt;/span> Comodo&lt;/a>&lt;/li>
&lt;li>&lt;a href="#cleanbrowsing-dot-org">&lt;span class="section-num">7&lt;/span> CleanBrowsing.org&lt;/a>&lt;/li>
&lt;li>&lt;a href="#dns-watch">&lt;span class="section-num">8&lt;/span> DNS Watch&lt;/a>&lt;/li>
&lt;li>&lt;a href="#freedns">&lt;span class="section-num">9&lt;/span> FreeDNS&lt;/a>&lt;/li>
&lt;li>&lt;a href="#fourth-estate">&lt;span class="section-num">10&lt;/span> Fourth Estate&lt;/a>&lt;/li>
&lt;li>&lt;a href="#uncensoreddns">&lt;span class="section-num">11&lt;/span> UncensoredDNS&lt;/a>&lt;/li>
&lt;li>&lt;a href="#verisign">&lt;span class="section-num">12&lt;/span> Verisign&lt;/a>&lt;/li>
&lt;li>&lt;a href="#level-3-communications">&lt;span class="section-num">13&lt;/span> Level 3 Communications&lt;/a>&lt;/li>
&lt;li>&lt;a href="#adguard">&lt;span class="section-num">14&lt;/span> AdGuard&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#серверы-по-умолчанию">&lt;span class="section-num">14.1&lt;/span> Серверы по умолчанию&lt;/a>&lt;/li>
&lt;li>&lt;a href="#серверы-без-фильтрации">&lt;span class="section-num">14.2&lt;/span> Серверы без фильтрации&lt;/a>&lt;/li>
&lt;li>&lt;a href="#семейные-серверы">&lt;span class="section-num">14.3&lt;/span> Семейные серверы&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="google">&lt;span class="section-num">1&lt;/span> Google&lt;/h2>
&lt;ul>
&lt;li>Описание:
&lt;ul>
&lt;li>&lt;a href="https://developers.google.com/speed/public-dns/docs/using" target="_blank" rel="noopener">https://developers.google.com/speed/public-dns/docs/using&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developers.google.com/speed/public-dns/docs/isp" target="_blank" rel="noopener">https://developers.google.com/speed/public-dns/docs/isp&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>8.8.8.8&lt;/li>
&lt;li>8.8.4.4&lt;/li>
&lt;li>2001:4860:4860::8888&lt;/li>
&lt;li>2001:4860:4860::8844&lt;/li>
&lt;li>Поддерживается DNS over TLS.&lt;/li>
&lt;/ul>
&lt;h2 id="cloudflare">&lt;span class="section-num">2&lt;/span> CloudFlare&lt;/h2>
&lt;ul>
&lt;li>1.1.1.1&lt;/li>
&lt;li>1.0.0.1&lt;/li>
&lt;li>2606:4700:4700::1111&lt;/li>
&lt;li>2606:4700:4700::1001&lt;/li>
&lt;li>Поддерживается DNS over TLS.&lt;/li>
&lt;/ul>
&lt;h2 id="quad9">&lt;span class="section-num">3&lt;/span> Quad9&lt;/h2>
&lt;ul>
&lt;li>9.9.9.9&lt;/li>
&lt;li>149.112.112.112&lt;/li>
&lt;li>Блокируются вредоносные хосты и поддерживается DNS over TLS.&lt;/li>
&lt;/ul>
&lt;h2 id="yandex">&lt;span class="section-num">4&lt;/span> Yandex&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://dns.yandex.ru/" target="_blank" rel="noopener">https://dns.yandex.ru/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="базовый">&lt;span class="section-num">4.1&lt;/span> Базовый&lt;/h3>
&lt;h4 id="информация">&lt;span class="section-num">4.1.1&lt;/span> Информация&lt;/h4>
&lt;ul>
&lt;li>Стандартный рекурсивный DNS.&lt;/li>
&lt;li>Не предусмотрена блокировка каких-либо сайтов.&lt;/li>
&lt;/ul>
&lt;h4 id="список">&lt;span class="section-num">4.1.2&lt;/span> Список&lt;/h4>
&lt;ul>
&lt;li>77.88.8.8&lt;/li>
&lt;li>77.88.8.1&lt;/li>
&lt;li>2a02:6b8::feed:0ff&lt;/li>
&lt;li>2a02:6b8:0:1::feed:0ff&lt;/li>
&lt;/ul>
&lt;h3 id="безопасный">&lt;span class="section-num">4.2&lt;/span> Безопасный&lt;/h3>
&lt;h4 id="информация">&lt;span class="section-num">4.2.1&lt;/span> Информация&lt;/h4>
&lt;ul>
&lt;li>Блокируются вредоносные хосты.&lt;/li>
&lt;li>Защита от мошенников.&lt;/li>
&lt;li>Защита от ботнетов.&lt;/li>
&lt;/ul>
&lt;h4 id="список">&lt;span class="section-num">4.2.2&lt;/span> Список&lt;/h4>
&lt;ul>
&lt;li>77.88.8.88&lt;/li>
&lt;li>77.88.8.2&lt;/li>
&lt;li>2a02:6b8::feed:bad&lt;/li>
&lt;li>2a02:6b8:0:1::feed:bad&lt;/li>
&lt;/ul>
&lt;h3 id="семейный">&lt;span class="section-num">4.3&lt;/span> Семейный&lt;/h3>
&lt;h4 id="описание">&lt;span class="section-num">4.3.1&lt;/span> Описание&lt;/h4>
&lt;ul>
&lt;li>Блокировка сайтов для взрослых.
&lt;ul>
&lt;li>База данных с порносайтами обновляется 2-3 раза в неделю.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Блокировка рекламы для взрослых.&lt;/li>
&lt;li>Семейный поиск Яндекса.&lt;/li>
&lt;/ul>
&lt;h4 id="список">&lt;span class="section-num">4.3.2&lt;/span> Список&lt;/h4>
&lt;ul>
&lt;li>77.88.8.7&lt;/li>
&lt;li>77.88.8.3&lt;/li>
&lt;li>2a02:6b8::feed:a11&lt;/li>
&lt;li>2a02:6b8:0:1::feed:a11&lt;/li>
&lt;/ul>
&lt;h2 id="opendns-cisco">&lt;span class="section-num">5&lt;/span> OpenDNS/Cisco&lt;/h2>
&lt;ul>
&lt;li>208.67.222.222&lt;/li>
&lt;li>208.67.220.220&lt;/li>
&lt;li>Блокируются вредоносные хосты и сайты для взрослых.&lt;/li>
&lt;li>Поддерживается DNSCrypt и DNS over TLS.&lt;/li>
&lt;/ul>
&lt;h2 id="comodo">&lt;span class="section-num">6&lt;/span> Comodo&lt;/h2>
&lt;ul>
&lt;li>8.26.56.26&lt;/li>
&lt;li>8.20.247.20&lt;/li>
&lt;li>Блокируются вредоносные хосты.&lt;/li>
&lt;li>Поддерживается DNSCrypt и DNS over TLS.&lt;/li>
&lt;/ul>
&lt;h2 id="cleanbrowsing-dot-org">&lt;span class="section-num">7&lt;/span> CleanBrowsing.org&lt;/h2>
&lt;ul>
&lt;li>185.228.168.168&lt;/li>
&lt;li>185.228.169.168&lt;/li>
&lt;li>Блокируется хосты с сайтами для взрослых.&lt;/li>
&lt;li>Поддерживается DNSCrypt.&lt;/li>
&lt;/ul>
&lt;h2 id="dns-watch">&lt;span class="section-num">8&lt;/span> DNS Watch&lt;/h2>
&lt;ul>
&lt;li>84.200.69.80&lt;/li>
&lt;li>84.200.70.40&lt;/li>
&lt;li>Не ведутся логи.&lt;/li>
&lt;/ul>
&lt;h2 id="freedns">&lt;span class="section-num">9&lt;/span> FreeDNS&lt;/h2>
&lt;ul>
&lt;li>37.235.1.174&lt;/li>
&lt;li>37.235.1.177&lt;/li>
&lt;li>Не ведутся логи.&lt;/li>
&lt;/ul>
&lt;h2 id="fourth-estate">&lt;span class="section-num">10&lt;/span> Fourth Estate&lt;/h2>
&lt;ul>
&lt;li>45.77.165.194&lt;/li>
&lt;li>45.32.36.36&lt;/li>
&lt;li>Не ведутся логи.&lt;/li>
&lt;/ul>
&lt;h2 id="uncensoreddns">&lt;span class="section-num">11&lt;/span> UncensoredDNS&lt;/h2>
&lt;ul>
&lt;li>91.239.100.100
&lt;ul>
&lt;li>Anycast.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>89.233.43.71
&lt;ul>
&lt;li>Размещён в Дании.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="verisign">&lt;span class="section-num">12&lt;/span> Verisign&lt;/h2>
&lt;ul>
&lt;li>64.6.64.6&lt;/li>
&lt;li>64.6.65.6&lt;/li>
&lt;/ul>
&lt;h2 id="level-3-communications">&lt;span class="section-num">13&lt;/span> Level 3 Communications&lt;/h2>
&lt;ul>
&lt;li>4.2.2.1&lt;/li>
&lt;li>4.2.2.2&lt;/li>
&lt;li>4.2.2.3&lt;/li>
&lt;li>4.2.2.4&lt;/li>
&lt;li>4.2.2.5&lt;/li>
&lt;li>4.2.2.6&lt;/li>
&lt;/ul>
&lt;h2 id="adguard">&lt;span class="section-num">14&lt;/span> AdGuard&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://adguard-dns.io/" target="_blank" rel="noopener">https://adguard-dns.io/&lt;/a>&lt;/li>
&lt;li>Ограниченный пробный тариф.&lt;/li>
&lt;/ul>
&lt;h3 id="серверы-по-умолчанию">&lt;span class="section-num">14.1&lt;/span> Серверы по умолчанию&lt;/h3>
&lt;ul>
&lt;li>Если вы хотите блокировать рекламу и трекеры.&lt;/li>
&lt;li>94.140.14.14&lt;/li>
&lt;li>94.140.15.15&lt;/li>
&lt;li>2a10:50c0::ad1:ff&lt;/li>
&lt;li>2a10:50c0::ad2:ff&lt;/li>
&lt;/ul>
&lt;h3 id="серверы-без-фильтрации">&lt;span class="section-num">14.2&lt;/span> Серверы без фильтрации&lt;/h3>
&lt;ul>
&lt;li>Если вы не хотите, чтобы AdGuard DNS блокировал рекламу, трекеры или любые другие DNS-запросы.&lt;/li>
&lt;li>94.140.14.140&lt;/li>
&lt;li>94.140.14.141&lt;/li>
&lt;li>2a10:50c0::1:ff&lt;/li>
&lt;li>2a10:50c0::2:ff&lt;/li>
&lt;/ul>
&lt;h3 id="семейные-серверы">&lt;span class="section-num">14.3&lt;/span> Семейные серверы&lt;/h3>
&lt;ul>
&lt;li>Если вы хотите блокировать рекламу, трекеры и взрослый контент, включить безопасный поиск и безопасный режим.&lt;/li>
&lt;li>94.140.14.15&lt;/li>
&lt;li>94.140.15.16&lt;/li>
&lt;li>2a10:50c0::bad1:ff&lt;/li>
&lt;li>2a10:50c0::bad2:ff&lt;/li>
&lt;/ul></description></item><item><title>DNS. PowerDNS Recursor</title><link>https://yamadharma.github.io/ru/post/2023/05/23/dns-powerdns-recursor/</link><pubDate>Tue, 23 May 2023 10:08:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/05/23/dns-powerdns-recursor/</guid><description>&lt;p>PowerDNS Recursor.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-powerdns-recursor">&lt;span class="section-num">2&lt;/span> Установка PowerDNS Recursor&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#rocky-linux">&lt;span class="section-num">2.1&lt;/span> Rocky Linux&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#настройка-powerdns-recursor">&lt;span class="section-num">3&lt;/span> Настройка PowerDNS Recursor&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Документация: &lt;a href="https://doc.powerdns.com/recursor/" target="_blank" rel="noopener">https://doc.powerdns.com/recursor/&lt;/a>&lt;/li>
&lt;li>Сайт: &lt;a href="https://www.powerdns.com/powerdns-recursor" target="_blank" rel="noopener">https://www.powerdns.com/powerdns-recursor&lt;/a>&lt;/li>
&lt;li>Только кэширующий сервер DNS.&lt;/li>
&lt;/ul>
&lt;h2 id="установка-powerdns-recursor">&lt;span class="section-num">2&lt;/span> Установка PowerDNS Recursor&lt;/h2>
&lt;h3 id="rocky-linux">&lt;span class="section-num">2.1&lt;/span> Rocky Linux&lt;/h3>
&lt;ul>
&lt;li>Установите репозиторий &lt;em>Epel&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf config-manager --set-enabled crb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf -y install epel-release
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установите PowerDNS Recursor:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf install powerdns-recursor
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-powerdns-recursor">&lt;span class="section-num">3&lt;/span> Настройка PowerDNS Recursor&lt;/h2>
&lt;ul>
&lt;li>Файл конфигурации: &lt;code>recursor.conf&lt;/code>.&lt;/li>
&lt;li>Находится в папке,определённой во время компиляции:
&lt;ul>
&lt;li>&lt;code>/etc/powerdns&lt;/code>,&lt;/li>
&lt;li>&lt;code>/etc/pdns&lt;/code>,&lt;/li>
&lt;li>&lt;code>/etc/pdns-recursor&lt;/code>,&lt;/li>
&lt;li>&lt;code>/usr/local/etc&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Можно найти эту папку, выполнив команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">pdns_recursor --config&lt;span class="o">=&lt;/span>default &lt;span class="p">|&lt;/span> grep config-dir
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>По умолчанию Recursor прослушивает локальный петлевой интерфейс, нужно задать нужные адреса.&lt;/li>
&lt;li>В параметре &lt;code>allow-from&lt;/code> перечислены подсети, которые могут взаимодействовать с Recursor.&lt;/li>
&lt;li>Например:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">local-address=192.0.2.25, 2001:DB8::1:25
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">allow-from=192.0.2.0/24, 2001:DB8::1:/64
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Чтобы принимать входящие запросы клиентов, разрешите службу DNS на брандмауэре:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --permanent --add-service&lt;span class="o">=&lt;/span>dns
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">firewall-cmd --permanent --add-service&lt;span class="o">=&lt;/span>dns-over-tls
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перезапустите брандмауэр:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firewall-cmd --reload
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Запустите сервис:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> --now pdns-recursor.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Сопоставление команд Cisco и Huawei</title><link>https://yamadharma.github.io/ru/post/2023/04/04/cisco-huawei-commands/</link><pubDate>Tue, 04 Apr 2023 15:26:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/04/04/cisco-huawei-commands/</guid><description>&lt;p>Команды Cisco и Huawei.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">&lt;/nav>
&lt;/details>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 1:&lt;/span>
Exec mode
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Cisco exec mode&lt;/th>
&lt;th>Huawei user view&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>traceroute&lt;/td>
&lt;td>tracert&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>terminal length 0&lt;/td>
&lt;td>screen-length 0 temporary&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show&lt;/td>
&lt;td>display&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show version&lt;/td>
&lt;td>display version&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show history-command&lt;/td>
&lt;td>display history-command&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show interfaces&lt;/td>
&lt;td>display interface&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show ip interface&lt;/td>
&lt;td>display ip interface&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show ip route&lt;/td>
&lt;td>display ip routing-table&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show ip bgp&lt;/td>
&lt;td>display bgp routing-table&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show clock&lt;/td>
&lt;td>display clock&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show flash&lt;/td>
&lt;td>dir flash:&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show logging&lt;/td>
&lt;td>display logbuffer&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show snmp&lt;/td>
&lt;td>display snmp-agent statistics&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show users&lt;/td>
&lt;td>display users&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show tech-support&lt;/td>
&lt;td>display diagnostic-information&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show running-config&lt;/td>
&lt;td>display current-configuration&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>write terminal&lt;/td>
&lt;td>display current-configuration&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>show startup-config&lt;/td>
&lt;td>display saved-configuration&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>more nvram:startup-config&lt;/td>
&lt;td>display saved-configuration&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>write erase&lt;/td>
&lt;td>reset saved-configuration&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>write memory&lt;/td>
&lt;td>save&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>copy running-config startup-config&lt;/td>
&lt;td>save&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>clear&lt;/td>
&lt;td>reset&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>clear counters&lt;/td>
&lt;td>reset counters interface&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>clear interface&lt;/td>
&lt;td>reset counters interface&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>clear access-list counters&lt;/td>
&lt;td>reset acl counter all&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>no&lt;/td>
&lt;td>undo&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>debug / no debug&lt;/td>
&lt;td>debugging / undo debugging&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>reload&lt;/td>
&lt;td>reboot&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>enable&lt;/td>
&lt;td>super&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>disable&lt;/td>
&lt;td>super 0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>erase&lt;/td>
&lt;td>delete&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>exit&lt;/td>
&lt;td>quit&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>configure terminal&lt;/td>
&lt;td>system-view&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 2:&lt;/span>
Configuration mode
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Cisco configuration mode&lt;/th>
&lt;th>Huawei system view&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>end&lt;/td>
&lt;td>return&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>snmp-server&lt;/td>
&lt;td>snmp-agent&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>hostname&lt;/td>
&lt;td>sysname&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>router bgp&lt;/td>
&lt;td>bgp&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>router ospf&lt;/td>
&lt;td>ospf&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>router rip&lt;/td>
&lt;td>rip&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>shutdown / no shutdown&lt;/td>
&lt;td>shutdown / undo shutdown&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>Система мониторинга LibreNMS</title><link>https://yamadharma.github.io/ru/post/2023/03/20/librenms-monitoring-system/</link><pubDate>Mon, 20 Mar 2023 15:07:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/03/20/librenms-monitoring-system/</guid><description>&lt;p>Система мониторинга LibreNMS.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#дополнения">&lt;span class="section-num">3&lt;/span> Дополнения&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#oxidized">&lt;span class="section-num">3.1&lt;/span> Oxidized&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://www.librenms.org/" target="_blank" rel="noopener">https://www.librenms.org/&lt;/a>.&lt;/li>
&lt;li>Документация: &lt;a href="https://docs.librenms.org/" target="_blank" rel="noopener">https://docs.librenms.org/&lt;/a>.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/librenms/librenms/" target="_blank" rel="noopener">https://github.com/librenms/librenms/&lt;/a>.&lt;/li>
&lt;li>LibreNMS &amp;mdash; форк Observium (см. &lt;a href="https://yamadharma.github.io/ru/post/2023/03/02/observium-monitoring-system/">Система мониторинга Observium&lt;/a>).&lt;/li>
&lt;li>LibreNMS был создан из последней версии Observium под лицензией GPL (2013 год).&lt;/li>
&lt;li>Можно мигрировать с Observium на LibreNMS.&lt;/li>
&lt;li>Нет платной поддержки.&lt;/li>
&lt;li>Используется git для контроля версий.&lt;/li>
&lt;/ul>
&lt;h2 id="установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/04/26/librenms-installation/">Установка LibreNMS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/04/26/librenms-observium-migration/">LibreNMS. Миграция с Observium&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="дополнения">&lt;span class="section-num">3&lt;/span> Дополнения&lt;/h2>
&lt;h3 id="oxidized">&lt;span class="section-num">3.1&lt;/span> Oxidized&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/04/26/oxidized/">Система управления конфигурациями Oxidized&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Контроллер Cisco WLC</title><link>https://yamadharma.github.io/ru/post/2023/03/03/cisco-wlc/</link><pubDate>Fri, 03 Mar 2023 15:14:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/03/03/cisco-wlc/</guid><description>&lt;p>Контроллер Cisco WLC.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#полезные-команды">&lt;span class="section-num">2&lt;/span> Полезные команды&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-wlan">&lt;span class="section-num">3&lt;/span> Настройка WLAN&lt;/a>&lt;/li>
&lt;li>&lt;a href="#обновление">&lt;span class="section-num">4&lt;/span> Обновление&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>WLC (wireless lan controller) контроллер точек WiFi от Cisco.&lt;/li>
&lt;li>Контроллер нужен для централизованного управления большими беспроводными сетями, построенными на базе не настраиваемых индивидуально точек доступа.&lt;/li>
&lt;li>Точки доступа регистрируются на контроллере, получают с него настройки, управляются им, и предоставляют беспроводной доступ Wi-Fi абонентам.&lt;/li>
&lt;li>Практически все модели точек доступа Cisco выпускаются как в автономном варианте (независимое управление через CLI или GUI), так и в унифицированном (лимитированный CLI и управление с контроллера по протоколу CAPWAP).&lt;/li>
&lt;li>Контроллер представляет собой программно-аппаратную платформу взаимодействия с точками доступа, и проводной сетью.&lt;/li>
&lt;li>Есть виртуальный контроллер в виде образа виртуальной машины под VMware ESXi (ovf-файл).&lt;/li>
&lt;/ul>
&lt;h2 id="полезные-команды">&lt;span class="section-num">2&lt;/span> Полезные команды&lt;/h2>
&lt;ul>
&lt;li>Настроить IP-адрес точке доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap static-ip &lt;span class="nb">enable&lt;/span> AP-NAME IP-ADDRESS MASK GATEWAY
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настроить учётные данные точки доступа для Telnet/SSH:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap telnet &lt;span class="nb">enable&lt;/span> AP-NAME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">config ap ssh &lt;span class="nb">enable&lt;/span> AP-NAME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">config ap mgmtuser add username USERNAME password PASSWORD enablesecret ENABLE-PASSWORD AP-NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Изменить режим точки доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap mode MODE AP-NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настроить имя группы на точке доступа&lt;/li>
&lt;/ul>
&lt;!--listend-->
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap group-name GROUP-NAME AP-NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>
&lt;p>Настроить flexconnect native vlan на точке доступа:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap flexconnect vlan native VLAN-ID AP-NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Проверить идентификатор vlan интерфейса:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show interface summary
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Проверить идентификатор wlan интерфейса:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show wlan summary
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Сопоставить идентификатор vlan с wlan на точке доступа:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap flexconnect vlan wlan WLAN-ID VLAN-ID AP-NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Настроить wlan и сопоставление wlan-интерфейса в группе точек доступа:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config wlan apgroup interface-mapping add GROUP-NAME WLAN-ID INTERFACE-NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Понизить точку доступа до автономной с WLC:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap tftp-downgrade TFTP-IP-ADDRESS FILENAME AP-NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Посмотреть cdp на точке доступа:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show ap cdp neighbors detail AP-NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Отключить подключение беспроводных клиентов к сети (добавление клиентов в список исключений):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config exclusionlist add MAC-ADDRESS DESCRIPTION
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Включить светодиод точки доступа:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap led-state &lt;span class="nb">enable&lt;/span> AP_NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Отключить светодиод точки доступа:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap led-state disable AP_NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Перезагрузить точку доступа:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config ap reset AP_NAME
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Применить фильтр для фильтрации результатов:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">grep include &lt;span class="s2">&amp;#34;pattern&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;commands&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Примеры:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">grep include &lt;span class="s2">&amp;#34;AP Serial Number&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;show ap config general AP-NAME&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">grep include &lt;span class="s2">&amp;#34;MAC Address&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;show ap config general AP-NAME”
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">grep include &amp;#34;&lt;/span>IP Address&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>show ap config general AP-NAME&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-wlan">&lt;span class="section-num">3&lt;/span> Настройка WLAN&lt;/h2>
&lt;ul>
&lt;li>Каждая беспроводная сеть идентифицируется уникальным именем (SSID).&lt;/li>
&lt;li>Каждая сеть может иметь свой, независимый набор параметров авторизации, шифрования, QoS, дополнительных свойств.&lt;/li>
&lt;li>Каждая точка доступа может обслуживать (анонсировать) до 16 беспроводных сетей.&lt;/li>
&lt;li>Контроллер (в зависимости от модели) может обслуживать до 512 сетей и до сотен точек доступа.&lt;/li>
&lt;li>Просмотр настроенных WLAN:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">show wlan summary
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для создания новой сети необходимо задать базовые параметры:
&lt;ul>
&lt;li>&lt;em>Тип сети&lt;/em>: WLAN (беспроводная). Контроллер может также работать как Captive Portal для проводной сети (Guest LAN).&lt;/li>
&lt;li>&lt;em>Имя профиля (profile-name)&lt;/em>: произвольное слово, обычно соответствует имени сети, применяется при использовании систем управления WCS/NCS.&lt;/li>
&lt;li>&lt;em>Имя сети (SSID)&lt;/em>: то, как ваша сеть будет видна клиентским компьютерам.&lt;/li>
&lt;li>&lt;em>Идентификатор (порядковый номер)&lt;/em>: по умолчанию ваши точки доступа будут анонсировать сети с номерами &amp;lt;=16.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Создадим новую сеть:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config wlan create wlan-id profile-name ssid
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Следует задать параметры сети.
&lt;ul>
&lt;li>&lt;em>enable&lt;/em> включает, &lt;em>disable&lt;/em> выключает обслуживание сети точками доступа.&lt;/li>
&lt;li>&lt;em>Security policy&lt;/em> оповещает вас о текущем наборе политик безопасности сети, которые настраиваются далее&lt;/li>
&lt;li>Radio policy позволяет выбрать, в каком диапазоне частот (2.4, 5 ГГц) и скоростей (до 11, до 54 мбит/с) будет работать сеть. Возможны комбинации вариантов. Высокие скорости (802.11n) — тема отдельной статьи. Естественно, ваши точки должны поддерживать выбранные диапазоны.&lt;/li>
&lt;li>&lt;em>interface&lt;/em> определяет, на какой проводной сетевой интерфейс (VLAN) контроллера по умолчанию будут терминироваться подключения беспроводных клиентов.
&lt;ul>
&lt;li>Можно создать несколько динамических интерфейсов, каждый со своим VLAN ID, и распределять ваших пользователей по ним в зависимости от того, к какой сети они подключились.&lt;/li>
&lt;li>&lt;em>Multicast VLAN&lt;/em> определяет, куда в случае нескольких групп интерфейсов будет идти мультикаст трафик.&lt;/li>
&lt;li>&lt;em>Broadcast SSID&lt;/em> определяет, будет ли имя сети отражаться в beacon (анонсах) пакетов, периодически рассылаемых точкой доступа. Иначе это называется «открытая/закрытая сеть».&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Подключение сети к интерфейсу:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config wlan interface &amp;lt;wlan-id&amp;gt; &amp;lt;interface-name&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">config wlan broadcast-ssid &lt;span class="nb">enable&lt;/span> &amp;lt;wlan_id&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Безопасность беспроводной сети строится из трех компонентов:
&lt;ul>
&lt;li>авторизация;&lt;/li>
&lt;li>шифрования;&lt;/li>
&lt;li>веб-политика (опционально), позволяет заворачивать клиентскую HTTP-сессию на встроенный или внешний веб-сервер и запрашивать подтверждение/логин-пароль через форму.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Доступные параметры безопасности 2го уровня:
&lt;ul>
&lt;li>&lt;em>None&lt;/em>: авторизация и шифрование трафика не применяются;&lt;/li>
&lt;li>&lt;em>WPA+WPA2&lt;/em>: позволяет выбрать политику WPA, WPA2 (либо обе), тип шифрования TKIP, AES (либо оба). Данные параметры просто анонсируются клиентам в beacon пакетах.
&lt;ul>
&lt;li>Оптимальным будет использование WPA2/AES.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Нужно, как будет образовываться ключ для шифрования:
&lt;ul>
&lt;li>&lt;em>802.1X&lt;/em>: индивидуальный ключ для каждого клиента будет генерироваться RADIUS-сервером в момент авторизации; также называется WPA(2) Enterprise;&lt;/li>
&lt;li>&lt;em>CCKM&lt;/em>: используется собственный механизм Cisco генерации ключей, подходит только для Cisco Wi-Fi телефонов;&lt;/li>
&lt;li>&lt;em>PSK&lt;/em>: общий (pre-shared) ключ, пароль на сеть, именуемую в таком случае WPA(2) Personal;&lt;/li>
&lt;li>&lt;em>802.1x+CCKM&lt;/em>: гибрид CCKM и RADIUS-ключа (для Cisco-телефонов);&lt;/li>
&lt;li>&lt;em>802.1X&lt;/em>: индивидуальный ключ для каждого клиента будет генерироваться RADIUS-сервером в момент авторизации (это WEP-ключ, протокол шифрования радиоканала &amp;mdash; WEP, пользоваться не рекомендуется);&lt;/li>
&lt;li>&lt;em>Static WEP&lt;/em>: статический WEP-ключ;&lt;/li>
&lt;li>&lt;em>Static WEP+802.1X&lt;/em>: гибрид двух предыдущих;&lt;/li>
&lt;li>&lt;em>CKIP&lt;/em>: проприетарный аналог WEP для Cisco телефонов.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>В реальности необходимо делать выбор между:
&lt;ul>
&lt;li>отсутствием шифрования/авторизации (гостевой доступ);&lt;/li>
&lt;li>WPA2 (AES) PSK (WPA2 Personal) для доступа в сеть по общему паролю;&lt;/li>
&lt;li>WPA2 (AES) + 802.1X (WPA2 Enterprise) для доступа в сеть через авторизацию на RADIUS-сервере.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Настроим параметры безопасности на интерфейсе:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config wlan security wpa akm 802.1x disable &amp;lt;wlan_id&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">config wlan security wpa akm psk &lt;span class="nb">enable&lt;/span> &amp;lt;wlan_id&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">config wlan security wpa akm psk set-key ascii &amp;lt;password&amp;gt; &amp;lt;wlan_id&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Подключим радио-интерфейсы:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config wlan radio &amp;lt;wlan_id&amp;gt; all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Активируем интерфейс:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config wlan &lt;span class="nb">enable&lt;/span> &amp;lt;wlan_id&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сети добавляются автоматически в группу точек доступа &lt;code>default-group&lt;/code>.&lt;/li>
&lt;li>Если существуют другие группы точек доступа, то следует сеть добавить к ней:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">config wlan apgroup interface-mapping add &amp;lt;apgroup-name&amp;gt; &amp;lt;wlan-id&amp;gt; &amp;lt;interface-name&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="обновление">&lt;span class="section-num">4&lt;/span> Обновление&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/10/01/cisco-wlc-firmware-upgrade/">Контроллер Cisco WLC. Обновление программного обеспечения&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Домашний интернет</title><link>https://yamadharma.github.io/ru/post/2023/02/16/home-internet/</link><pubDate>Thu, 16 Feb 2023 15:17:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2023/02/16/home-internet/</guid><description>&lt;p>Домашний интернет.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#провайдеры">&lt;span class="section-num">1&lt;/span> Провайдеры&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#2004-2008-cinet">&lt;span class="section-num">1.1&lt;/span> 2004-2008, CiNet&lt;/a>&lt;/li>
&lt;li>&lt;a href="#2008-2013-netbynet">&lt;span class="section-num">1.2&lt;/span> 2008&amp;ndash;2013, NetByNet&lt;/a>&lt;/li>
&lt;li>&lt;a href="#2013-2019-avelacom">&lt;span class="section-num">1.3&lt;/span> 2013&amp;ndash;2019, Avelacom&lt;/a>&lt;/li>
&lt;li>&lt;a href="#2019-2023-мгтс">&lt;span class="section-num">1.4&lt;/span> 2019&amp;ndash;2023, МГТС&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#частичная-блокировка-интернета">&lt;span class="section-num">1.4.1&lt;/span> Частичная блокировка интернета&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#2023-seven-sky">&lt;span class="section-num">1.5&lt;/span> 2023&amp;ndash;, Seven Sky&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1.5.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#рекомендации-по-подключению">&lt;span class="section-num">1.5.2&lt;/span> Рекомендации по подключению&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="провайдеры">&lt;span class="section-num">1&lt;/span> Провайдеры&lt;/h2>
&lt;ul>
&lt;li>Провайдеры, услугами которых я пользовался.&lt;/li>
&lt;/ul>
&lt;h3 id="2004-2008-cinet">&lt;span class="section-num">1.1&lt;/span> 2004-2008, CiNet&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;code>http://ci.net.ru&lt;/code>. Не существует.&lt;/li>
&lt;li>В 2008 куплен NetByNet (см. &lt;a href="https://ru.wikipedia.org/wiki/NetByNet" target="_blank" rel="noopener">https://ru.wikipedia.org/wiki/NetByNet&lt;/a>).&lt;/li>
&lt;/ul>
&lt;h3 id="2008-2013-netbynet">&lt;span class="section-num">1.2&lt;/span> 2008&amp;ndash;2013, NetByNet&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://www.netbynet.ru/" target="_blank" rel="noopener">https://www.netbynet.ru/&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h3 id="2013-2019-avelacom">&lt;span class="section-num">1.3&lt;/span> 2013&amp;ndash;2019, Avelacom&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://avelacom.ru/" target="_blank" rel="noopener">https://avelacom.ru/&lt;/a>.&lt;/li>
&lt;li>Был на тот момент единственным провайдером в доме.&lt;/li>
&lt;li>Подключение по витой паре.&lt;/li>
&lt;li>Несколько раз в неделю подвисало соединение.&lt;/li>
&lt;li>По этой причине был осуществлён переход на МГТС GPON.&lt;/li>
&lt;/ul>
&lt;h3 id="2019-2023-мгтс">&lt;span class="section-num">1.4&lt;/span> 2019&amp;ndash;2023, МГТС&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://moskva.mts.ru/personal/dom/home-allmts/moskva" target="_blank" rel="noopener">https://moskva.mts.ru/personal/dom/home-allmts/moskva&lt;/a>.&lt;/li>
&lt;li>Подключение по оптике, GPON.&lt;/li>
&lt;li>Оборудование: абонентский терминал GPON ZXHN F670.
&lt;ul>
&lt;li>&lt;a href="https://4pda.to/forum/index.php?showtopic=848460" target="_blank" rel="noopener">https://4pda.to/forum/index.php?showtopic=848460&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Есть сеть ipv6.
&lt;ul>
&lt;li>Адрес ipv6 можно получить, только в отсутствии внешнего ipv4 адреса.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Провайдер заменён в связи со сменой места жительства.&lt;/li>
&lt;li>Для переоформления договора (или закрытия договора) необходимо ехать в офис.
&lt;ul>
&lt;li>Эти можно сделать в офисе МТС-Home.&lt;/li>
&lt;li>Сайт: &lt;a href="https://moscow.mt-home.ru/" target="_blank" rel="noopener">https://moscow.mt-home.ru/&lt;/a>&lt;/li>
&lt;li>Офисы обслуживания: &lt;a href="https://support.mts.ru/domashnii_internet_i_tv_instruktsiii/ofisi/ofisi-obsluzhivaniya" target="_blank" rel="noopener">https://support.mts.ru/domashnii_internet_i_tv_instruktsiii/ofisi/ofisi-obsluzhivaniya&lt;/a>&lt;/li>
&lt;li>Офисов мало, персонала мало, ждать приходится долго.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="частичная-блокировка-интернета">&lt;span class="section-num">1.4.1&lt;/span> Частичная блокировка интернета&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://moskva.mts.ru/personal/dlya-doma/uslugi/katalog-uslug-fiksirovannoy-svyazi/chastichnaya_blokirovka#" target="_blank" rel="noopener">https://moskva.mts.ru/personal/dlya-doma/uslugi/katalog-uslug-fiksirovannoy-svyazi/chastichnaya_blokirovka#&lt;/a>&lt;/li>
&lt;li>Можно подключить частичную блокировку и не платить за услуги, которыми временно не пользуетесь.&lt;/li>
&lt;li>Общее количество дней действия услуги «МТС. Частичная блокировка» не может превышать 180 дней в год.&lt;/li>
&lt;li>Подключить услугу можно или в офисе, или позвонив по телефону &lt;code>+7 (495) 636-06-36&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="2023-seven-sky">&lt;span class="section-num">1.5&lt;/span> 2023&amp;ndash;, Seven Sky&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">1.5.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Акционерное общество «Искрателеком», &lt;a href="https://ru.wikipedia.org/wiki/%D0%98%D1%81%D0%BA%D1%80%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%BA%D0%BE%D0%BC" target="_blank" rel="noopener">https://ru.wikipedia.org/wiki/%D0%98%D1%81%D0%BA%D1%80%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%BA%D0%BE%D0%BC&lt;/a>.&lt;/li>
&lt;li>&lt;a href="https://www.seven-sky.net/" target="_blank" rel="noopener">https://www.seven-sky.net/&lt;/a>&lt;/li>
&lt;li>Подключение по витой паре.&lt;/li>
&lt;li>Тарифы
&lt;ul>
&lt;li>Зависят от региона.&lt;/li>
&lt;li>Кроме того, они первыми подключают разные жилые комплексы.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Телевидение:
&lt;ul>
&lt;li>Базовый пакет &amp;mdash; бесплатно.&lt;/li>
&lt;li>Бесплатно, как понимаю, в новостройках. Когда ещё коллективная антенна не работает.&lt;/li>
&lt;li>Просмотр на телевизоре (SmartTV) через приложение.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Приложение для телефона: &lt;a href="https://play.google.com/store/apps/details?id=com.sevensky.app&amp;amp;hl=ru&amp;amp;gl=US" target="_blank" rel="noopener">https://play.google.com/store/apps/details?id=com.sevensky.app&amp;hl=ru&amp;gl=US&lt;/a>.&lt;/li>
&lt;li>Настройка:
&lt;ul>
&lt;li>Интернет: &lt;a href="https://www.seven-sky.net/for_abonents/InternetTV/Nastrojki_podklyucheniya_k_seti_Internet" target="_blank" rel="noopener">https://www.seven-sky.net/for_abonents/InternetTV/Nastrojki_podklyucheniya_k_seti_Internet&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="рекомендации-по-подключению">&lt;span class="section-num">1.5.2&lt;/span> Рекомендации по подключению&lt;/h4>
&lt;ul>
&lt;li>На сайте нужно вверху набрать свою улицу и дом, заказать звонок.&lt;/li>
&lt;li>Рекомендую тариф Можно - 500, с годовой оплатой.&lt;/li>
&lt;li>Маршрутизатор (если не осталось старого), можно купить у них.
&lt;ul>
&lt;li>Цены нормальные.&lt;/li>
&lt;li>Рекомендую Wi-fi роутер Keenetic Speedster KN-12&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Если на телевизоре SMART, то телеприставка не обязательна.&lt;/li>
&lt;li>Посмотрите акции: &lt;a href="https://www.seven-sky.net/for_abonents/Akcii" target="_blank" rel="noopener">https://www.seven-sky.net/for_abonents/Akcii&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>GNS3 на Hyper-V</title><link>https://yamadharma.github.io/ru/post/2022/11/29/gns3-hyperv/</link><pubDate>Tue, 29 Nov 2022 14:05:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/11/29/gns3-hyperv/</guid><description>&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-hyper-v">&lt;span class="section-num">2&lt;/span> Установка Hyper-V&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-gns3">&lt;span class="section-num">3&lt;/span> Установка GNS3&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-виртуальной-машины">&lt;span class="section-num">4&lt;/span> Установка виртуальной машины&lt;/a>&lt;/li>
&lt;li>&lt;a href="#подключение-gns3-к-виртуальной-машине">&lt;span class="section-num">5&lt;/span> Подключение GNS3 к виртуальной машине&lt;/a>&lt;/li>
&lt;li>&lt;a href="#видео-установка-gns3-на-hyper-v">&lt;span class="section-num">6&lt;/span> Видео: Установка GNS3 на Hyper-V&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Начиная с Windows 10 и Windows Server 2016 поддерживается &lt;em>nested virtualization&lt;/em>, т.е. возможно запускать гипервизоры внутри виртуальных машин.&lt;/li>
&lt;li>В BIOS вашего ПК должна быть активирована технология виртуализации.&lt;/li>
&lt;/ul>
&lt;h2 id="установка-hyper-v">&lt;span class="section-num">2&lt;/span> Установка Hyper-V&lt;/h2>
&lt;ul>
&lt;li>Добавим роль Hyper-V.&lt;/li>
&lt;li>Откроем PowerShell от имени Администратора.&lt;/li>
&lt;li>Введём команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перезагружаем компьютер.&lt;/li>
&lt;li>Проверим работоспособность.&lt;/li>
&lt;li>Запустим диспетчер Hyper-V от имени администратора:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">virtmgmt.msc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Это можно сделать и из меню Пуск.&lt;/li>
&lt;li>Должен запуститься графический диспетчер Hyper-V.&lt;/li>
&lt;/ul>
&lt;h2 id="установка-gns3">&lt;span class="section-num">3&lt;/span> Установка GNS3&lt;/h2>
&lt;ul>
&lt;li>Скачайте установочный образ &lt;code>GNS3-&amp;lt;version&amp;gt;-all-in-one.exe&lt;/code> из репозитория &lt;a href="https://github.com/GNS3/gns3-gui/releases" target="_blank" rel="noopener">https://github.com/GNS3/gns3-gui/releases&lt;/a>/.&lt;/li>
&lt;li>Из этого же репозитория скачайте образ виртуальной машины &lt;code>GNS3.VM.Hyper-V.&amp;lt;version&amp;gt;.zip&lt;/code>.&lt;/li>
&lt;li>Впрочем, её же может скачать и установщик.&lt;/li>
&lt;li>После установки снимите галочку &lt;em>Запуск GNS3&lt;/em>, поскольку GNS3 запускается от имени администратора и могут возникнуть проблемы с настройкой.&lt;/li>
&lt;/ul>
&lt;h2 id="установка-виртуальной-машины">&lt;span class="section-num">4&lt;/span> Установка виртуальной машины&lt;/h2>
&lt;ul>
&lt;li>Распакуем архив с образом виртуальной машины.&lt;/li>
&lt;li>Перейдём в папку с виртуальной машиной.&lt;/li>
&lt;li>Разрешим запуск скриптов.&lt;/li>
&lt;li>Откроем PowerShell от имени Администратора.&lt;/li>
&lt;li>Выполним команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">set-executionpolicy RemoteSigned
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Архив с виртуальной машиной уже содержит скрипт, который сам создаст виртуальную машину и добавит все настройки и выдаст вам ошибку, если расширения виртуализации не включены.&lt;/li>
&lt;li>Запустим скрипт:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">create-vm.ps1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Отключим исполнение скриптов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">set-executionpolicy Restricted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="подключение-gns3-к-виртуальной-машине">&lt;span class="section-num">5&lt;/span> Подключение GNS3 к виртуальной машине&lt;/h2>
&lt;ul>
&lt;li>Запустите вручную созданную раньше виртуальную машину.&lt;/li>
&lt;li>После успешной загрузки виртуальной машины будет выведено окно с информацией, где указан IP-адрес машины.&lt;/li>
&lt;li>Запустите GNS3.&lt;/li>
&lt;li>После первого запуска появится окно &lt;em>Setup Wizard&lt;/em>.&lt;/li>
&lt;li>Его можно запустить в любое время из меню &lt;em>Help&lt;/em>.&lt;/li>
&lt;li>Выберите пункт:&lt;/li>
&lt;li>В поле &lt;em>host&lt;/em> вводим адрес нашего виртуального сервера, например 172.19.76.78.&lt;/li>
&lt;li>Меняем порт на 80.&lt;/li>
&lt;li>Нажимаем &lt;em>Next&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h2 id="видео-установка-gns3-на-hyper-v">&lt;span class="section-num">6&lt;/span> Видео: Установка GNS3 на Hyper-V&lt;/h2>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-cfbead" data-toggle="tab" href="#cfbead"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-cdabfe" data-toggle="tab" href="#cdabfe"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="cfbead" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/b8f77686a9ebc2bd59abe496a8078786"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="cdabfe" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/CBwoqmiMFC8?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Начальная конфигурация коммутатора Cisco</title><link>https://yamadharma.github.io/ru/post/2022/11/15/initial-cisco-switch-configuration/</link><pubDate>Tue, 15 Nov 2022 14:51:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/11/15/initial-cisco-switch-configuration/</guid><description>&lt;p>Начальная конфигурация коммутатора Cisco Catalist.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#подготовка">&lt;span class="section-num">1&lt;/span> Подготовка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#базовая-конфигурация">&lt;span class="section-num">2&lt;/span> Базовая конфигурация&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#включение">&lt;span class="section-num">2.1&lt;/span> Включение&lt;/a>&lt;/li>
&lt;li>&lt;a href="#переход-в-привилегированный-режим">&lt;span class="section-num">2.2&lt;/span> Переход в привилегированный режим&lt;/a>&lt;/li>
&lt;li>&lt;a href="#переход-в-режим-конфигурации">&lt;span class="section-num">2.3&lt;/span> Переход в режим конфигурации&lt;/a>&lt;/li>
&lt;li>&lt;a href="#шифрование-паролей">&lt;span class="section-num">2.4&lt;/span> Шифрование паролей&lt;/a>&lt;/li>
&lt;li>&lt;a href="#административный-доступ">&lt;span class="section-num">2.5&lt;/span> Административный доступ&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-нового-режима-аутентификации">&lt;span class="section-num">2.6&lt;/span> Настройка нового режима аутентификации&lt;/a>&lt;/li>
&lt;li>&lt;a href="#административный-пользователь">&lt;span class="section-num">2.7&lt;/span> Административный пользователь&lt;/a>&lt;/li>
&lt;li>&lt;a href="#удалённый-доступ">&lt;span class="section-num">2.8&lt;/span> Удалённый доступ&lt;/a>&lt;/li>
&lt;li>&lt;a href="#зададим-имя-устройства">&lt;span class="section-num">2.9&lt;/span> Зададим имя устройства&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-ssh">&lt;span class="section-num">2.10&lt;/span> Настройка ssh&lt;/a>&lt;/li>
&lt;li>&lt;a href="#поднимем-интерфейсы">&lt;span class="section-num">2.11&lt;/span> Поднимем интерфейсы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сетевые-настройки">&lt;span class="section-num">2.12&lt;/span> Сетевые настройки&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-vtp">&lt;span class="section-num">2.13&lt;/span> Настройка vtp&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-lldp">&lt;span class="section-num">2.14&lt;/span> Настройка lldp&lt;/a>&lt;/li>
&lt;li>&lt;a href="#безопасность">&lt;span class="section-num">2.15&lt;/span> Безопасность&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-других-портов">&lt;span class="section-num">2.16&lt;/span> Настройка других портов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сохранение-конфигурации">&lt;span class="section-num">2.17&lt;/span> Сохранение конфигурации&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#добавление-в-dns">&lt;span class="section-num">3&lt;/span> Добавление в DNS&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#nsupdate">&lt;span class="section-num">3.1&lt;/span> nsupdate&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#подключение-к-системе-мониторинга">&lt;span class="section-num">4&lt;/span> Подключение к системе мониторинга&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#подключение-к-observium">&lt;span class="section-num">4.1&lt;/span> Подключение к Observium&lt;/a>&lt;/li>
&lt;li>&lt;a href="#подключение-к-librenms">&lt;span class="section-num">4.2&lt;/span> Подключение к Librenms&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="подготовка">&lt;span class="section-num">1&lt;/span> Подготовка&lt;/h2>
&lt;ul>
&lt;li>На Linux для конфигурации используется Minicom.&lt;/li>
&lt;li>Запускайте по пользователем &lt;code>root&lt;/code>.&lt;/li>
&lt;li>Для первоначальной конфигурации задайте ключ &lt;code>-s&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">minicom -s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Выставите параметры Скорость/Четность/Биты (Bps/Par/Bits) = 9600 8N1.&lt;/li>
&lt;li>Укажите последовательный порт:
&lt;ul>
&lt;li>последовательный порт: &lt;code>/dev/ttyS[0-3]&lt;/code>;&lt;/li>
&lt;li>порт USB: &lt;code>/dev/ttyUSB0&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Итоговая конфигурация:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">A - Последовательный порт : /dev/ttyUSB0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">B - Размещение lock-файла : /var/lock
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">C - Программа при выходе :
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">D - Программа при запуске :
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">E - Скорость/Чётность/Биты : 9600 8N1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">F - Аппаратное управление потоком : Да
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">G - Программное управление потоком : Нет
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После изменений в меню выбрать &amp;ldquo;Сохранить настройки как dfl&amp;rdquo; или под своим именем.&lt;/li>
&lt;/ul>
&lt;h2 id="базовая-конфигурация">&lt;span class="section-num">2&lt;/span> Базовая конфигурация&lt;/h2>
&lt;h3 id="включение">&lt;span class="section-num">2.1&lt;/span> Включение&lt;/h3>
&lt;ul>
&lt;li>При первом включении, после долгой загрузки коммутатор выдает предложение запустить диалог стартовой конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">Would you like to enter the initial configuration dialog? [yes/no]:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Следует отказаться и выполнить конфигурацию вручную, поэтому отвечаем &lt;code>no&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="переход-в-привилегированный-режим">&lt;span class="section-num">2.2&lt;/span> Переход в привилегированный режим&lt;/h3>
&lt;ul>
&lt;li>Получаем приглашение &lt;code>Switch&amp;gt;&lt;/code>.&lt;/li>
&lt;li>Переходим в привилегированный режим командой &lt;code>enable&lt;/code>.&lt;/li>
&lt;li>Приглашение меняется на &lt;code>#&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Switch&amp;gt;enable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="переход-в-режим-конфигурации">&lt;span class="section-num">2.3&lt;/span> Переход в режим конфигурации&lt;/h3>
&lt;ul>
&lt;li>Перейдём в режим конфигурации коммутатора:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Switch#configure terminal
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="шифрование-паролей">&lt;span class="section-num">2.4&lt;/span> Шифрование паролей&lt;/h3>
&lt;ul>
&lt;li>Установим шифрование паролей, хранящиеся в устройстве в открытом виде:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#service password-encryption&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="административный-доступ">&lt;span class="section-num">2.5&lt;/span> Административный доступ&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Зададим пароль на &lt;em>enable&lt;/em>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#enable secret &amp;lt;пароль&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>secret&lt;/code> : указывает на то, что пароль будет храниться в зашифрованном виде&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>После оператора &lt;code>secret&lt;/code> можно задать представление пароля:&lt;/p>
&lt;ul>
&lt;li>&lt;code>0&lt;/code> : незашифрованный текстовый пароль; используется по умолчанию, поэтому не обязателен;&lt;/li>
&lt;li>&lt;code>4&lt;/code> : используется хеш SHA-256; считается устаревшим;&lt;/li>
&lt;li>&lt;code>5&lt;/code> : используется хеш MD5;&lt;/li>
&lt;li>&lt;code>8&lt;/code> : используется хеш SHA-256;&lt;/li>
&lt;li>&lt;code>9&lt;/code> : используется алгоритм &lt;code>scrypt&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-нового-режима-аутентификации">&lt;span class="section-num">2.6&lt;/span> Настройка нового режима аутентификации&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Настроим режим &lt;em>aaa&lt;/em> (authentication, authorization, accounting):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#aaa new-model&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#aaa authentication login default local&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Настроим подключение по консоли:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#line console 0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#login authentication default&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#no password&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Консоль настроена на использование локальной базы данных имён пользователей и паролей.&lt;/li>
&lt;li>&lt;code>no password&lt;/code> : удалить старую модель паролей.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="административный-пользователь">&lt;span class="section-num">2.7&lt;/span> Административный пользователь&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Зададим пользователя admin и пароль для него:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#username admin privilege 1 secret &amp;lt;пароль&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>privelege&lt;/code> : уровень привилегий для данного пользователя от 0 до 15 (15 самый высокий);&lt;/li>
&lt;li>&lt;code>secret&lt;/code> : пароль будет храниться в зашифрованном виде.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="удалённый-доступ">&lt;span class="section-num">2.8&lt;/span> Удалённый доступ&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Не во всех поставках IOS есть поддержка &lt;em>ssh&lt;/em>. Поэтому приходится использовать &lt;em>telnet&lt;/em>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Настроим порядок аутентификации по &lt;em>telnet&lt;/em>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Настроим подключение по терминальным линиям.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#line vty 0 4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#login authentication default&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#transport input telnet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#no password&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#line vty 5 15&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#login authentication default&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#transport input telnet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#no password&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Терминальные линии, включая telnet, настроены на использование одной и той же локальной базы данных имён пользователей и паролей.&lt;/li>
&lt;li>&lt;code>no password&lt;/code> : удалить старую модель паролей.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="зададим-имя-устройства">&lt;span class="section-num">2.9&lt;/span> Зададим имя устройства&lt;/h3>
&lt;ul>
&lt;li>Имя устройства имеет вид: sw-&amp;lt;помещение&amp;gt;-&amp;lt;номер устройства&amp;gt;, например &lt;code>sw-103-1&lt;/code>.&lt;/li>
&lt;li>Зададим имя устройства:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Switch&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#hostname sw-103-1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#ip domain-name example.com&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-ssh">&lt;span class="section-num">2.10&lt;/span> Настройка ssh&lt;/h3>
&lt;ul>
&lt;li>Если устройство поддерживает ssh, то стоит его настроить.&lt;/li>
&lt;li>Создадим ключ (необходимо, чтобы было настроено имя домена):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#crypto key generate rsa modulus 2048&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Задаёт версию протокола для ssh:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#ip ssh version 2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Указываем время таймаута до автоматического закрытия SSH сессии в 60 минут:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#ip ssh time-out 60&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сбрасываем подключение после 3 неверных паролей:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#ip ssh authentication-retries 3&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Задаём протокол для подключения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#line vty 0 4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#transport input ssh&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Можно также оставить и telnet:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#line vty 0 4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-line&lt;span class="o">)&lt;/span>&lt;span class="c1">#transport input all&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="поднимем-интерфейсы">&lt;span class="section-num">2.11&lt;/span> Поднимем интерфейсы&lt;/h3>
&lt;ul>
&lt;li>Сделаем последний порт транковым:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#interface gigabitEthernet1/0/48&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-if-range&lt;span class="o">)&lt;/span>&lt;span class="c1">#switchport mode trunk&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-if-range&lt;span class="o">)&lt;/span>&lt;span class="c1">#exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="сетевые-настройки">&lt;span class="section-num">2.12&lt;/span> Сетевые настройки&lt;/h3>
&lt;ul>
&lt;li>Зададим адрес 192.168.0.1/24, шлюз 192.168.0.254:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#interface vlan1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-if&lt;span class="o">)&lt;/span>&lt;span class="c1">#no shutdown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-if&lt;span class="o">)&lt;/span>&lt;span class="c1">#ip address 192.168.0.1 255.255.255.0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-if&lt;span class="o">)&lt;/span>&lt;span class="c1">#exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#ip default-gateway 192.168.0.254&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настроим клиента DNS:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#ip name-server 192.168.0.254&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настроим NTP:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#ntp server pool.ntp.org&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверим статус синхронизации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1#sh ntp status
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-vtp">&lt;span class="section-num">2.13&lt;/span> Настройка vtp&lt;/h3>
&lt;ul>
&lt;li>Настройте vtp:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#vtp mode client&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверьте статус vtp:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1#sh vtp status
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-lldp">&lt;span class="section-num">2.14&lt;/span> Настройка lldp&lt;/h3>
&lt;ul>
&lt;li>Если в сети присутствует не только оборудование Cisco, то есть смысл подключить поддержку протокола lldp:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#lldp run&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="безопасность">&lt;span class="section-num">2.15&lt;/span> Безопасность&lt;/h3>
&lt;ul>
&lt;li>Отключим сервер http:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#no ip http server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#no ip http secure-server&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-других-портов">&lt;span class="section-num">2.16&lt;/span> Настройка других портов&lt;/h3>
&lt;ul>
&lt;li>Настроим другие порты для подключения клиентских устройств:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#interface range GigabitEthernet1/0/1 - 46&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-if-range&lt;span class="o">)&lt;/span>&lt;span class="c1">#switchport mode access&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-if-range&lt;span class="o">)&lt;/span>&lt;span class="c1">#switchport access vlan 100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config-if-range&lt;span class="o">)&lt;/span>&lt;span class="c1">#exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="сохранение-конфигурации">&lt;span class="section-num">2.17&lt;/span> Сохранение конфигурации&lt;/h3>
&lt;ul>
&lt;li>Сохраните конфигурацию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1#write mem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="добавление-в-dns">&lt;span class="section-num">3&lt;/span> Добавление в DNS&lt;/h2>
&lt;ul>
&lt;li>Необходимо добавить коммутатор в DNS.&lt;/li>
&lt;/ul>
&lt;h3 id="nsupdate">&lt;span class="section-num">3.1&lt;/span> nsupdate&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/10/28/nsupdate-dynamic-dns-editor/">nsupdate: динамический редактор зон DNS&lt;/a>&lt;/li>
&lt;li>Добавьте адрес коммутатора в DNS:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> -e &lt;span class="s2">&amp;#34;update add sw-103-1.example.com 86400 a 192.168.0.1\nshow\nsend&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> nsupdate -v -k /etc/named/keys/example.com.key
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="подключение-к-системе-мониторинга">&lt;span class="section-num">4&lt;/span> Подключение к системе мониторинга&lt;/h2>
&lt;ul>
&lt;li>Настройте доступ к SMTP.&lt;/li>
&lt;li>Пусть сервер мониторинга имеет адрес: 192.168.0.5.&lt;/li>
&lt;li>Имя коммьюнити для чтения: rocom.
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#access-list 90 permit 192.168.0.5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sw-103-1&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1">#snmp-server community rocom RO 90&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Добавьте коммутатор в свой DNS.&lt;/li>
&lt;/ul>
&lt;h3 id="подключение-к-observium">&lt;span class="section-num">4.1&lt;/span> Подключение к Observium&lt;/h3>
&lt;ul>
&lt;li>Подключитесь к Observium.&lt;/li>
&lt;li>Добавьте коммутатор в список наблюдения в Observium:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@observium ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># /opt/observium/add_device.php sw-103-1 rocom&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@observium ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># /opt/observium/discovery.php -h sw-103-1; /opt/observium/poller.php -h sw-103-1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="подключение-к-librenms">&lt;span class="section-num">4.2&lt;/span> Подключение к Librenms&lt;/h3>
&lt;ul>
&lt;li>Подключитесь к Librenms (см. &lt;a href="https://yamadharma.github.io/ru/post/2023/03/20/librenms-monitoring-system/">Система мониторинга LibreNMS&lt;/a>).&lt;/li>
&lt;li>Добавьте коммутатор в список наблюдения в Librenms:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@librenms ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># /opt/librenms/addhost.php sw-103-1 rocom&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@librenms ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># /opt/librenms/discovery.php -h sw-103-1; /opt/librenms/poller.php -h sw-103-1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Установка пароля может быть выполнена двумя командами &lt;code>password&lt;/code> и &lt;code>secret&lt;/code>. В первом случае пароль хранится в конфигурационном файле в открытом виде, а во втором в зашифрованном. Если использовалась команда &lt;code>password&lt;/code>, необходимо зашифровать пароли, хранящиеся в устройстве в открытом виде с помощью команды &lt;code>service password-encryption&lt;/code> в режиме глобальной конфигурации.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Адресация IPv4 и IPv6. Настройка DHCPv6 для IPv6</title><link>https://yamadharma.github.io/ru/course/nettech/configuring-dhcpv6-ipv6/</link><pubDate>Wed, 17 Aug 2022 19:48:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/nettech/configuring-dhcpv6-ipv6/</guid><description>&lt;p>Настройка DHCPv6 для IPv6. Продолжение &lt;a href="https://yamadharma.github.io/ru/course/nettech/configuring-dhcp-ipv4/">Адресация IPv4 и IPv6. Настройка DHCP для IPv4&lt;/a>.&lt;/p>
&lt;h2 id="описание">&lt;span class="section-num">1&lt;/span> Описание&lt;/h2>
&lt;h3 id="цель">&lt;span class="section-num">1.1&lt;/span> Цель&lt;/h3>
&lt;ul>
&lt;li>Овладеть принципами настройки сетей IPv6.&lt;/li>
&lt;/ul>
&lt;h3 id="задачи">&lt;span class="section-num">1.2&lt;/span> Задачи&lt;/h3>
&lt;ul>
&lt;li>Настроить адресацию IPv6 на хостах и маршрутизаторе.&lt;/li>
&lt;li>Настроить статическую маршрутизацию IPv6.&lt;/li>
&lt;/ul>
&lt;h3 id="схема-сети">&lt;span class="section-num">1.3&lt;/span> Схема сети&lt;/h3>
&lt;figure id="figure-105610801089-1-схема-сети">
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://yamadharma.github.io/ox-hugo/20220817194800-topology.png" alt="&amp;amp;#1056;&amp;amp;#1080;&amp;amp;#1089;. 1.: Схема сети" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;figcaption>
&lt;span class="figure-number">Рис. 1.: &lt;/span>Схема сети
&lt;/figcaption>&lt;/figure>
&lt;h3 id="исходные-данные">&lt;span class="section-num">1.4&lt;/span> Исходные данные&lt;/h3>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 1:&lt;/span>
Таблица адресации
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Устройство&lt;/th>
&lt;th>Интерфейс&lt;/th>
&lt;th>IPv6-адрес&lt;/th>
&lt;th>Длина префикса&lt;/th>
&lt;th>Шлюз по умолчанию&lt;/th>
&lt;th>DNS&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>username-gw-01&lt;/td>
&lt;td>eth1&lt;/td>
&lt;td>2000::1&lt;/td>
&lt;td>64&lt;/td>
&lt;td>&amp;mdash;&lt;/td>
&lt;td>&amp;mdash;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>username-gw-01&lt;/td>
&lt;td>eth2&lt;/td>
&lt;td>2001::1&lt;/td>
&lt;td>64&lt;/td>
&lt;td>&amp;mdash;&lt;/td>
&lt;td>&amp;mdash;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC2&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>Назначен протоколом SLAAC&lt;/td>
&lt;td>64 (SLAAC)&lt;/td>
&lt;td>Назначен протоколом SLAAC&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC2&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>Назначен протоколами SLAAC и DHCPv6&lt;/td>
&lt;td>64&lt;/td>
&lt;td>Назначен маршрутизатором R1&lt;/td>
&lt;td>2000::1 (DHCPv6)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC3&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>Назначен протоколом DHCPv6&lt;/td>
&lt;td>64&lt;/td>
&lt;td>Назначен маршрутизатором R1&lt;/td>
&lt;td>2001::1 (DHCPv6)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="общие-сведения-о-сценариях-настройки">&lt;span class="section-num">1.5&lt;/span> Общие сведения о сценариях настройки&lt;/h3>
&lt;ul>
&lt;li>Динамическое назначение глобальных индивидуальных IPv6-адресов можно настроить тремя способами:
&lt;ul>
&lt;li>Только автоматическая настройка адреса без отслеживания состояния (SLAAC).&lt;/li>
&lt;li>DHCPv6 без отслеживания состояния.&lt;/li>
&lt;li>Адресация DHCPv6 с учётом состояний.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>В случае использования SLAAC (произносится как «слэк»), сервер DHCPv6 не требуется для получения узлами IPv6-адресов.
&lt;ul>
&lt;li>Сервер DHCPv6 можно использовать для получения дополнительной информации, необходимой узлу, например доменного имени или адреса сервера доменных имён (DNS).&lt;/li>
&lt;li>Когда SLAAC используется для назначения IPv6-адресов узлам, а DHCPv6 используется для получения других сетевых параметров, подобная настройка носит название DHCPv6 без отслеживания состояния.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>При использовании DHCPv6 с отслеживанием состояния, сервер DHCP назначает всю информацию, включая IPv6-адрес узла.&lt;/li>
&lt;li>Определение способа получения динамической IPv6-адресации зависит от установленных значений флагов, содержащихся в объявлениях маршрутизатора (сообщениях RA).&lt;/li>
&lt;/ul>
&lt;h3 id="техническое-обеспечение">&lt;span class="section-num">1.6&lt;/span> Техническое обеспечение&lt;/h3>
&lt;ul>
&lt;li>В качестве сервера DHCPv6 используем маршрутизатор VyOS.&lt;/li>
&lt;li>В качестве хоста (клиента) используем &lt;em>Kali Linux CLI&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h4 id="обоснование">&lt;span class="section-num">1.6.1&lt;/span> Обоснование&lt;/h4>
&lt;ul>
&lt;li>Клиент VPCS не поддерживает DHCPv6.&lt;/li>
&lt;/ul>
&lt;h3 id="задание">&lt;span class="section-num">1.7&lt;/span> Задание&lt;/h3>
&lt;ul>
&lt;li>Мониторинг трафика производится на сетевом интерфейсе PC2.&lt;/li>
&lt;li>Мониторинг трафика производится на сетевом интерфейсе PC3.&lt;/li>
&lt;/ul>
&lt;h2 id="порядок-выполнения">&lt;span class="section-num">2&lt;/span> Порядок выполнения&lt;/h2>
&lt;h3 id="настройка-адресации-ipv6-на-маршрутизаторе">&lt;span class="section-num">2.1&lt;/span> Настройка адресации IPv6 на маршрутизаторе&lt;/h3>
&lt;ul>
&lt;li>После перехода в режим конфигурации введём следующие команды:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> interfaces ethernet eth1 address &lt;span class="s1">&amp;#39;2000::1/64&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> interfaces ethernet eth2 address &lt;span class="s1">&amp;#39;2001::1/64&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Проверим конфигурацию интерфейсов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">username@username-gw-01# show interfaces
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="dhcpv6-без-отслеживания-состояния--dhcpv6-stateless-configuration">&lt;span class="section-num">2.2&lt;/span> DHCPv6 без отслеживания состояния (DHCPv6 Stateless configuration)&lt;/h3>
&lt;h4 id="настройка-маршрутизатора">&lt;span class="section-num">2.2.1&lt;/span> Настройка маршрутизатора&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Настроим объявления о маршрутизаторах (Router Advertisements &amp;mdash; RA) на интерфейсе &lt;code>eth1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service router-advert interface eth1 prefix 2000::/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service router-advert interface eth1 other-config-flag
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Опция &lt;code>other-config-flag&lt;/code> означает, что для конфигурации не адресных параметров использует протокол с сохранением состояния.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Добавим конфигурацию DHCP-сервера на маршрутизаторе:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcpv6-server shared-network-name username-stateless
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcpv6-server shared-network-name username-stateless subnet 2000::0/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcpv6-server shared-network-name username-stateless common-options nameserver 2000::1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcpv6-server shared-network-name username-stateless common-options domain-search username.net
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Здесь мы создали:&lt;/p>
&lt;ul>
&lt;li>разделяемую сеть (&lt;code>shared-network-name&lt;/code>) &lt;code>username&lt;/code> (следует заменить на Ваш логин).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Задали информацию:&lt;/p>
&lt;ul>
&lt;li>информация задана в общих опциях (&lt;code>common-options&lt;/code>) для разделяемой сети;&lt;/li>
&lt;li>подсеть (&lt;code>subnet&lt;/code>) &lt;code>2000::/64&lt;/code> нам конфигурировать не нужно, поскольку никакой информации в ней не будет.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="проверка-работоспособности">&lt;span class="section-num">2.2.2&lt;/span> Проверка работоспособности&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Подключитесь к хосту &lt;code>PC2&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Проверьте настройки сети:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC2:/# ifconfig
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@PC2:/# route -n -A inet6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Пропингуйте маршрутизатор:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC2:/# ping 2000::1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Проверьте настройки DNS:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC2:/# cat /etc/resolv.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Получите адрес по DHCPv6:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC2:/# dhclient -6 -S -v eth0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>опция &lt;code>-6&lt;/code>: протокол DHCPv6;&lt;/li>
&lt;li>опция &lt;code>-S&lt;/code>: запрос только информации DHCPv6, не адреса;&lt;/li>
&lt;li>опция &lt;code>-v&lt;/code>: подробная информация;&lt;/li>
&lt;li>операнд &lt;code>eth0&lt;/code>: наименование интерфейса.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Проверьте настройки сети:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC2:/# ifconfig
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@PC2:/# route -n -A inet6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Пропингуйте маршрутизатор:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC2:/# ping 2000::1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Проверьте настройки DNS:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC2:/# cat /etc/resolv.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Посмотрите статистику DHCP-сервера и выданные адреса:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# show dhcpv6 server leases
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="видео-адресация-ipv4-и-ipv6-dot-настройка-dhcpv6-stateless-для-ipv6">&lt;span class="section-num">2.2.3&lt;/span> Видео: Адресация IPv4 и IPv6. Настройка DHCPv6 Stateless для IPv6&lt;/h4>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-cabefd" data-toggle="tab" href="#cabefd"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-dbacfe" data-toggle="tab" href="#dbacfe"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="cabefd" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/6702b8ed46fa55cf77447fc691a9f7f1"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="dbacfe" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/MXN5e1B-8TI?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h3 id="dhcpv6-с-отслеживанием-состояния--dhcpv6-stateful-configuration">&lt;span class="section-num">2.3&lt;/span> DHCPv6 с отслеживанием состояния (DHCPv6 Stateful configuration)&lt;/h3>
&lt;h4 id="настройка-маршрутизатора">&lt;span class="section-num">2.3.1&lt;/span> Настройка маршрутизатора&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Настроим объявления о маршрутизаторах (Router Advertisements &amp;mdash; RA) на интерфейсе &lt;code>eth2&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service router-advert interface eth2 managed-flag
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Опция &lt;code>managed-flag&lt;/code> означает, что хосты использует администрируемый (отслеживающий состояние) протокол для автоматической настройки адресов в дополнение к любым адресам, автоматически настраиваемым с помощью SLAAC.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Добавим конфигурацию DHCP-сервера на маршрутизаторе:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcpv6-server shared-network-name username-stateful
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcpv6-server shared-network-name username-stateful subnet 2001::0/64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcpv6-server shared-network-name username-stateful subnet 2001::0/64 name-server 2001::1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcpv6-server shared-network-name username-stateful subnet 2001::0/64 domain-search username.net
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcpv6-server shared-network-name username-stateful subnet 2001::0/64 address-range start 2001::100 stop 2001::199
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Здесь мы создали:&lt;/p>
&lt;ul>
&lt;li>разделяемую сеть (&lt;code>shared-network-name&lt;/code>) &lt;code>username&lt;/code>;&lt;/li>
&lt;li>подсеть (&lt;code>subnet&lt;/code>) &lt;code>2001::/64&lt;/code>;&lt;/li>
&lt;li>диапазон адресов (&lt;code>range&lt;/code>) с именем &lt;code>hosts&lt;/code>, содержащий адреса &lt;code>2001::100&lt;/code> &amp;ndash; &lt;code>2001::199&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Посмотрите статистику DHCP-сервера и выданные адреса:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# show dhcpv6 server leases
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="проверка-работоспособности">&lt;span class="section-num">2.3.2&lt;/span> Проверка работоспособности&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Подключитесь к хосту &lt;code>PC3&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Проверьте настройки сети:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC3:/# ifconfig
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@PC3:/# route -n -A inet6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Проверьте настройки DNS:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC3:/# cat /etc/resolv.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Получите адрес по DHCPv6:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC3:/# dhclient -6 -v eth0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>опция &lt;code>-6&lt;/code>: протокол DHCPv6;&lt;/li>
&lt;li>опция &lt;code>-v&lt;/code>: подробная информация;&lt;/li>
&lt;li>операнд &lt;code>eth0&lt;/code>: наименование интерфейса.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Проверьте настройки сети:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC3:/# ifconfig
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@PC3:/# route -n -A inet6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Пропингуйте маршрутизатор:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC3:/# ping 2001::1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Проверьте настройки DNS:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@PC3:/# cat /etc/resolv.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Посмотрите статистику DHCP-сервера и выданные адреса:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# show dhcpv6 server leases
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="видео-адресация-ipv4-и-ipv6-dot-настройка-dhcpv6-stateful-для-ipv6">&lt;span class="section-num">2.3.3&lt;/span> Видео: Адресация IPv4 и IPv6. Настройка DHCPv6 Stateful для IPv6&lt;/h4>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-acfdeb" data-toggle="tab" href="#acfdeb"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-afdbec" data-toggle="tab" href="#afdbec"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="acfdeb" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/01cffa5c0d70841abe46eb1ae129322c"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="afdbec" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/2sQrBsF3lms?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Адресация IPv4 и IPv6. Настройка DHCP для IPv4</title><link>https://yamadharma.github.io/ru/course/nettech/configuring-dhcp-ipv4/</link><pubDate>Mon, 15 Aug 2022 20:21:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/nettech/configuring-dhcp-ipv4/</guid><description>&lt;p>Настройка DHCP для IPv4.&lt;/p>
&lt;h2 id="описание">&lt;span class="section-num">1&lt;/span> Описание&lt;/h2>
&lt;h3 id="цель">&lt;span class="section-num">1.1&lt;/span> Цель&lt;/h3>
&lt;ul>
&lt;li>Получение навыков настройки службы DHCP на сетевом оборудовании для распределения адресов IPv4.&lt;/li>
&lt;/ul>
&lt;h3 id="задачи">&lt;span class="section-num">1.2&lt;/span> Задачи&lt;/h3>
&lt;ul>
&lt;li>Сделать предварительную настройку маршрутизатора.
&lt;ul>
&lt;li>Удалить стандартное имя системного пользователя маршрутизатора.&lt;/li>
&lt;li>Настроить интерфейс маршрутизатора: &lt;code>10.0.0.1/24&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Поднять на маршрутизаторе DHCP-сервис по распределению IPv4-адресов из диапазона &lt;code>10.0.0.2&lt;/code> -– &lt;code>10.0.0.253&lt;/code>.&lt;/li>
&lt;li>Настроить получение адреса по DHCP на хосте.&lt;/li>
&lt;li>Исследовать пакеты DHCP.&lt;/li>
&lt;/ul>
&lt;h3 id="схема-сети">&lt;span class="section-num">1.3&lt;/span> Схема сети&lt;/h3>
&lt;figure id="figure-105610801089-1-схема-сети">
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://yamadharma.github.io/ox-hugo/20220815202100-topology.png" alt="&amp;amp;#1056;&amp;amp;#1080;&amp;amp;#1089;. 1.: Схема сети" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;figcaption>
&lt;span class="figure-number">Рис. 1.: &lt;/span>Схема сети
&lt;/figcaption>&lt;/figure>
&lt;h3 id="исходные-данные">&lt;span class="section-num">1.4&lt;/span> Исходные данные&lt;/h3>
&lt;div class="table-caption">
&lt;span class="table-number">&amp;#1058;&amp;#1072;&amp;#1073;&amp;#1083;&amp;#1080;&amp;#1094;&amp;#1072; 1:&lt;/span>
Таблица адресации
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Устройство&lt;/th>
&lt;th>Интерфейс&lt;/th>
&lt;th>IPv4-адрес&lt;/th>
&lt;th>Длина префикса&lt;/th>
&lt;th>Шлюз по умолчанию&lt;/th>
&lt;th>DNS&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>username-gw-01&lt;/td>
&lt;td>eth0&lt;/td>
&lt;td>10.0.0.1&lt;/td>
&lt;td>24&lt;/td>
&lt;td>&amp;mdash;&lt;/td>
&lt;td>&amp;mdash;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>PC1&lt;/td>
&lt;td>NIC&lt;/td>
&lt;td>Назначен протоколом DHCP&lt;/td>
&lt;td>24 (DHCP)&lt;/td>
&lt;td>10.0.0.1 (DHCP)&lt;/td>
&lt;td>10.0.0.1 (DHCP)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="техническое-обеспечение">&lt;span class="section-num">1.5&lt;/span> Техническое обеспечение&lt;/h3>
&lt;ul>
&lt;li>В качестве сервера DHCP используем маршрутизатор VyOS.&lt;/li>
&lt;li>В качестве хоста (клиента) используем VPCS.&lt;/li>
&lt;/ul>
&lt;h3 id="задание">&lt;span class="section-num">1.6&lt;/span> Задание&lt;/h3>
&lt;ul>
&lt;li>Мониторинг трафика производится на сетевом интерфейсе PC1.&lt;/li>
&lt;/ul>
&lt;h2 id="порядок-выполнения">&lt;span class="section-num">2&lt;/span> Порядок выполнения&lt;/h2>
&lt;h3 id="настройка-образа-vyos">&lt;span class="section-num">2.1&lt;/span> Настройка образа VyOS&lt;/h3>
&lt;h4 id="вход-в-систему">&lt;span class="section-num">2.1.1&lt;/span> Вход в систему&lt;/h4>
&lt;ul>
&lt;li>Для входа в систему используем пользователя &lt;code>vyos&lt;/code> и пароль &lt;code>vyos&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h4 id="установка-образа">&lt;span class="section-num">2.1.2&lt;/span> Установка образа&lt;/h4>
&lt;ul>
&lt;li>После загрузки установите систему на диск:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos:~$ install image
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После этого перегрузите маршрутизатор:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos:~$ reboot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="режим-конфигурации">&lt;span class="section-num">2.1.3&lt;/span> Режим конфигурации&lt;/h4>
&lt;ul>
&lt;li>В рабочем режиме в командной строке отображается символ &lt;code>$&lt;/code>.&lt;/li>
&lt;li>В режиме конфигурации в командной строке отображается &lt;code>#&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@vyos#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="сохранение">&lt;span class="section-num">2.1.4&lt;/span> Сохранение&lt;/h4>
&lt;ul>
&lt;li>Посмотреть, какие изменения внесены:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos# compare
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После каждого изменения конфигурации необходимо применить изменения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos# commit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В конце нужно сохранить конфигурацию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="имя-устройства">&lt;span class="section-num">2.1.5&lt;/span> Имя устройства&lt;/h4>
&lt;ul>
&lt;li>Имя хоста может содержать до 63 символов. Имя хоста должно начинаться и заканчиваться буквой или цифрой и содержать в качестве внутренних символов только буквы, цифры или дефис.&lt;/li>
&lt;li>Установите имя хоста в &lt;code>username-gw-01&lt;/code>, где &lt;code>username&lt;/code> &amp;mdash; имя учётной записи:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> system host-name username-gw-01
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Доменное имя должно начинаться и заканчиваться буквой или цифрой и содержать в качестве внутренних символов только буквы, цифры или дефис.&lt;/li>
&lt;li>Установите доменное имя в &lt;code>username.net&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> system domain-name username.net
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="замена-системного-пользователя">&lt;span class="section-num">2.1.6&lt;/span> Замена системного пользователя&lt;/h4>
&lt;ul>
&lt;li>Заменим системного пользователя по умолчанию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> system login user &amp;lt;username&amp;gt; authentication plaintext-password &amp;lt;mysecurepassword&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Отлогинимся:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Залогинимся под новым пользователем.&lt;/li>
&lt;li>Удалим исходного пользователя &lt;code>vyos&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">delete system login user vyos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Зафиксируем изменения, сохраним конфигурацию и выйдем из режима конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># commit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># save&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-адресации-ipv4-на-маршрутизаторе">&lt;span class="section-num">2.2&lt;/span> Настройка адресации IPv4 на маршрутизаторе&lt;/h3>
&lt;ul>
&lt;li>Интерфейс &lt;code>eth0&lt;/code>. Использует статический IP-адрес &lt;code>10.0.0.1/24&lt;/code>.&lt;/li>
&lt;li>После перехода в режим конфигурации введём следующие команды:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> interfaces ethernet eth0 address &lt;span class="s1">&amp;#39;10.0.0.1/24&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-адресации-dhcp-на-маршрутизаторе">&lt;span class="section-num">2.3&lt;/span> Настройка адресации DHCP на маршрутизаторе&lt;/h3>
&lt;ul>
&lt;li>Добавим конфигурацию DHCP-сервера на маршрутизаторе:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name username domain-name username.net
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name username name-server 10.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name username subnet 10.0.0.0/24 default-router 10.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name username subnet 10.0.0.0/24 range hosts start 10.0.0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# &lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name username subnet 10.0.0.0/24 range hosts stop 10.0.0.253
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01# save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Здесь мы создали:
&lt;ul>
&lt;li>разделяемую сеть (&lt;code>shared-network-name&lt;/code>) &lt;code>username&lt;/code>;&lt;/li>
&lt;li>подсеть (&lt;code>subnet&lt;/code>) &lt;code>10.0.0.0/24&lt;/code>;&lt;/li>
&lt;li>диапазон адресов (&lt;code>range&lt;/code>) с именем &lt;code>hosts&lt;/code>, содержащий адреса &lt;code>10.0.0.2&lt;/code>&amp;ndash;&lt;code>10.0.0.253&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Посмотрите статистику DHCP-сервера и выданные адреса:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01$ show dhcp server statistics
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01$ show dhcp server leases
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-хоста">&lt;span class="section-num">2.4&lt;/span> Настройка хоста&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;code>PC1&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">PC1&amp;gt; ip dhcp -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PC1&amp;gt; save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Опцию &lt;code>-d&lt;/code> мы добавили, чтобы видеть декодированные запросы DHCP.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Проверьте конфигурацию IPv4 на узле:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">PC1&amp;gt; show ip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="проверка-работоспособности">&lt;span class="section-num">2.5&lt;/span> Проверка работоспособности&lt;/h3>
&lt;ul>
&lt;li>Пропингуйте маршрутизатор с хоста:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">PC1&amp;gt; ping 10.0.0.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Посмотрите статистику DHCP-сервера и выданные адреса:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01$ show dhcp server statistics
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">username@username-gw-01$ show dhcp server leases
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Посмотрите журнал работы DHCP-сервера:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">username@username-gw-01$ show log &lt;span class="p">|&lt;/span> grep dhcp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="видео-адресация-ipv4-и-ipv6-dot-настройка-dhcp-для-ipv4">&lt;span class="section-num">3&lt;/span> Видео: Адресация IPv4 и IPv6. Настройка DHCP для IPv4&lt;/h2>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-ebcdfa" data-toggle="tab" href="#ebcdfa"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-debfca" data-toggle="tab" href="#debfca"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="ebcdfa" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/371ec8f0d7f915d84eac93e9ad3d1150"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="debfca" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/M_x5hbQ5PYU?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>GNS3. Установка Arista EOS</title><link>https://yamadharma.github.io/ru/post/2022/07/16/gns3-install-arista-eos/</link><pubDate>Sat, 16 Jul 2022 12:14:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/07/16/gns3-install-arista-eos/</guid><description>&lt;p>Установка Arista EOS в GNS3.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#особенности-конфигурации">&lt;span class="section-num">2&lt;/span> Особенности конфигурации&lt;/a>&lt;/li>
&lt;li>&lt;a href="#варианты-образов">&lt;span class="section-num">3&lt;/span> Варианты образов&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#arista-veos">&lt;span class="section-num">3.1&lt;/span> Arista vEOS&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#порядок-установки">&lt;span class="section-num">3.1.1&lt;/span> Порядок установки&lt;/a>&lt;/li>
&lt;li>&lt;a href="#видео-установка-arista-veos-на-gns3">&lt;span class="section-num">3.1.2&lt;/span> Видео: Установка Arista vEOS на GNS3&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#arista-ceos">&lt;span class="section-num">3.2&lt;/span> Arista cEOS&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#порядок-установки">&lt;span class="section-num">3.2.1&lt;/span> Порядок установки&lt;/a>&lt;/li>
&lt;li>&lt;a href="#видео-установка-arista-ceos-на-gns3">&lt;span class="section-num">3.2.2&lt;/span> Видео: Установка Arista cEOS на GNS3&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Репозиторий образов: &lt;a href="https://www.arista.com/en/support/software-download" target="_blank" rel="noopener">https://www.arista.com/en/support/software-download&lt;/a>.
&lt;ul>
&lt;li>Требуется регистрация.&lt;/li>
&lt;li>Блокируются российские ip-адреса.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="особенности-конфигурации">&lt;span class="section-num">2&lt;/span> Особенности конфигурации&lt;/h2>
&lt;ul>
&lt;li>В старших версиях (наверное, начиная с 4.21) конфигурация по умолчанию скорее похожа на маршрутизатор, чем на коммутатор.&lt;/li>
&lt;li>Например, на всех портах установлен режим &lt;code>no switchposrt&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h2 id="варианты-образов">&lt;span class="section-num">3&lt;/span> Варианты образов&lt;/h2>
&lt;h3 id="arista-veos">&lt;span class="section-num">3.1&lt;/span> Arista vEOS&lt;/h3>
&lt;ul>
&lt;li>Виртуализация: qemu.&lt;/li>
&lt;li>Архитектура: i386 и amd64.&lt;/li>
&lt;li>Необходимо RAM: 2048 MB.&lt;/li>
&lt;li>Система команд похожа на Cisco.&lt;/li>
&lt;/ul>
&lt;h4 id="порядок-установки">&lt;span class="section-num">3.1.1&lt;/span> Порядок установки&lt;/h4>
&lt;ul>
&lt;li>Для примера будем рассматривать образы:
&lt;ul>
&lt;li>&lt;code>Aboot-veos-serial-8.0.0.iso&lt;/code>: &lt;a href="https://www.arista.com/custom_data/aws3-explorer/download-s3-file.php?f=/support/download/vEOS-lab/Aboot/Aboot-veos-serial-8.0.0.iso" target="_blank" rel="noopener">https://www.arista.com/custom_data/aws3-explorer/download-s3-file.php?f=/support/download/vEOS-lab/Aboot/Aboot-veos-serial-8.0.0.iso&lt;/a>&lt;/li>
&lt;li>&lt;code>vEOS-lab-4.18.10M&lt;/code>: &lt;a href="https://www.arista.com/custom_data/aws3-explorer/download-s3-file.php?f=/support/download/vEOS-lab/4.18/vEOS-lab-4.18.10M.vmdk" target="_blank" rel="noopener">https://www.arista.com/custom_data/aws3-explorer/download-s3-file.php?f=/support/download/vEOS-lab/4.18/vEOS-lab-4.18.10M.vmdk&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Не следует устанавливать сохранение для образов &lt;em>Qemu&lt;/em> в &lt;em>GNS3&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h4 id="видео-установка-arista-veos-на-gns3">&lt;span class="section-num">3.1.2&lt;/span> Видео: Установка Arista vEOS на GNS3&lt;/h4>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-dfbeca" data-toggle="tab" href="#dfbeca"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-baefcd" data-toggle="tab" href="#baefcd"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="dfbeca" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/b793370d31c54e74d18e7c6a1aff51e2"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="baefcd" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/jWBFlSdN8Lc?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h3 id="arista-ceos">&lt;span class="section-num">3.2&lt;/span> Arista cEOS&lt;/h3>
&lt;ul>
&lt;li>Виртуализация: docker.&lt;/li>
&lt;li>Архитектура: i386 и amd64.&lt;/li>
&lt;li>Система команд похожа на Cisco.&lt;/li>
&lt;/ul>
&lt;h4 id="порядок-установки">&lt;span class="section-num">3.2.1&lt;/span> Порядок установки&lt;/h4>
&lt;ul>
&lt;li>Скачать образ.&lt;/li>
&lt;li>Скопируйте файл на виртуальную машину.&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>cEOS 4.20.5F&lt;/p>
&lt;ul>
&lt;li>Для примера будем рассматривать &lt;code>cEOS-lab-4.20.5F&lt;/code>: &lt;a href="https://www.arista.com/custom_data/aws3-explorer/download-s3-file.php?f=/support/download/cEOS-lab/EOS-4.20.5F/cEOS-lab-4.20.5F.tar.xz" target="_blank" rel="noopener">https://www.arista.com/custom_data/aws3-explorer/download-s3-file.php?f=/support/download/cEOS-lab/EOS-4.20.5F/cEOS-lab-4.20.5F.tar.xz&lt;/a>&lt;/li>
&lt;li>Для версии &lt;code>4.20.5F&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker import cEOS-lab-4.20.5F.tar.xz ceosimage:4.20.5F
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;rm /etc/systemd/system/getty.target.wants/getty@tty1.service&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>docker run --name&lt;span class="o">=&lt;/span>ceos-container -e &lt;span class="nv">CEOS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -e &lt;span class="nv">container&lt;/span>&lt;span class="o">=&lt;/span>docker -e &lt;span class="nv">EOS_PLATFORM&lt;/span>&lt;span class="o">=&lt;/span>ceossim -e &lt;span class="nv">SKIP_ZEROTOUCH_BARRIER_IN_SYSDBINIT&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -e &lt;span class="nv">ETBA&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -e &lt;span class="nv">INTFTYPE&lt;/span>&lt;span class="o">=&lt;/span>eth -i ceosimage:4.20.5F sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker commit --change&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;CMD [&amp;#34;/sbin/init&amp;#34;]&amp;#39;&lt;/span> --change&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;VOLUME /mnt/flash&amp;#39;&lt;/span> ceos-container ceosimage:GNS3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker rm ceos-container
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для работы следует залогиниться под учётной записью &lt;code>admin&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>cEOS новее, чем 4.20.5F&lt;/p>
&lt;ul>
&lt;li>Установите docker-образ (для произвольной версии):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker import cEOS-lab-&amp;lt;version&amp;gt;.tar.xz ceosimage:&amp;lt;version&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;rm /etc/systemd/system/getty.target.wants/getty@tty1.service&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>docker run --name&lt;span class="o">=&lt;/span>ceos-container -e &lt;span class="nv">CEOS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -e &lt;span class="nv">container&lt;/span>&lt;span class="o">=&lt;/span>docker -e &lt;span class="nv">EOS_PLATFORM&lt;/span>&lt;span class="o">=&lt;/span>ceoslab -e &lt;span class="nv">SKIP_ZEROTOUCH_BARRIER_IN_SYSDBINIT&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -e &lt;span class="nv">ETBA&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -e &lt;span class="nv">INTFTYPE&lt;/span>&lt;span class="o">=&lt;/span>eth -i ceosimage:&amp;lt;version&amp;gt; sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker commit --change&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;CMD [&amp;#34;/sbin/init&amp;#34;]&amp;#39;&lt;/span> --change&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;VOLUME /mnt/flash&amp;#39;&lt;/span> ceos-container ceosimage:GNS3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker rm ceos-container
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для примера будем рассматривать &lt;code>cEOS-lab-4.28.1F&lt;/code>: &lt;a href="https://www.arista.com/custom_data/aws3-explorer/download-s3-file.php?f=/support/download/cEOS-lab/EOS-4.28.1F/cEOS-lab-4.28.1F.tar.xz" target="_blank" rel="noopener">https://www.arista.com/custom_data/aws3-explorer/download-s3-file.php?f=/support/download/cEOS-lab/EOS-4.28.1F/cEOS-lab-4.28.1F.tar.xz&lt;/a>&lt;/li>
&lt;li>Например, для версии &lt;code>4.28.1F&lt;/code> команды выглядят следующим образом:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker import cEOS-lab-4.28.1F.tar.xz ceosimage:4.28.1F
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;rm /etc/systemd/system/getty.target.wants/getty@tty1.service&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>docker run --name&lt;span class="o">=&lt;/span>ceos-container -e &lt;span class="nv">CEOS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -e &lt;span class="nv">container&lt;/span>&lt;span class="o">=&lt;/span>docker -e &lt;span class="nv">EOS_PLATFORM&lt;/span>&lt;span class="o">=&lt;/span>ceoslab -e &lt;span class="nv">SKIP_ZEROTOUCH_BARRIER_IN_SYSDBINIT&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -e &lt;span class="nv">ETBA&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -e &lt;span class="nv">INTFTYPE&lt;/span>&lt;span class="o">=&lt;/span>eth -i ceosimage:4.28.1F sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker commit --change&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;CMD [&amp;#34;/sbin/init&amp;#34;]&amp;#39;&lt;/span> --change&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;VOLUME /mnt/flash&amp;#39;&lt;/span> ceos-container ceosimage:GNS3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker rm ceos-container
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>У меня возникли проблемы при загрузке.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="видео-установка-arista-ceos-на-gns3">&lt;span class="section-num">3.2.2&lt;/span> Видео: Установка Arista cEOS на GNS3&lt;/h4>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-cbdafe" data-toggle="tab" href="#cbdafe"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-fcdabe" data-toggle="tab" href="#fcdabe"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="cbdafe" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/b970b6b886687d7a4cf5429b9251b09e"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="fcdabe" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/X3Rd-mSZPQk?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Arista EOS</title><link>https://yamadharma.github.io/ru/post/2022/07/16/arista-eos/</link><pubDate>Sat, 16 Jul 2022 11:30:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/07/16/arista-eos/</guid><description>&lt;p>Операционная система Arista EOS.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#компания-arista">&lt;span class="section-num">1.1&lt;/span> Компания Arista&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#расширяемая-операционная-система">&lt;span class="section-num">2&lt;/span> Расширяемая операционная система&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">2.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#именование-образов">&lt;span class="section-num">2.2&lt;/span> Именование образов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#командный-интерфейс">&lt;span class="section-num">2.3&lt;/span> Командный интерфейс&lt;/a>&lt;/li>
&lt;li>&lt;a href="#загрузчик-aboot">&lt;span class="section-num">2.4&lt;/span> Загрузчик &lt;code>aboot&lt;/code>&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#ethernet-коммутаторы">&lt;span class="section-num">3&lt;/span> Ethernet-коммутаторы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#основные-семейства">&lt;span class="section-num">3.1&lt;/span> Основные семейства&lt;/a>&lt;/li>
&lt;li>&lt;a href="#аппаратная-часть">&lt;span class="section-num">3.2&lt;/span> Аппаратная часть&lt;/a>&lt;/li>
&lt;li>&lt;a href="#основные-конкуренты">&lt;span class="section-num">3.3&lt;/span> Основные конкуренты&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Репозиторий образов: &lt;a href="https://www.arista.com/en/support/software-download" target="_blank" rel="noopener">https://www.arista.com/en/support/software-download&lt;/a>.
&lt;ul>
&lt;li>Требуется регистрация.&lt;/li>
&lt;li>Блокируются российские ip-адреса.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="компания-arista">&lt;span class="section-num">1.1&lt;/span> Компания Arista&lt;/h3>
&lt;ul>
&lt;li>Arista Networks (ранее Arastra) &amp;mdash; американская компьютерная сетевая компания со штаб-квартирой в Санта-Кларе, Калифорния.&lt;/li>
&lt;li>Компания разрабатывает и продаёт многоуровневые сетевые коммутаторы для предоставления программно-определяемых сетей (SDN) для крупных центров обработки данных, облачных вычислений, высокопроизводительных вычислений и высокочастотных торговых сред.&lt;/li>
&lt;li>Собственная сетевая операционная система Arista на базе Linux, расширяемая операционная система (EOS), работает на всех продуктах Arista.&lt;/li>
&lt;/ul>
&lt;h2 id="расширяемая-операционная-система">&lt;span class="section-num">2&lt;/span> Расширяемая операционная система&lt;/h2>
&lt;h3 id="общая-информация">&lt;span class="section-num">2.1&lt;/span> Общая информация&lt;/h3>
&lt;ul>
&lt;li>EOS &amp;mdash; это сетевая операционная система Arista, представляющая собой единый образ, который работает на всех устройствах Arista или на виртуальной машине (ВМ).&lt;/li>
&lt;li>У Arista пока получается делать единый файл с ОС для всей линейки.&lt;/li>
&lt;li>EOS базируется на Fedora.&lt;/li>
&lt;li>Слово &lt;em>Extensible&lt;/em> в &lt;em>Extensible Operating System&lt;/em> по задумке говорит о расширяемости функционала ОС. Достигается это за счет возможности установки своих программ, демонов, скриптов на коммутатор.&lt;/li>
&lt;li>ОС работает на отдельном CPU, что позволяет разделить Control Plane (плоскость управления &amp;mdash; CPU, EOS) и Data Plane (плоскость передачи данных &amp;mdash; ASIC).&lt;/li>
&lt;li>Основные элементы:
&lt;ul>
&lt;li>драйверы, управляющие коммутацией специализированных интегральных схем (ASIC);&lt;/li>
&lt;li>интерфейс командной строки (CLI);&lt;/li>
&lt;li>протоколы маршрутизации;&lt;/li>
&lt;li>состояние коммутатора и его различных протоколов централизовано в процессе &lt;em>Sysdb&lt;/em>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Компоненты, необходимые для работы коммутатора, не обмениваются данными друг с другом напрямую, а делают это только через менеджер-базу &lt;em>Sysdb&lt;/em>.&lt;/li>
&lt;li>Sysdb является как общей шиной для коммуникации между процессами, так и базой данных для рабочей информации этих процессов.&lt;/li>
&lt;li>С помощью работы через Sysdb получается обеспечить большую выживаемость и стабильность. После запуска все сервисы обращаются к Sysdb и, если там уже есть их данные, то они их восстанавливают и продолжают с ними работать.&lt;/li>
&lt;/ul>
&lt;h3 id="именование-образов">&lt;span class="section-num">2.2&lt;/span> Именование образов&lt;/h3>
&lt;ul>
&lt;li>Образы помечаются буквами &lt;em>F&lt;/em> или &lt;em>M&lt;/em>:
&lt;ul>
&lt;li>&lt;code>F&lt;/code> : добавлены новые функции;&lt;/li>
&lt;li>&lt;code>M&lt;/code> : поддерживающий релиз.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="командный-интерфейс">&lt;span class="section-num">2.3&lt;/span> Командный интерфейс&lt;/h3>
&lt;ul>
&lt;li>В EOS у всех запускаемых приложений от Arista имена с заглавной буквы.&lt;/li>
&lt;li>Команды CLI написаны на Python.&lt;/li>
&lt;li>Пользователям можно изменять как встроенные команды, так и писать свои.&lt;/li>
&lt;li>Работа в CLI похожа на работу в CLI Cisco IOS.&lt;/li>
&lt;/ul>
&lt;h3 id="загрузчик-aboot">&lt;span class="section-num">2.4&lt;/span> Загрузчик &lt;code>aboot&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>Aboot &amp;mdash; загрузчик EOS.&lt;/li>
&lt;li>Представляет из себя образ на основе BusyBox.&lt;/li>
&lt;li>Все данные, включая образы EOS и логи, хранятся на встроенной флешке.&lt;/li>
&lt;li>Aboot позволяет получить к ней доступ (а так же доступ к внешним USB накопителям, подключенным к USB портам) и восстановить работоспособность устройства в случае проблем.&lt;/li>
&lt;li>Вход в &lt;em>aboot&lt;/em>: &lt;code>CRTL+C&lt;/code>.** Возможности EOS&lt;/li>
&lt;li>&lt;em>CloudVision&lt;/em> позволяет подключать коммутаторы Arista к XMPP серверу в роли клиентов. В «чаты» с ними можно писать команды CLI, и свитчи будут отвечать результатами их выполнения. Можно добавить несколько устройств в групповой чат и выполнять команды на всех участниках группы одновременно.&lt;/li>
&lt;li>&lt;em>Advanced Event Management&lt;/em> &amp;mdash; это что-то вроде Cisco EEM или Junos Event Scripts: можно запрограммировать действия (команды CLI, выполнение скриптов) на определенные события (например: упал порт).&lt;/li>
&lt;li>&lt;em>Event Monitor&lt;/em> ведет логирование изменений MAC, ARP и таблицы маршрутизации на встроенной флеш памяти в виде базы SQLite.&lt;/li>
&lt;li>&lt;em>eAPI&lt;/em> (External API) позволяет работать с коммутатором по JSON-RPC: ввод и вывод данных в виде JSON объектов.&lt;/li>
&lt;li>&lt;em>Zero Touch Provisioning&lt;/em> (ZTP) позволяет автоматизировать настройку нового коммутатора.
&lt;ul>
&lt;li>Коммутатор с настройками по умолчанию грузится в режиме ZTP и пытается получить сетевые настройки по DHCP.&lt;/li>
&lt;li>Используя &lt;code>option bootfile-name&lt;/code>, которую тоже можно передать по DHCP, коммутатору можно указать URL для загрузки скрипта (на shell, или, например, на языке встроенного CLI, т.к. он является одним из вариантов shell).&lt;/li>
&lt;li>Если скрипт скачается успешно, то устройство его выполнит.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;em>DirectFlow&lt;/em> позволяет задавать правила (такие, как зеркалирование; изменение приоритета, VLAN, SRC/DST и т.д.), применяемые к трафику (на основе, например, SRC/DST (IP, MAC, port) или номера протокола, или номера VLAN и т.д.) из CLI.&lt;/li>
&lt;/ul>
&lt;h2 id="ethernet-коммутаторы">&lt;span class="section-num">3&lt;/span> Ethernet-коммутаторы&lt;/h2>
&lt;h3 id="основные-семейства">&lt;span class="section-num">3.1&lt;/span> Основные семейства&lt;/h3>
&lt;ul>
&lt;li>Серия 7500R: модульное шасси с матрицей виртуальной очереди вывода (VOQ), поддерживающей от 4 до 16 линейных карт хранения и переадресации, обеспечивающее неблокирующую производительность 10GbE, 40GbE и 100GbE на линейной скорости в фабрика 150 Тбит/с, поддерживающая до 576 портов 100GbE с буфером пакетов 384 ГБ. Каждый порт 100GbE также может работать как порт 40GbE или 4 порта 10GbE, что эффективно обеспечивает 2304 порта 10GbE с линейной скоростью и большими таблицами маршрутизации.&lt;/li>
&lt;li>Серии 7300X, 7300X3 и 7320X: модульное шасси с 4 или 8 линейными картами в вариантах 10G, 40G и 100G с пропускной способностью 6,4 Тбит/с на линейную карту для коммутационной сети общей пропускной способностью до 50 Тбит/с для 1024 порта 10GbE. В отличие от серии 7500, 10GBASE-T доступен на линейных картах серии 7300.&lt;/li>
&lt;li>Серия 7280R: Системы 1U и 2U с общей архитектурой для серии 7500R, глубоким буфером VOQ и большими таблицами маршрутизации. Множество различных комбинаций скоростей и портов от 10GbE до 100GbE.&lt;/li>
&lt;li>Серия 7200X: коммутаторы 2U с высокой плотностью и малой задержкой, линейной скоростью 100GbE и 40GbE и пропускной способностью до 12,8 Тбит/с.&lt;/li>
&lt;li>Серия 7170: высокопроизводительные многофункциональные программируемые платформы, набор стационарных 100-гигабитных платформ на основе пакетного процессора Barefoot Tofino, позволяющий настраивать плоскость данных с использованием профилей EOS и P4.&lt;/li>
&lt;li>Серия 7160: программируемый высокопроизводительный диапазон 1U 10 GbE, 25 GbE и 100 GbE с поддержкой технологии AlgoMatch и пакетным процессором с возможностью обновления программного обеспечения.&lt;/li>
&lt;li>Серия 7150S: коммутаторы 1U со сверхнизкой задержкой и линейной скоростью 10 Гбит/с. Задержка между портами составляет менее 380 нс, независимо от размера кадра. В отличие от более ранней серии 7100, микросхему коммутатора можно перепрограммировать для добавления новых функций, работающих на скорости передачи данных, таких как виртуальная расширяемая локальная сеть (VXLAN) или преобразование сетевых адресов (NAT/PAT).&lt;/li>
&lt;li>Серия 7130 (7130, 7130L, 7130E): 1U и 2U коммутатор уровня 1 со сверхнизкой задержкой и программируемые коммутаторы. Коммутация уровня 1 обеспечивает зеркалирование и программно-определяемую маршрутизацию портов с задержкой между портами от 4 нс в зависимости от физического расстояния. Варианты E и L позволяют запускать пользовательские приложения FPGA непосредственно на коммутаторе с задержкой от порта к FPGA всего 3 нс. Эта серия происходит из оригинальной линейки продуктов Metamako, приобретенной Arista Networks в 2018 году, и работает на комбинации операционных систем MOS и Arista EOS.&lt;/li>
&lt;li>Серии 7050X и 7060X: 1U и 2U сквозные коммутаторы с линейной скоростью 10GbE/25GbE, 40GbE и 100GbE с малой задержкой. Эта линейка продуктов предлагает более высокую плотность портов, чем серия 7150, в более широком выборе вариантов портов и скоростей интерфейса за счет немного увеличенной задержки (1 мкс или меньше).&lt;/li>
&lt;li>Серии 7050X и 7060X основаны на коммерческих микросхемах Broadcom Trident и Tomahawk.&lt;/li>
&lt;li>Серия 7020R: линейная скорость хранения и пересылки 1U с возможностью выбора между коммутатором наверху стойки 1 Гбит/с с восходящими каналами 6x10 Гбит или 10 Гбит/с с восходящими каналами 100 Гбит/с. Эти коммутаторы используют архитектуру глубокого буфера с 3 ГБ пакетной памяти.&lt;/li>
&lt;li>Серия 7010: коммутатор 1U с низким энергопотреблением (52 Вт) с пропускной способностью 1 Гбит/с, устанавливаемый поверх стойки, с 4 восходящими линиями связи по 10 Гбит/с.&lt;/li>
&lt;li>Устройства Arista представляют собой многоуровневые коммутаторы, которые поддерживают ряд протоколов уровня 3, включая IGMP, протокол резервирования виртуального маршрутизатора (VRRP), RIP, BGP, OSPF, IS-IS и OpenFlow.&lt;/li>
&lt;/ul>
&lt;h3 id="аппаратная-часть">&lt;span class="section-num">3.2&lt;/span> Аппаратная часть&lt;/h3>
&lt;ul>
&lt;li>Data Plane (плоскость передачи данных) в коммутаторах Arista построен с использованием интегральных схем специального назначения &amp;mdash; ASIC.&lt;/li>
&lt;li>По типу происхождения ASIC делятся на:
&lt;ul>
&lt;li>&lt;em>Custom Silicon&lt;/em> &amp;mdash; микросхемы, которые обычно разработаны и произведены компанией, которая производит на этих чипах коммутаторы.&lt;/li>
&lt;li>&lt;em>Merchant Silicon&lt;/em> &amp;mdash; «коммерчески» доступные микросхемы, разработанные и произведенные компанией, которая не производит на них коммутаторы.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Arista не разрабатывает собственные ASIC, а использует в своих коммутаторах Merchant Silicon от Intel и Broadcom.&lt;/li>
&lt;/ul>
&lt;h3 id="основные-конкуренты">&lt;span class="section-num">3.3&lt;/span> Основные конкуренты&lt;/h3>
&lt;ul>
&lt;li>Extreme Networks.&lt;/li>
&lt;li>Juniper Networks.&lt;/li>
&lt;li>Cisco Systems.&lt;/li>
&lt;li>Hewlett Packard Enterprise (подразделение Aruba Networks).&lt;/li>
&lt;/ul></description></item><item><title>Маршрутизация. VyOS</title><link>https://yamadharma.github.io/ru/post/2022/06/03/routing-vyos/</link><pubDate>Fri, 03 Jun 2022 12:24:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/06/03/routing-vyos/</guid><description>&lt;p>Программный маршрутизатор &lt;em>VyOS&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#модель-распространения">&lt;span class="section-num">2&lt;/span> Модель распространения&lt;/a>&lt;/li>
&lt;li>&lt;a href="#функционал">&lt;span class="section-num">3&lt;/span> Функционал&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурирование">&lt;span class="section-num">4&lt;/span> Конфигурирование&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#быстрая-настройка">&lt;span class="section-num">4.1&lt;/span> Быстрая настройка&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#режим-конфигурации">&lt;span class="section-num">4.1.1&lt;/span> Режим конфигурации&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сохранение">&lt;span class="section-num">4.1.2&lt;/span> Сохранение&lt;/a>&lt;/li>
&lt;li>&lt;a href="#конфигурация-интерфейсов">&lt;span class="section-num">4.1.3&lt;/span> Конфигурация интерфейсов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#ssh-сервер">&lt;span class="section-num">4.1.4&lt;/span> SSH-сервер&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сервисы-dhcp-и-dns">&lt;span class="section-num">4.1.5&lt;/span> Сервисы DHCP и DNS&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-nat">&lt;span class="section-num">4.1.6&lt;/span> Настройка NAT&lt;/a>&lt;/li>
&lt;li>&lt;a href="#брандмауэр">&lt;span class="section-num">4.1.7&lt;/span> Брандмауэр&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-безопасности">&lt;span class="section-num">4.1.8&lt;/span> Настройка безопасности&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#образы-операционной-системы">&lt;span class="section-num">5&lt;/span> Образы операционной системы&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайты.
&lt;ul>
&lt;li>Сайт: &lt;a href="https://vyos.net/" target="_blank" rel="noopener">https://vyos.net/&lt;/a>.&lt;/li>
&lt;li>Коммерческий сайт: &lt;a href="https://vyos.io/" target="_blank" rel="noopener">https://vyos.io/&lt;/a>.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/vyos/vyos-1x" target="_blank" rel="noopener">https://github.com/vyos/vyos-1x&lt;/a>.&lt;/li>
&lt;li>Документация: &lt;a href="https://docs.vyos.io/" target="_blank" rel="noopener">https://docs.vyos.io/&lt;/a>.&lt;/li>
&lt;li>Документация в &lt;code>pdf&lt;/code>: &lt;a href="https://buildmedia.readthedocs.org/media/pdf/vyos/latest/vyos.pdf" target="_blank" rel="noopener">https://buildmedia.readthedocs.org/media/pdf/vyos/latest/vyos.pdf&lt;/a>.&lt;/li>
&lt;li>Блог: &lt;a href="https://blog.vyos.io/" target="_blank" rel="noopener">https://blog.vyos.io/&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Поддержка Vagrant (см. &lt;a href="https://yamadharma.github.io/ru/post/2021/11/12/using-vagrant/">Использование vagrant&lt;/a>).
&lt;ul>
&lt;li>Образы для Vagrant: &lt;a href="https://app.vagrantup.com/vyos/" target="_blank" rel="noopener">https://app.vagrantup.com/vyos/&lt;/a>.&lt;/li>
&lt;li>Плагин для Vagrant: &lt;a href="https://github.com/higebu/vagrant-vyos" target="_blank" rel="noopener">https://github.com/higebu/vagrant-vyos&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Форк проекта &lt;em>Vyatta&lt;/em>.&lt;/li>
&lt;li>Реализовано на основе дистрибутива Debian.&lt;/li>
&lt;li>Система команд похожа на Juniper.&lt;/li>
&lt;li>Подсистема маршрутизации основывается на проекте FRRouting (см. &lt;a href="https://yamadharma.github.io/ru/post/2022/06/02/routing-frrouting/">Маршрутизация. FRRouting&lt;/a>).&lt;/li>
&lt;li>Можно купить аппаратную платформу, на которой возможно развернуть маршрутизатор:
&lt;ul>
&lt;li>&lt;a href="https://aliexpress.ru/popular/vyos-router.html" target="_blank" rel="noopener">https://aliexpress.ru/popular/vyos-router.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="модель-распространения">&lt;span class="section-num">2&lt;/span> Модель распространения&lt;/h2>
&lt;ul>
&lt;li>Можно собрать самому из исходного кода (см. &lt;a href="https://yamadharma.github.io/ru/post/2023/07/06/vyos-build/">Сборка образа VyOS&lt;/a>).&lt;/li>
&lt;li>Образы LTS можно скачивать за плату.
&lt;ul>
&lt;li>Для учебных заведений и некоммерческих организаций предоставляется бесплатный доступ к релизам.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Образы для rolling релизов можно скачивать бесплатно.&lt;/li>
&lt;li>Rolling релизы:
&lt;ul>
&lt;li>&lt;a href="https://vyos.net/get/?dir=rolling/current/amd64" target="_blank" rel="noopener">https://vyos.net/get/?dir=rolling/current/amd64&lt;/a>;&lt;/li>
&lt;li>&lt;a href="https://community.vyos.net/get/" target="_blank" rel="noopener">https://community.vyos.net/get/&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Блокируются российский ip-адреса.&lt;/li>
&lt;/ul>
&lt;h2 id="функционал">&lt;span class="section-num">3&lt;/span> Функционал&lt;/h2>
&lt;ul>
&lt;li>VPN: Dynamic Multipoint VPN (DMVPN), GRE, IPSec, IPSec VTI, OpenVPN (server и client), WireGuard.&lt;/li>
&lt;li>Туннели: L2TP, L2TPv3, VXLAN, PPTP, GRE, IPIP, SIT, IPIP, IPIP6, IP6IP6.&lt;/li>
&lt;li>Интерфейсы L2/L3: Ethernet Bridge, 802.1Q VLAN, QinQ, Агрегация портов (LACP и статическая).&lt;/li>
&lt;li>Маршрутизация: BGP, OSPF, OSPFv3, RIP, RIPng протоколов динамической маршрутизации.&lt;/li>
&lt;li>Статическая маршрутизация и Policy-Based Routing (PBR)&lt;/li>
&lt;li>QoS для приоритизации трафика.&lt;/li>
&lt;li>Высокая доступность: VRRP, WAN load-balancing, Conntrack-Sync, Clustering.&lt;/li>
&lt;li>Сетевые сервисы: DHCP, DNS recursive server, Network Address Translation, IGMP-Proxy, NTP, LLDP, mDNS repeater, PPPoE server, TFTP сервер.&lt;/li>
&lt;li>Фильтрация трафика: Zone-based firewall, stateful firewall.&lt;/li>
&lt;li>Политики: Shaping, Rate limiting, Priority-based queues.&lt;/li>
&lt;/ul>
&lt;h2 id="конфигурирование">&lt;span class="section-num">4&lt;/span> Конфигурирование&lt;/h2>
&lt;h3 id="быстрая-настройка">&lt;span class="section-num">4.1&lt;/span> Быстрая настройка&lt;/h3>
&lt;ul>
&lt;li>Настроим шлюз NAT с двумя сетевыми интерфейсами (&lt;code>eth0&lt;/code> и &lt;code>eth1&lt;/code>).&lt;/li>
&lt;/ul>
&lt;h4 id="режим-конфигурации">&lt;span class="section-num">4.1.1&lt;/span> Режим конфигурации&lt;/h4>
&lt;ul>
&lt;li>В рабочем режиме в командной строке отображается символ &lt;code>$&lt;/code>.&lt;/li>
&lt;li>В режиме конфигурации в командной строке отображается &lt;code>#&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos$ configure
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@vyos#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="сохранение">&lt;span class="section-num">4.1.2&lt;/span> Сохранение&lt;/h4>
&lt;ul>
&lt;li>После каждого изменения конфигурации необходимо применить изменения:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">commit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В конце нужно сохранить конфигурацию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="конфигурация-интерфейсов">&lt;span class="section-num">4.1.3&lt;/span> Конфигурация интерфейсов&lt;/h4>
&lt;ul>
&lt;li>Внешний интерфейс: &lt;code>eth0&lt;/code>. Он получает адрес по DHCP.&lt;/li>
&lt;li>Внутренний интерфейс: &lt;code>eth1&lt;/code>. Использует статический IP-адрес &lt;code>192.168.0.1/24&lt;/code>.&lt;/li>
&lt;li>После перехода в режим конфигурации введём следующие команды:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> interfaces ethernet eth0 address dhcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> interfaces ethernet eth0 description &lt;span class="s1">&amp;#39;OUTSIDE&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> interfaces ethernet eth1 address &lt;span class="s1">&amp;#39;192.168.0.1/24&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> interfaces ethernet eth1 description &lt;span class="s1">&amp;#39;INSIDE&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="ssh-сервер">&lt;span class="section-num">4.1.4&lt;/span> SSH-сервер&lt;/h4>
&lt;ul>
&lt;li>Включим ssh-сервер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service ssh port &lt;span class="s1">&amp;#39;22&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="сервисы-dhcp-и-dns">&lt;span class="section-num">4.1.5&lt;/span> Сервисы DHCP и DNS&lt;/h4>
&lt;ul>
&lt;li>Сетевые настройки:
&lt;ul>
&lt;li>Шлюз по умолчанию и адрес сервера DNS: &lt;code>192.168.0.1/24&lt;/code>.&lt;/li>
&lt;li>Диапазон адресов для статических назначений: &lt;code>192.168.0.2/24&lt;/code>&amp;ndash;&lt;code>192.168.0.8/24&lt;/code>.&lt;/li>
&lt;li>Диапазон адресов для клиентов DHCP: &lt;code>192.168.0.9&lt;/code>&amp;ndash;&lt;code>192.168.0.254&lt;/code>.&lt;/li>
&lt;li>Время аренды адреса DHCP: однин день (86400 секунд).&lt;/li>
&lt;li>Рекурсор DNS могут использовать только хосты из локальной сети.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Конфигурация:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name LAN subnet 192.168.0.0/24 default-router &lt;span class="s1">&amp;#39;192.168.0.1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name LAN subnet 192.168.0.0/24 name-server &lt;span class="s1">&amp;#39;192.168.0.1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name LAN subnet 192.168.0.0/24 domain-name &lt;span class="s1">&amp;#39;vyos.net&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name LAN subnet 192.168.0.0/24 lease &lt;span class="s1">&amp;#39;86400&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name LAN subnet 192.168.0.0/24 range &lt;span class="m">0&lt;/span> start 192.168.0.9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service dhcp-server shared-network-name LAN subnet 192.168.0.0/24 range &lt;span class="m">0&lt;/span> stop &lt;span class="s1">&amp;#39;192.168.0.254&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service dns forwarding cache-size &lt;span class="s1">&amp;#39;0&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service dns forwarding listen-address &lt;span class="s1">&amp;#39;192.168.0.1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service dns forwarding allow-from &lt;span class="s1">&amp;#39;192.168.0.0/24&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="настройка-nat">&lt;span class="section-num">4.1.6&lt;/span> Настройка NAT&lt;/h4>
&lt;ul>
&lt;li>Настроим правила SNAT для внутренней сети:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> nat &lt;span class="nb">source&lt;/span> rule &lt;span class="m">100&lt;/span> outbound-interface &lt;span class="s1">&amp;#39;eth0&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> nat &lt;span class="nb">source&lt;/span> rule &lt;span class="m">100&lt;/span> &lt;span class="nb">source&lt;/span> address &lt;span class="s1">&amp;#39;192.168.0.0/24&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> nat &lt;span class="nb">source&lt;/span> rule &lt;span class="m">100&lt;/span> translation address masquerade
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="брандмауэр">&lt;span class="section-num">4.1.7&lt;/span> Брандмауэр&lt;/h4>
&lt;ul>
&lt;li>Блокируем весь трафик, который не был инициирован со стороны локальной сети:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-IN default-action &lt;span class="s1">&amp;#39;drop&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-IN rule &lt;span class="m">10&lt;/span> action &lt;span class="s1">&amp;#39;accept&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-IN rule &lt;span class="m">10&lt;/span> state established &lt;span class="s1">&amp;#39;enable&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-IN rule &lt;span class="m">10&lt;/span> state related &lt;span class="s1">&amp;#39;enable&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL default-action &lt;span class="s1">&amp;#39;drop&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">10&lt;/span> action &lt;span class="s1">&amp;#39;accept&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">10&lt;/span> state established &lt;span class="s1">&amp;#39;enable&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">10&lt;/span> state related &lt;span class="s1">&amp;#39;enable&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">20&lt;/span> action &lt;span class="s1">&amp;#39;accept&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">20&lt;/span> icmp type-name &lt;span class="s1">&amp;#39;echo-request&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">20&lt;/span> protocol &lt;span class="s1">&amp;#39;icmp&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">20&lt;/span> state new &lt;span class="s1">&amp;#39;enable&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Разрешим SSH-доступ к маршрутизатору с внешнего интерфейса.&lt;/li>
&lt;li>Ограничивают до 4 запросов в минуту (для блокировки взлома грубой силой):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">30&lt;/span> action &lt;span class="s1">&amp;#39;drop&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">30&lt;/span> destination port &lt;span class="s1">&amp;#39;22&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">30&lt;/span> protocol &lt;span class="s1">&amp;#39;tcp&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">30&lt;/span> recent count &lt;span class="s1">&amp;#39;4&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">30&lt;/span> recent &lt;span class="nb">time&lt;/span> &lt;span class="s1">&amp;#39;60&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">30&lt;/span> state new &lt;span class="s1">&amp;#39;enable&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">31&lt;/span> action &lt;span class="s1">&amp;#39;accept&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">31&lt;/span> destination port &lt;span class="s1">&amp;#39;22&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">31&lt;/span> protocol &lt;span class="s1">&amp;#39;tcp&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> firewall name OUTSIDE-LOCAL rule &lt;span class="m">31&lt;/span> state new &lt;span class="s1">&amp;#39;enable&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Применим политики брандмауэра:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> interfaces ethernet eth0 firewall in name &lt;span class="s1">&amp;#39;OUTSIDE-IN&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> interfaces ethernet eth0 firewall &lt;span class="nb">local&lt;/span> name &lt;span class="s1">&amp;#39;OUTSIDE-LOCAL&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Зафиксируем изменения, сохраним конфигурацию и выйдем из режима конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@vyos# save
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Saving configuration to &lt;span class="s1">&amp;#39;/config/config.boot&amp;#39;&lt;/span>...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Done
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@vyos# &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@vyos$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="настройка-безопасности">&lt;span class="section-num">4.1.8&lt;/span> Настройка безопасности&lt;/h4>
&lt;ul>
&lt;li>Заменим системного пользователя по умолчанию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> system login user myvyosuser authentication plaintext-password mysecurepassword
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настроим аутентификацию на основе ключа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> system login user myvyosuser authentication public-keys myusername@mydesktop &lt;span class="nb">type&lt;/span> ssh-rsa
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> system login user myvyosuser authentication public-keys myusername@mydesktop key contents_of_id_rsa.pub
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Удалим исходного пользователя &lt;code>vyos&lt;/code> полностью отключим аутентификацию по паролю для SSH:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">delete system login user vyos
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> service ssh disable-password-authentication
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Зафиксируем изменения, сохраним конфигурацию и выйдем из режима конфигурации:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vyos@vyos# commit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@vyos# save
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Saving configuration to &lt;span class="s1">&amp;#39;/config/config.boot&amp;#39;&lt;/span>...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Done
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@vyos# &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vyos@vyos$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="образы-операционной-системы">&lt;span class="section-num">5&lt;/span> Образы операционной системы&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/gns3-vyos/">GNS3. Образ VyOS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/07/06/vyos-build/">Сборка образа VyOS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/07/16/vyos-build-repository/">Сборка образа VyOS. Репозиторий&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Маршрутизация. FRRouting</title><link>https://yamadharma.github.io/ru/post/2022/06/02/routing-frrouting/</link><pubDate>Thu, 02 Jun 2022 19:30:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/06/02/routing-frrouting/</guid><description>&lt;p>Проект &lt;em>FRRouting&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#протоколы">&lt;span class="section-num">2&lt;/span> Протоколы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-в-gns3">&lt;span class="section-num">3&lt;/span> Установка в GNS3&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#видео-установка-приложения--маршрутизатор-frr">&lt;span class="section-num">3.1&lt;/span> Видео: Установка приложения (маршрутизатор FRR)&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://frrouting.org/" target="_blank" rel="noopener">https://frrouting.org/&lt;/a>.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/FRRouting/frr" target="_blank" rel="noopener">https://github.com/FRRouting/frr&lt;/a>&lt;/li>
&lt;li>Документация: &lt;a href="https://docs.frrouting.org/" target="_blank" rel="noopener">https://docs.frrouting.org/&lt;/a>.&lt;/li>
&lt;li>Форк проекта Quagga.&lt;/li>
&lt;li>Для управления используется оболочка &lt;em>vtysh&lt;/em>, система команд которой похожа на Cisco.&lt;/li>
&lt;/ul>
&lt;h2 id="протоколы">&lt;span class="section-num">2&lt;/span> Протоколы&lt;/h2>
&lt;ul>
&lt;li>Border Gateway Protocol (BGP)&lt;/li>
&lt;li>Intermediate System to Intermediate System (IS-IS)&lt;/li>
&lt;li>Open Shortest Path First (OSPF)&lt;/li>
&lt;li>Protocol-Independent Multicast (PIM)&lt;/li>
&lt;li>Routing Information Protocol (RIP)&lt;/li>
&lt;li>Routing Information Protocol next generation (RIPng)&lt;/li>
&lt;li>Enhanced Interior Gateway Routing Protocol (EIGRP)&lt;/li>
&lt;li>Next Hop Resolution Protocol (NHRP)&lt;/li>
&lt;li>Bidirectional Forwarding Detection (BFD)&lt;/li>
&lt;li>Policy-based Routing (PBR)&lt;/li>
&lt;/ul>
&lt;h2 id="установка-в-gns3">&lt;span class="section-num">3&lt;/span> Установка в GNS3&lt;/h2>
&lt;h3 id="видео-установка-приложения--маршрутизатор-frr">&lt;span class="section-num">3.1&lt;/span> Видео: Установка приложения (маршрутизатор FRR)&lt;/h3>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-fedcab" data-toggle="tab" href="#fedcab"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-abdfce" data-toggle="tab" href="#abdfce"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="fedcab" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/f90d7b7baaea8a0d5549384327207060"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="abdfce" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/BgIzJo18yp8?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Средство натурного моделирования сетей GNS3</title><link>https://yamadharma.github.io/ru/post/2022/05/07/gns3-network-simulation-tool/</link><pubDate>Sat, 07 May 2022 15:54:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/05/07/gns3-network-simulation-tool/</guid><description>&lt;p>Средство натурного моделирования сетей GNS3.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#доступность">&lt;span class="section-num">2&lt;/span> Доступность&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">3&lt;/span> Установка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#оборудование">&lt;span class="section-num">4&lt;/span> Оборудование&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://gns3.com/" target="_blank" rel="noopener">https://gns3.com/&lt;/a>&lt;/li>
&lt;li>Репозитории: &lt;a href="https://github.com/GNS3" target="_blank" rel="noopener">https://github.com/GNS3&lt;/a>&lt;/li>
&lt;li>GNS (Graphical Network Simulator).&lt;/li>
&lt;li>Цифра &lt;em>3&lt;/em> является частью названия.&lt;/li>
&lt;li>Позволяет использовать виртуализацию Dynamips, QEMU, Docker.&lt;/li>
&lt;li>Приложение запускается на машине, на которой находится.&lt;/li>
&lt;li>Для эмуляции устройств может использовать виртуальные машины, расположенные на этом же хосте или удалённо.&lt;/li>
&lt;li>Поддерживается работа в Linux, Windows и Mac OS X.&lt;/li>
&lt;li>Можно использовать те же инструменты, что и для работы с реальными системами.&lt;/li>
&lt;li>Поддерживает оборудование различных производителей: Cisco, Juniper, MikroTik, Aruba (HPE), Fortinet и др.&lt;/li>
&lt;li>Содержит несколько собственных сетевых примитивов (имитационные модели): конечные узлы (Virtual PC Simulator, VPCS), коммутаторы и т.д.&lt;/li>
&lt;/ul>
&lt;h2 id="доступность">&lt;span class="section-num">2&lt;/span> Доступность&lt;/h2>
&lt;ul>
&lt;li>Распространяется бесплатно по лицензии GNU GPL.&lt;/li>
&lt;li>Образы эмулируемых систем доступны в магазине: &lt;a href="https://gns3.com/marketplace" target="_blank" rel="noopener">https://gns3.com/marketplace&lt;/a>.&lt;/li>
&lt;li>Вернее, там доступны файлы описания для GNS3 и ссылки (если есть) на скачивание образов.&lt;/li>
&lt;li>Также в магазине есть и платный контент.&lt;/li>
&lt;/ul>
&lt;h2 id="установка">&lt;span class="section-num">3&lt;/span> Установка&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/gns3-virtualbox/">GNS3 на Virtualbox&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/11/29/gns3-hyperv/">GNS3 на Hyper-V&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/10/08/gns3-kvm-disable/">Отключение поддержки KVM в GNS3&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="оборудование">&lt;span class="section-num">4&lt;/span> Оборудование&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/05/07/gns3-appliances/">GNS3. Образы оборудования&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>GNS3. Образы оборудования</title><link>https://yamadharma.github.io/ru/post/2022/05/07/gns3-appliances/</link><pubDate>Sat, 07 May 2022 15:47:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/05/07/gns3-appliances/</guid><description>&lt;ul>
&lt;li>Сам по себе GNS3 является интерфейсом к виртуальным машинам.&lt;/li>
&lt;li>Для моделирования сетей необходимо иметь ещё и образы операционных систем для разного оборудования.&lt;/li>
&lt;/ul>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сетевые-сервисы">&lt;span class="section-num">2&lt;/span> Сетевые сервисы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#networkers-toolkit">&lt;span class="section-num">2.1&lt;/span> Networkers&amp;rsquo; Toolkit&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#клиенты">&lt;span class="section-num">3&lt;/span> Клиенты&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#webterm">&lt;span class="section-num">3.1&lt;/span> Webterm&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#коммутаторы">&lt;span class="section-num">4&lt;/span> Коммутаторы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#arista-eos">&lt;span class="section-num">4.1&lt;/span> Arista EOS&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#arista-veos">&lt;span class="section-num">4.1.1&lt;/span> Arista vEOS&lt;/a>&lt;/li>
&lt;li>&lt;a href="#arista-ceos">&lt;span class="section-num">4.1.2&lt;/span> Arista cEOS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#exos">&lt;span class="section-num">4.2&lt;/span> EXOS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#маршрутизаторы">&lt;span class="section-num">5&lt;/span> Маршрутизаторы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#freertr">&lt;span class="section-num">5.1&lt;/span> FreeRTR&lt;/a>&lt;/li>
&lt;li>&lt;a href="#frrouting">&lt;span class="section-num">5.2&lt;/span> FRRouting&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#образы-для-gns3">&lt;span class="section-num">5.2.1&lt;/span> Образы для GNS3&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#vyos">&lt;span class="section-num">5.3&lt;/span> VyOS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Образы эмулируемых систем доступны в магазине: &lt;a href="https://gns3.com/marketplace" target="_blank" rel="noopener">https://gns3.com/marketplace&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h2 id="сетевые-сервисы">&lt;span class="section-num">2&lt;/span> Сетевые сервисы&lt;/h2>
&lt;h3 id="networkers-toolkit">&lt;span class="section-num">2.1&lt;/span> Networkers&amp;rsquo; Toolkit&lt;/h3>
&lt;ul>
&lt;li>Название: Toolkit.&lt;/li>
&lt;li>Магазин: &lt;a href="https://gns3.com/marketplace/appliances/networkers-toolkit" target="_blank" rel="noopener">https://gns3.com/marketplace/appliances/networkers-toolkit&lt;/a>.&lt;/li>
&lt;li>Виртуализация: docker.&lt;/li>
&lt;li>Предоставляет услуги:
&lt;ul>
&lt;li>www (nginx);&lt;/li>
&lt;li>ftp (vsftpd);&lt;/li>
&lt;li>tftp (tftpd);&lt;/li>
&lt;li>syslog (rsyslog);&lt;/li>
&lt;li>dhcp (isc-dhcpd);&lt;/li>
&lt;li>snmp server (snmpd + snmptrapd).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="клиенты">&lt;span class="section-num">3&lt;/span> Клиенты&lt;/h2>
&lt;h3 id="webterm">&lt;span class="section-num">3.1&lt;/span> Webterm&lt;/h3>
&lt;ul>
&lt;li>Магазин: &lt;a href="https://www.gns3.com/marketplace/appliances/webterm" target="_blank" rel="noopener">https://www.gns3.com/marketplace/appliances/webterm&lt;/a>.&lt;/li>
&lt;li>Виртуализация: docker.&lt;/li>
&lt;li>ОС: Debian Linux.&lt;/li>
&lt;li>Набор сетевых инструментов:
&lt;ul>
&lt;li>веб-броузер Firefox;&lt;/li>
&lt;li>утилиты: net-tools, iproute2, ping, traceroute, curl, host, iperf3, mtr, socat, ssh client, tcpdump;&lt;/li>
&lt;li>инструменты тестирования многоадресной рассылки msend/mreceive.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="коммутаторы">&lt;span class="section-num">4&lt;/span> Коммутаторы&lt;/h2>
&lt;h3 id="arista-eos">&lt;span class="section-num">4.1&lt;/span> Arista EOS&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/07/16/arista-eos/">Arista EOS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/07/16/gns3-install-arista-eos/">GNS3. Установка Arista EOS&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="arista-veos">&lt;span class="section-num">4.1.1&lt;/span> Arista vEOS&lt;/h4>
&lt;ul>
&lt;li>Виртуализация: qemu.&lt;/li>
&lt;li>Архитектура: i386 и amd64.&lt;/li>
&lt;li>Необходимо RAM: 2048 MB.&lt;/li>
&lt;li>Система команд похожа на Cisco.&lt;/li>
&lt;/ul>
&lt;h4 id="arista-ceos">&lt;span class="section-num">4.1.2&lt;/span> Arista cEOS&lt;/h4>
&lt;ul>
&lt;li>Виртуализация: docker.&lt;/li>
&lt;li>Архитектура: i386 и amd64.&lt;/li>
&lt;li>Система команд похожа на Cisco.&lt;/li>
&lt;/ul>
&lt;h3 id="exos">&lt;span class="section-num">4.2&lt;/span> EXOS&lt;/h3>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/extremenetworks/Virtual_EXOS" target="_blank" rel="noopener">https://github.com/extremenetworks/Virtual_EXOS&lt;/a>&lt;/li>
&lt;li>Как устанавливать на GNS3: &lt;a href="https://github.com/extremenetworks/Virtual_EXOS/blob/master/GNS3_EXOS-VM_Guide.md" target="_blank" rel="noopener">https://github.com/extremenetworks/Virtual_EXOS/blob/master/GNS3_EXOS-VM_Guide.md&lt;/a>&lt;/li>
&lt;li>Аналоги в других операционных системах для коммутаторов: &lt;a href="https://documentation.extremenetworks.com/CLI_X-Ref/1.0/CLI_X-Ref_Guide_1.0.pdf" target="_blank" rel="noopener">https://documentation.extremenetworks.com/CLI_X-Ref/1.0/CLI_X-Ref_Guide_1.0.pdf&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="маршрутизаторы">&lt;span class="section-num">5&lt;/span> Маршрутизаторы&lt;/h2>
&lt;h3 id="freertr">&lt;span class="section-num">5.1&lt;/span> FreeRTR&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="http://www.freertr.org/" target="_blank" rel="noopener">http://www.freertr.org/&lt;/a>.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/rare-freertr/freeRtr" target="_blank" rel="noopener">https://github.com/rare-freertr/freeRtr&lt;/a>.&lt;/li>
&lt;li>Виртуализация: qemu.&lt;/li>
&lt;li>Необходимо RAM: 2048 MB.&lt;/li>
&lt;li>Реализован на Java.&lt;/li>
&lt;li>Система команд похожа на Cisco.&lt;/li>
&lt;/ul>
&lt;h3 id="frrouting">&lt;span class="section-num">5.2&lt;/span> FRRouting&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/06/02/routing-frrouting/">Маршрутизация. FRRouting&lt;/a>&lt;/li>
&lt;li>Магазин: &lt;a href="https://www.gns3.com/marketplace/appliances/frr" target="_blank" rel="noopener">https://www.gns3.com/marketplace/appliances/frr&lt;/a>.&lt;/li>
&lt;li>Сайт: &lt;a href="https://frrouting.org/" target="_blank" rel="noopener">https://frrouting.org/&lt;/a>.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/FRRouting/frr" target="_blank" rel="noopener">https://github.com/FRRouting/frr&lt;/a>&lt;/li>
&lt;li>Виртуализация: qemu.&lt;/li>
&lt;li>Необходимо RAM: 256 MB.&lt;/li>
&lt;li>Система команд похожа на Cisco.&lt;/li>
&lt;/ul>
&lt;h4 id="образы-для-gns3">&lt;span class="section-num">5.2.1&lt;/span> Образы для GNS3&lt;/h4>
&lt;ul>
&lt;li>Неофициальные образы делаются для GNS3: &lt;a href="https://sourceforge.net/projects/gns-3/files/Qemu%20Appliances/" target="_blank" rel="noopener">https://sourceforge.net/projects/gns-3/files/Qemu%20Appliances/&lt;/a>.&lt;/li>
&lt;li>Фактически это Debian с подсистемой FRRouting. При запуске сразу открывается оболочка &lt;em>vtysh&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h3 id="vyos">&lt;span class="section-num">5.3&lt;/span> VyOS&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/06/03/routing-vyos/">Маршрутизация. VyOS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/nettech/gns3-vyos/">GNS3. Образ VyOS&lt;/a>&lt;/li>
&lt;li>Магазин: &lt;a href="https://www.gns3.com/marketplace/appliances/vyos" target="_blank" rel="noopener">https://www.gns3.com/marketplace/appliances/vyos&lt;/a>.&lt;/li>
&lt;li>Сайт: &lt;a href="https://vyos.net/" target="_blank" rel="noopener">https://vyos.net/&lt;/a>.&lt;/li>
&lt;li>Коммерческий сайт: &lt;a href="https://vyos.io/" target="_blank" rel="noopener">https://vyos.io/&lt;/a>.&lt;/li>
&lt;li>Репозиторий: &lt;a href="https://github.com/vyos/vyos-1x" target="_blank" rel="noopener">https://github.com/vyos/vyos-1x&lt;/a>&lt;/li>
&lt;li>Виртуализация: qemu.&lt;/li>
&lt;li>Необходимо RAM: 512 MB.&lt;/li>
&lt;li>Система команд похожа на Juniper.&lt;/li>
&lt;li>Образы для vyos-1.1: &lt;a href="https://sourceforge.net/projects/gns-3/files/Qemu%20Appliances/" target="_blank" rel="noopener">https://sourceforge.net/projects/gns-3/files/Qemu%20Appliances/&lt;/a>.&lt;/li>
&lt;/ul></description></item><item><title>Работа без учётной записи в Cisco Packet Tracer</title><link>https://yamadharma.github.io/ru/post/2022/05/07/cisco-packet-tracer-accountless/</link><pubDate>Sat, 07 May 2022 15:39:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/05/07/cisco-packet-tracer-accountless/</guid><description>&lt;p>В начале марта 2022 года Cisco заблокировало учётные записи пользователей из России и доступ с ip-адресов России.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-патча-на-packet-tracer">&lt;span class="section-num">2&lt;/span> Установка патча на Packet Tracer&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#видео-установка-патча-на-packet-tracer--windows">&lt;span class="section-num">2.1&lt;/span> Видео: Установка патча на Packet Tracer (Windows)&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#запуск-packet-tracer-без-сети">&lt;span class="section-num">3&lt;/span> Запуск Packet Tracer без сети&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#linux">&lt;span class="section-num">3.1&lt;/span> Linux&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#программа-firejail">&lt;span class="section-num">3.1.1&lt;/span> Программа &lt;em>firejail&lt;/em>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#запуск-packet-tracer-без-сети-на-linux">&lt;span class="section-num">3.1.2&lt;/span> Запуск Packet Tracer без сети на Linux&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#windows">&lt;span class="section-num">3.2&lt;/span> Windows&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#блокировка-доступа-в-интернет">&lt;span class="section-num">3.2.1&lt;/span> Блокировка доступа в интернет&lt;/a>&lt;/li>
&lt;li>&lt;a href="#запуск-packet-tracer-без-сети-на-windows">&lt;span class="section-num">3.2.2&lt;/span> Запуск Packet Tracer без сети на Windows&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Начиная с версии PacketTracer7 для работы требуется наличие учётной записи в Network Academy: &lt;a href="https://www.netacad.com/" target="_blank" rel="noopener">https://www.netacad.com/&lt;/a> или &lt;a href="https://skillsforall.com/" target="_blank" rel="noopener">https://skillsforall.com/&lt;/a>.&lt;/li>
&lt;li>В начале марта 2022 года Cisco заблокировало учётные записи пользователей из России и доступ с ip-адресов России.&lt;/li>
&lt;/ul>
&lt;h2 id="установка-патча-на-packet-tracer">&lt;span class="section-num">2&lt;/span> Установка патча на Packet Tracer&lt;/h2>
&lt;ul>
&lt;li>Можно установить патч, отключающий проверку учётной записи при запуске PacketTracer.&lt;/li>
&lt;li>Один из вариантов находится по адресу &lt;a href="https://rutracker.org/forum/viewtopic.php?t=6103761" target="_blank" rel="noopener">https://rutracker.org/forum/viewtopic.php?t=6103761&lt;/a>.&lt;/li>
&lt;li>Патч копируется в каталог с программой и запускается от имени администратора.&lt;/li>
&lt;li>Перед этим следует отключить (временно) антивирус.&lt;/li>
&lt;/ul>
&lt;h3 id="видео-установка-патча-на-packet-tracer--windows">&lt;span class="section-num">2.1&lt;/span> Видео: Установка патча на Packet Tracer (Windows)&lt;/h3>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/JVmEkkMFI_g?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h2 id="запуск-packet-tracer-без-сети">&lt;span class="section-num">3&lt;/span> Запуск Packet Tracer без сети&lt;/h2>
&lt;ul>
&lt;li>При запуске Packet Tracer на компьютере без доступа к сети учётная запись не проверяется.&lt;/li>
&lt;/ul>
&lt;h3 id="linux">&lt;span class="section-num">3.1&lt;/span> Linux&lt;/h3>
&lt;h4 id="программа-firejail">&lt;span class="section-num">3.1.1&lt;/span> Программа &lt;em>firejail&lt;/em>&lt;/h4>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Общая информация&lt;/p>
&lt;ul>
&lt;li>Ограничивает среду выполнения ненадёжных приложений с помощью &lt;em>пространств имён Linux&lt;/em> и &lt;em>seccomp-bpf&lt;/em>.&lt;/li>
&lt;li>Сайт: &lt;a href="https://firejail.wordpress.com/" target="_blank" rel="noopener">https://firejail.wordpress.com/&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Установка&lt;/p>
&lt;ul>
&lt;li>Gentoo
&lt;ul>
&lt;li>Стандартная версия
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge sys-apps/firejail
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Версия с долговременной поддержкой
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge sys-apps/firejail-lts
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="3">
&lt;li>
&lt;p>Запуск Packet Tracer&lt;/p>
&lt;ul>
&lt;li>Запускаем с отключённой сетью:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">firejail --net&lt;span class="o">=&lt;/span>none --noprofile packettracer
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="запуск-packet-tracer-без-сети-на-linux">&lt;span class="section-num">3.1.2&lt;/span> Запуск Packet Tracer без сети на Linux&lt;/h4>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-cfbead" data-toggle="tab" href="#cfbead"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-fdeacb" data-toggle="tab" href="#fdeacb"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="cfbead" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/d20632ba64ccef923c3295da9fe19a7d"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="fdeacb" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/OvfE3MsH-Jo?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h3 id="windows">&lt;span class="section-num">3.2&lt;/span> Windows&lt;/h3>
&lt;h4 id="блокировка-доступа-в-интернет">&lt;span class="section-num">3.2.1&lt;/span> Блокировка доступа в интернет&lt;/h4>
&lt;ul>
&lt;li>Откройте &lt;em>Панель управления&lt;/em>.&lt;/li>
&lt;li>Откройте пункт &lt;em>Брандмауэр Защитника Windows&lt;/em> или просто &lt;em>Брандмауэр Windows&lt;/em>.&lt;/li>
&lt;li>В открывшемся окне нажмите &lt;em>Дополнительные параметры&lt;/em>.&lt;/li>
&lt;li>Откроется окно брандмауэра в режиме повышенной безопасности.&lt;/li>
&lt;li>Выберите &lt;em>Правило для исходящего подключения&lt;/em>, а потом &amp;mdash; &lt;em>Создать правило&lt;/em>.&lt;/li>
&lt;li>Выберите &lt;em>Для программы&lt;/em> и нажмите &lt;em>Далее&lt;/em>.&lt;/li>
&lt;li>Укажите путь к исполняемому файлу программы, которой нужно запретить доступ в Интернет.&lt;/li>
&lt;li>В следующем окне оставьте отмеченным пункт /Блокировать подключение.&lt;/li>
&lt;li>В следующем окне отметьте, для каких сетей выполнять блокировку. Если для любых &amp;mdash; оставьте отмеченными все пункты.&lt;/li>
&lt;li>Укажите понятное для вас имя правила и нажмите &lt;em>Готово&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h4 id="запуск-packet-tracer-без-сети-на-windows">&lt;span class="section-num">3.2.2&lt;/span> Запуск Packet Tracer без сети на Windows&lt;/h4>
&lt;nav>
&lt;div class="nav nav-tabs" id="nav-tab" role="tablist">
&lt;a class="nav-item nav-link active "
id="nav-cdeabf" data-toggle="tab" href="#cdeabf"
role="tab" aria-controls="nav-home" aria-selected="true">RuTube&lt;/a>
&lt;a class="nav-item nav-link "
id="nav-cbdfae" data-toggle="tab" href="#cbdfae"
role="tab" aria-controls="nav-home" aria-selected="true">Youtube&lt;/a>
&lt;/div>
&lt;/nav>
&lt;div class="tab-content" id="nav-tab-content">
&lt;div class="tab-pane fade show active " id="cdeabf" role="tabpanel" aria-labelledby="nav-1">
&lt;div class="embed video-player">
&lt;iframe class="rutube-player" type="text/html"
width="720" height="405"
src="https://rutube.ru/play/embed/220a90487801dbf81e5016f6c1d213be"
webkitAllowFullScreen mozallowfullscreen allowFullScreen
allow="clipboard-write" frameborder="0">
&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;div class="tab-pane fade show " id="cbdfae" role="tabpanel" aria-labelledby="nav-1">
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/DMkFAMDjLIo?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Средства моделирования сетей для целей обучения</title><link>https://yamadharma.github.io/ru/post/2022/05/06/network-modeling-tools/</link><pubDate>Fri, 06 May 2022 18:59:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/05/06/network-modeling-tools/</guid><description>&lt;p>Инструментарий по изучению сетей.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#прагматика">&lt;span class="section-num">1&lt;/span> Прагматика&lt;/a>&lt;/li>
&lt;li>&lt;a href="#симуляторы">&lt;span class="section-num">2&lt;/span> Симуляторы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#cisco-packet-tracer">&lt;span class="section-num">2.1&lt;/span> Cisco Packet Tracer&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">2.1.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#доступность">&lt;span class="section-num">2.1.2&lt;/span> Доступность&lt;/a>&lt;/li>
&lt;li>&lt;a href="#выводы">&lt;span class="section-num">2.1.3&lt;/span> Выводы&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#boson-netsim">&lt;span class="section-num">2.2&lt;/span> Boson NetSim&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">2.2.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#доступность">&lt;span class="section-num">2.2.2&lt;/span> Доступность&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#эмуляторы">&lt;span class="section-num">3&lt;/span> Эмуляторы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#dynamips-plus-dynagen">&lt;span class="section-num">3.1&lt;/span> Dynamips + Dynagen&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">3.1.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#доступность">&lt;span class="section-num">3.1.2&lt;/span> Доступность&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#iou-iol-plus-webiol">&lt;span class="section-num">3.2&lt;/span> IOU/IOL + WebIOL&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">3.2.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#доступность">&lt;span class="section-num">3.2.2&lt;/span> Доступность&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#виртуальные-машины-для-qemu-virtualbox-vmware">&lt;span class="section-num">3.3&lt;/span> Виртуальные машины для QEMU, Virtualbox, VMWare&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#виртуальные-лаборатории">&lt;span class="section-num">4&lt;/span> Виртуальные лаборатории&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#cisco-virl">&lt;span class="section-num">4.1&lt;/span> Cisco VIRL&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">4.1.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#доступность">&lt;span class="section-num">4.1.2&lt;/span> Доступность&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#gns3">&lt;span class="section-num">4.2&lt;/span> GNS3&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">4.2.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#доступность">&lt;span class="section-num">4.2.2&lt;/span> Доступность&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#eve-ng">&lt;span class="section-num">4.3&lt;/span> EVE-NG&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">4.3.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#доступность">&lt;span class="section-num">4.4&lt;/span> Доступность&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="прагматика">&lt;span class="section-num">1&lt;/span> Прагматика&lt;/h2>
&lt;ul>
&lt;li>Для реализации курса по администрированию сетей необходимо было подобрать средство для построения моделей сетей.&lt;/li>
&lt;li>Били рассмотрены несколько вариантов инструментария.&lt;/li>
&lt;/ul>
&lt;h2 id="симуляторы">&lt;span class="section-num">2&lt;/span> Симуляторы&lt;/h2>
&lt;ul>
&lt;li>Симуляторы являются средством имитационного моделирования.&lt;/li>
&lt;li>Имитируют работу оригинального программного обеспечения.&lt;/li>
&lt;li>Предназначены только для воспроизведения внешнего поведения исследуемого объекта.&lt;/li>
&lt;li>Реализуют не весь функционал.&lt;/li>
&lt;li>Требуют умеренное количество ресурсов.&lt;/li>
&lt;li>Достаточны для первоначального обучения.&lt;/li>
&lt;/ul>
&lt;h3 id="cisco-packet-tracer">&lt;span class="section-num">2.1&lt;/span> Cisco Packet Tracer&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">2.1.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2021/08/18/cisco-packet-tracer-software/">Программное средство Cisco Packet Tracer&lt;/a>&lt;/li>
&lt;li>Самый известный симулятор для Cisco.&lt;/li>
&lt;li>Легковесен.&lt;/li>
&lt;li>Имитирует наиболее популярное оборудование Cisco.&lt;/li>
&lt;li>Имеется отладчик, позволяющий пошагово визуализировать прохождение пакета в сети.&lt;/li>
&lt;/ul>
&lt;h4 id="доступность">&lt;span class="section-num">2.1.2&lt;/span> Доступность&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2021/08/18/cisco-packet-tracer-software/">Программное средство Cisco Packet Tracer&lt;/a>&lt;/li>
&lt;li>Отсутствует в свободном доступе.&lt;/li>
&lt;li>Доступен студентам &lt;em>Сетевой академии Cisco (Cisco Network Academy)&lt;/em>.&lt;/li>
&lt;li>Для получения Packet Tracer необходимо зарегистрироваться на свободном курсе &lt;em>Сетевой академии Cisco&lt;/em>.&lt;/li>
&lt;li>Для работы требует регистрации на сайте.&lt;/li>
&lt;li>На данный момент доступ к сайту из России блокирован (см. &lt;a href="https://yamadharma.github.io/ru/post/2022/05/07/cisco-packet-tracer-accountless/">Работа без учётной записи в Cisco Packet Tracer&lt;/a>).&lt;/li>
&lt;/ul>
&lt;h4 id="выводы">&lt;span class="section-num">2.1.3&lt;/span> Выводы&lt;/h4>
&lt;ul>
&lt;li>Из-за рисков ограничения работоспособности программного средства &lt;em>Cisco Packet Tracer&lt;/em> не может быть рекомендован как средство обучения.&lt;/li>
&lt;/ul>
&lt;h3 id="boson-netsim">&lt;span class="section-num">2.2&lt;/span> Boson NetSim&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">2.2.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://www.boson.com/netsim-cisco-network-simulator" target="_blank" rel="noopener">https://www.boson.com/netsim-cisco-network-simulator&lt;/a>&lt;/li>
&lt;li>Ориентирован на подготовку к экзаменам треков CCNA и CCNP официальной сертификации Cisco.&lt;/li>
&lt;li>Представляет собой сборник лабораторных работ, сгруппированный по темам экзамена.&lt;/li>
&lt;li>Доступен только под Windows.&lt;/li>
&lt;/ul>
&lt;h4 id="доступность">&lt;span class="section-num">2.2.2&lt;/span> Доступность&lt;/h4>
&lt;ul>
&lt;li>Симулятор платный: цена колеблется от 179 до 349 долларов за разные версии экзаменов.&lt;/li>
&lt;/ul>
&lt;h2 id="эмуляторы">&lt;span class="section-num">3&lt;/span> Эмуляторы&lt;/h2>
&lt;ul>
&lt;li>Эмуляторы являются средствами натурного моделирования.&lt;/li>
&lt;li>Предназначены для запуска оригинального или слегка изменённого программного обеспечения.&lt;/li>
&lt;li>Могут быть небольшие отличия относительно работы оригинального оборудования.&lt;/li>
&lt;li>Рассматриваемые средства эмулируют среду исполнения.&lt;/li>
&lt;li>Для работы необходимо иметь доступ к образам операционных систем сетевого оборудования.&lt;/li>
&lt;/ul>
&lt;h3 id="dynamips-plus-dynagen">&lt;span class="section-num">3.1&lt;/span> Dynamips + Dynagen&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">3.1.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Dynamips &amp;mdash; эмулятор маршрутизаторов Cisco.&lt;/li>
&lt;li>Dynagen &amp;mdash; консольный фронтенд.&lt;/li>
&lt;li>Работает в Windows, Linix, Mac OS X.&lt;/li>
&lt;li>Лицензия GNU GPLv2.&lt;/li>
&lt;li>Позволяет запускать виртуальную машину с оригинальным образом ОС от старых маршрутизаторов Cisco семейств 1700, 3725, 7200 и некоторых других.&lt;/li>
&lt;li>Не может работать с прошивками коммутаторов Cisco.&lt;/li>
&lt;/ul>
&lt;h4 id="доступность">&lt;span class="section-num">3.1.2&lt;/span> Доступность&lt;/h4>
&lt;ul>
&lt;li>Образы для оборудования Cisco свободно не доступны.&lt;/li>
&lt;/ul>
&lt;h3 id="iou-iol-plus-webiol">&lt;span class="section-num">3.2&lt;/span> IOU/IOL + WebIOL&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">3.2.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Cisco IOS on UNIX (IOU) и его вариация Cisco IOS on Linux (IOL).&lt;/li>
&lt;li>Представляет собой двоичный исполняемый файл, содержащий операционную систему L3 коммутатора Catalyst (L2IOU) или многофункционального маршрутизатора &amp;mdash; ISR (L3IOU), скомпилированную производителем для запуска в UNIX/Linux.&lt;/li>
&lt;li>Характеризуется низким потреблением ресурсов.&lt;/li>
&lt;li>WebIOL &amp;mdash; официальный графический фронтенд.&lt;/li>
&lt;/ul>
&lt;h4 id="доступность">&lt;span class="section-num">3.2.2&lt;/span> Доступность&lt;/h4>
&lt;ul>
&lt;li>IOU разработан Cisco Systems для внутреннего использования.&lt;/li>
&lt;li>Доступен только сотрудникам и партнёрам фирмы.&lt;/li>
&lt;/ul>
&lt;h3 id="виртуальные-машины-для-qemu-virtualbox-vmware">&lt;span class="section-num">3.3&lt;/span> Виртуальные машины для QEMU, Virtualbox, VMWare&lt;/h3>
&lt;ul>
&lt;li>Многие фирмы выпускают операционные системы в виде &lt;em>Virtual Appliance&lt;/em>.&lt;/li>
&lt;li>Это образы виртуальных машин, предназначенные для запуска в распространённых гипервизорах: QEMU, VMWare, Hyper-V и др.&lt;/li>
&lt;/ul>
&lt;h2 id="виртуальные-лаборатории">&lt;span class="section-num">4&lt;/span> Виртуальные лаборатории&lt;/h2>
&lt;ul>
&lt;li>Для исследования возникает потребность запускать несколько устройств и рассматривать их взаимодействие.&lt;/li>
&lt;li>Для удобства работы существуют программные продукты, которые позволяют автоматизировать создание виртуальных сетевых окружений и снабдить его графическим интерфейсом.&lt;/li>
&lt;/ul>
&lt;h3 id="cisco-virl">&lt;span class="section-num">4.1&lt;/span> Cisco VIRL&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">4.1.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Сайт: &lt;a href="http://virl.cisco.com" target="_blank" rel="noopener">http://virl.cisco.com&lt;/a>&lt;/li>
&lt;li>Cisco VIRL (Virtual Internet Routing Lab).&lt;/li>
&lt;li>Распространяется в виде виртуальной машины или пакета для установки на &lt;em>голое железо&lt;/em>.&lt;/li>
&lt;li>Включает в себя учебные версии образов IOSv, IOSvL2, IOS XRv, NX-OSv, CSR1000v, ASAv.&lt;/li>
&lt;li>Для работы с VIRL используется собственный GUI клиент VM Maestro.&lt;/li>
&lt;/ul>
&lt;h4 id="доступность">&lt;span class="section-num">4.1.2&lt;/span> Доступность&lt;/h4>
&lt;ul>
&lt;li>Продаётся по подписке.&lt;/li>
&lt;/ul>
&lt;h3 id="gns3">&lt;span class="section-num">4.2&lt;/span> GNS3&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">4.2.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://gns3.com/" target="_blank" rel="noopener">https://gns3.com/&lt;/a>&lt;/li>
&lt;li>Репозитории: &lt;a href="https://github.com/GNS3" target="_blank" rel="noopener">https://github.com/GNS3&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/05/07/gns3-network-simulation-tool/">Средство натурного моделирования сетей GNS3&lt;/a>&lt;/li>
&lt;li>GNS (Graphical Network Simulator).&lt;/li>
&lt;li>Цифра &lt;em>3&lt;/em> является частью названия.&lt;/li>
&lt;li>Позволяет использовать виртуализацию Dynamips, QEMU, Docker.&lt;/li>
&lt;li>Приложение запускается на машине, на которой находится.&lt;/li>
&lt;li>Для эмуляции устройств может использовать виртуальные машины, расположенные на этом же хосте или удалённо.&lt;/li>
&lt;li>Поддерживается работа в Linux, Windows и Mac OS X.&lt;/li>
&lt;li>Можно использовать те же инструменты, что и для работы с реальными системами.&lt;/li>
&lt;li>Поддерживает оборудование различных производителей: Cisco, Juniper, MikroTik, Aruba (HPE), Fortinet и др.&lt;/li>
&lt;li>Содержит несколько собственных сетевых примитивов (имитационные модели): конечные узлы (Virtual PC Simulator, VPCS), коммутаторы и т.д.&lt;/li>
&lt;/ul>
&lt;h4 id="доступность">&lt;span class="section-num">4.2.2&lt;/span> Доступность&lt;/h4>
&lt;ul>
&lt;li>Распространяется бесплатно по лицензии GNU GPL.&lt;/li>
&lt;li>Образы эмулируемых систем доступны в магазине: &lt;a href="https://gns3.com/marketplace" target="_blank" rel="noopener">https://gns3.com/marketplace&lt;/a> (см. &lt;a href="https://yamadharma.github.io/ru/post/2022/05/07/gns3-appliances/">GNS3. Образы оборудования&lt;/a>).&lt;/li>
&lt;li>Вернее, там доступны файлы описания для GNS3 и ссылки (если есть) на скачивание образов.&lt;/li>
&lt;li>Также в магазине есть и платный контент.&lt;/li>
&lt;/ul>
&lt;h3 id="eve-ng">&lt;span class="section-num">4.3&lt;/span> EVE-NG&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">4.3.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://www.eve-ng.net/" target="_blank" rel="noopener">https://www.eve-ng.net/&lt;/a>&lt;/li>
&lt;li>EVE-NG (The Emulated Virtual Environment&amp;ndash;–Next Generation).&lt;/li>
&lt;li>Предыдущие названия: iou-web, UNetLab.&lt;/li>
&lt;li>По своему функционалу очень похожа на GNS3.&lt;/li>
&lt;li>Распространяется в виде образа виртуальной машины.&lt;/li>
&lt;/ul>
&lt;h3 id="доступность">&lt;span class="section-num">4.4&lt;/span> Доступность&lt;/h3>
&lt;ul>
&lt;li>Предлагается несколько редакция:
&lt;ul>
&lt;li>Community
&lt;ul>
&lt;li>бесплатная;&lt;/li>
&lt;li>ограничение по числу узлов на лабораторную работу &amp;mdash; 63 узла;&lt;/li>
&lt;li>устаревшая версия.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Professional
&lt;ul>
&lt;li>платная;&lt;/li>
&lt;li>ограничение по числу узлов на лабораторную работу &amp;mdash; 1024 узла.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Learning Center
&lt;ul>
&lt;li>платная;&lt;/li>
&lt;li>ограничение по числу узлов на лабораторную работу &amp;mdash; 1024 узла;&lt;/li>
&lt;li>возможно разделение пользователей по ролям.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Механизм HSTS</title><link>https://yamadharma.github.io/ru/post/2022/05/03/hsts-mechanism/</link><pubDate>Tue, 03 May 2022 20:05:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/05/03/hsts-mechanism/</guid><description>&lt;p>&lt;em>HSTS&lt;/em> (&lt;em>HTTP Strict Transport Security&lt;/em>) &amp;mdash; механизм, принудительно активирующий защищённое соединение через протокол HTTPS.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#механизм-работы">&lt;span class="section-num">2&lt;/span> Механизм работы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#типы-политик">&lt;span class="section-num">3&lt;/span> Типы политик&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#динамические-политики">&lt;span class="section-num">3.1&lt;/span> Динамические политики&lt;/a>&lt;/li>
&lt;li>&lt;a href="#статические-политики">&lt;span class="section-num">3.2&lt;/span> Статические политики&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#проверка-работы">&lt;span class="section-num">4&lt;/span> Проверка работы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#поддержка-на-стороне-сервера">&lt;span class="section-num">5&lt;/span> Поддержка на стороне сервера&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#apache">&lt;span class="section-num">5.1&lt;/span> Apache&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#включение-hsts">&lt;span class="section-num">5.1.1&lt;/span> Включение HSTS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#поддержка-на-стороне-клиента">&lt;span class="section-num">6&lt;/span> Поддержка на стороне клиента&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#chrome">&lt;span class="section-num">6.1&lt;/span> Chrome&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#отключение-hsts">&lt;span class="section-num">6.1.1&lt;/span> Отключение HSTS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>HSTS защищает от даунгрейд-атак на TLS.&lt;/li>
&lt;li>Указывает броузеру всегда использовать TLS для сайтов с соответствующими политиками.&lt;/li>
&lt;li>Стандарт описан в RFC 6797.&lt;/li>
&lt;/ul>
&lt;h2 id="механизм-работы">&lt;span class="section-num">2&lt;/span> Механизм работы&lt;/h2>
&lt;ul>
&lt;li>Сервер сообщает о политиках HSTS с помощью специального заголовка при подключении по протоколу &lt;em>https&lt;/em>.&lt;/li>
&lt;li>При подключении по /http заголовок HSTS игнорируется.&lt;/li>
&lt;li>Когда сайт применяет политику HSTS, пользовательские броузеры, корректно воспринимающие заголовок HSTS, должны:
&lt;ul>
&lt;li>Автоматически автономно преобразовывать все http-ссылки на данный сайт в https-ссылки.&lt;/li>
&lt;li>Если безопасность соединения https не может быть проверена (в частности, если TLS-сертификат сервера не подписан доверенным ключом), будет показано сообщение об ошибке, и пользователь будет лишен доступа к сайту.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="типы-политик">&lt;span class="section-num">3&lt;/span> Типы политик&lt;/h2>
&lt;h3 id="динамические-политики">&lt;span class="section-num">3.1&lt;/span> Динамические политики&lt;/h3>
&lt;ul>
&lt;li>Политика применяется из HTTP-заголовка &lt;em>Strict-Transport-Security&lt;/em> при первом заходе на сайт по HTTPS.&lt;/li>
&lt;li>В заголовке указан срок действия и применимость к субдоменам.&lt;/li>
&lt;/ul>
&lt;h3 id="статические-политики">&lt;span class="section-num">3.2&lt;/span> Статические политики&lt;/h3>
&lt;ul>
&lt;li>Исходный вариант HSTS не защищает первое подключение пользователя к сайту. Злоумышленник может легко перехватить первое подключение, если оно происходит по протоколу http.&lt;/li>
&lt;li>Для борьбы с этой проблемой большинство современных броузеров использует дополнительный статический список сайтов (&lt;em>HSTS preload list&lt;/em>), требующих использования протокола https.&lt;/li>
&lt;li>Список составляется авторами Google Chrome с 2010 года.&lt;/li>
&lt;li>На базе этого списка составляются подобные списки для других броузеров.&lt;/li>
&lt;/ul>
&lt;h2 id="проверка-работы">&lt;span class="section-num">4&lt;/span> Проверка работы&lt;/h2>
&lt;ul>
&lt;li>Можно проверить с помощью сайта: &lt;a href="https://www.ssllabs.com/ssltest/index.html" target="_blank" rel="noopener">https://www.ssllabs.com/ssltest/index.html&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h2 id="поддержка-на-стороне-сервера">&lt;span class="section-num">5&lt;/span> Поддержка на стороне сервера&lt;/h2>
&lt;h3 id="apache">&lt;span class="section-num">5.1&lt;/span> Apache&lt;/h3>
&lt;h4 id="включение-hsts">&lt;span class="section-num">5.1.1&lt;/span> Включение HSTS&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>За HSTS отвечает директива &lt;code>Strict-Transport-Security&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Реализуется с помощью модуля &lt;code>mod_headers&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Для блока &lt;code>&amp;lt;VirtualHost *:443&amp;gt;&lt;/code> следует установить&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;VirtualHost *:443&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Header always set Strict-Transport-Security &amp;#34;max-age=31536000; includeSubDomains&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;/VirtualHost&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>max-age&lt;/code>: время, в течение которого броузер должен применять заголовок HSTS для этого сайта. Указан 1 год.&lt;/li>
&lt;li>&lt;code>includeSubDomains&lt;/code>: применять HSTS также для субдоменов.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="поддержка-на-стороне-клиента">&lt;span class="section-num">6&lt;/span> Поддержка на стороне клиента&lt;/h2>
&lt;h3 id="chrome">&lt;span class="section-num">6.1&lt;/span> Chrome&lt;/h3>
&lt;h4 id="отключение-hsts">&lt;span class="section-num">6.1.1&lt;/span> Отключение HSTS&lt;/h4>
&lt;ul>
&lt;li>Настройки находятся по адресу &lt;code>chrome://net-internals/#hsts&lt;/code>.&lt;/li>
&lt;li>В &lt;em>Query HSTS/PKP domain&lt;/em> укажем наш домен и нажмём &lt;em>Query&lt;/em> для информации по настройке сайта.&lt;/li>
&lt;li>В разделе &lt;em>Delete domain security policies&lt;/em> указываем наш домен, нажимаем &lt;em>Delete&lt;/em>.&lt;/li>
&lt;li>Перезапускаем броузер.&lt;/li>
&lt;/ul></description></item><item><title>Клиенты ACME. acme.sh</title><link>https://yamadharma.github.io/ru/post/2022/05/02/acme-clients-acme-sh/</link><pubDate>Mon, 02 May 2022 17:11:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/05/02/acme-clients-acme-sh/</guid><description>&lt;p>Клиент протокола ACME, написанный на Unix shell.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/acmesh-official/acme.sh" target="_blank" rel="noopener">https://github.com/acmesh-official/acme.sh&lt;/a>&lt;/li>
&lt;li>Wiki: &lt;a href="https://github.com/acmesh-official/acme.sh/wiki" target="_blank" rel="noopener">https://github.com/acmesh-official/acme.sh/wiki&lt;/a>&lt;/li>
&lt;li>Провайдер по умолчанию: ZeroSSL.com.&lt;/li>
&lt;li>Работает с большим количеством провайдеров.&lt;/li>
&lt;/ul></description></item><item><title>Провайдеры ACME</title><link>https://yamadharma.github.io/ru/post/2022/05/02/acme-providers/</link><pubDate>Mon, 02 May 2022 17:00:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/05/02/acme-providers/</guid><description>&lt;p>Существующие провайдеры, работающие по протоколу ACME.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#letsencrypt">&lt;span class="section-num">1&lt;/span> Letsencrypt&lt;/a>&lt;/li>
&lt;li>&lt;a href="#zerossl">&lt;span class="section-num">2&lt;/span> ZeroSSL&lt;/a>&lt;/li>
&lt;li>&lt;a href="#buypass">&lt;span class="section-num">3&lt;/span> BuyPass&lt;/a>&lt;/li>
&lt;li>&lt;a href="#ssl-dot-com">&lt;span class="section-num">4&lt;/span> SSL.com&lt;/a>&lt;/li>
&lt;li>&lt;a href="#google-dot-com-public-ca">&lt;span class="section-num">5&lt;/span> Google.com Public CA&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="letsencrypt">&lt;span class="section-num">1&lt;/span> Letsencrypt&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://letsencrypt.org/" target="_blank" rel="noopener">https://letsencrypt.org/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="zerossl">&lt;span class="section-num">2&lt;/span> ZeroSSL&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://zerossl.com/" target="_blank" rel="noopener">https://zerossl.com/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="buypass">&lt;span class="section-num">3&lt;/span> BuyPass&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://www.buypass.com/" target="_blank" rel="noopener">https://www.buypass.com/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="ssl-dot-com">&lt;span class="section-num">4&lt;/span> SSL.com&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://www.ssl.com/" target="_blank" rel="noopener">https://www.ssl.com/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="google-dot-com-public-ca">&lt;span class="section-num">5&lt;/span> Google.com Public CA&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://cloud.google.com/certificate-authority-service" target="_blank" rel="noopener">https://cloud.google.com/certificate-authority-service&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Клиенты ACME. Certbot</title><link>https://yamadharma.github.io/ru/post/2022/05/02/acme-clients-certbot/</link><pubDate>Mon, 02 May 2022 16:54:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/05/02/acme-clients-certbot/</guid><description>&lt;p>Клиент протокола ACME &lt;em>Certbot&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#получение-сертификатов">&lt;span class="section-num">2&lt;/span> Получение сертификатов&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#сертификаты-dns">&lt;span class="section-num">2.1&lt;/span> Сертификаты DNS&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">2.1.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-программного-обеспечения">&lt;span class="section-num">2.1.2&lt;/span> Установка программного обеспечения&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-bind">&lt;span class="section-num">2.1.3&lt;/span> Настройка BIND&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-certbot">&lt;span class="section-num">2.1.4&lt;/span> Настройка certbot&lt;/a>&lt;/li>
&lt;li>&lt;a href="#получение-сертификата">&lt;span class="section-num">2.1.5&lt;/span> Получение сертификата&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#сертификаты-http">&lt;span class="section-num">2.2&lt;/span> Сертификаты HTTP&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#сервер-apache">&lt;span class="section-num">2.2.1&lt;/span> Сервер &lt;em>Apache&lt;/em>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#сервер-nginx">&lt;span class="section-num">2.2.2&lt;/span> Сервер &lt;em>Nginx&lt;/em>&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">3&lt;/span> Установка&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка-certbot">&lt;span class="section-num">3.1&lt;/span> Установка &lt;em>certbot&lt;/em>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-реализации-snap-certbot">&lt;span class="section-num">3.2&lt;/span> Установка реализации &lt;em>snap certbot&lt;/em>&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Бесплатный программный инструмент с открытым исходным кодом для автоматического использования сертификатов Let’s Encrypt.&lt;/li>
&lt;li>Создан Electronic Frontier Foundation (EFF).&lt;/li>
&lt;li>Сайт: &lt;a href="https://certbot.eff.org/" target="_blank" rel="noopener">https://certbot.eff.org/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="получение-сертификатов">&lt;span class="section-num">2&lt;/span> Получение сертификатов&lt;/h2>
&lt;h3 id="сертификаты-dns">&lt;span class="section-num">2.1&lt;/span> Сертификаты DNS&lt;/h3>
&lt;h4 id="общая-информация">&lt;span class="section-num">2.1.1&lt;/span> Общая информация&lt;/h4>
&lt;ul>
&lt;li>Для выпуска wildcard-сертификата необходимо выполнить &lt;em>DNS challenge request&lt;/em>, используя протокол ACMEv2.&lt;/li>
&lt;li>&lt;em>DNS challenge&lt;/em> представляет собой запись TXT, предоставленную клиентом &lt;em>certbot&lt;/em>, которую необходимо установить вручную в DNS.&lt;/li>
&lt;li>Нужно будет обновлять DNS при каждом обновлении сертификатов.
&lt;ul>
&lt;li>Чтобы не делать это вручную, воспользуйтесь &lt;em>rfc2136&lt;/em>, для которого в Certbot есть плагин &lt;code>certbot-dns-rfc2136&lt;/code>.&lt;/li>
&lt;li>Также необходимо настроить DNS-сервер, чтобы разрешить динамическое обновление TXT-записей.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Документация: &lt;a href="https://certbot-dns-rfc2136.readthedocs.io/" target="_blank" rel="noopener">https://certbot-dns-rfc2136.readthedocs.io/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="установка-программного-обеспечения">&lt;span class="section-num">2.1.2&lt;/span> Установка программного обеспечения&lt;/h4>
&lt;ul>
&lt;li>Установка плагина &lt;code>certbot-dns-rfc2136&lt;/code> для &lt;em>Snap&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">snap &lt;span class="nb">set&lt;/span> certbot trust-plugin-with-root&lt;span class="o">=&lt;/span>ok
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo snap install certbot-dns-rfc2136
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сам &lt;em>Certbot&lt;/em> может находиться на произвольном сервере.&lt;/li>
&lt;/ul>
&lt;h4 id="настройка-bind">&lt;span class="section-num">2.1.3&lt;/span> Настройка BIND&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>Сгенерируйте секретный TSIG-ключ:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tsig-keygen -a HMAC-SHA512 example-key
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Здесь &lt;code>example-key&lt;/code> &amp;mdash; имя вашего ключа. Выбирается произвольно. Можно назвать по имени домена.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Добавьте ключ в файл конфигурации &lt;em>Bind&lt;/em> &lt;code>/etc/named.conf&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">// /etc/named.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zone &amp;#34;domain.ltd&amp;#34; IN {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> // this is for certbot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> update-policy {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> grant example-key name _acme-challenge.domain.ltd. txt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> };
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">key &amp;#34;example-key&amp;#34; {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> algorithm hmac-sha512;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> secret &amp;#34;секретный_ключ&amp;#34;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Перезапустите &lt;em>named&lt;/em>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl restart named.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="настройка-certbot">&lt;span class="section-num">2.1.4&lt;/span> Настройка certbot&lt;/h4>
&lt;ul>
&lt;li>Сгенерируйте файл конфигурации для плагина &lt;em>rfc2136&lt;/em> &lt;code>/etc/letsencrypt/rfc2136_domain.ltd.ini&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Target DNS server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">dns_rfc2136_server&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">IP-адрес&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Target DNS port&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">dns_rfc2136_port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">53&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># TSIG key name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">dns_rfc2136_name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">example-key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># TSIG key secret&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">dns_rfc2136_secret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">ключ_без_кавычек&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># TSIG key algorithm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">dns_rfc2136_algorithm&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">HMAC-SHA512&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Поправьте права доступа:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">600&lt;/span> /etc/letsencrypt/rfc2136_domain.ltd.ini
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="получение-сертификата">&lt;span class="section-num">2.1.5&lt;/span> Получение сертификата&lt;/h4>
&lt;ul>
&lt;li>Выполните команду
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot certonly &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --dns-rfc2136 --force-renewal &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --dns-rfc2136-credentials /etc/letsencrypt/rfc2136_domain.ltd.ini &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --server https://acme-v02.api.letsencrypt.org/directory &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --email example@domain.ltd &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --agree-tos --no-eff-email &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --dns-rfc2136-propagation-seconds &lt;span class="m">60&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -d &lt;span class="s1">&amp;#39;domain.ltd&amp;#39;&lt;/span> -d &lt;span class="s1">&amp;#39;*.domain.ltd&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сертификаты помещаются в каталог &lt;code>/etc/letsencrypt/live/domain.ltd&lt;/code>.&lt;/li>
&lt;/ul>
&lt;h3 id="сертификаты-http">&lt;span class="section-num">2.2&lt;/span> Сертификаты HTTP&lt;/h3>
&lt;h4 id="сервер-apache">&lt;span class="section-num">2.2.1&lt;/span> Сервер &lt;em>Apache&lt;/em>&lt;/h4>
&lt;ul>
&lt;li>Плагин &lt;code>certbot-apache&lt;/code> предоставляет автоматическую настройку &lt;em>Apache HTTP Server&lt;/em>.&lt;/li>
&lt;li>Он пытается найти конфигурацию каждого домена, а также добавляет рекомендованные для безопасности параметры, настройки использования сертификатов и пути к сертификатам Let&amp;rsquo;s Encrypt.&lt;/li>
&lt;li>Первоначальная настройка виртуальных хостов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot --apache
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обновление сертификатов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot renew
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Изменение сертификатов без изменения файлов конфигурации &lt;em>apache&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot --apache certonly
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="сервер-nginx">&lt;span class="section-num">2.2.2&lt;/span> Сервер &lt;em>Nginx&lt;/em>&lt;/h4>
&lt;ul>
&lt;li>Плагин &lt;code>certbot-nginx&lt;/code> предоставляет автоматическую настройку &lt;em>Nginx HTTP Server&lt;/em>.&lt;/li>
&lt;li>Он пытается найти конфигурацию каждого домена, а также добавляет рекомендованные для безопасности параметры, настройки использования сертификатов и пути к сертификатам Let&amp;rsquo;s Encrypt.&lt;/li>
&lt;li>Первоначальная настройка виртуальных хостов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot --nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обновление сертификатов:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot renew
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Изменение сертификатов без изменения файлов конфигурации &lt;em>nginx&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot --nginx certonly
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="установка">&lt;span class="section-num">3&lt;/span> Установка&lt;/h2>
&lt;h3 id="установка-certbot">&lt;span class="section-num">3.1&lt;/span> Установка &lt;em>certbot&lt;/em>&lt;/h3>
&lt;ul>
&lt;li>Проверьте, что установлен репозитории EPEL:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install epel-release
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установите &lt;em>certbot&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install certbot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для веб-сервера Apache:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install python3-certbot-apache
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для веб-сервера Nginx:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install python3-certbot-nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для сертификата DNS:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dnf -y install python3-certbot-dns-rfc2136
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="установка-реализации-snap-certbot">&lt;span class="section-num">3.2&lt;/span> Установка реализации &lt;em>snap certbot&lt;/em>&lt;/h3>
&lt;ul>
&lt;li>Установка &lt;em>Snap&lt;/em>
&lt;ul>
&lt;li>Centos
&lt;ul>
&lt;li>Установите репозиторий &lt;em>Epel&lt;/em>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo dnf install epel-release
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo dnf upgrade
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установите &lt;em>Snap&lt;/em>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo dnf -y install snapd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Запустите &lt;em>Snap&lt;/em>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo systemctl &lt;span class="nb">enable&lt;/span> --now snapd.socket
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ln -s /var/lib/snapd/snap /snap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Обновите &lt;em>Snap&lt;/em> (перед этим необходимо немного подождать, чтобы запустился snapd)
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo snap install core
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo snap refresh core
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установка &lt;em>certbot&lt;/em>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo snap install --classic certbot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Сделайте символьную ссылку для запуска:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo ln -s /snap/bin/certbot /usr/local/bin/certbot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Клиенты ACME</title><link>https://yamadharma.github.io/ru/post/2022/05/02/acme-clients/</link><pubDate>Mon, 02 May 2022 16:50:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/05/02/acme-clients/</guid><description>&lt;p>Выдача сертификатов SSL по протоколу ACME.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#certbot">&lt;span class="section-num">1&lt;/span> Certbot&lt;/a>&lt;/li>
&lt;li>&lt;a href="#acme-dot-sh">&lt;span class="section-num">2&lt;/span> acme.sh&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="certbot">&lt;span class="section-num">1&lt;/span> Certbot&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/05/02/acme-clients-certbot/">Клиенты ACME. Certbot&lt;/a>&lt;/li>
&lt;li>Наиболее популярный клиент ACME.&lt;/li>
&lt;li>Основной провайдер: Let&amp;rsquo;s Encrypt.&lt;/li>
&lt;li>Написан на &lt;em>python&lt;/em>.&lt;/li>
&lt;li>Есть реализация &lt;em>snap&lt;/em>.&lt;/li>
&lt;/ul>
&lt;h2 id="acme-dot-sh">&lt;span class="section-num">2&lt;/span> acme.sh&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/05/02/acme-clients-acme-sh/">Клиенты ACME. acme.sh&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Сертификаты ACME</title><link>https://yamadharma.github.io/ru/post/2022/04/30/acme-certificates/</link><pubDate>Sat, 30 Apr 2022 14:49:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/04/30/acme-certificates/</guid><description>&lt;p>SSL-сертификаты от &lt;em>Let&amp;rsquo;s Encrypt&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#провайдеры">&lt;span class="section-num">2&lt;/span> Провайдеры&lt;/a>&lt;/li>
&lt;li>&lt;a href="#инструментарий">&lt;span class="section-num">3&lt;/span> Инструментарий&lt;/a>&lt;/li>
&lt;li>&lt;a href="#тестирование-работы-выдачи-сертификатов-acme">&lt;span class="section-num">4&lt;/span> Тестирование работы выдачи сертификатов ACME&lt;/a>&lt;/li>
&lt;li>&lt;a href="#проверки-acme">&lt;span class="section-num">5&lt;/span> Проверки ACME&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#проверка-http-01">&lt;span class="section-num">5.1&lt;/span> Проверка HTTP-01&lt;/a>&lt;/li>
&lt;li>&lt;a href="#проверка-dns-01">&lt;span class="section-num">5.2&lt;/span> Проверка DNS-01&lt;/a>&lt;/li>
&lt;li>&lt;a href="#проверка-tls-alpn-01">&lt;span class="section-num">5.3&lt;/span> Проверка TLS-ALPN-01&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://letsencrypt.org/" target="_blank" rel="noopener">https://letsencrypt.org/&lt;/a>&lt;/li>
&lt;li>Использует протокол ACME для выдачи сертификата.&lt;/li>
&lt;li>Наиболее известным провайдером сертификатов, выдаваемых по протоколу ACME, является Let&amp;rsquo;s Encrypt.&lt;/li>
&lt;/ul>
&lt;h2 id="провайдеры">&lt;span class="section-num">2&lt;/span> Провайдеры&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/05/02/acme-providers/">Провайдеры ACME&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="инструментарий">&lt;span class="section-num">3&lt;/span> Инструментарий&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/05/02/acme-clients/">Клиенты ACME&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="тестирование-работы-выдачи-сертификатов-acme">&lt;span class="section-num">4&lt;/span> Тестирование работы выдачи сертификатов ACME&lt;/h2>
&lt;ul>
&lt;li>Проверить на проблемы работу Let&amp;rsquo;s Encrypt можно с помощью сайта: &lt;a href="https://letsdebug.net/" target="_blank" rel="noopener">https://letsdebug.net/&lt;/a>.&lt;/li>
&lt;li>Видимость Ваших ресурсов из внешних сетей можно проверить на сайте &lt;a href="https://check-host.net/" target="_blank" rel="noopener">https://check-host.net/&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h2 id="проверки-acme">&lt;span class="section-num">5&lt;/span> Проверки ACME&lt;/h2>
&lt;ul>
&lt;li>Для выдачи сертификата необходимо верифицировать хост, которому выдаётся сертификат.&lt;/li>
&lt;/ul>
&lt;h3 id="проверка-http-01">&lt;span class="section-num">5.1&lt;/span> Проверка HTTP-01&lt;/h3>
&lt;ul>
&lt;li>Этот тип проверки используется чаще всего.&lt;/li>
&lt;li>Let&amp;rsquo;s Encrypt выдаёт ACME-клиенту токен, а ACME-клиент записывает этот токен в файл на web-сервере по пути &lt;code>http://&amp;lt;YOUR_DOMAIN&amp;gt;/.well-known/acme-challenge/&amp;lt;TOKEN&amp;gt;&lt;/code>.
&lt;ul>
&lt;li>В этом файле содержится сам токен, плюс отпечаток ключа вашего аккаунта.&lt;/li>
&lt;li>Как только ACME-клиент сообщит Let&amp;rsquo;s Encrypt, что файл готов, Let&amp;rsquo;s Encrypt будет пытаться получить этот файл по URL (возможно, несколько раз, с различных адресов).&lt;/li>
&lt;li>Если полученный ответ будет верным, проверка считается успешной, и сертификат для выбранного домена готов к использованию.&lt;/li>
&lt;li>Если проверка прошла неудачно, требуется повторить попытку с новым сертификатом.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Реализация проверки HTTP-01 разрешает редиректы запросов, общим числом не более 10.
&lt;ul>
&lt;li>Редиректы принимаются только на адреса, начинающиеся с &lt;code>http:&lt;/code> или &lt;code>https:&lt;/code>, и только на порты 80 или 443.&lt;/li>
&lt;li>Редиректы на IP-адреса не принимаются.&lt;/li>
&lt;li>Если редирект выполнялся на URL c HTTPS, то сертификат не считается подтверждённым (т.к. проверка для новых сертификатов, может обнаружить самоподписанные или просроченные сертификаты).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Проверка HTTP-01 выполняется только с использованием порта 80. Произвольный порт для проверки снижает надёжность, и потому запрещён стандартом ACME.&lt;/li>
&lt;li>Плюсы:
&lt;ul>
&lt;li>Упрощённая автоматизация процесса, не требующая дополнительных знаний по настройке доменов.&lt;/li>
&lt;li>Выпуск сертификатов для доменов хостинг-провайдеров, привязанных по &lt;code>CNAME&lt;/code>.&lt;/li>
&lt;li>Совместим с уже настроенными web-серверами.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Минусы:
&lt;ul>
&lt;li>&lt;strong>Требует открытого порта 80&lt;/strong>.&lt;/li>
&lt;li>Let&amp;rsquo;s Encrypt не разрешает использовать эту проверку для сертификатов с подстановкой (wildcard-сертификатов).&lt;/li>
&lt;li>Для каждого web-сервера требуется свой файл.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="проверка-dns-01">&lt;span class="section-num">5.2&lt;/span> Проверка DNS-01&lt;/h3>
&lt;ul>
&lt;li>Эта проверка требует подтверждения прав на домен с помощью специальной TXT-записи для доменного имени.
&lt;ul>
&lt;li>Проверка DNS-01 разрешает выпускать сертификаты с подстановкой (wildcard-сертификаты).&lt;/li>
&lt;li>После того, как Let&amp;rsquo;s Encrypt передаёт ACME-клиенту токен, клиент создаёт содержимое TXT-записи на основе токена и ключа аккаунта, и записывает её в &lt;code>_acme-challenge.&amp;lt;YOUR_DOMAIN&amp;gt;&lt;/code>.&lt;/li>
&lt;li>Далее, Let&amp;rsquo;s Encrypt запрашивает TXT-запись в DNS-зоне домена. Если значения совпадают, то сертификат готов к использованию!&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Для автоматизации процесса выпуска и отзыва сертификатов желательно, чтобы DNS-провайдер предоставлял API для автоматических обновлений.&lt;/li>
&lt;li>Let&amp;rsquo;s Encrypt придерживается стандартов DNS для поиска TXT-записи при проверке DNS-01, поэтому можно задействовать записи CNAME или NS для делегирования права ответа за другие DNS-зоны.
&lt;ul>
&lt;li>Например настроив субдомен &lt;code>_acme-challenge&lt;/code> для специального сервера валидации.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Для одного и того же доменного имени допускается несколько TXT-записей.
&lt;ul>
&lt;li>Например, когда требуется одновременно выполнить проверку и для обычного сертификата, и для wildcard-сертификата.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Рекомендуется удалять неактуальные TXT-записи, т.к. из-за большого размера ответа сервера при проверке Let&amp;rsquo;s Encrypt признает проверку неудачной.&lt;/li>
&lt;li>Плюсы:
&lt;ul>
&lt;li>Подходит для сертификатов с подстановкой (wildcard-сертификатов).&lt;/li>
&lt;li>Одна запись для нескольких web-серверов.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Минусы:
&lt;ul>
&lt;li>У DNS-провайдера может не быть своего API.&lt;/li>
&lt;li>Хранение учётной записи для DNS API небезопасно.&lt;/li>
&lt;li>DNS API может не быть методов оценки период обновления записей.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="проверка-tls-alpn-01">&lt;span class="section-num">5.3&lt;/span> Проверка TLS-ALPN-01&lt;/h3>
&lt;ul>
&lt;li>Замена проверки TLS-SNI-01.&lt;/li>
&lt;li>Проверка TLS-ALPN-01 выполняется через TLS handshake на порте 443.&lt;/li>
&lt;li>Плюсы:
&lt;ul>
&lt;li>Будет работать даже если порт 80 закрыт.&lt;/li>
&lt;li>Реализована целиком внутри слоя TLS&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Минусы:
&lt;ul>
&lt;li>Пока не поддерживается Apache, Nginx или Certbot, и, возможно, не будет поддерживаться.&lt;/li>
&lt;li>Как и для проверки HTTP-01, настраивать нужно ответ от каждого web-сервера.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Исследования. Mininet. Подготовка стенда</title><link>https://yamadharma.github.io/ru/post/2022/02/23/research-mininet-stand-preparation/</link><pubDate>Wed, 23 Feb 2022 18:33:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2022/02/23/research-mininet-stand-preparation/</guid><description>&lt;ul>
&lt;li>Для проведения исследования с использованием &lt;em>Mininet&lt;/em> следует подготовить исследовательский стенд.&lt;/li>
&lt;li>Здесь рассматривается проведение воспроизводимых исследований.&lt;/li>
&lt;/ul>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#выбор-версии">&lt;span class="section-num">2&lt;/span> Выбор версии&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-образа">&lt;span class="section-num">3&lt;/span> Настройка образа&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#virtualbox">&lt;span class="section-num">3.1&lt;/span> VirtualBox&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#подключение-к-виртуальной-машине">&lt;span class="section-num">4&lt;/span> Подключение к виртуальной машине&lt;/a>&lt;/li>
&lt;li>&lt;a href="#видео">&lt;span class="section-num">5&lt;/span> Видео&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Репозиторий &lt;em>Mininet&lt;/em>: &lt;a href="https://github.com/mininet/mininet" target="_blank" rel="noopener">https://github.com/mininet/mininet&lt;/a>&lt;/li>
&lt;li>Виртуальные машины:
&lt;ul>
&lt;li>версия 2.2.2: &lt;a href="https://github.com/mininet/mininet/releases/tag/2.2.2" target="_blank" rel="noopener">https://github.com/mininet/mininet/releases/tag/2.2.2&lt;/a>&lt;/li>
&lt;li>версия 2.3.0: &lt;a href="https://github.com/mininet/mininet/releases/tag/2.3.0" target="_blank" rel="noopener">https://github.com/mininet/mininet/releases/tag/2.3.0&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="выбор-версии">&lt;span class="section-num">2&lt;/span> Выбор версии&lt;/h2>
&lt;ul>
&lt;li>Выбор версии зависит от необходимой версии python:
&lt;ul>
&lt;li>mininet-2.2.2: python2;&lt;/li>
&lt;li>mininet-2.3.0: python3.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="настройка-образа">&lt;span class="section-num">3&lt;/span> Настройка образа&lt;/h2>
&lt;h3 id="virtualbox">&lt;span class="section-num">3.1&lt;/span> VirtualBox&lt;/h3>
&lt;ul>
&lt;li>Распакуйте скачанный образ.&lt;/li>
&lt;li>Импортируйте файл &lt;code>.ovf&lt;/code>.&lt;/li>
&lt;li>Перейдите в настройки.&lt;/li>
&lt;li>Добавьте дополнительный сетевой адаптер &lt;em>host-only network adapter&lt;/em>, который вы можете использовать для входа в образ виртуальной машины.&lt;/li>
&lt;/ul>
&lt;h2 id="подключение-к-виртуальной-машине">&lt;span class="section-num">4&lt;/span> Подключение к виртуальной машине&lt;/h2>
&lt;ul>
&lt;li>Залогиньтесь в виртуальной машине:
&lt;ul>
&lt;li>login: mininet&lt;/li>
&lt;li>password: mininet&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Посмотрите адрес машины:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ifconfig
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для активации второго интерфейса наберите:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo dhclient eth1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ifconfig
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Внутренний адрес машины будет иметь вид 192.168.x.y.&lt;/li>
&lt;li>Подключитесь к виртуальной машине:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -Y mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Настройте вход по ключу (см. &lt;a href="https://yamadharma.github.io/ru/post/2022/02/17/ssh-keys/">Ключи ssh&lt;/a>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh-copy-id mininet@192.168.x.y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="видео">&lt;span class="section-num">5&lt;/span> Видео&lt;/h2>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/dDDSaO-j564?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div></description></item><item><title>Сброс пароля на коммутаторах Catalyst</title><link>https://yamadharma.github.io/ru/post/2021/10/06/password-reset-catalyst-switches/</link><pubDate>Wed, 06 Oct 2021 11:36:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2021/10/06/password-reset-catalyst-switches/</guid><description>&lt;p>Сброс пароля на коммутаторах Catalyst серий 2900, 2950, 2960, 3500, 3550.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">&lt;/nav>
&lt;/details>
&lt;ul>
&lt;li>При нажатой кнопке выбора режима (mode) вставить шнур питания (не отпускать кнопку, до тех пор, пока индикатор над портом 1, не будет гореть, как минимум 2 секунды).&lt;/li>
&lt;li>Ввести команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">flash_init
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Ввести команду:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">load_helper
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Переименовать файл &lt;code>config.text&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rename flash:config.text flash:config.old
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Продолжить процесс загрузки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">boot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Отказаться от входа в режим настройки (набрать &lt;code>no&lt;/code>).&lt;/li>
&lt;li>Перейти в пользовательский режим: (&lt;code>Enter&lt;/code>).&lt;/li>
&lt;li>Перейти в привилегированный режим:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">enable&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Вернуть имя ранее переименованному файлу:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rename flash:config.old flash:config.text
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Загрузить в running-config конфигурационный файл:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">copy startup run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Перейти в конфигурационный режим:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">conf t
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Изменить пароль:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">enable&lt;/span> password &amp;lt;пароль&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Выйти из режима настройки (&lt;code>Ctrl+Z&lt;/code>).&lt;/li>
&lt;li>Сохранить конфигурацию:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">write memory
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Программное средство Cisco Packet Tracer</title><link>https://yamadharma.github.io/ru/post/2021/08/18/cisco-packet-tracer-software/</link><pubDate>Wed, 18 Aug 2021 20:39:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2021/08/18/cisco-packet-tracer-software/</guid><description>&lt;ul>
&lt;li>Симулятор сети &lt;em>Cisco Packet Tracer&lt;/em>, выпускаемый фирмой Cisco Systems.&lt;/li>
&lt;li>Позволяет делать работоспособные модели сети, настраивать (командами Cisco IOS) маршрутизаторы и коммутаторы, взаимодействовать между несколькими пользователями (через облако).&lt;/li>
&lt;/ul>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#регистрация-в-сетевой-академии-cisco">&lt;span class="section-num">2&lt;/span> Регистрация в Сетевой академии Cisco&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#видео">&lt;span class="section-num">2.1&lt;/span> Видео&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#работа-без-учётной-записи">&lt;span class="section-num">3&lt;/span> Работа без учётной записи&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Разработчик: Cisco Systems&lt;/li>
&lt;li>Сайт: &lt;a href="https://www.netacad.com/courses/packet-tracer" target="_blank" rel="noopener">https://www.netacad.com/courses/packet-tracer&lt;/a>&lt;/li>
&lt;li>Доступность: Cisco Packet Tracer доступен бесплатно для участников Программы Сетевой Академии Cisco.&lt;/li>
&lt;li>Ссылки для скачки (не официальные): &lt;a href="https://www.computernetworkingnotes.com/ccna-study-guide/download-packet-tracer-for-windows-and-linux.html" target="_blank" rel="noopener">https://www.computernetworkingnotes.com/ccna-study-guide/download-packet-tracer-for-windows-and-linux.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="регистрация-в-сетевой-академии-cisco">&lt;span class="section-num">2&lt;/span> Регистрация в Сетевой академии Cisco&lt;/h2>
&lt;h3 id="видео">&lt;span class="section-num">2.1&lt;/span> Видео&lt;/h3>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/M6NwfZ60_RQ?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h2 id="работа-без-учётной-записи">&lt;span class="section-num">3&lt;/span> Работа без учётной записи&lt;/h2>
&lt;ul>
&lt;li>Начиная с версии PacketTracer7 для работы требуется наличие учётной записи в Network Academy: &lt;a href="https://www.netacad.com/" target="_blank" rel="noopener">https://www.netacad.com/&lt;/a> или &lt;a href="https://skillsforall.com/" target="_blank" rel="noopener">https://skillsforall.com/&lt;/a>.&lt;/li>
&lt;li>В начале марта 2022 года Cisco заблокировало учётные записи пользователей из России и доступ с ip-адресов России.&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/05/07/cisco-packet-tracer-accountless/">Работа без учётной записи в Cisco Packet Tracer&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Анализатор протоколов Wireshark</title><link>https://yamadharma.github.io/ru/post/2021/08/18/wireshark-protocol-analyzer/</link><pubDate>Wed, 18 Aug 2021 18:29:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2021/08/18/wireshark-protocol-analyzer/</guid><description>&lt;p>Анализатор протоколов &lt;em>Wireshark&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка-в-разных-операционных-системах">&lt;span class="section-num">2.1&lt;/span> Установка в разных операционных системах&lt;/a>&lt;/li>
&lt;li>&lt;a href="#запуск-без-административных-привилегий">&lt;span class="section-num">2.2&lt;/span> Запуск без административных привилегий&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#linux">&lt;span class="section-num">2.2.1&lt;/span> Linux&lt;/a>&lt;/li>
&lt;li>&lt;a href="#windows">&lt;span class="section-num">2.2.2&lt;/span> Windows&lt;/a>&lt;/li>
&lt;li>&lt;a href="#bsd-macos">&lt;span class="section-num">2.2.3&lt;/span> BSD, MacOS&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#видео">&lt;span class="section-num">2.3&lt;/span> Видео&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#установка-на-windows">&lt;span class="section-num">2.3.1&lt;/span> Установка на Windows&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-на-ubuntu-linux">&lt;span class="section-num">2.3.2&lt;/span> Установка на Ubuntu Linux&lt;/a>&lt;/li>
&lt;li>&lt;a href="#установка-на-fedora-linux">&lt;span class="section-num">2.3.3&lt;/span> Установка на Fedora Linux&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#терминальный-вариант-wireshark">&lt;span class="section-num">3&lt;/span> Терминальный вариант Wireshark&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">3.1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#пример-использования">&lt;span class="section-num">3.2&lt;/span> Пример использования&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://www.wireshark.org/" target="_blank" rel="noopener">https://www.wireshark.org/&lt;/a>&lt;/li>
&lt;li>Впервые выпущен в 1998 году.&lt;/li>
&lt;li>Первоначальное название &amp;mdash; &lt;em>Ethereal&lt;/em>.&lt;/li>
&lt;li>Разработчикам пришлось изменить название на &lt;em>Wireshark&lt;/em> в 2006 году из-за проблем с товарными знаками.&lt;/li>
&lt;/ul>
&lt;h2 id="установка">&lt;span class="section-num">2&lt;/span> Установка&lt;/h2>
&lt;h3 id="установка-в-разных-операционных-системах">&lt;span class="section-num">2.1&lt;/span> Установка в разных операционных системах&lt;/h3>
&lt;ul>
&lt;li>Windows (менеджер пакетов Chocolatey: &lt;a href="https://yamadharma.github.io/ru/post/2021/01/18/package-manager-windows-chocolatey/">Пакетный менеджер для Windows. Chocolatey&lt;/a>):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">choco install wireshark
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">choco install winpcap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Linux
&lt;ul>
&lt;li>Gentoo
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emerge wireshark
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Ubuntu
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt-get install wireshark
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Fedora
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo dnf install wireshark
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="запуск-без-административных-привилегий">&lt;span class="section-num">2.2&lt;/span> Запуск без административных привилегий&lt;/h3>
&lt;ul>
&lt;li>Административные полномочия требуются для захвата пакетов.&lt;/li>
&lt;/ul>
&lt;h4 id="linux">&lt;span class="section-num">2.2.1&lt;/span> Linux&lt;/h4>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Ограничение разрешения на захват для группы&lt;/p>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Произвольный дистрибутив Linux&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Необходимо установить права доступа к файлу &lt;code>/usr/sbin/dumpcap&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Предположим, что это группа &lt;code>wireshark&lt;/code>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Создайте группу &lt;code>wirehark&lt;/code> и добавьте в неё пользователя &lt;code>user_name&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">groupadd -s wireshark
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gpasswd -a -G wireshark user_name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Изменим параметры файла &lt;code>/usr/sbin/dumpcap&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chgrp wireshark /usr/bin/dumpcap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">750&lt;/span> /usr/bin/dumpcap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Кроме того, зададим &lt;em>capabilities&lt;/em> для этого файла:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">setcap cap_net_raw,cap_net_admin&lt;span class="o">=&lt;/span>eip /usr/bin/dumpcap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Можно проверить, что параметры установлены правильно:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">getcap /usr/bin/dumpcap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>После этого можно перелогиниться или временно добавить себя в новую группу:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">newgrp wireshark
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Ubuntu&lt;/p>
&lt;ul>
&lt;li>Нужно выполнить следующие действия:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get install wireshark
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get install pcaputils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dpkg-reconfigure wireshark-common
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">groupadd wireshark
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">usermod -a -G wireshark user_name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После этого можно перелогиниться или временно добавить себя в новую группу:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">newgrp wireshark
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="3">
&lt;li>
&lt;p>Gentoo&lt;/p>
&lt;ul>
&lt;li>В Gentoo для захвата используется группа &lt;code>pcap&lt;/code>.&lt;/li>
&lt;li>Выполните следующее:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo -i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">usermod -a -G pcap user_name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После этого можно перелогиниться или временно добавить себя в новую группу:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">newgrp pcap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h4 id="windows">&lt;span class="section-num">2.2.2&lt;/span> Windows&lt;/h4>
&lt;ul>
&lt;li>Драйвер &lt;code>WinPcap&lt;/code> (&lt;code>NPF&lt;/code>) загружается Wireshark, когда он начинает собирать данные в реальном времени.&lt;/li>
&lt;li>Для этого требуются права администратора.&lt;/li>
&lt;li>Остановка Wireshark не останавливает драйвер WinPcap.&lt;/li>
&lt;li>При установке драйвера WinPcap через Chocolatey он устанавливается для автоматического запуска с полномочиями администратора.&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Запуск Wireshark под администратором&lt;/p>
&lt;ul>
&lt;li>Самый простой вариант, но не безопасный.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Запуск драйвера NPF под администратором вручную&lt;/p>
&lt;ul>
&lt;li>Запустите драйвер NPF:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">runas /u:administrator &lt;span class="s2">&amp;#34;net start npf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>После этого можно работать с Wireshark.&lt;/li>
&lt;li>Остановите драйвер NPF:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">runas /u:administrator &lt;span class="s2">&amp;#34;net stop npf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="3">
&lt;li>
&lt;p>Запуск драйвера NPF под администратором автоматически при старте системы&lt;/p>
&lt;ul>
&lt;li>Запустите под администратором:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sc config npf &lt;span class="nv">start&lt;/span>&lt;span class="o">=&lt;/span>auto
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Или в &lt;code>Device Manager&lt;/code> выберите &lt;code>View-&amp;gt;Show hidden devices&lt;/code>, откройте &lt;code>Non-Plug and Play Drivers&lt;/code>. Потом настройте запуск &lt;code>NetGroup Packet Filter Driver&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="bsd-macos">&lt;span class="section-num">2.2.3&lt;/span> BSD, MacOS&lt;/h4>
&lt;ul>
&lt;li>Для захвата пакетов необходим доступ для чтения к устройствам BPF в &lt;code>/dev/bpf*&lt;/code>.&lt;/li>
&lt;li>Поскольку в MacOS используется &lt;code>devfs&lt;/code>, изменения не сохраняется между перезагрузками.&lt;/li>
&lt;/ul>
&lt;h3 id="видео">&lt;span class="section-num">2.3&lt;/span> Видео&lt;/h3>
&lt;h4 id="установка-на-windows">&lt;span class="section-num">2.3.1&lt;/span> Установка на Windows&lt;/h4>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/YZDTGFu4vGQ?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h4 id="установка-на-ubuntu-linux">&lt;span class="section-num">2.3.2&lt;/span> Установка на Ubuntu Linux&lt;/h4>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/M-b_nox14io?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h4 id="установка-на-fedora-linux">&lt;span class="section-num">2.3.3&lt;/span> Установка на Fedora Linux&lt;/h4>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/NtAGouu6ncU?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"
>&lt;/iframe>
&lt;/div>
&lt;h2 id="терминальный-вариант-wireshark">&lt;span class="section-num">3&lt;/span> Терминальный вариант Wireshark&lt;/h2>
&lt;h3 id="общая-информация">&lt;span class="section-num">3.1&lt;/span> Общая информация&lt;/h3>
&lt;ul>
&lt;li>Сайт: &lt;a href="https://tshark.dev/" target="_blank" rel="noopener">https://tshark.dev/&lt;/a>&lt;/li>
&lt;li>&lt;em>TShark&lt;/em> &amp;mdash; анализатор сетевых протоколов, терминальный вариант Wireshark.&lt;/li>
&lt;li>Без настроек &lt;em>TShark&lt;/em> будет работать так же, как tcpdump.&lt;/li>
&lt;li>Будет использовать библиотеку &lt;code>pcap&lt;/code> для захвата трафика с первого доступного сетевого интерфейса и отображать сводную строку в стандартном выводе для каждого полученного пакета.&lt;/li>
&lt;/ul>
&lt;h3 id="пример-использования">&lt;span class="section-num">3.2&lt;/span> Пример использования&lt;/h3>
&lt;ul>
&lt;li>Например, чтобы перехватить пакеты через указанный сетевой интерфейс и сохранить результаты, введите:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -i eth0 -w capture-eth0.pcap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Цветной вывод текста требуется терминал с поддержкой 24-битного цвета:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -i any --color
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Показывать только типы файлов, начинающиеся с &lt;code>test&lt;/code>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">shark -Y &lt;span class="s1">&amp;#39;http.content_type[0:4] == &amp;#34;text&amp;#34;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Показать только &lt;em>JavaScript&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -Y tshark -i wlp2s0 -Y &lt;span class="s1">&amp;#39;http.content_type contains &amp;#34;javascript&amp;#34;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Показать все http с content-type=&amp;ldquo;image/(gif|jpeg|png|etc)&amp;rdquo;:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -Y &lt;span class="s1">&amp;#39;http.content_type[0:5] == &amp;#34;image&amp;#34;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Показать все http с content-type=&amp;ldquo;image/gif&amp;rdquo;:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -Y http.content_type &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;image/gif&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Не показывать контент http, только заголовки:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -Y http.response !&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> &lt;span class="o">||&lt;/span> http.request.method !&lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;TRACE&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для сопоставления IP-адресов, заканчивающихся на 255, в блоке подсетей (от 172.16 до 172.31):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -Y string&lt;span class="o">(&lt;/span>ip.dst&lt;span class="o">)&lt;/span> matches r&lt;span class="s2">&amp;#34;^172\.(1[6-9]|2[0-9]|3[0-1])\.[0-9]{1,3}\.255
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Для сопоставления нечетных номеров кадров:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -Y string&lt;span class="o">(&lt;/span>frame.number&lt;span class="o">)&lt;/span> matches &lt;span class="s2">&amp;#34;[13579]&lt;/span>$&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Печать http-данных в вик дерева:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tshark -q -i any -Y http -z http,tree
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Подготовка курса Сетевые технологии</title><link>https://yamadharma.github.io/ru/post/2021/08/17/course-network-technologies/</link><pubDate>Tue, 17 Aug 2021 14:10:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2021/08/17/course-network-technologies/</guid><description>&lt;p>Курс &lt;em>Сетевые технологии&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#лабораторные-работы">&lt;span class="section-num">1&lt;/span> Лабораторные работы&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#методы-кодирования-и-модуляция-сигналов">&lt;span class="section-num">1.1&lt;/span> Методы кодирования и модуляция сигналов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#расчёт-сети-fast-ethernet">&lt;span class="section-num">1.2&lt;/span> Расчёт сети Fast Ethernet&lt;/a>&lt;/li>
&lt;li>&lt;a href="#wireshark-dot-канальный-уровень">&lt;span class="section-num">1.3&lt;/span> Wireshark. Канальный уровень&lt;/a>&lt;/li>
&lt;li>&lt;a href="#wireshark-dot-сетевой-уровень">&lt;span class="section-num">1.4&lt;/span> Wireshark. Сетевой уровень&lt;/a>&lt;/li>
&lt;li>&lt;a href="#packet-tracer-dot-моделирование-простой-сети">&lt;span class="section-num">1.5&lt;/span> Packet Tracer. Моделирование простой сети&lt;/a>&lt;/li>
&lt;li>&lt;a href="#packet-tracer-dot-адресация-ipv4-и-ipv6">&lt;span class="section-num">1.6&lt;/span> Packet Tracer. Адресация IPv4 и IPv6&lt;/a>&lt;/li>
&lt;li>&lt;a href="#packet-tracer-dot-динамическая-маршрутизация">&lt;span class="section-num">1.7&lt;/span> Packet Tracer. Динамическая маршрутизация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#wireshark-dot-транспортный-уровень">&lt;span class="section-num">1.8&lt;/span> Wireshark. Транспортный уровень&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="лабораторные-работы">&lt;span class="section-num">1&lt;/span> Лабораторные работы&lt;/h2>
&lt;h3 id="методы-кодирования-и-модуляция-сигналов">&lt;span class="section-num">1.1&lt;/span> Методы кодирования и модуляция сигналов&lt;/h3>
&lt;ul>
&lt;li>Уровень ISO/OSI: физический уровень&lt;/li>
&lt;li>Цели работы:
&lt;ul>
&lt;li>Изучение методов кодирования и модуляции сигналов с помощью высокоуровнего языка программирования Octave.&lt;/li>
&lt;li>Определение спектра и параметров сигнала.&lt;/li>
&lt;li>Демонстрация принципов модуляции сигнала на примере аналоговой амплитудной модуляции.&lt;/li>
&lt;li>Исследование свойства самосинхронизации сигнала.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="расчёт-сети-fast-ethernet">&lt;span class="section-num">1.2&lt;/span> Расчёт сети Fast Ethernet&lt;/h3>
&lt;ul>
&lt;li>Уровень ISO/OSI: канальный уровень&lt;/li>
&lt;li>Цели работы:
&lt;ul>
&lt;li>Изучение принципов технологий Ethernet и Fast Ethernet.&lt;/li>
&lt;li>Практическое освоение методик оценки работоспособности сети, построенной на базе технологии Fast Ethernet.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Содержание лабораторной работы:
&lt;ul>
&lt;li>Правила построения сети.&lt;/li>
&lt;li>Расчёт конфигурации сети Fast Ethernet.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="wireshark-dot-канальный-уровень">&lt;span class="section-num">1.3&lt;/span> Wireshark. Канальный уровень&lt;/h3>
&lt;ul>
&lt;li>Уровень ISO/OSI: канальный уровень&lt;/li>
&lt;li>Цели работы:
&lt;ul>
&lt;li>Научиться использовать анализатор протоколов Wireshark.&lt;/li>
&lt;li>Использовать анализатор протоколов Wireshark для анализа канального уровня.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Содержание лабораторной работы:
&lt;ul>
&lt;li>Установка Wireshark (см. &lt;a href="https://yamadharma.github.io/ru/post/2021/08/18/wireshark-protocol-analyzer/">Анализатор протоколов Wireshark&lt;/a>).&lt;/li>
&lt;li>Интерфейс Wireshark&lt;/li>
&lt;li>Исследование канального уровня с Wireshark&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Ресурсы:
&lt;ul>
&lt;li>&lt;a href="https://www.youtube.com/watch?v=Cc5wi1bxmpc" target="_blank" rel="noopener">https://www.youtube.com/watch?v=Cc5wi1bxmpc&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.youtube.com/watch?v=HsPurrcG_9Y" target="_blank" rel="noopener">https://www.youtube.com/watch?v=HsPurrcG_9Y&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="wireshark-dot-сетевой-уровень">&lt;span class="section-num">1.4&lt;/span> Wireshark. Сетевой уровень&lt;/h3>
&lt;ul>
&lt;li>Уровень ISO/OSI: сетевой уровень&lt;/li>
&lt;li>Цели работы:
&lt;ul>
&lt;li>Исследовать функционирование протоколов сетевого уровня.&lt;/li>
&lt;li>Рассмотрение протоколов ARP и ICMP.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Содержание лабораторной работы:
&lt;ul>
&lt;li>Протокол ARP.&lt;/li>
&lt;li>Протокол ICMP. Утилита &lt;code>ping&lt;/code>.&lt;/li>
&lt;li>Протокол ICMP. Утилита &lt;code>traceroute&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Задания
&lt;ul>
&lt;li>С помощью утилиты &lt;code>traceroute&lt;/code> постройте маршрут до некоторого (выбранного Вами) хоста.
&lt;ul>
&lt;li>Исследуйте структуру пакетов при построении маршрута.&lt;/li>
&lt;li>Постройте маршрут с помощью утилиты &lt;code>ping&lt;/code>.&lt;/li>
&lt;li>Исследуйте структуру пакетов при построении маршрута.&lt;/li>
&lt;li>Сравните результаты, полученные с помощью &lt;code>traceroute&lt;/code> и &lt;code>ping&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="packet-tracer-dot-моделирование-простой-сети">&lt;span class="section-num">1.5&lt;/span> Packet Tracer. Моделирование простой сети&lt;/h3>
&lt;ul>
&lt;li>Уровень ISO/OSI: сетевой уровень&lt;/li>
&lt;li>Содержание лабораторной работы:
&lt;ul>
&lt;li>Знакомство с Packet Tracer (см. &lt;a href="https://yamadharma.github.io/ru/post/2021/08/18/cisco-packet-tracer-software/">Программное средство Cisco Packet Tracer&lt;/a>).&lt;/li>
&lt;li>Настройка коммутаторов&lt;/li>
&lt;li>Настройка сети с маршрутизаторами&lt;/li>
&lt;li>Моделирование простейшей сети. Протокол ICMP&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="packet-tracer-dot-адресация-ipv4-и-ipv6">&lt;span class="section-num">1.6&lt;/span> Packet Tracer. Адресация IPv4 и IPv6&lt;/h3>
&lt;ul>
&lt;li>Уровень ISO/OSI: сетевой уровень&lt;/li>
&lt;li>Содержание лабораторной работы:
&lt;ul>
&lt;li>Разбиение сети IPv4 на подсети.&lt;/li>
&lt;li>Статическая маршрутизация сетей IPv4.&lt;/li>
&lt;li>Настройка автоматической выдачи адресов в сети IPv4.&lt;/li>
&lt;li>Адресация IPv6.&lt;/li>
&lt;li>Статическая маршрутизация в сетях IPv6.&lt;/li>
&lt;li>Настройка автоматической выдачи адресов в сети IPv6.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="packet-tracer-dot-динамическая-маршрутизация">&lt;span class="section-num">1.7&lt;/span> Packet Tracer. Динамическая маршрутизация&lt;/h3>
&lt;ul>
&lt;li>Уровень ISO/OSI: сетевой уровень&lt;/li>
&lt;li>Содержание лабораторной работы:
&lt;ul>
&lt;li>Моделирование сети с динамической маршрутизацией&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="wireshark-dot-транспортный-уровень">&lt;span class="section-num">1.8&lt;/span> Wireshark. Транспортный уровень&lt;/h3>
&lt;ul>
&lt;li>Уровень ISO/OSI: транспортный уровень&lt;/li>
&lt;li>Содержание лабораторной работы:
&lt;ul>
&lt;li>Порты транспортного уровня.&lt;/li>
&lt;li>Установка соединения TCP (TCP-handshake).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Задания
&lt;ul>
&lt;li>Захватить несколько прикладных протоколов и исследовать, как они используют порты транспортного уровня.&lt;/li>
&lt;li>Захватить пакеты DHCP. Какие особенности выделения портов можно наблюдать.&lt;/li>
&lt;li>С помощью клиента ftp подключитесь к какому-либо ftp-серверу.
&lt;ul>
&lt;li>Выберите пассивный вариант ftp. Какие особенности выделения портов можно наблюдать.&lt;/li>
&lt;li>Выберите активный вариант ftp. Какие особенности выделения портов можно наблюдать.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Исследования. Mininet</title><link>https://yamadharma.github.io/ru/post/2021/08/08/research-mininet/</link><pubDate>Sun, 08 Aug 2021 16:18:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2021/08/08/research-mininet/</guid><description>&lt;p>Исследования по Mininet.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#что-сделано">&lt;span class="section-num">1&lt;/span> Что сделано&lt;/a>&lt;/li>
&lt;li>&lt;a href="#возможные-направления-исследований">&lt;span class="section-num">2&lt;/span> Возможные направления исследований&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#воспроизводимые-исследования-сетей-dot">&lt;span class="section-num">2.1&lt;/span> Воспроизводимые исследования сетей.&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#проблемы-воспроизводимых-исследований-с-mininet">&lt;span class="section-num">2.1.1&lt;/span> Проблемы воспроизводимых исследований с mininet&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#сравнение-натурного-эксперимента--mininet--имитационной-модели--ns-2-ns-3--математической-модели">&lt;span class="section-num">2.2&lt;/span> Сравнение натурного эксперимента (mininet), имитационной модели (ns-2, ns-3), математической модели&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#инструментальные-средства">&lt;span class="section-num">3&lt;/span> Инструментальные средства&lt;/a>&lt;/li>
&lt;li>&lt;a href="#задания-студентам">&lt;span class="section-num">4&lt;/span> Задания студентам&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#техническая-часть--как-делать">&lt;span class="section-num">4.1&lt;/span> Техническая часть (как делать)&lt;/a>&lt;/li>
&lt;li>&lt;a href="#исследовательская-часть">&lt;span class="section-num">4.2&lt;/span> Исследовательская часть&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#red">&lt;span class="section-num">4.2.1&lt;/span> RED&lt;/a>&lt;/li>
&lt;li>&lt;a href="#tcp-congestion-control-with-a-misbehaving-receiver">&lt;span class="section-num">4.2.2&lt;/span> TCP congestion control with a misbehaving receiver&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="что-сделано">&lt;span class="section-num">1&lt;/span> Что сделано&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Посмотрел научные публикации по mininet:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/mininet/mininet/wiki/Publications" target="_blank" rel="noopener">https://github.com/mininet/mininet/wiki/Publications&lt;/a> &amp;mdash; список избранных публикаций на сайте mininet.&lt;/li>
&lt;li>&lt;a href="https://reproducingnetworkresearch.wordpress.com/" target="_blank" rel="noopener">https://reproducingnetworkresearch.wordpress.com/&lt;/a> &amp;mdash; сайт с материалами по воспроизводимым исследованиям сетей.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Посмотрел дополнительный инструментарий для mininet:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/mininet/mininet/wiki/Mininet-Apps-and-Tools" target="_blank" rel="noopener">https://github.com/mininet/mininet/wiki/Mininet-Apps-and-Tools&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Посмотрел дополнительные разработки по mininet (не все полезные):&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/mininet/mininet/wiki/Mininet-Community-Extensions-and-Packages" target="_blank" rel="noopener">https://github.com/mininet/mininet/wiki/Mininet-Community-Extensions-and-Packages&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Также есть смысл обратить внимание на wiki-страницу:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/mininet/mininet/wiki" target="_blank" rel="noopener">https://github.com/mininet/mininet/wiki&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="возможные-направления-исследований">&lt;span class="section-num">2&lt;/span> Возможные направления исследований&lt;/h2>
&lt;h3 id="воспроизводимые-исследования-сетей-dot">&lt;span class="section-num">2.1&lt;/span> Воспроизводимые исследования сетей.&lt;/h3>
&lt;ul>
&lt;li>Находится в мировом мейнстриме по воспроизводимости научных исследований.&lt;/li>
&lt;li>Подразумевается, что по статье можно полностью повторить исследование.&lt;/li>
&lt;li>К статье прилагается полный программный код с пояснениями.&lt;/li>
&lt;/ul>
&lt;h4 id="проблемы-воспроизводимых-исследований-с-mininet">&lt;span class="section-num">2.1.1&lt;/span> Проблемы воспроизводимых исследований с mininet&lt;/h4>
&lt;ul>
&lt;li>Проблемы с версиями python
&lt;ul>
&lt;li>Большая часть исследований сделана на &lt;em>python2&lt;/em>&lt;/li>
&lt;li>Современные версии mininet на &lt;em>python3&lt;/em>&lt;/li>
&lt;li>Под &lt;em>python2&lt;/em> нет уже многих модулей&lt;/li>
&lt;li>Необходимо переписывать скрипты на &lt;em>python3&lt;/em>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Проблемы с версиями &lt;em>mininet&lt;/em>
&lt;ul>
&lt;li>Новые версии могут содержать изменения, делающими неработоспособными старые скрипты&lt;/li>
&lt;li>Часто не указывается, с какой версией совместимы скрипты эксперимента&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="сравнение-натурного-эксперимента--mininet--имитационной-модели--ns-2-ns-3--математической-модели">&lt;span class="section-num">2.2&lt;/span> Сравнение натурного эксперимента (mininet), имитационной модели (ns-2, ns-3), математической модели&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/09/24/research-mininet-ns/">Исследования. Натурный эксперимент (mininet) и имитационная модель (ns-2, ns-3)&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="инструментальные-средства">&lt;span class="section-num">3&lt;/span> Инструментальные средства&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/02/23/research-mininet-stand-preparation/">Исследования. Mininet. Подготовка стенда&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="задания-студентам">&lt;span class="section-num">4&lt;/span> Задания студентам&lt;/h2>
&lt;ul>
&lt;li>Необходимо выполнить сначала техническую часть.&lt;/li>
&lt;li>Далее необходимо повторить протокол проведённого исследования.&lt;/li>
&lt;li>Результат:
&lt;ul>
&lt;li>Описание работы с mininet.&lt;/li>
&lt;li>Описание исследуемой статьи.&lt;/li>
&lt;li>Воспроизведение результатов протокола исследования.&lt;/li>
&lt;li>Код воспроизводимого исследования.&lt;/li>
&lt;li>Код будет помещаться на github.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="техническая-часть--как-делать">&lt;span class="section-num">4.1&lt;/span> Техническая часть (как делать)&lt;/h3>
&lt;ul>
&lt;li>Поскольку тема новая для нас, необходимо исследовать техническую часть проведения исследования.
&lt;ul>
&lt;li>Подробное описание установки и запуска mininet.&lt;/li>
&lt;li>Снятие показаний с mininet.&lt;/li>
&lt;li>Дополнительные инструментальные средства для исследований (в первую очередь, тулзы с сайта).&lt;/li>
&lt;li>Возможные расширения ядра Linux (Click).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="исследовательская-часть">&lt;span class="section-num">4.2&lt;/span> Исследовательская часть&lt;/h3>
&lt;ul>
&lt;li>Научные статьи идут с графиками, которые потом сравниваются с некоторой моделью.&lt;/li>
&lt;li>Необходимо повторить эти результаты с помощью моделирования на mininet.&lt;/li>
&lt;/ul>
&lt;h4 id="red">&lt;span class="section-num">4.2.1&lt;/span> RED&lt;/h4>
&lt;ul>
&lt;li>Основная статья: S. Floyd and V. Jacobson. Random Early Detection gateways for congestion avoidance. IEEE/ACM Transactions on Networking, 1(4):397–413, 1993.&lt;/li>
&lt;li>Протокол исследования: &lt;a href="https://reproducingnetworkresearch.wordpress.com/2012/06/05/seeing-red/" target="_blank" rel="noopener">https://reproducingnetworkresearch.wordpress.com/2012/06/05/seeing-red/&lt;/a>.&lt;/li>
&lt;li>Авторам не удалось воспроизвести результаты исходной статьи.&lt;/li>
&lt;li>Нам необходимо повторить протокол и определить, в чём состоит проблема.&lt;/li>
&lt;/ul>
&lt;h4 id="tcp-congestion-control-with-a-misbehaving-receiver">&lt;span class="section-num">4.2.2&lt;/span> TCP congestion control with a misbehaving receiver&lt;/h4>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Общая информация&lt;/p>
&lt;ul>
&lt;li>Репозиторий кода: &lt;a href="https://github.com/rameshvarun/misbehaving-receiver" target="_blank" rel="noopener">https://github.com/rameshvarun/misbehaving-receiver&lt;/a>&lt;/li>
&lt;li>Описание исследования: &lt;a href="https://reproducingnetworkresearch.wordpress.com/2016/05/30/cs244-16-tcp-congestion-control-with-a-misbehaving-receiver/" target="_blank" rel="noopener">https://reproducingnetworkresearch.wordpress.com/2016/05/30/cs244-16-tcp-congestion-control-with-a-misbehaving-receiver/&lt;/a>&lt;/li>
&lt;li>Исследуемая статья: Savage, Stefan, Neal Cardwell, David Wetherall, and Tom Anderson. “TCP congestion control with a misbehaving receiver.” ACM SIGCOMM Computer Communication Review 29, no. 5 (1999): 71-78.
&lt;ul>
&lt;li>Ссылка на текст статьи: &lt;a href="https://cseweb.ucsd.edu/~savage/papers/CCR99.pdf" target="_blank" rel="noopener">https://cseweb.ucsd.edu/~savage/papers/CCR99.pdf&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Краткая информация по исследованию&lt;/p>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Исходная статья&lt;/p>
&lt;ul>
&lt;li>Механизмы сквозного управления перегрузкой в ​​TCP обычно предполагают, что хосты ведут себя хорошо.&lt;/li>
&lt;li>Однако злонамеренный получатель может обмануть другие узлы, заставив их наводнить сеть пакетами, что вызовет перегрузку и снизит пропускную способность.&lt;/li>
&lt;li>В рассматриваемой статье приводится пример трёх атак, которые злоумышленник может использовать, чтобы обмануть отправителя, использующего стандартный механизм контроль перегрузки TCP.&lt;/li>
&lt;li>Чтобы сделать реализации TCP более устойчивыми, авторы предлагают средства защиты от каждой из трех атак.&lt;/li>
&lt;li>Первая атака: &lt;em>разделение ACK&lt;/em>.
&lt;ul>
&lt;li>Используется то, что управление перегрузкой TCP работает на уровне сегментов, а не отдельных байтов.&lt;/li>
&lt;li>Злоумышленник, при получении сегмента данных, делит диапазон данных на \(M\) частей, подтверждая каждую отдельно.&lt;/li>
&lt;li>Поскольку будет получено в \(M\) раз больше ACK, окно перегрузки отправителя будет увеличиваться в \(M\) раз по сравнению с нормальной скоростью.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Вторая атака: &lt;em>спуфинг дублирования ACK&lt;/em>.
&lt;ul>
&lt;li>Злоумышленник многократно подтверждает каждый пакет, который он получает.&lt;/li>
&lt;li>Отправитель неправильно увеличивает свое окно перегрузки, так как считает, что дублированные ACK являются признаком того, что его пакеты данных отброшены.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Третья атака: &lt;em>атака на оптимистический ACK&lt;/em>.
&lt;ul>
&lt;li>После получения первого пакета данных получатель отправляет отправителю поток подтверждений для данных, которые он ещё не получил.&lt;/li>
&lt;li>Отправитель, сбитый с толку этими ACK, отправит больше данных в сеть.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Что повторяется в исследовании&lt;/p>
&lt;ul>
&lt;li>Реализованы атака на оптимистический ACK и защита от неё.
&lt;ul>
&lt;li>Эту атаку легко реализовать, но трудно защитить от неё, что делает ее особенно разрушительной.&lt;/li>
&lt;li>Злоумышленник может завалить сеть пакетами данных со скоростью, намного превышающей обычную скорость соединения.&lt;/li>
&lt;li>В исходной статье предлагается две защиты от атаки на оптимистический ACK.
&lt;ul>
&lt;li>Одна защита требует изменения как отправителя, так и получателя.&lt;/li>
&lt;li>Другая защита требует изменения только отправителя.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>В исследовании используется второй вариант защиты.
&lt;ul>
&lt;li>Защищённый сетевой стек обратно совместим со стандартными сетевыми стеками.&lt;/li>
&lt;li>Вводятся два изменения:
&lt;ul>
&lt;li>игнорируются ACK, которые не попадают на границу сегмента;&lt;/li>
&lt;li>случайным образом изменяется размер каждого выходного сегмента на небольшую величину, что не позволяет злоумышленнику правильно предсказать границу сегмента.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="3">
&lt;li>
&lt;p>Проведение исследования&lt;/p>
&lt;ul>
&lt;li>Топология &amp;mdash; два хоста, соединённых коммутатором.
&lt;ul>
&lt;li>Задержки и пропускная способность оставлены по умолчанию.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Создаётся четыре TCP-клиента:
&lt;ul>
&lt;li>три злоумышленника плюс обычный клиент (telnet).&lt;/li>
&lt;li>Создаётся три TCP-сервера:
&lt;ul>
&lt;li>один с использованием стека ядра;&lt;/li>
&lt;li>один с использованием стека &lt;em>lwip&lt;/em>;&lt;/li>
&lt;li>один с использованием модифицированного стека &lt;em>lwip&lt;/em>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Клиенты просто устанавливают соединение и ждут данных, в то время как серверы отправляют 100 000 байт данных каждому подключающемуся клиенту.&lt;/li>
&lt;li>Неправильно работающие приёмники написаны на Python с использованием Scapy (инструмента управления пакетами, который может отправлять и получать пакеты с использованием необработанных сокетов).&lt;/li>
&lt;li>Обычный сервер &amp;mdash; это простой скрипт, написанный на Python.&lt;/li>
&lt;li>Для реализации защиты необходим стек TCP, который можно было бы модифицировать.&lt;/li>
&lt;li>Исправление ядра слишком затратно по времени.&lt;/li>
&lt;li>Используется стек TCP в пользовательском пространстве lwIP.
&lt;ul>
&lt;li>Чтобы использовать lwIP, создаётся TAP-устройство &lt;code>lwip-tap&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>lwIP поставлялся с эхо-сервером, который модифицирован для создания сервера данных.&lt;/li>
&lt;li>Реализация защиты изменяет только файлы &lt;code>tcp_in.c&lt;/code> и &lt;code>tcp_out.c&lt;/code> в lwIP и требует добавления примерно 10 строк кода.&lt;/li>
&lt;li>Дампы пакетов захватываются с помощью &lt;em>tcpdump&lt;/em>.&lt;/li>
&lt;li>Графики выполнены с помощью Matplotlib.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="4">
&lt;li>
&lt;p>Результаты&lt;/p>
&lt;ul>
&lt;li>В целом результаты соответствуют результатам исходной статьи.&lt;/li>
&lt;li>Есть некоторые отличия:
&lt;ul>
&lt;li>в исследовании у атакующего соединения номера последовательности (sequence numbers) линейны во времени,&lt;/li>
&lt;li>в исходной статье они образуют кривую.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Это может быть связано с тем, что в исследовании тесты запускались в эмуляторе сети, а исходной статье проводилась атака на &lt;em>CNN.com&lt;/em>.&lt;/li>
&lt;li>В исследовании бо́льшая задержка соединения (link delay), что приводит к разреженности по оси времени.&lt;/li>
&lt;li>Защищённый стек LWIP игнорирует все оптимистические ACK, соединение прекращается.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="3">
&lt;li>
&lt;p>Задание студенту&lt;/p>
&lt;ul>
&lt;li>Прочесть и разобраться в исходной статье.&lt;/li>
&lt;li>Выполнить протокол исследования.&lt;/li>
&lt;li>Сделать аннотированное описание скриптов.&lt;/li>
&lt;li>Сравнить результаты с исходной статьёй.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="4">
&lt;li>
&lt;p>Протокол воспроизведения исследования&lt;/p>
&lt;ul>
&lt;li>Установить виртуальную машину с mininet версии 2.2.2
&lt;ul>
&lt;li>Репозиторий: &lt;a href="https://github.com/mininet/mininet/releases/tag/2.2.2" target="_blank" rel="noopener">https://github.com/mininet/mininet/releases/tag/2.2.2&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Скрипты написаны на &lt;em>python2&lt;/em>, поэтому нам не подходит версия 2.3 (она на &lt;em>python3&lt;/em>)&lt;/li>
&lt;li>Подключиться к виртуальной машине&lt;/li>
&lt;li>Обновить систему:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get upgrade
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Установить необходимое дополнительное программное обеспечение:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt-get install python-matplotlib
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Скачать скрипты:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git clone https://github.com/rameshvarun/misbehaving-receiver.git
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Выполнить исследование:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> misbehaving-receiver
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./run-experiment.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;!--list-separator-->
&lt;ol>
&lt;li>
&lt;p>Файлы эксперимента&lt;/p>
&lt;ul>
&lt;li>&lt;code>run-experiment.sh&lt;/code>: запускает весь эксперимент, создавая все сетевые трассировки и все графики.&lt;/li>
&lt;li>&lt;code>opt-ack-defense.diff&lt;/code>: защита от оптимистичных ACK-атак, оформленная в виде патча.&lt;/li>
&lt;li>&lt;code>server.py&lt;/code>: простой TCP-сервер.
&lt;ul>
&lt;li>Когда клиент устанавливает соединение, сервер немедленно отправляет большой поток данных.&lt;/li>
&lt;li>После отправки данных сервер закрывает соединение.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>attackers/&lt;/code>: в папке находятся три скрипта, каждый из которых реализует одну из атак, упомянутых в оригинальной статье.&lt;/li>
&lt;li>&lt;code>runner.py&lt;/code>: скрипт создаёт топологию минисети и запускает клиент и сервер, регистрируя пакеты.&lt;/li>
&lt;li>&lt;code>create_graph.py&lt;/code>: скрипт создает графики ACK и сегментов данных на основе перехваченных пакетов.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;!--list-separator-->
&lt;ol start="2">
&lt;li>
&lt;p>Результирующие файлы эксперимента&lt;/p>
&lt;ul>
&lt;li>Графики будут находиться в папке &lt;code>graphs&lt;/code>.&lt;/li>
&lt;li>Скопируйте их на свой компьютер:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">scp -r graphs user@адрес_хоста:папка_назначения
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol></description></item><item><title>Почта. Кодировка папок IMAP</title><link>https://yamadharma.github.io/ru/post/2021/07/04/mail-imap-folder-encoding/</link><pubDate>Sun, 04 Jul 2021 20:43:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2021/07/04/mail-imap-folder-encoding/</guid><description>&lt;p>Национальные символы в именах почтовых ящиков на сервере должны кодироваться в модифицированную кодировку UTF-7.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/a>&lt;/li>
&lt;li>&lt;a href="#преобразование">&lt;span class="section-num">2&lt;/span> Преобразование&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#кодирование">&lt;span class="section-num">2.1&lt;/span> Кодирование&lt;/a>&lt;/li>
&lt;li>&lt;a href="#декодирование">&lt;span class="section-num">2.2&lt;/span> Декодирование&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="общая-информация">&lt;span class="section-num">1&lt;/span> Общая информация&lt;/h2>
&lt;ul>
&lt;li>В соответствие с RFC2060 национальные символы в именах почтовых ящиков на сервере должны кодироваться в модифицированную кодировку UTF-7.&lt;/li>
&lt;li>Отличия от оригинальной UTF-7 связаны с особым значением символа &lt;code>+&lt;/code> в некоторых почтовых системах и символа &lt;code>/&lt;/code> в роли разделителя имён каталогов в Unix.&lt;/li>
&lt;/ul>
&lt;h2 id="преобразование">&lt;span class="section-num">2&lt;/span> Преобразование&lt;/h2>
&lt;h3 id="кодирование">&lt;span class="section-num">2.1&lt;/span> Кодирование&lt;/h3>
&lt;ul>
&lt;li>Алгоритм кодирования имён папок:
&lt;ul>
&lt;li>Текст -&amp;gt; UTF7;&lt;/li>
&lt;li>&lt;code>&amp;amp;&lt;/code> -&amp;gt; &lt;code>&amp;amp;-&lt;/code>;&lt;/li>
&lt;li>&lt;code>/&lt;/code> -&amp;gt; &lt;code>,&lt;/code>;&lt;/li>
&lt;li>&lt;code>+&lt;/code> -&amp;gt; &lt;code>&amp;amp;&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Код (shell):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Черновики&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> iconv -f UTF8 -t UTF7 &lt;span class="p">|&lt;/span> sed &lt;span class="s1">&amp;#39;s/&amp;amp;/&amp;amp;-/g;s/\//,/g;s/+/\&amp;amp;/g&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В результате получаем:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;amp;&lt;/span>BCcENQRABD0EPgQyBDgEOgQ4
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="декодирование">&lt;span class="section-num">2.2&lt;/span> Декодирование&lt;/h3>
&lt;ul>
&lt;li>Алгоритм декодирования имён папок:
&lt;ul>
&lt;li>&lt;code>&amp;amp;&lt;/code> -&amp;gt; &lt;code>+&lt;/code>;&lt;/li>
&lt;li>&lt;code>&amp;amp;-&lt;/code> -&amp;gt; &lt;code>&amp;amp;&lt;/code>;&lt;/li>
&lt;li>&lt;code>,&lt;/code> -&amp;gt; &lt;code>/&lt;/code>;&lt;/li>
&lt;li>UTF7 -&amp;gt; Текст.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Код (shell):
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;&amp;amp;BB4EQgQ,BEAEMAQyBDsENQQ9BD0ESwQ1-&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> sed &lt;span class="s1">&amp;#39;s/&amp;amp;\([^-]\)/+\1/g;s/&amp;amp;-/&amp;amp;/g;s/,/\//g&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> iconv -f UTF7 -t UTF8
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В результате получаем:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Отправленные
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul></description></item><item><title>Подготовка курса Моделирование сетей передачи данных</title><link>https://yamadharma.github.io/ru/post/2021/06/24/course-simulation-data-networks/</link><pubDate>Thu, 24 Jun 2021 15:01:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2021/06/24/course-simulation-data-networks/</guid><description>&lt;p>Курс &lt;em>Моделирование сетей передачи данных&lt;/em>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#предназначение-курса">&lt;span class="section-num">1&lt;/span> Предназначение курса&lt;/a>&lt;/li>
&lt;li>&lt;a href="#информация-по-предмету">&lt;span class="section-num">2&lt;/span> Информация по предмету&lt;/a>&lt;/li>
&lt;li>&lt;a href="#брс">&lt;span class="section-num">3&lt;/span> БРС&lt;/a>&lt;/li>
&lt;li>&lt;a href="#лабораторные-работы">&lt;span class="section-num">4&lt;/span> Лабораторные работы&lt;/a>&lt;/li>
&lt;li>&lt;a href="#лекции">&lt;span class="section-num">5&lt;/span> Лекции&lt;/a>&lt;/li>
&lt;li>&lt;a href="#темы-докладов">&lt;span class="section-num">6&lt;/span> Темы докладов&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="предназначение-курса">&lt;span class="section-num">1&lt;/span> Предназначение курса&lt;/h2>
&lt;ul>
&lt;li>Курс описывает не аналитическое моделирование (modeling) сетей, а моделирование путём создания натурного стенда на основе виртуализации (simulation).&lt;/li>
&lt;li>Изучается не теоретическая, а операциональная часть модели.&lt;/li>
&lt;/ul>
&lt;h2 id="информация-по-предмету">&lt;span class="section-num">2&lt;/span> Информация по предмету&lt;/h2>
&lt;ul>
&lt;li>Наименование дисциплины: Моделирование сетей передачи данных&lt;/li>
&lt;li>Объем курса:
&lt;ul>
&lt;li>4 кредита,&lt;/li>
&lt;li>144 часа&lt;/li>
&lt;li>контактные часы: 54 часа&lt;/li>
&lt;li>самостоятельная работа: 63 часа&lt;/li>
&lt;li>контроль: 27 часов&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Курс: 4
&lt;ul>
&lt;li>Семестр: 7&lt;/li>
&lt;li>Модуль: 14 (E)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Продолжительность курса: 9 недель&lt;/li>
&lt;li>Лекции: 18 часов (2 часа/нед)&lt;/li>
&lt;li>Лабораторные работы: 36 часов (4 часа/нед)&lt;/li>
&lt;/ul>
&lt;h2 id="брс">&lt;span class="section-num">3&lt;/span> БРС&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Активность&lt;/th>
&lt;th>Количество&lt;/th>
&lt;th>Баллы за единицу&lt;/th>
&lt;th>Общие баллы&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>А1.1&lt;/td>
&lt;td>14&lt;/td>
&lt;td>3&lt;/td>
&lt;td>42&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>А1.2&lt;/td>
&lt;td>14&lt;/td>
&lt;td>2&lt;/td>
&lt;td>28&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>А2&lt;/td>
&lt;td>8&lt;/td>
&lt;td>1&lt;/td>
&lt;td>8&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>А3&lt;/td>
&lt;td>1&lt;/td>
&lt;td>12&lt;/td>
&lt;td>12&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>A4&lt;/td>
&lt;td>1&lt;/td>
&lt;td>10&lt;/td>
&lt;td>10&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;td>100&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;ul>
&lt;li>
&lt;p>Активности&lt;/p>
&lt;ul>
&lt;li>А1.1: Лабораторные работы. Выполнение.&lt;/li>
&lt;li>А1.2: Лабораторные работы. Самопроверка и взаимопроверка.&lt;/li>
&lt;li>А2: Тесты к лекциям работам.&lt;/li>
&lt;li>А3: Доклады по темам.&lt;/li>
&lt;li>A4: Итоговый контроль знаний (тест).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Разделы&lt;/p>
&lt;ul>
&lt;li>Р1: Введение в моделирование сетей передачи данных&lt;/li>
&lt;li>Р2: Моделирование производительности сетей передачи данных&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Темы&lt;/p>
&lt;ul>
&lt;li>T1. Генерация трафика.&lt;/li>
&lt;li>T2. Эмуляция сетей.&lt;/li>
&lt;li>T3. Настройка пропускной способности сети.&lt;/li>
&lt;li>T4. Управление перегрузкой TCP.&lt;/li>
&lt;li>T5. Задержки и размер буфера TCP.&lt;/li>
&lt;li>T6. Повышение пропускной способности TCP.&lt;/li>
&lt;li>T7. Буферы маршрутизатора.&lt;/li>
&lt;li>T8. Контроль скорости TCP.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="лабораторные-работы">&lt;span class="section-num">4&lt;/span> Лабораторные работы&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/course/simulation-networks/lab/">Mininet. Лабораторные работы&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="лекции">&lt;span class="section-num">5&lt;/span> Лекции&lt;/h2>
&lt;ol>
&lt;li>Современные технологии межсетевого уровня IP.&lt;/li>
&lt;li>Параметры TCP.&lt;/li>
&lt;li>Формирование трафика на границе сети.&lt;/li>
&lt;li>Назначение, разновидности и основные функции маршрутизаторов.&lt;/li>
&lt;li>Динамическая маршрутизация.&lt;/li>
&lt;li>Статическая маршрутизация.&lt;/li>
&lt;li>Качество сетевого обслуживания (QoS).&lt;/li>
&lt;li>Средства QoS коммуникационного узла. Протоколы сигнализации QoS и службы QoS IP-уровня.&lt;/li>
&lt;/ol>
&lt;h2 id="темы-докладов">&lt;span class="section-num">6&lt;/span> Темы докладов&lt;/h2>
&lt;ul>
&lt;li>Обзор возможностей системы моделирования Mininet.&lt;/li>
&lt;li>Генераторы трафика. Особенности в разных системах моделирования.&lt;/li>
&lt;li>Эмуляция сетей передачи данных: особенности моделирования задержки передачи данных.&lt;/li>
&lt;li>Эмуляция сетей передачи данных: особенности моделирования потери, дублирования, переупорядочивания пакетов.&lt;/li>
&lt;li>Обзор алгоритмов управления трафиком:
&lt;ul>
&lt;li>Алгоритм скользящего временного окна с 2 цветным маркером (Time Sliding Window with Two Color Marking).&lt;/li>
&lt;li>Алгоритм трёхцветного маркера для одного входящего потока (A Single Rate Three Color Marker).&lt;/li>
&lt;li>Двухпараметровый трёхцветный маркер (Two Rate Three Color Marker).&lt;/li>
&lt;li>Token Bucket Filter (TBF) или «маркерное ведро».&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Обзор алгоритмов управления перегрузками:
&lt;ul>
&lt;li>Механизм приоритетной обработки трафика (Priority Queue).&lt;/li>
&lt;li>Алгоритм стохастического справедливого обслуживания (Stochastic Fairness Queueing, SFQ).&lt;/li>
&lt;li>Алгоритм взвешенного обслуживания (Weighted Queuing, WQ).&lt;/li>
&lt;li>Взвешенное справедливое обслуживание (Weighted Fair Queuing, WFQ).&lt;/li>
&lt;li>Алгоритм обработки очередей с малой задержкой (Low Latency Queuing, LLQ).&lt;/li>
&lt;li>Дисциплина взвешенного циклического обслуживания (Weighted Round Robin, WRR).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Алгоритмы избежания перегрузок: обзор различных алгоритмов случайного раннего обнаружения (Random Early Detect, RED) перегрузки.&lt;/li>
&lt;li>Особенности различных типов протокола TCP (TCP Tahoe, TCP Reno, TCP New Reno, TCP Vegas, TCP Westwood).&lt;/li>
&lt;li>Обзор моделей TCP: TCP Hybla, BIC-TCP, CUBIC TCP, TCP Illinois, TCP-Veno.&lt;/li>
&lt;li>Традиционное управление перегрузкой TCP: HTCP, Cubic, Reno.&lt;/li>
&lt;li>Управление перегрузкой TCP на основе скорости: BBR.&lt;/li>
&lt;li>Задержки и размер буфера TCP.&lt;/li>
&lt;li>Повышение пропускной способности TCP с помощью параллельных потоков.&lt;/li>
&lt;li>Измерение справедливости TCP.&lt;/li>
&lt;li>Контроль скорости TCP.&lt;/li>
&lt;li>Влияние MSS на пропускную способность.&lt;/li>
&lt;/ul></description></item><item><title>Администрирование Cisco</title><link>https://yamadharma.github.io/ru/post/2021/06/16/cisco-administration/</link><pubDate>Wed, 16 Jun 2021 12:38:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2021/06/16/cisco-administration/</guid><description>&lt;p>Администрирование сетей и оборудования Cisco.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#настройка">&lt;span class="section-num">1&lt;/span> Настройка&lt;/a>&lt;/li>
&lt;li>&lt;a href="#обслуживание">&lt;span class="section-num">2&lt;/span> Обслуживание&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="настройка">&lt;span class="section-num">1&lt;/span> Настройка&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2021/06/16/cisco-storm-control/">Cisco. Защита от широковещательного шторма&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2022/11/15/initial-cisco-switch-configuration/">Начальная конфигурация коммутатора Cisco&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/03/03/cisco-wlc/">Контроллер Cisco WLC&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2023/04/04/cisco-huawei-commands/">Сопоставление команд Cisco и Huawei&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="обслуживание">&lt;span class="section-num">2&lt;/span> Обслуживание&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2021/10/06/password-reset-catalyst-switches/">Сброс пароля на коммутаторах Catalyst&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://yamadharma.github.io/ru/post/2024/07/03/flashing-cisco-aironet/">Перепрошивка точки доступа Cisco Aironet&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Cisco. Защита от широковещательного шторма</title><link>https://yamadharma.github.io/ru/post/2021/06/16/cisco-storm-control/</link><pubDate>Wed, 16 Jun 2021 11:48:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/post/2021/06/16/cisco-storm-control/</guid><description>&lt;p>Для борьбы с широковещательным штормом в сетевых устройствах Cisco используется параметр &lt;code>storm-control&lt;/code>.&lt;/p>
&lt;details class="toc-inpage d-print-none " open>
&lt;summary class="font-weight-bold">Содержание&lt;/summary>
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#описание">&lt;span class="section-num">1&lt;/span> Описание&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка">&lt;span class="section-num">2&lt;/span> Настройка&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#задание-порогов-срабатывания">&lt;span class="section-num">2.1&lt;/span> Задание порогов срабатывания&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#однопороговый-вариант">&lt;span class="section-num">2.1.1&lt;/span> Однопороговый вариант&lt;/a>&lt;/li>
&lt;li>&lt;a href="#двупороговый-вариант">&lt;span class="section-num">2.1.2&lt;/span> Двупороговый вариант&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#реакция-на-шторм">&lt;span class="section-num">2.2&lt;/span> Реакция на шторм&lt;/a>&lt;/li>
&lt;li>&lt;a href="#восстановление-портов">&lt;span class="section-num">2.3&lt;/span> Восстановление портов&lt;/a>&lt;/li>
&lt;li>&lt;a href="#обнаружение-петель">&lt;span class="section-num">2.4&lt;/span> Обнаружение петель&lt;/a>&lt;/li>
&lt;li>&lt;a href="#настройка-на-все-порты-сразу">&lt;span class="section-num">2.5&lt;/span> Настройка на все порты сразу&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#проверка-работы">&lt;span class="section-num">3&lt;/span> Проверка работы&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;/details>
&lt;h2 id="описание">&lt;span class="section-num">1&lt;/span> Описание&lt;/h2>
&lt;ul>
&lt;li>Параметр &lt;code>storm-control&lt;/code> задаёт количество бродкастов в секунду.&lt;/li>
&lt;li>Всё, что свыше этого значения, отбрасывается.&lt;/li>
&lt;li>Порт при этом продолжает работать для пересылки всего остального трафика.&lt;/li>
&lt;li>В случае высокого значения &lt;code>storm-contorol&lt;/code> можно получить перегрузку ЦПУ коммутатора, в случае низкого значения можно иметь проблемы с работой DHCP и ARP.&lt;/li>
&lt;/ul>
&lt;h2 id="настройка">&lt;span class="section-num">2&lt;/span> Настройка&lt;/h2>
&lt;h3 id="задание-порогов-срабатывания">&lt;span class="section-num">2.1&lt;/span> Задание порогов срабатывания&lt;/h3>
&lt;ul>
&lt;li>Максимальный уровень широковещательного трафика задаётся либо в процентах от полосы пропускания (безразмерные значения), либо в битах в секунду (bps).&lt;/li>
&lt;li>Есть два варианта конфигурирования:
&lt;ul>
&lt;li>однопороговое,&lt;/li>
&lt;li>двупороговое.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="однопороговый-вариант">&lt;span class="section-num">2.1.1&lt;/span> Однопороговый вариант&lt;/h4>
&lt;ul>
&lt;li>Задаётся максимальный порог и действие по достижении этого порога:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1"># int f0/1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config-if&lt;span class="o">)&lt;/span>&lt;span class="c1"># storm-control broadcast level 30.00&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config-if&lt;span class="o">)&lt;/span>&lt;span class="c1"># storm-control multicast level 30.00&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Команда устанавливает максимальный уровень широковещательного трафика в 30% от полосы пропускания.&lt;/li>
&lt;/ul>
&lt;h4 id="двупороговый-вариант">&lt;span class="section-num">2.1.2&lt;/span> Двупороговый вариант&lt;/h4>
&lt;ul>
&lt;li>Указывается два порога.&lt;/li>
&lt;li>При достижении первого порога порт будет отключаться.&lt;/li>
&lt;li>При падении уровня трафика до второго порога порт будет включаться:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config-if&lt;span class="o">)&lt;/span>&lt;span class="c1"># storm-control broadcast level 30.00 10.00&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config-if&lt;span class="o">)&lt;/span>&lt;span class="c1"># storm-control multicast level 30.00 10.00&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Здесь первый порог &amp;mdash; 30% от полосы пропускания, второй порог &amp;mdash; 10% от полосы пропускания.&lt;/li>
&lt;/ul>
&lt;h3 id="реакция-на-шторм">&lt;span class="section-num">2.2&lt;/span> Реакция на шторм&lt;/h3>
&lt;ul>
&lt;li>Необходимо задать действие при возникновении шторма
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1"># int f0/1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config-if&lt;span class="o">)&lt;/span>&lt;span class="c1"># storm-control action shutdown&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>Вторая команда указывает на то, какое действие должно быть совершено, когда лимит будет достигнут. В данном случае мы отключаем порт (&lt;code>shutdown&lt;/code>).&lt;/li>
&lt;li>Если действие не указывать, то свитч будет просто фильтровать трафик, превышающий порог, и не отправлять никаких оповещений.&lt;/li>
&lt;li>Можно включить SNMP-трапы и сообщения в Syslog:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config-if&lt;span class="o">)&lt;/span>&lt;span class="c1"># storm-control action trap&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="восстановление-портов">&lt;span class="section-num">2.3&lt;/span> Восстановление портов&lt;/h3>
&lt;ul>
&lt;li>Чтобы коммутатор автоматически восстанавливал порт через некоторое время после отключения, необходимо в глобальной конфигурации задать:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1"># errdisable recovery cause storm-control&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1"># errdisable recovery interval 180&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>В данном случае восстановление происходит через 3 минуты (180 секунд).&lt;/li>
&lt;/ul>
&lt;h3 id="обнаружение-петель">&lt;span class="section-num">2.4&lt;/span> Обнаружение петель&lt;/h3>
&lt;ul>
&lt;li>У коммутаторов Cisco есть также штатное средство обнаружения петель, основанное на периодической отправке keepalive-сообщений.&lt;/li>
&lt;li>Эта опция обычно включена по умолчанию, и в случае срабатывания порт отключается.&lt;/li>
&lt;li>Для механизма keepalive можно также настроить автоматическое включение интерфейса:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1"># errdisable recovery cause loopback&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="настройка-на-все-порты-сразу">&lt;span class="section-num">2.5&lt;/span> Настройка на все порты сразу&lt;/h3>
&lt;ul>
&lt;li>Для настройки параметров всех портов сразу используйте &lt;em>диапазон портов&lt;/em>:
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config&lt;span class="o">)&lt;/span>&lt;span class="c1"># interface range f0/1 - 24&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>config-if-range&lt;span class="o">)&lt;/span>&lt;span class="c1"># storm-control broadcast level 30.00 10.00&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="проверка-работы">&lt;span class="section-num">3&lt;/span> Проверка работы&lt;/h2>
&lt;ul>
&lt;li>Используйте команду &lt;code>show storm-control&lt;/code>, чтобы проверить конфигурацию функции подавления широковещательной и многоадресной рассылки.&lt;/li>
&lt;li>Используйте команду &lt;code>show storm-control &amp;lt;интерфейс&amp;gt;&lt;/code>, чтобы проверить конфигурацию функции подавления широковещательной и многоадресной рассылки на интерфейсе.&lt;/li>
&lt;li>Используйте команду &lt;code>show run interface &amp;lt;интерфейс&amp;gt;&lt;/code>, чтобы проверить ловушку (trap), настроенную для порта.&lt;/li>
&lt;/ul></description></item><item><title>Администрирование локальных сетей</title><link>https://yamadharma.github.io/ru/course/net-admin/</link><pubDate>Sun, 31 Jan 2021 20:06:00 +0300</pubDate><guid>https://yamadharma.github.io/ru/course/net-admin/</guid><description>&lt;p>Курс &lt;em>Администрирование локальных сетей&lt;/em>.&lt;/p>
&lt;h2 id="информация-по-курсу">&lt;span class="section-num">1&lt;/span> Информация по курсу&lt;/h2>
&lt;h2 id="информация-по-предмету">&lt;span class="section-num">2&lt;/span> Информация по предмету&lt;/h2>
&lt;ul>
&lt;li>Наименование дисциплины: Администрирование локальных сетей&lt;/li>
&lt;li>Объем курса (общий):
&lt;ul>
&lt;li>7 кредитов&lt;/li>
&lt;li>252 часа&lt;/li>
&lt;li>контактные часы: 96 часов&lt;/li>
&lt;li>самостоятельная работа: 129 часов&lt;/li>
&lt;li>контроль: 27 часов&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Курс: 3, Модуль: 3
&lt;ul>
&lt;li>Объем курса:
&lt;ul>
&lt;li>3 кредита&lt;/li>
&lt;li>108 часов&lt;/li>
&lt;li>контактные часы: 54 часов
&lt;ul>
&lt;li>лекции: 18 часов&lt;/li>
&lt;li>лабораторные работы: 36 часов&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>самостоятельная работа: 54 часа&lt;/li>
&lt;li>контроль: 27 часов&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Продолжительность курса: 9 недель&lt;/li>
&lt;li>Лекции: 2 часа&lt;/li>
&lt;li>Лабораторные работы: 4 часа&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Курс: 3, Модуль: 4
&lt;ul>
&lt;li>Объем курса:
&lt;ul>
&lt;li>4 кредита&lt;/li>
&lt;li>144 часов&lt;/li>
&lt;li>контактные часы: 42 часа
&lt;ul>
&lt;li>лекции: 14 часов&lt;/li>
&lt;li>лабораторные работы: 28 часов&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>самостоятельная работа: 75 часов&lt;/li>
&lt;li>контроль: 27 часов&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Продолжительность курса: 9 недель&lt;/li>
&lt;li>Лекции: 2 часа&lt;/li>
&lt;li>Лабораторные работы: 4 часа&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="брс">&lt;span class="section-num">3&lt;/span> БРС&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Активность&lt;/th>
&lt;th>Количество&lt;/th>
&lt;th>Баллы за единицу&lt;/th>
&lt;th>Общие баллы&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>А1.1&lt;/td>
&lt;td>16&lt;/td>
&lt;td>3&lt;/td>
&lt;td>48&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>А1.2&lt;/td>
&lt;td>16&lt;/td>
&lt;td>2&lt;/td>
&lt;td>32&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>А2&lt;/td>
&lt;td>1&lt;/td>
&lt;td>10&lt;/td>
&lt;td>10&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>А3&lt;/td>
&lt;td>1&lt;/td>
&lt;td>10&lt;/td>
&lt;td>10&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;td>100&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;ul>
&lt;li>
&lt;p>Активности&lt;/p>
&lt;ul>
&lt;li>А1.1: Лабораторные работы. Выполнение.&lt;/li>
&lt;li>А1.2: Лабораторные работы. Защита.&lt;/li>
&lt;li>А2: Доклады по темам.&lt;/li>
&lt;li>A3. Итоговый контроль знаний (тест).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Разделы&lt;/p>
&lt;ul>
&lt;li>Р1: Администрирование коммутируемой сети&lt;/li>
&lt;li>Р2: Администрирование маршрутизируемой сети&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Темы&lt;/p>
&lt;ul>
&lt;li>Р1: Администрирование коммутируемой сети
&lt;ul>
&lt;li>T1: Программное средство Cisco Packet Tracer&lt;/li>
&lt;li>T2: Предварительная настройка оборудования Cisco&lt;/li>
&lt;li>T3: Планирование сети&lt;/li>
&lt;li>T4: Первоначальное конфигурирование сети&lt;/li>
&lt;li>T5: Конфигурирование VLAN&lt;/li>
&lt;li>T6: Статическая маршрутизация VLAN&lt;/li>
&lt;li>T7: Учёт физических параметров сети&lt;/li>
&lt;li>T8: Использование протокола STP. Агрегирование каналов&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Р2: Администрирование маршрутизируемой сети
&lt;ul>
&lt;li>T9: Настройка сетевых сервисов DHCP&lt;/li>
&lt;li>T10: Настройка списков управления доступом (ACL)&lt;/li>
&lt;li>T11: Настройка NAT. Планирование&lt;/li>
&lt;li>T12: Настройка NAT&lt;/li>
&lt;li>T13: Статическая маршрутизация в Интернете. Планирование&lt;/li>
&lt;li>T14: Статическая маршрутизация в Интернете. Настройка&lt;/li>
&lt;li>T15: Динамическая маршрутизация&lt;/li>
&lt;li>T16: Настройка VPN&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="лабораторные-работы">&lt;span class="section-num">4&lt;/span> Лабораторные работы&lt;/h2>
&lt;p>Лабораторные работы строятся по общей схеме (см. &lt;a href="https://yamadharma.github.io/ru/post/2021/01/16/laboratory-work-structure/">Структура лабораторной работы&lt;/a>).&lt;/p>
&lt;h3 id="темы-лабораторных-работ">&lt;span class="section-num">4.1&lt;/span> Темы лабораторных работ&lt;/h3>
&lt;ol>
&lt;li>Знакомство с Cisco Packet Tracer&lt;/li>
&lt;li>Предварительная настройка оборудования Cisco&lt;/li>
&lt;li>Планирование локальной сети организации&lt;/li>
&lt;li>Первоначальное конфигурирование сети&lt;/li>
&lt;li>Конфигурирование VLAN&lt;/li>
&lt;li>Статическая маршрутизация VLAN&lt;/li>
&lt;li>Учёт физических параметров сети&lt;/li>
&lt;li>Настройка сетевых сервисов DHCP&lt;/li>
&lt;li>Использование протокола STP. Агрегирование каналов&lt;/li>
&lt;li>Настройка списков управления доступом (ACL)&lt;/li>
&lt;li>Настройка NAT. Планирование&lt;/li>
&lt;li>Настройка NAT&lt;/li>
&lt;li>Статическая маршрутизация в Интернете. Планирование&lt;/li>
&lt;li>Статическая маршрутизация в Интернете. Настройка&lt;/li>
&lt;li>Динамическая маршрутизация&lt;/li>
&lt;li>Настройка VPN&lt;/li>
&lt;/ol>
&lt;h2 id="доклады">&lt;span class="section-num">5&lt;/span> Доклады&lt;/h2>
&lt;h3 id="темы-докладов">&lt;span class="section-num">5.1&lt;/span> Темы докладов&lt;/h3>
&lt;h4 id="моделирование-сетей-передачи-данных">&lt;span class="section-num">5.1.1&lt;/span> Моделирование сетей передачи данных&lt;/h4>
&lt;ul>
&lt;li>Средство моделирования Cisco Packet Tracer. Установка и пример
моделирования.&lt;/li>
&lt;li>Средство моделирования Huawei eNSP. Установка и пример моделирования.&lt;/li>
&lt;li>Средство моделирования GNS3. Установка и пример моделирования.&lt;/li>
&lt;li>Средство моделирования EVE-NG. Установка и пример моделирования.&lt;/li>
&lt;li>Средство моделирования Mininet. Установка и пример моделирования.&lt;/li>
&lt;li>Средство моделирования HP Network Simulator. Установка и пример
моделирования.&lt;/li>
&lt;/ul>
&lt;h4 id="основы-сетевых-технологий">&lt;span class="section-num">5.1.2&lt;/span> Основы сетевых технологий&lt;/h4>
&lt;ul>
&lt;li>Понятие стека протоколов. Основные стеки. Соответствие протоколов
модели OSI.&lt;/li>
&lt;li>Стек протоколов TCP/IP.&lt;/li>
&lt;li>Методы коммутации в компьютерных сетях. Коммутация каналов. Коммутация
пакетов. Коммутация сообщений.&lt;/li>
&lt;li>Методы доступа к среде передачи данных. Случайные методы (CSMA/CD,
CSMA/CA). Детерминированные методы (маркерный доступ: Token Ring,
FDDI).&lt;/li>
&lt;li>Понятие, виды и функции модема, принципы работы (xDSL, телефонные
модемы).&lt;/li>
&lt;li>Понятие и функции маршрутизатора, отличие маршрутизаторов от
коммутаторов.&lt;/li>
&lt;li>Устройства, предназначенные для межсетевого взаимодействия:
брандмауэр, мост, шлюз, коммутатор.&lt;/li>
&lt;/ul>
&lt;h4 id="стандарты-локальный-сетей">&lt;span class="section-num">5.1.3&lt;/span> Стандарты локальный сетей&lt;/h4>
&lt;ul>
&lt;li>Структурированная кабельная система. Специфика передачи сигнала. Витая
пара. Оптоволоконный кабель. Радиоволны. Инфракрасное излучение и
видимый свет.&lt;/li>
&lt;li>Преобразователи и повторители. Активные и интеллектуальные
концентраторы. Устройства сегментации и создания подсетей.&lt;/li>
&lt;li>Топология сети. Топологии типа «звезда», «кольцо», «шина».&lt;/li>
&lt;li>Беспроводные сети передачи данных. WiFi. Проектирование и
развёртывание. (PoE, repeater, сетевой контроллер).&lt;/li>
&lt;li>Структурированная кабельная система. Зависимость от размеров: малая,
средняя, большая организации.&lt;/li>
&lt;li>Структурированная кабельная система. Разъемы оптоволоконных кабелей.
Коммутационные панели и пассивные концентраторы.&lt;/li>
&lt;/ul>
&lt;h4 id="настройка-сетевого-оборудования">&lt;span class="section-num">5.1.4&lt;/span> Настройка сетевого оборудования&lt;/h4>
&lt;ul>
&lt;li>Основы настройки сетевого оборудования Cisco. Примеры работы в CLI.&lt;/li>
&lt;li>Основы настройки сетевого оборудования Hewlett Packard. Примеры работы
в CLI.&lt;/li>
&lt;li>Основы настройки сетевого оборудования Huawei. Примеры работы в CLI.&lt;/li>
&lt;li>Основы настройки сетевого оборудования Microtik. Примеры работы в CLI.&lt;/li>
&lt;li>Основы настройки сетевого оборудования Juniper. Примеры работы в CLI.&lt;/li>
&lt;/ul>
&lt;h4 id="технологии-канального-уровня">&lt;span class="section-num">5.1.5&lt;/span> Технологии канального уровня&lt;/h4>
&lt;ul>
&lt;li>Технология VLAN. VLAN для больших сетей (Q-in-Q, MetroEthernet).&lt;/li>
&lt;li>Конфигурирование VLAN. Статическая маршрутизация VLAN.&lt;/li>
&lt;li>Использование протокола STP. Агрегирование каналов.&lt;/li>
&lt;li>Протокол быстрого связующего дерева (RSTP).&lt;/li>
&lt;li>Протокол множественного связующего дерева (MST). Переход от STP к MST.&lt;/li>
&lt;li>Протокол VTP. Различия версий протокола VTP.&lt;/li>
&lt;/ul>
&lt;h4 id="технологии-сетевого-уровня">&lt;span class="section-num">5.1.6&lt;/span> Технологии сетевого уровня&lt;/h4>
&lt;ul>
&lt;li>Настройка сетевых сервисов на сетевом оборудовании. DHCP. Безопасность
DHCP (option 82).&lt;/li>
&lt;li>Настройка сетевых сервисов на сетевом оборудовании. DNS.&lt;/li>
&lt;li>Настройка сетевых сервисов на сетевом оборудовании. TACACS+, RADIUS,
Kerberos.&lt;/li>
&lt;li>Планирование и настройка адресации IPv4. Связь с VLAN.&lt;/li>
&lt;li>Планирование и настройка адресации IPv6. Автоконфигурация.&lt;/li>
&lt;li>Настройка NAT. Типы NAT. Особенности применения разных типов NAT.
Cisco ASA.&lt;/li>
&lt;li>Статическая маршрутизация в Интернете.&lt;/li>
&lt;li>Динамическая маршрутизация.&lt;/li>
&lt;li>Настройка VPN.&lt;/li>
&lt;/ul>
&lt;h4 id="принципы-управления-сетями">&lt;span class="section-num">5.1.7&lt;/span> Принципы управления сетями&lt;/h4>
&lt;ul>
&lt;li>Настройка списков управления доступом (ACL).&lt;/li>
&lt;li>Аутентификация, авторизация и учёт (AAA). (LDAP, Kerberos, AD, IPA,
RADIUS).&lt;/li>
&lt;li>Мониторинг в сетях. (SNMP, агенты, Zabbix, Nagios).&lt;/li>
&lt;li>Программное конфигурирование сетевого оборудования. Инфраструктура как
код.&lt;/li>
&lt;li>Автоматизация конфигурирования сетевого оборудования. Обеспечение
быстрого развёртывания сетевого оборудования. (Puppet, Chef, Ansible).&lt;/li>
&lt;li>Системы управления сетью (OpenView).&lt;/li>
&lt;li>Анализаторы сетевых протоколов (Ethereal, ss, netflow).&lt;/li>
&lt;/ul></description></item></channel></rss>