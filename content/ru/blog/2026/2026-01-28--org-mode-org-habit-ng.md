---
title: "Org-mode. Пакет org-habit-ng"
author: ["Dmitry S. Kulyabov"]
date: 2026-01-28T21:07:00+03:00
lastmod: 2026-01-29T11:34:00+03:00
tags: ["org-mode", "emacs"]
categories: ["computer-science"]
draft: false
slug: "org-mode-org-habit-ng"
---

Org-mode. Пакет org-habit-ng.

<!--more-->

{{< toc >}}


## <span class="section-num">1</span> Общая информация {#общая-информация}

-   Репозиторий: <https://codeberg.org/Trevoke/org-habit-ng>
-   Расширяет стандартный org-mode за счёт введения собственного DSL.
-   Для меня наиболее интересна возможность задания количества повторений и время, после которого завершается работа привычки.


## <span class="section-num">2</span> Другие пакеты {#другие-пакеты}

-   Другие пакеты тоже могут реализовать подобную функциональность.


### <span class="section-num">2.1</span> org-repeat-by-cron {#org-repeat-by-cron}

-   Репозиторий: <https://github.com/TomoeMami/org-repeat-by-cron.el>


### <span class="section-num">2.2</span> org-reschedule-by-rule {#org-reschedule-by-rule}

-   Репозиторий: <https://github.com/Raemi/org-reschedule-by-rule>


## <span class="section-num">3</span> Шаблоны правил {#шаблоны-правил}

-   `RRULE` --- это стандарт для календарного повторения (RFC 5545).


### <span class="section-num">3.1</span> Суточные и недельные графики {#суточные-и-недельные-графики}

-   Простейшие закономерности повторяются через фиксированные интервалы.
-   `FREQ` задает базовую единицу измерения (день, неделя, месяц, год).
-   `INTERVAL` умножает его.
-   Фильтр `BYDAY` для выбора конкретных дней.

| Что нужно          | Правило                      |
|--------------------|------------------------------|
| Каждый день        | `FREQ=DAILY`                 |
| Каждые 3 дня       | `FREQ=DAILY;INTERVAL=3`      |
| Каждую неделю      | `FREQ=WEEKLY`                |
| Каждые 2 недели    | `FREQ=WEEKLY;INTERVAL=2`     |
| Пн, Ср, Пт         | `FREQ=WEEKLY;BYDAY=MO,WE,FR` |
| Только по выходным | `FREQ=WEEKLY;BYDAY=SA,SU`    |


### <span class="section-num">3.2</span> Ежемесячные модели {#ежемесячные-модели}

-   `BYDAY` с числовым префиксом означает «N-е вхождение» «Этот будний день месяца».
-   Отрицательные числа отсчитываются с конца.

| Что нужно                  | Правило                                        |
|----------------------------|------------------------------------------------|
| 15-го числа каждого месяца | `FREQ=MONTHLY;BYMONTHDAY=15`                   |
| Последний день месяца      | `FREQ=MONTHLY;BYMONTHDAY=-1`                   |
| 2-я суббота                | `FREQ=MONTHLY;BYDAY=2SA`                       |
| В прошлую пятницу          | `FREQ=MONTHLY;BYDAY=-1FR`                      |
| Первый будний день         | `FREQ=MONTHLY;BYDAY=MO,TU,WE,TH,FR;BYSETPOS=1` |


### <span class="section-num">3.3</span> Годовые модели {#годовые-модели}

| Что нужно                       | Правило                               |
|---------------------------------|---------------------------------------|
| Каждый год 1 января             | `FREQ=YEARLY;BYMONTH=1;BYMONTHDAY=1`  |
| Последнее воскресенье декабря   | `FREQ=YEARLY;BYMONTH=12;BYDAY=-1SU`   |
| День уплаты налогов (15 апреля) | `FREQ=YEARLY;BYMONTH=4;BYMONTHDAY=15` |


## <span class="section-num">4</span> Гибкость в реальных условиях {#гибкость-в-реальных-условиях}


### <span class="section-num">4.1</span> Гибкие окна {#гибкие-окна}

-   Некоторые привычки не требуют строгого соблюдения графика. Например, "Поливать растения каждые 3 дня" --- это действительно означает "примерно каждые 3 дня":
    ```org
    ​* TODO Water plants
    SCHEDULED: <2024-01-15 Mon>
    :PROPERTIES:
    :STYLE: habit
    :RECURRENCE: FREQ=DAILY;INTERVAL=3;X-FLEXIBILITY=1
    :END:
    ```

-   `X-FLEXIBILITY=1` означает, что завершение на 1 день раньше или позже по-прежнему отображается как «Вовремя».


### <span class="section-num">4.2</span> Повторение {#повторение}

-   По умолчанию следующее событие рассчитывается с момента завершения.
-   Но некоторые привычки следует придерживаться графика независимо от того, когда вы их завершите. их.
-   Прием лекарств по установленному графику, например:
    ```org
    ​* TODO Take medication
    SCHEDULED: <2024-01-15 Mon>
    :PROPERTIES:
    :STYLE: habit
    :RECURRENCE: FREQ=DAILY;X-REPEAT-FROM=scheduled
    :END:
    ```

| Значение           | Смысл                                                           |
|--------------------|-----------------------------------------------------------------|
| `completion`       | Далее --- с момента, когда вы отметите «ГОТОВО» (по умолчанию). |
| `scheduled`        | Следующая дата с запланированной даты                           |
| `scheduled-future` | Как и планировалось, но раньше никогда не было запланировано.   |


### <span class="section-num">4.3</span> Индивидуальные периоды предупреждения {#индивидуальные-периоды-предупреждения}

-   В случае привычек с длительными интервалами вам могут понадобиться более ранние предупреждения:
    ```org
    ​* TODO Quarterly review
    SCHEDULED: <2024-01-15 Mon>
    :PROPERTIES:
    :STYLE: habit
    :RECURRENCE: FREQ=MONTHLY;INTERVAL=3;X-WARN=2w
    :END:
    ```

-   `X-WARN=2w` : предупреждение о привычке появится за 2 недели до запланированной даты.


### <span class="section-num">4.4</span> Прекращение действия: Ограниченные привычки {#прекращение-действия-ограниченные-привычки}

-   Некоторые привычки не остаются навсегда.
-   Например, 30-дневный челлендж:
    ```org
    ​* TODO 30-day challenge
    SCHEDULED: <2024-01-01 Mon>
    :PROPERTIES:
    :STYLE: habit
    :RECURRENCE: FREQ=DAILY;COUNT=30
    :END:
    ```

| Параметр         | Значение                     |
|------------------|------------------------------|
| `COUNT=N`        | Остановиться после N событий |
| `UNTIL=YYYYMMDD` | Остановиться после этой даты |

-   Я это же делаю с помощью org-edna (но сложнее и не полностьб реализую данный функционал).


## <span class="section-num">5</span> Использование мастера {#использование-мастера}

-   Мастер для создания описания повторений:

<!--listend-->

```emacs-lisp
M-x org-habit-ng-set-recurrence
```

-   Мастер настройки пошагово описывает каждый вариант и показывает предварительный просмотр перед сохранением.
-   Если заголовок уже содержит `RECURRENCE` свойство, которое вы можете изменить или очистить его.


## <span class="section-num">6</span> Сводное описание {#сводное-описание}


### <span class="section-num">6.1</span> Полный набор компонентов RRULE {#полный-набор-компонентов-rrule}


#### <span class="section-num">6.1.1</span> Частоты {#частоты}

| Частота    | Значение         |
|------------|------------------|
| `SECONDLY` | Каждые N секунд  |
| `MINUTELY` | Каждые N минут   |
| `HOURLY`   | Каждые N часов   |
| `DAILY`    | Каждые N дней    |
| `WEEKLY`   | Каждые N недель  |
| `MONTHLY`  | Каждые N месяцев |
| `YEARLY`   | Каждые N лет     |


#### <span class="section-num">6.1.2</span> Параметры {#параметры}

| Параметр     | Ценности                   | Значение                                            |
|--------------|----------------------------|-----------------------------------------------------|
| `INTERVAL`   | Число (по умолчанию 1)     | Повторять каждые N периодов                         |
| `BYDAY`      | ПН, ВТ, СР, ЧТ, ПТ, СБ, ВС | Конкретные дни недели                               |
| `BYDAY`      | 2SA, -1FR                  | N-й рабочий день (отрицательное число = от конца)   |
| `BYMONTHDAY` | 1-31, -1 до -31            | День месяца (отрицательное число = от конца месяца) |
| `BYMONTH`    | 1-12                       | Конкретные месяцы                                   |
| `BYSETPOS`   | 1, -1 и т. д.              | Позиция в сете (первая, последняя)                  |
| `COUNT`      | Число                      | Остановиться после N событий                        |
| `UNTIL`      | ГГГГММДД                   | Остановить после истечения срока годности           |


#### <span class="section-num">6.1.3</span> Расширения org-habit-ng {#расширения-org-habit-ng}

| Расширение      | Ценности                                                | Значение                            |
|-----------------|---------------------------------------------------------|-------------------------------------|
| `X-REPEAT-FROM` | завершение, запланированное, запланированное на будущее | Основа для следующего события       |
| `X-WARN`        | Nd, Nw, Nh (дни, недели, часы)                          | Предупредительный период            |
| `X-FLEXIBILITY` | Число (дней)                                            | Льготный период вокруг даты платежа |


### <span class="section-num">6.2</span> Команды {#команды}

| Командование                  | Описание                                    |
|-------------------------------|---------------------------------------------|
| `org-habit-ng-mode`           | Включение/отключение дополнительного режима |
| `org-habit-ng-set-recurrence` | Интерактивный мастер для RRULE              |
