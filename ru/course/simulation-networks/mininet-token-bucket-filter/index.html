<!DOCTYPE html><html lang="ru-ru" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.6.0 for Hugo" />
  

  
  












  
  










  







  
  

  
  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Дмитрий Сергеевич Кулябов" />

  
  
  
    
  
  <meta name="description" content="Управление пропускной способностью с помощью дисциплина очередей Token Bucket Filter (TBF)" />

  
  <link rel="alternate" hreflang="ru-ru" href="https://yamadharma.github.io/ru/course/simulation-networks/mininet-token-bucket-filter/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  
    
    <script src="https://yamadharma.github.io/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="https://yamadharma.github.io/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="https://yamadharma.github.io/css/wowchemy.2bde192b69af735dad4bae1a5d756e35.css" />

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="https://yamadharma.github.io/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="https://yamadharma.github.io/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162854716-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-162854716-1', { 'anonymize_ip': true });
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  


  




  
  
  

  
  

  
  
    <link rel="manifest" href="https://yamadharma.github.io/ru/manifest.webmanifest" />
  

  
  <link rel="icon" type="image/png" href="https://yamadharma.github.io/media/icon_hu0a661dd90139895e92e2f18ae9404407_611148_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="https://yamadharma.github.io/media/icon_hu0a661dd90139895e92e2f18ae9404407_611148_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://yamadharma.github.io/ru/course/simulation-networks/mininet-token-bucket-filter/" />

  
  
  
  
  
  
  
  
    
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary" />
  
    <meta property="twitter:site" content="@dskulyabov" />
    <meta property="twitter:creator" content="@dskulyabov" />
  
  <meta property="og:site_name" content="Д. С. Кулябов" />
  <meta property="og:url" content="https://yamadharma.github.io/ru/course/simulation-networks/mininet-token-bucket-filter/" />
  <meta property="og:title" content="Mininet. Token Bucket Filter | Д. С. Кулябов" />
  <meta property="og:description" content="Управление пропускной способностью с помощью дисциплина очередей Token Bucket Filter (TBF)" /><meta property="og:image" content="https://yamadharma.github.io/media/icon_hu0a661dd90139895e92e2f18ae9404407_611148_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://yamadharma.github.io/media/icon_hu0a661dd90139895e92e2f18ae9404407_611148_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="ru-ru" />
  
    
      <meta
        property="article:published_time"
        content="2022-10-19T19:51:00&#43;03:00"
      />
    
    <meta property="article:modified_time" content="2022-10-24T15:44:00&#43;03:00">
  

  



  

  
  
  
  
  
    <script src="https://cdn.jsdelivr.net/gh/osano/cookieconsent@3.1.1/build/cookieconsent.min.js" integrity="sha512-yXXqOFjdjHNH1GND+1EO0jbvvebABpzGKD66djnUfiKlYME5HGMUJHoCaeE4D5PTG2YsSJf6dwqyUUvQvS0vaA==" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/osano/cookieconsent@3.1.1/build/cookieconsent.min.css" integrity="sha512-LQ97camar/lOliT/MqjcQs5kWgy6Qz/cCRzzRzUCfv0fotsCTC9ZHXaPQmJV8Xu/PVALfJZ7BDezl5lW3/qBxg==" crossorigin="anonymous">
  
  <script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#1565c0",
          "text": "rgb(255, 255, 255)"
        },
        "button": {
          "background": "rgb(255, 255, 255)",
          "text": "#1565c0"
        }
      },
      "theme": "classic",
      "content": {
        "message": "Для комфорной навигации на этом сайте используются куки (cookies).",
        "dismiss": "Понял!",
        "link": "Узнать больше",
        "href": "https://www.cookiesandyou.com"
      }
    })});
  </script>



  <title>Mininet. Token Bucket Filter | Д. С. Кулябов</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="89dcb620fb02c6455618bc8394d1a393" >

  
  
  
  
  
  
  
  
  
  <script src="https://yamadharma.github.io/js/wowchemy-init.min.613040fe4f2c0f007b4dcb64404201cb.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Поиск</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Поиск ..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Поиск ...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="https://yamadharma.github.io/ru/">Д. С. Кулябов</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Переключить навигацию">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="https://yamadharma.github.io/ru/">Д. С. Кулябов</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://yamadharma.github.io/ru/#about"><span>Обо мне</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://yamadharma.github.io/ru/#posts"><span>Блог</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://yamadharma.github.io/ru/#projects"><span>Проекты</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://yamadharma.github.io/ru/#featured"><span>Публикации</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link  active" href="https://yamadharma.github.io/ru/course/"><span>Курсы</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://yamadharma.github.io/ru/#contact"><span>Контакты</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Поиск"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
        
          Моделирование сетей передачи данных
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Поиск ...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      <ul class="nav docs-sidenav">
        <li><a href="https://yamadharma.github.io/ru/course/"><i class="fas fa-arrow-left pr-1"></i>Курсы</a></li>
      </ul>

      
      
        
          
        
      


  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="https://yamadharma.github.io/ru/course/simulation-networks/">Моделирование сетей передачи данных</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="https://yamadharma.github.io/ru/course/simulation-networks/mininet-lab/">Mininet. Лабораторные работы</a></li>



  <li class=""><a href="https://yamadharma.github.io/ru/course/simulation-networks/mininet-intro/">Введение в Mininet</a></li>



  <li class=""><a href="https://yamadharma.github.io/ru/course/simulation-networks/mininet-iperf-intro/">Mininet. Введение в Iperf</a></li>



  <li class=""><a href="https://yamadharma.github.io/ru/course/simulation-networks/mininet-netem-i/">Mininet. Использование netem (latency, jitter)</a></li>



  <li class=""><a href="https://yamadharma.github.io/ru/course/simulation-networks/mininet-netem-ii/">Mininet. Использование netem (потери пакетов)</a></li>



  <li class="active"><a href="https://yamadharma.github.io/ru/course/simulation-networks/mininet-token-bucket-filter/">Mininet. Token Bucket Filter</a></li>

      
        </ul>
      
    

    
      </div>
    

    
  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      












      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">На этой странице</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#общая-информация"><span class="section-num">1</span> Общая информация</a>
      <ul>
        <li><a href="#цели"><span class="section-num">1.1</span> Цели</a></li>
        <li><a href="#задачи"><span class="section-num">1.2</span> Задачи</a></li>
      </ul>
    </li>
    <li><a href="#теоретические-сведения"><span class="section-num">2</span> Теоретические сведения</a></li>
    <li><a href="#подготовка-стенда"><span class="section-num">3</span> Подготовка стенда</a>
      <ul>
        <li><a href="#лабораторная-топология"><span class="section-num">3.1</span> Лабораторная топология</a></li>
        <li><a href="#рабочие-файлы"><span class="section-num">3.2</span> Рабочие файлы</a></li>
      </ul>
    </li>
    <li><a href="#интерактивный-эксперимент"><span class="section-num">4</span> Интерактивный эксперимент</a></li>
  </ul>
</nav>

      











    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          
            
  <nav class="d-none d-md-flex" aria-label="breadcrumb">
    <ol class="breadcrumb">
      
  
    
  
    
  
    
  

    <li class="breadcrumb-item">
      <a href="https://yamadharma.github.io/ru/">
        
          Home
        
      </a>
    </li>
  

    <li class="breadcrumb-item">
      <a href="https://yamadharma.github.io/ru/course/">
        
          Курсы
        
      </a>
    </li>
  

    <li class="breadcrumb-item">
      <a href="https://yamadharma.github.io/ru/course/simulation-networks/">
        
          Моделирование сетей передачи данных
        
      </a>
    </li>
  

      <li class="breadcrumb-item active" aria-current="page">
        Mininet. Token Bucket Filter
      </li>
    </ol>
  </nav>




          
        </div>

        
        

        <div class="docs-article-container">
          
          <h1>Mininet. Token Bucket Filter</h1>

          <div class="article-style">

            
            

            <p>Управление пропускной способностью с помощью дисциплина очередей Token Bucket Filter (TBF).</p>
<h2 id="общая-информация"><span class="section-num">1</span> Общая информация</h2>
<h3 id="цели"><span class="section-num">1.1</span> Цели</h3>
<ul>
<li>Освоить использование дисциплины очередей Token Bucket Filter (TBF).</li>
</ul>
<h3 id="задачи"><span class="section-num">1.2</span> Задачи</h3>
<ul>
<li>Получить понятие об алгоритме Token Bucket.</li>
<li>Использовать Token Bucket Filter (tbf) в Linux.</li>
<li>Понять, как комбинировать дисциплины очередей в Linux Traffic Control (tc).</li>
<li>Объединить tbf и NETEM.</li>
<li>Эмулируйте свойства WAN в Mininet.</li>
<li>Визуализируйте вывод iPerf3 после изменения параметров сети.</li>
</ul>
<h2 id="теоретические-сведения"><span class="section-num">2</span> Теоретические сведения</h2>
<ol>
<li>Введение в алгоритм Token Bucket</li>
</ol>
<p>При моделировании глобальной сети (WAN) иногда необходимо ограничить пропускную способность устройств (конечных хостов и сетевых устройств), чтобы наблюдать за поведением сети в различных условиях.
Token Bucket — это алгоритм, используемый в сетях с коммутацией пакетов для ограничения пропускной способности и пиковой нагрузки трафика. Таким образом, ведро токенов состоит из добавления токенов (представленных в виде пакетов или байтов пакетов) с фиксированной скоростью в ведро с фиксированной емкостью. Когда приходит новый пакет, ведро проверяется на количество доступных токенов; если доступно хотя бы n токенов, n токенов удаляются из ведра, и пакет отправляется в сеть. В противном случае токены не удаляются, и пакет считается несоответствующим. В таком случае пакет может быть отброшен, поставлен в очередь или передан, но помечен как несоответствующий. Этот алгоритм проиллюстрирован на рисунке 1.
Рисунок 1. Фильтр Token Bucket.
Скорость, то есть скорость передачи, определяется частотой, с которой токены добавляются в корзину.
Еще одним важным свойством алгоритма ведра токенов является взрывоопасность; когда ведро становится полностью занятым (т. е. никакие пакеты не потребляют токены), новые пакеты будут потреблять токены сразу, без ограничений. Взрывность определяется как количество токенов, которые могут поместиться в ведро, или размер ведра.
Чтобы обеспечить ограничения и контроль над пакетами, реализации сегмента маркеров часто создают еще один сегмент меньшего размера с размером, равным максимальному блоку передачи (MTU), и скоростью, намного превышающей исходный сегмент (пиковая скорость). Его скорость определяет максимальную скорость пакетов.
Алгоритм корзины маркеров, реализованный в Linux, представляет собой фильтр корзины маркеров (tbf), который представляет собой дисциплину организации очереди, используемую в сочетании с управлением трафиком Linux (tc) для формирования трафика.
Рисунок 2 изображает основные параметры, используемые tbf.</p>
<p>Рисунок 2. Параметры и архитектура tbf.</p>
<p>Основной синтаксис tbf, используемый с tc, следующий:
tc qdisc [add | &hellip;] dev [dev_id] root tbf limit [BYTES] burst [BYTES] rate
[BPS] [mtu BYTES] [ peakrate BPS ] [ latency TIME ]</p>
<p>• tc : инструмент управления трафиком Linux.
• qdisc : дисциплина очереди (qdisc) представляет собой набор правил, определяющих порядок, в котором обслуживаются пакеты, поступающие с выходных данных IP-протокола. Дисциплина очереди применяется к очереди пакетов, чтобы решить, когда отправлять каждый пакет.
• [add | del | replace | change | show]  ([добавить | дель | заменить | изменить | show] ): это операция над qdisc. Например, чтобы добавить алгоритм корзины маркеров на определенный интерфейс, операция будет add . Чтобы изменить или удалить его, операция будет изменена или удалена соответственно.
• dev [dev_id]: этот параметр указывает, что интерфейс подлежит эмуляции.
• tbf : этот параметр определяет алгоритм Token Bucket Filter.
• limit [BYTES] : размер очереди пакетов в байтах.
• Burst [BYTES] : количество байтов, которое может поместиться в корзину.
• rate [BPS]: скорость передачи, определяемая частотой, с которой токены добавляются в корзину.
• mtu [BYTES] : максимальная единица передачи в байтах.
• peakrate [BPS] (пиковая скорость [бит/с]): максимальная скорость пакета.
• latency [TIME]: максимальное время ожидания пакета в очереди.</p>
<p>В этой лабораторной работе мы будем использовать дисциплину организации очередей tbf для имитации вышеупомянутых параметров, влияющих на поведение сети.</p>
<h2 id="подготовка-стенда"><span class="section-num">3</span> Подготовка стенда</h2>
<h3 id="лабораторная-топология"><span class="section-num">3.1</span> Лабораторная топология</h3>
<ul>
<li>
<p>В топологии используется сеть 10.0.0.0/8, назначенная Mininet по умолчанию.</p>
</li>
<li>
<p>Топология представляет собой коммутатор с двумя подключёнными к нему хостами.</p>
</li>
<li>
<p>Для запуска топологии (рис. <a href="#figure--fig:tbf:topology">1</a>) используем параметры командной строки:</p>
<pre><code class="language-shell">sudo mn --topo=single,2 -x
</code></pre>
<p><a id="figure--fig:tbf:topology"></a></p>
<figure>
<svg
xmlns="http://www.w3.org/2000/svg"
xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css"
height="120px" preserveAspectRatio="none"
style="width:690px;height:120px;background:#FFFFFF;" version="1.1"
viewBox="0 0 690 120" width="690px"
zoomAndPan="magnify"><defs/><g><g id="elem_h1"><polygon fill="#F1F1F1"
points="9.5,7,9.5,7.2102,19.5,6.5857,29.5,7.1933,39.5,7.3997,49.5,6.2866,59.5,6.9223,69.5,7,69.4456,6.8687,69.8046,7.0283,70.1984,7.2719,70.4725,7.2264,70.9848,7.7563,71.2678,7.7322,71.0737,7.6518,71.3533,8.0606,71.6937,8.4944,71.6807,8.782,71.8746,9.1552,72,9.5,71.9681,9.5,72.1785,19.7318,72.2391,29.9635,72.5857,40.1953,72.6711,50.427,72.6793,60.6588,72.2546,70.8905,72.4636,81.1223,72.7022,91.354,71.2788,101.5858,72,111.8175,72.209,111.9041,71.7622,112.1332,71.8715,112.5927,71.4082,112.815,71.3931,113.223,71.2678,113.5853,71.3624,113.8137,70.908,113.7167,70.5741,113.9106,70.2503,114.1289,69.9066,114.2992,69.5,114.3175,69.5,114.3136,59.5,114.6047,49.5,113.7451,39.5,114.6019,29.5,114.8657,19.5,114.762,9.5,114.3175,9.5782,114.5063,9.0848,114.0223,8.7097,113.8238,8.3601,113.6868,8.0783,113.7136,7.7322,113.5853,7.6717,113.5602,7.7956,113.3186,7.3855,112.8559,7.1872,112.4809,7.2167,112.2002,7,111.8175,6.3332,111.8175,6.4809,101.5858,7.649,91.354,7.4357,81.1223,7.7345,70.8905,6.6782,60.6588,7.3192,50.427,7.5904,40.1953,6.5276,29.9635,6.9041,19.7318,7,9.5,7.0388,9.5161,7.3472,9.2296,7.2916,8.7924,7.5818,8.4983,7.4152,8.0151,7.7322,7.7322,7.6458,7.5237,8.15,7.7409,8.3479,7.2186,8.8578,7.4496,9.1728,7.2101,9.5,7"
style="stroke:#181818;stroke-width:0.5;"/><image height="48"
width="45" x="17"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAwCAIAAAAKMGSIAAABYUlEQVR4Xu2Y7Y3DIAyGu2JGyAgZ4UbICBmBEW4ERugI3eCsvEAxifnwWbqexPMrjfHLE0olmsfrM3iUN/6I4OG937ZtGYe6qJdFqggeOglAvSxSRfAoswdhkSqmB+fGw/eRt7BIFTcerC6jaKlw46GARaqYHpzpwZkenH/lse/7dxWeqaHt4S2OF00aHsdxUJWeuCwYQSvd5VGvmoCvdcBjtwaxzrkxD1wbgtjpEUHs9IggdnpEEDs9IogVPb4y8mrotgOxokc2MiDd/yWIFT0+ZT1y8iquDUHs9IggVvTIRgZwn85mzhTEOsnjmXGtmiN65GBQcjcn/SQbHsu5PBhTp2w76ex99Xgs584o3wZlIOH2jWOcpU2XxxUyo3M2SaQnphUuxqzr+p6nRfBIe7iHYrXpoxM2EB3K04LVCR6j0MTrSTmzDA1Ou/KK0uN2N/Qg7VylB76LUSr/yJUe5vwAo6Ho0KlFbyoAAAAASUVORK5CYII="
y="17"/><text fill="#000000" font-family="xkcd Script" font-size="14"
lengthAdjust="spacing" textLength="10" x="36.5"
y="80.2429">h1</text><text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="39" x="20"
y="99.9017">10.0.0.1</text></g><g id="elem_h2"><polygon fill="#F1F1F1"
points="621.5,7,621.5,7.2102,631.5,6.5857,641.5,7.1933,651.5,7.3997,661.5,6.2866,671.5,6.9223,681.5,7,681.4456,6.8687,681.8046,7.0283,682.1984,7.2719,682.4725,7.2264,682.9848,7.7563,683.2678,7.7322,683.0737,7.6518,683.3533,8.0606,683.6937,8.4944,683.6807,8.782,683.8746,9.1552,684,9.5,683.9681,9.5,684.1785,19.7318,684.2391,29.9635,684.5857,40.1953,684.6711,50.427,684.6793,60.6588,684.2546,70.8905,684.4636,81.1223,684.7022,91.354,683.2788,101.5858,684,111.8175,684.209,111.9041,683.7622,112.1332,683.8715,112.5927,683.4082,112.815,683.3931,113.223,683.2678,113.5853,683.3624,113.8137,682.908,113.7167,682.5741,113.9106,682.2503,114.1289,681.9066,114.2992,681.5,114.3175,681.5,114.3136,671.5,114.6047,661.5,113.7451,651.5,114.6019,641.5,114.8657,631.5,114.762,621.5,114.3175,621.5782,114.5063,621.0848,114.0223,620.7097,113.8238,620.3601,113.6868,620.0783,113.7136,619.7322,113.5853,619.6717,113.5602,619.7956,113.3186,619.3855,112.8559,619.1872,112.4809,619.2167,112.2002,619,111.8175,618.3332,111.8175,618.4809,101.5858,619.649,91.354,619.4357,81.1223,619.7345,70.8905,618.6782,60.6588,619.3192,50.427,619.5904,40.1953,618.5276,29.9635,618.9041,19.7318,619,9.5,619.0388,9.5161,619.3472,9.2296,619.2916,8.7924,619.5818,8.4983,619.4152,8.0151,619.7322,7.7322,619.6458,7.5237,620.15,7.7409,620.3479,7.2186,620.8578,7.4496,621.1728,7.2101,621.5,7"
style="stroke:#181818;stroke-width:0.5;"/><image height="48"
width="45" x="629"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAwCAIAAAAKMGSIAAABYUlEQVR4Xu2Y7Y3DIAyGu2JGyAgZ4UbICBmBEW4ERugI3eCsvEAxifnwWbqexPMrjfHLE0olmsfrM3iUN/6I4OG937ZtGYe6qJdFqggeOglAvSxSRfAoswdhkSqmB+fGw/eRt7BIFTcerC6jaKlw46GARaqYHpzpwZkenH/lse/7dxWeqaHt4S2OF00aHsdxUJWeuCwYQSvd5VGvmoCvdcBjtwaxzrkxD1wbgtjpEUHs9IggdnpEEDs9IogVPb4y8mrotgOxokc2MiDd/yWIFT0+ZT1y8iquDUHs9IggVvTIRgZwn85mzhTEOsnjmXGtmiN65GBQcjcn/SQbHsu5PBhTp2w76ex99Xgs584o3wZlIOH2jWOcpU2XxxUyo3M2SaQnphUuxqzr+p6nRfBIe7iHYrXpoxM2EB3K04LVCR6j0MTrSTmzDA1Ou/KK0uN2N/Qg7VylB76LUSr/yJUe5vwAo6Ho0KlFbyoAAAAASUVORK5CYII="
y="17"/><text fill="#000000" font-family="xkcd Script" font-size="14"
lengthAdjust="spacing" textLength="15" x="646"
y="80.2429">h2</text><text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="44" x="629.5"
y="99.9017">10.0.0.2</text></g><g id="elem_s1"><polygon fill="#F1F1F1"
points="197.5,31.5,197.5,31.7102,208,31.0857,218.5,31.6933,229,31.8997,239.5,30.7866,250,31.4223,260.5,31.5,260.4456,31.3687,260.8046,31.5283,261.1984,31.7719,261.4725,31.7264,261.9848,32.2563,262.2678,32.2322,262.0737,32.1518,262.3533,32.5606,262.6937,32.9944,262.6807,33.282,262.8746,33.6552,263,34,262.9681,34,263.1785,44.5318,263.2391,55.0635,263.5857,65.5953,263.6711,76.127,263,86.6588,263.2092,86.7454,262.932,87.0448,262.8499,87.425,262.7769,87.809,262.1921,87.981,262.2678,88.4265,262.3543,88.6355,261.8764,88.4817,261.6288,88.8838,261.144,88.7134,260.8448,88.9912,260.5,89.1588,260.5,89.9004,250,89.11,239.5,89.2641,229,89.4974,218.5,89.575,208,89.1549,197.5,89.1588,197.5366,89.2472,197.0734,88.836,196.8292,88.9534,196.5093,88.8882,196.1425,88.7099,195.7322,88.4265,195.921,88.5047,195.437,88.0113,195.2385,87.6362,195.1015,87.2866,195.1283,87.0048,195,86.6588,194.8035,86.6588,195.6814,76.127,194.8253,65.5953,194.6569,55.0635,195.2283,44.5318,195,34,194.7946,33.9149,194.9866,33.5802,195.4927,33.3757,195.5735,32.9949,195.812,32.6795,195.7322,32.2322,195.6912,32.1331,196.1265,32.1841,196.5147,32.1212,196.7326,31.6474,197.1342,31.6169,197.5,31.5"
style="stroke:#181818;stroke-width:0.5;"/><image height="18"
width="48" x="205"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAASCAIAAACSBMrtAAAA4klEQVR4Xs2WYRHDIAyFa7ESKgEJSEACEpCABCQgAQfLJXcQMtig20G/n6958JpQrkd6GIcUdlMCWWvPTSilQghVIGOMrFpOjLEE4tJ6qB3UpCoQqyl476WEBESqyKzFOQe7k+tLICptrvJ3y1AgGCLUNUfZe90blqFAsCKJmfwIPgqua61vW4hfAwkdNpu1XNeVH6XBQAnPJifr0Hau8+lw3Y9Z0nighBucnesAGiM6T5CleVZ6lolAsG4vECwN94dUP1oMItWpQGvoBuJjXgnd1P490F6qQDLzDujYPe5/6AU/4JUKUwnC3AAAAABJRU5ErkJggg=="
y="41.5"/><text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="9" x="226.5"
y="74.7429">s1</text></g><g id="elem_s2"><polygon fill="#F1F1F1"
points="430.5,31.5,430.5,31.7102,441,31.0857,451.5,31.6933,462,31.8997,472.5,30.7866,483,31.4223,493.5,31.5,493.4456,31.3687,493.8046,31.5283,494.1984,31.7719,494.4725,31.7264,494.9848,32.2563,495.2678,32.2322,495.0737,32.1518,495.3533,32.5606,495.6937,32.9944,495.6807,33.282,495.8746,33.6552,496,34,495.9681,34,496.1785,44.5318,496.2391,55.0635,496.5857,65.5953,496.6711,76.127,496,86.6588,496.2092,86.7454,495.932,87.0448,495.8499,87.425,495.7769,87.809,495.1921,87.981,495.2678,88.4265,495.3543,88.6355,494.8764,88.4817,494.6288,88.8838,494.144,88.7134,493.8448,88.9912,493.5,89.1588,493.5,89.9004,483,89.11,472.5,89.2641,462,89.4974,451.5,89.575,441,89.1549,430.5,89.1588,430.5366,89.2472,430.0734,88.836,429.8292,88.9534,429.5093,88.8882,429.1425,88.7099,428.7322,88.4265,428.921,88.5047,428.437,88.0113,428.2385,87.6362,428.1015,87.2866,428.1283,87.0048,428,86.6588,427.8035,86.6588,428.6814,76.127,427.8253,65.5953,427.6569,55.0635,428.2283,44.5318,428,34,427.7946,33.9149,427.9866,33.5802,428.4927,33.3757,428.5735,32.9949,428.812,32.6795,428.7322,32.2322,428.6912,32.1331,429.1265,32.1841,429.5147,32.1212,429.7326,31.6474,430.1342,31.6169,430.5,31.5"
style="stroke:#181818;stroke-width:0.5;"/><image height="18"
width="48" x="438"
xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAASCAIAAACSBMrtAAAA4klEQVR4Xs2WYRHDIAyFa7ESKgEJSEACEpCABCQgAQfLJXcQMtig20G/n6958JpQrkd6GIcUdlMCWWvPTSilQghVIGOMrFpOjLEE4tJ6qB3UpCoQqyl476WEBESqyKzFOQe7k+tLICptrvJ3y1AgGCLUNUfZe90blqFAsCKJmfwIPgqua61vW4hfAwkdNpu1XNeVH6XBQAnPJifr0Hau8+lw3Y9Z0nighBucnesAGiM6T5CleVZ6lolAsG4vECwN94dUP1oMItWpQGvoBuJjXgnd1P490F6qQDLzDujYPe5/6AU/4JUKUwnC3AAAAABJRU5ErkJggg=="
y="41.5"/><text fill="#000000" font-family="xkcd Script"
font-size="14" lengthAdjust="spacing" textLength="14" x="457"
y="74.7429">s2</text></g><g id="link_h1_s1"><path d="M72.31,60.5 L72.31,60.7802
L82.515,59.9476 L92.72,60.7577 L102.925,61.0329 L113.13,59.5488
L123.335,60.3964 L133.54,59.9313 L143.745,59.9887 L153.95,60.4091
L164.155,59.5782 L174.36,61.2382 L184.565,59.6596 L194.77,60.5 "
fill="none" style="stroke:#181818;stroke-width:1.0;"/><text
fill="#000000" font-family="xkcd Script" font-size="13"
lengthAdjust="spacing" textLength="43" x="79.9473"
y="75.9155">h1-eth0</text><text fill="#000000" font-family="xkcd
Script" font-size="13" lengthAdjust="spacing" textLength="38"
x="148.9518"
y="76.02">s1-eth1</text></g><g id="link_s1_s2"><path d="M263.1,60.5 L263.1,60.7802
L273.4038,59.9476 L283.7075,60.7577 L294.0113,61.0329 L304.315,59.5488
L314.6188,60.3964 L324.9225,59.9313 L335.2263,59.9887 L345.53,60.4091
L355.8338,59.5782 L366.1375,61.2382 L376.4412,59.6596 L386.745,60.2363
L397.0488,61.0759 L407.3525,60.3856 L417.6563,60.591 L427.96,60.5 "
fill="none" style="stroke:#181818;stroke-width:1.0;"/><text
fill="#000000" font-family="xkcd Script" font-size="13"
lengthAdjust="spacing" textLength="41" x="325" y="55.6543">10
Gbps</text><text fill="#000000" font-family="xkcd Script"
font-size="13" lengthAdjust="spacing" textLength="42" x="270.8484"
y="75.9618">s1-eth2</text><text fill="#000000" font-family="xkcd
Script" font-size="13" lengthAdjust="spacing" textLength="46"
x="373.9387"
y="75.9618">s2-eth2</text></g><g id="link_s2_h2"><path d="M496.09,60.5
L496.09,60.7802 L506.3317,59.9476 L516.5733,60.7577 L526.815,61.0329
L537.0567,59.5488 L547.2983,60.3964 L557.54,59.9313 L567.7817,59.9887
L578.0233,60.4091 L588.265,59.5782 L598.5067,61.2382 L608.7483,59.6596
L618.99,60.5 " fill="none"
style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000"
font-family="xkcd Script" font-size="13" lengthAdjust="spacing"
textLength="42" x="503.837" y="75.9618">s2-eth1</text><text
fill="#000000" font-family="xkcd Script" font-size="13"
lengthAdjust="spacing" textLength="47" x="564.1136"
y="75.9155">h2-eth0</text></g></g></svg>
<figcaption>
<p><span class="figure-number">Рис. 1.: </span>Лабораторная топология</p>
</figcaption>
</figure>
</li>
</ul>
<h3 id="рабочие-файлы"><span class="section-num">3.2</span> Рабочие файлы</h3>
<ul>
<li>Подключимся к виртуальной машине:
<pre><code class="language-shell">ssh -Y mininet@192.168.x.y
</code></pre>
</li>
<li>Для рабочих файлов будем использовать каталог <code>~/work/lab_tbf</code>:
<pre><code class="language-shell">mkdir -p ~/work/lab_tbf
</code></pre>
</li>
</ul>
<h2 id="интерактивный-эксперимент"><span class="section-num">4</span> Интерактивный эксперимент</h2>
<p>2 Лабораторная топология
Давайте начнем с создания простой топологии Mininet с помощью MiniEdit. В топологии используется сеть 10.0.0.0/8, назначенная Mininet по умолчанию.
Рис. 3. Лабораторная топология.</p>
<p>Шаг 1. Ярлык MiniEdit находится на рабочем столе машины. Запустите MiniEdit, щелкнув ярлык MiniEdit. При запросе пароля введите пароль.
Шаг 2. В строке меню MiniEdit нажмите «Файл», затем «Открыть», чтобы загрузить топологию лаборатории. Найдите файл топологии Lab 5.mn и нажмите «Открыть».
Шаг 3. Перед началом измерений между хостом h1 и хостом h2 необходимо запустить сеть. Нажмите кнопку «Выполнить», расположенную в левом нижнем углу окна MiniEdit, чтобы запустить эмуляцию.
В приведенной выше топологии используется 10.0.0.0/8, которая является сетью по умолчанию, назначенной Mininet.</p>
<p>2.1 Запуск хоста h1 и хоста h2
Шаг 1. Щелкните правой кнопкой мыши на хосте h1 и выберите «Терминал». Это открывает терминал хоста h1 и позволяет выполнять команды на этом хосте.
Шаг 2. Примените те же действия на хосте h2 и откройте его Терминал.
Шаг 3. Проверьте подключение между конечными хостами с помощью команды ping. На хосте h1 введите команду ping 10.0.0.2. Эта команда проверяет соединение между хостом h1 и хостом h2. Чтобы остановить тест, нажмите Ctrl+c. На рисунке ниже показан успешный тест подключения.</p>
<p>3 Ограничение скорости на конечных хостах
Команду tc можно применить к сетевому интерфейсу устройства для формирования исходящего трафика. В этом разделе пользователь ограничит скорость отправки конечного хоста с помощью фильтра Token Bucket Filter (tbf), который является реализацией алгоритма Token Bucket.</p>
<p>3.1 Определите интерфейс хоста h1 и хоста h2
Согласно предыдущему разделу, мы должны идентифицировать интерфейсы на подключенных хостах.
Шаг 1. На хосте h1 введите команду ifconfig, чтобы отобразить информацию, относящуюся к его сетевым интерфейсам и назначенным им IP-адресам.
Вывод команды ifconfig показывает, что хост h1 имеет два интерфейса: h1-eth0 и lo. Интерфейс h1-eth0 на хосте h1 настроен с IP-адресом 10.0.0.1 и маской подсети 255.0.0.0. Этот интерфейс необходимо использовать в tc при эмуляции сети.
Шаг 2. В командной строке хоста h2 также введите команду ifconfig.
Вывод команды ifconfig показывает, что хост h2 имеет два интерфейса: h2-eth0 и lo. Интерфейс h2-eth0 на хосте h1 настроен с IP-адресом 10.0.0.2 и маской подсети 255.0.0.0. Этот интерфейс необходимо использовать в tc при эмуляции сети.
3.2 Эмуляция глобальной сети 10 Гбит/с с высокой задержкой
В этом разделе вы будете использовать команду tbf на сетевом интерфейсе для управления скоростью исходящего трафика.
Шаг 1. Измените пропускную способность хоста h1, введя команду ниже.</p>
<p>sudo tc qdisc add dev h1-eth0 root tbf rate 10gbit burst 5000000 limit 15000000</p>
<p>Эта команда устанавливает пропускную способность на 10 Гбит/с на интерфейсе h1-eth0 хоста h1. Параметры ТБФ следующие:
• rate : 10gbit
• burst : 5,000,000
• limit : 15,000,000</p>
<p>Эту команду можно обобщить следующим образом:
• sudo : включить выполнение команды с более высокими привилегиями безопасности.
• tc : вызвать управление трафиком Linux.
• qdisc : изменить дисциплину очередей сетевого планировщика.
• add (добавить): создать новое правило.
• dev h1-eth0 root: укажите интерфейс, на котором будет применяться правило.
• tbf : использовать алгоритм фильтра ведра токенов.
• rate : укажите скорость передачи (10 Гбит/с).
• Burst : количество байтов, которое может поместиться в корзину (5 000 000).
• limit : размер очереди в байтах (15 000 000).</p>
<p>Расчет всплеска: tbf требует установки значения всплеска при ограничении скорости. Это значение должно быть достаточно высоким, чтобы обеспечить установленную вами скорость. В частности, она должна быть не ниже указанной частоты, деленной на HZ, где HZ — тактовая частота, настроенная как параметр ядра, и может быть извлечена с помощью следующей команды:
egrep &lsquo;^CONFIG_HZ_[0-9]+&rsquo; /boot/config-`uname -r`</p>
<p>Рисунок 11. Извлечение тактовой частоты (HZ) системы.</p>
<p>HZ на Client1 — 250. Таким образом, для расчета всплеска делим 10 Гбит/с на 250:</p>
<p>10 Gbps = 10,000,000,000 bps</p>
<p>Burst =10,000,000,000 / 250 = 40,000,000 bits</p>
<p>Burst = 40,000,000 bits = 5,000,000 bytes</p>
<p>Полученное значение должно использоваться в команде в качестве значения Burst пакета.</p>
<p>Шаг 2. Теперь пользователь может проверить предыдущую конфигурацию с помощью инструмента iperf3 для измерения пропускной способности. Чтобы запустить iPerf3 в режиме сервера, выполните команду iperf3 -s в терминале хоста h2, как показано на рисунке ниже:
iperf3 -s
Шаг 3. Теперь, чтобы запустить iPerf3 в клиентском режиме, запустите команду iperf3 -c 10.0.0.2 для хоста h1 в терминале, как показано ниже:
iperf3 -c 10.0.0.2
Рис. 13. Отчет iPerf3 после ограничения скорости на хосте h1 до 10 Гбит/с.</p>
<p>На рисунке выше показан отчет iPerf3 после ограничения скорости на хосте h1 с помощью tbf. Средняя достигнутая пропускная способность составляет 9,57 Гбит/с (отправитель) и 9,53 Гбит/с (получатель). Поскольку мы выполнили команду на терминале хоста h1, правило было применено к сетевому интерфейсу хоста h1. Однако также возможно ограничить скорость на интерфейсах коммутатора, как описано ниже.
Шаг 4. Чтобы остановить сервер, нажмите Ctrl+c в терминале хоста h2. Пользователь также может видеть результаты пропускной способности на стороне сервера.</p>
<p>4 Ограничение скорости на коммутаторах
В предыдущем разделе объяснялось, как использовать фильтр корзины токенов на сетевых интерфейсах конечных хостов. В этом разделе мы объясним, как применить фильтр к интерфейсам коммутатора. При ограничении скорости на интерфейсе s1-eth2 коммутатора S1 все сеансы связи между коммутатором S1 и коммутатором S2 будут фильтроваться в соответствии с применяемыми правилами.
В предыдущих тестах мы применяли команду к терминалу хоста h1; переключатели, однако у нас нет терминалов, на которых можно было бы устанавливать и применять команды. Напомним, что для этой эмуляции мы используем Mininet, который создает виртуальные интерфейсы, эмулирующие функциональность коммутатора. Таким образом, эти виртуальные интерфейсы можно идентифицировать с помощью команды ifconfig, но на этот раз она должна выполняться на клиентском терминале (например, терминале, расположенном на рабочем столе), а не на конечных хостах (хост h1 или хост h2).</p>
<p>Шаг 1. Запустите терминал Linux, удерживая клавиши Ctrl+Alt+T или щелкнув значок терминала Linux.
Терминал Linux — это программа, которая открывает окно и позволяет вам взаимодействовать с интерфейсом командной строки (CLI). CLI — это программа, которая принимает команды с клавиатуры и отправляет их в операционную систему для выполнения.
Шаг 2. Введите в терминале команду ifconfig, чтобы отобразить информацию, связанную с его сетевыми интерфейсами.
На рис. 15 показаны сетевые интерфейсы клиента:
s1-eth1 — это интерфейс, соединяющий коммутатор S1 с хостом h1.
s1-eth2 — это интерфейс, соединяющий коммутатор S1 с коммутатором S2.
s2-eth1 — это интерфейс, соединяющий коммутатор S2 с хостом h2.
s2-eth2 — это интерфейс, соединяющий коммутатор S2 с коммутатором S1.
Шаг 3. Удалите предыдущую конфигурацию на хосте h1. Напишите следующую команду на терминале хоста h1:
sudo tc qdisc del dev h1-eth0 root</p>
<p>Шаг 4. Примените правило ограничения скорости tbf к интерфейсу коммутатора S1, который соединяет его с коммутатором S2 (s1-eth2). В терминале Client1 введите команду ниже.
sudo tc qdisc add dev s1-eth2 root tbf rate 10gbit burst 5000000 limit 15000000</p>
<p>При запросе пароля введите пароль и нажмите Enter. Параметры ТБФ следующие:
rate : 10gbit
burst : 5,000,000
limit : 15,000,000</p>
<p>Шаг 5. Теперь пользователь может проверить предыдущую конфигурацию с помощью инструмента iperf3 для измерения пропускной способности. Чтобы запустить iPerf3 в режиме сервера, запустите команду iperf3 -s в терминале хоста h2, как показано на рисунке 18:
iperf3 -s</p>
<p>Шаг 6. Теперь, чтобы запустить iPerf3 в клиентском режиме, выполните команду iperf3 -c 10.0.0.2 в терминале хоста h1, как показано на рисунке ниже:
iperf3 -c 10.0.0.2</p>
<p>Опять же, сообщаемые значения соответствуют желаемой пропускной способности (10 Гбит/с). На практике заявленная пропускная способность не будет соответствовать целевому значению (10 Гбит/с), но будет несколько меньше целевого значения.
Шаг 7. Чтобы остановить сервер, нажмите Ctrl+c в терминале хоста h2. Пользователь также может видеть результаты пропускной способности на стороне сервера.</p>
<p>5 Объединение NETEM и TBF
NETEM используется для введения задержки, джиттера, повреждения пакетов и т. д. С другой стороны, TBF может использоваться для ограничения скорости. Однако этого недостаточно для имитации реальных сетей, особенно глобальных сетей. Следовательно, также возможно комбинировать несколько нарушений и активировать их одновременно.
Рисунок 20. Цепочка иерархии qdiscs.
Как показано на рис. 20, первый qdisc (qdisc1) присоединен к корневой метке. Затем последующие qdisc можно прикрепить к своим родителям, указав правильную метку. В этом разделе мы рассмотрим, как объединить NETEM и TBF, чтобы эмулировать больше свойств в нашей сети. В частности, мы введем задержку, джиттер и повреждение пакетов, указав скорость на интерфейсе коммутатора S1.
Шаг 1. В клиентском терминале введите следующую команду, чтобы удалить предыдущую конфигурацию коммутатора S1.
sudo tc qdisc del dev s1-eth2 root</p>
<p>Шаг 2. В клиентском терминале введите команду ниже. При запросе пароля введите пароль и нажмите Enter.</p>
<p>sudo tc qdisc add dev s1-eth2 root handle 1: netem delay 10ms</p>
<p>Новое ключевое слово в этой команде — handle, и его значение отражает число, показанное на рис. 22 над каждым qdisc. Это означает, что наш NETEM qdisc подключен к корню с дескриптором 1: handle 1:.
Шаг 3. Теперь пользователь может проверить предыдущую конфигурацию с помощью инструмента проверки связи для измерения времени приема-передачи (RTT). На терминале хоста h1 введите ping 10.0.0.2. Чтобы остановить тест, нажмите Ctrl+c. На рисунке ниже показан успешный тест подключения. Хост h1 (10.0.0.1) отправил четыре пакета на хост h2 (10.0.0.2), успешно получив ответы.
Ping 10.0.0.2</p>
<p>Приведенный выше результат показывает, что все четыре пакета были получены успешно (0% потерь пакетов) и что минимальное, среднее, максимальное и стандартное отклонение времени приема-передачи (RTT) составили 10,083, 10,210, 10,575 и 0,222 миллисекунды соответственно. . По сути, стандартное отклонение — это среднее значение того, насколько каждый RTT пинга отличается от среднего RTT. Чем выше стандартное отклонение, тем более изменчивым является RTT.
Шаг 4. Теперь, чтобы добавить второе правило, которое применяет ограничение скорости с помощью tbf, введите команду, показанную ниже, на клиентском терминале.
sudo tc qdisc add dev s1-eth2 parent 1: handle 2: tbf rate 2gbit burst 1000000 limit 2000000
Параметры ТБФ следующие:
rate : 2gbit
burst : 1,000,000
limit : 2,000,000</p>
<p>Шаг 5. Теперь пользователь может проверить предыдущую конфигурацию с помощью инструмента iperf3 для измерения пропускной способности. Чтобы запустить iPerf3 в режиме сервера, выполните команду iperf3 -s в терминале хоста h2, как показано на рис. 25:
iperf3 -s
Шаг 6. Теперь снова запустите iPerf3 в клиентском режиме, выполнив команду iperf3 -c 10.0.0.2 в терминале хоста h1, как показано на рисунке 26:
iperf3 -c 10.0.0.2
На рисунке выше показан отчет о результатах теста iPerf3. Средняя достигнутая пропускная способность составляет 1,86 Гбит/с (отправитель) и 1,84 Гбит/с (получатель).
Шаг 7. Чтобы остановить сервер, нажмите Ctrl+c в терминале хоста h2. Пользователь также может видеть результаты пропускной способности на стороне сервера.
На этом лабораторная работа 5 завершена. Остановите эмуляцию и выйдите из MiniEdit.</p>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Предыдущий</div>
    <a href="https://yamadharma.github.io/ru/course/simulation-networks/mininet-netem-ii/" rel="next">Mininet. Использование netem (потери пакетов)</a>
  </div>
  
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Обновлено 2022-10-24</p>

          




          




          

  
  


        </div>

      </article>

      <footer class="site-footer">

  












  

  

  

  
  






  
  
  

  
  
  

  

  
  <p class="powered-by copyright-license-text">
    © 2006—2022 Dmitry S. Kulyabov. This work is licensed under <a href="https://creativecommons.org/licenses/by/4.0" rel="noopener noreferrer" target="_blank">CC BY 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
      
    </a>
  </p>




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  


<script src="https://yamadharma.github.io/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js"></script>




  

  
  

  






  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>




<script src="https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
<script>
  anchors.add();
</script>





  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":false}</script>











  
  


<script src="https://yamadharma.github.io/ru/js/wowchemy.min.b4848f3f337f1d09f31e59106665bb21.js"></script>



  <script src="https://yamadharma.github.io/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js" type="module"></script>




  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Процитировать</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Копия
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Скачать
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="https://yamadharma.github.io/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>
















</body>
</html>
