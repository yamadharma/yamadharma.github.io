---
title: "Технологии туннелирования IPv6"
author: ["Dmitry S. Kulyabov"]
date: 2023-05-26T19:17:00+03:00
lastmod: 2023-06-30T11:12:00+03:00
tags: ["ipv6", "network"]
categories: ["computer-science"]
draft: false
slug: "ipv6-tunneling-technologies"
---

Технологии туннелирования IPv6.

<!--more-->

{{< toc >}}


## <span class="section-num">1</span> Сводная таблица {#сводная-таблица}

<div class="table-caption">
  <span class="table-number">&#1058;&#1072;&#1073;&#1083;&#1080;&#1094;&#1072; 1:</span>
  Сводная таблица по протоколам туннелирования
</div>

| Протокол | Туннелей на IPv4-адрес | IPv6-хостов на туннель | Публичный IPv4 | NAT-совместимость   | P2P           | Gateway принадлежит                    |
|----------|------------------------|------------------------|----------------|---------------------|---------------|----------------------------------------|
| 6to4     | Один                   | Много                  | Требуется      | Нет                 | Глобальный    | ISP или публичный                      |
| LISP     | Один                   | Много                  | Требуется      | Нет                 | Настраивается | ISP или Tunnel Broker                  |
| 6rd      | Один                   | Много                  | Не требуется   | Нет                 | Внутри домена | ISP                                    |
| 6in4     | Один                   | Много                  | Не требуется   | Ограниченная        | Нет           | ISP или Tunnel Broker                  |
| Teredo   | Много                  | Один                   | Не требуется   | Да, с ограничениями | Глобальный    | Публичный релей                        |
| 6bed4    | Много                  | Много                  | Не требуется   | Да                  | Глобальный    | ISP, Tunnel Broker или публичный релей |
| 6a44     | Много                  | Много                  | Не требуется   | Да                  | Внутри домена | ISP                                    |
| AYIYA    | Много                  | Много                  | Не требуется   | Да                  | Нет           | ISP или Tunnel Broker                  |
| SEAL     | Много                  | Много                  | Не требуется   | Да                  | Настраивается | ISP или Tunnel Broker                  |


## <span class="section-num">2</span> 6in4 {#6in4}

-   [Брокеры IPv6]({{< relref "2023-06-26-ipv6-tunnelbrokers" >}})
-   Разработан в 1996 году.
-   Крупные туннельные брокеры: Hurricane Electric.
-   Номер протокол: 41.
-   Требует белый IP-адрес.
-   Не работает через NAT.
-   Не подразумевает каких-либо фиксированных адресов и префиксов.


## <span class="section-num">3</span> 6over4 {#6over4}

-   6over4 использует IPv4 как виртуальный ethernet для IPv6.
-   Например, multicast-адрес `ff02::1` превращается в IPv4 multicast-адрес `239.192.0.1`.
-   Протокол поддерживает генерацию Link-Local адреса, Neighbor Discovery и конфигурируется автоматически.
-   Все маршрутизаторы в сети должны поддерживать Multicast.


## <span class="section-num">4</span> 6to4 {#6to4}

-   [IPv6. Туннелирование. 6to4]({{< relref "2023-05-30-ipv6-tunneling-6to4" >}})
-   Признан устаревшим (deprecated) и не рекомендованным к использованию.
-   Вариант 6in4 с правилами использования.
-   Публичному адресу IPv4 сопоставляется IPv6-подсеть с префиксом 48.
-   Фиксированный anycast IPv4 адресом: `192.88.99.1`.
-   Протокол полностью автоконфигурируемый, ручная настройка невозможна.
-   Использует префикс `2002::/16`.
-   Не работает через NAT.
-   Связь между двумя пользователями 6to4 осуществляется не через туннельный сервер, а напрямую, с нулевой дополнительной задержкой.
-   Не требуется регистрации.
-   Оптимальный (самый близкий) шлюз выбирается автоматически.
-   Даёт IPv6-подсеть с префиксом 48.


## <span class="section-num">5</span> 6rd {#6rd}

-   Основан на 6to4.
-   Предназначен для развертывания внутри большой организации или ISP.
-   Использует обычный (провайдерский) диапазон адресов вместо префикса `2002::/16`.
-   Может автоматически настраиваться через DHCPv4 специальным параметром.


## <span class="section-num">6</span> AYIYA {#ayiya}

-   AYIYA --- Anything In Anything.
-   Разработан туннель-брокером SIXXS.
-   В основном используется как IPv4-UDP-AYIYA-IPv6.
-   Работает через NAT.


## <span class="section-num">7</span> ISATAP {#isatap}

-   Похож на 6over4, но не использует (и не поддерживает) Multicast.
-   IPv6-адреса генерируются на основе IPv4-адреса.
-   Предполагается, что IPv4-адрес будет уникальным,
-   Не работает с NAT.


## <span class="section-num">8</span> Teredo {#teredo}

-   Не требует настроек.
-   В Windows настроен и включён по умолчанию.
-   В Linux работает на основе Miredo.
-   Необходимо указать Teredo-сервер.
-   Работает через NAT (не всегда).
-   Не требуется регистрация.
-   Связь между двумя пользователями Teredo осуществляется не через туннельный сервер, а напрямую, с нулевой дополнительной задержкой.
-   Даётся всего один адрес IPv6, невозможно получить несколько Teredo-адресов и раздать их в локальную сеть.
-   Маршрутизация между Teredo и нативным IPv6 (а также другими видами туннелей) происходит через шлюзы.
-   Teredo-адреса генерируются из IPv4-адресов и использованного при подключении UDP-порта, поэтому всегда являются динамическими.


## <span class="section-num">9</span> 6a44 {#6a44}

-   Сделан под влиянием Teredo, но предназначен для развертывания средствами ISP.
-   Клиентам выдаётся IPv6-префикс провайдера.


## <span class="section-num">10</span> 6bed4 {#6bed4}

-   Peer-to-Peer IPv6 on Any Internetwork.
-   Предназначен для создания p2p IPv6-сети внутри IPv4-сети, не запрещающей p2p-соединения между хостами.
-   Является гибридом 6to4 и Teredo: IPv6-адрес формируется из IPv4 и UDP-порта, если p2p-соединение невозможно, используется релей, который может быть запущен ISP или просто сторонней организацией.
-   Работает через NAT.
-   Поддерживает как автоконфигурирование, так и ручную настройку.


## <span class="section-num">11</span> LISP {#lisp}

-   LISP --- Locator/ID Separation Protocol.
-   Основная цель --- убрать зависимость IPv6-адреса от местоположения клиента.
-   Например, можно использовать свой (предположим, домашний) IPv6-адрес вне вашей сети, без проксирования трафика.
-   По концепции схож с Proxy Mobile IPv6.
-   Не работает через NAT.


## <span class="section-num">12</span> SEAL {#seal}

-   SEAL --- Subnetwork Encapsulation and Adaptation Layer.
-   Поддерживает несколько IPv4-линков и multihoming.
-   Есть аутентификация и anti-replay механизм.
-   SEAL Control Message Protocol используется для обменом служебными данными между хостами.
