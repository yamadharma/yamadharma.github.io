<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>sysadmin | Dmitry S. Kulyabov</title><link>https://yamadharma.github.io/en/category/sysadmin/</link><atom:link href="https://yamadharma.github.io/en/category/sysadmin/index.xml" rel="self" type="application/rss+xml"/><description>sysadmin</description><generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><copyright>© 2023 Dmitry S. Kulyabov</copyright><lastBuildDate>Sat, 21 Apr 2018 15:37:34 +0000</lastBuildDate><image><url>https://yamadharma.github.io/media/icon_hu0a661dd90139895e92e2f18ae9404407_611148_512x512_fill_lanczos_center_3.png</url><title>sysadmin</title><link>https://yamadharma.github.io/en/category/sysadmin/</link></image><item><title>Migrating from livejournal to hexo</title><link>https://yamadharma.github.io/en/post/2018/04/21/from-lj-to-hexo/</link><pubDate>Sat, 21 Apr 2018 15:37:34 +0000</pubDate><guid>https://yamadharma.github.io/en/post/2018/04/21/from-lj-to-hexo/</guid><description>&lt;h1 id="migrating-from-livejournal-to-hexo">Migrating from livejournal to hexo&lt;/h1>
&lt;p>Migrating from &lt;a href="https://yamadharma.livejournal.com/" target="_blank" rel="noopener">livejornal&lt;/a> posed some problems.&lt;/p>
&lt;p>I want to note that I did not transfer the comments.&lt;/p>
&lt;p>&lt;a href="https://github.com/arty-name/livejournal-export" target="_blank" rel="noopener">livejournal-export&lt;/a> seemed to me the most suitable. It translates immediately to &lt;em>markdown&lt;/em>. However, tags are not imported.
It uses browser session parameters for identification.&lt;/p>
&lt;p>As the second option I considered &lt;a href="https://github.com/ghewgill/ljdump" target="_blank" rel="noopener">ljdump&lt;/a>. It downloads the weblog in &lt;em>html&lt;/em>. For identification uses login and password.&lt;/p>
&lt;p>Then I had to convert to &lt;em>markdown&lt;/em>. To do this, I wrote the script &lt;em>xml2md&lt;/em>.&lt;/p>
&lt;pre>&lt;code class="language-python">#!/usr/bin/python3
# -*- coding: utf-8 -*-
import os
import sys
from lxml import etree
import html2text
from datetime import datetime
from transliterate import translit, get_available_language_codes
outdir = 'markdown'
os.makedirs(outdir, exist_ok=True)
infile = sys.argv[1]
print(infile)
tree = etree.parse(infile)
post = tree.getroot()
postTitle = ''
postTags = ''
for elem in post.getchildren():
if not elem.text:
text = &amp;quot;None&amp;quot;
else:
text = elem.text
# print(elem.tag + &amp;quot; =&amp;gt; &amp;quot; + text)
# book_dict[elem.tag] = text
if elem.tag == 'subject':
postTitle = text
if elem.tag == 'eventtime':
postDate = text
if elem.tag == 'event':
postContent = text
if elem.tag == 'props':
for propsElem in elem.getchildren():
if not elem.text:
text = &amp;quot;None&amp;quot;
else:
text = propsElem.text
# print(propsElem.tag + &amp;quot; =&amp;gt; &amp;quot; + text)
if propsElem.tag == 'taglist':
postTags = text
postHeader = 'layout: post\n'+'title: '+postTitle+'\n'+'date: '+str(postDate)
postHeader = postHeader+'\ncategories: blog\nlang: ru'
postHeader = postHeader+'\ntags: ['+postTags+']'
postHeader = postHeader+'\n'+'---'
h = html2text.HTML2Text()
h.ignore_links = False
h.body_width = 0
h.unicode_snob = True
postContent = h.handle(postContent)
fullPost = postHeader+'\n\n\n'+postContent
date = datetime.strptime(postDate, '%Y-%m-%d %H:%M:%S')
outFile = '{0.year}-{0.month:02d}-{0.day:02d}'.format(date)
if postTitle != '':
translitTitle = translit(postTitle, 'ru', reversed=True)
translitTitle = translitTitle.replace(&amp;quot; &amp;quot;,&amp;quot;_&amp;quot;)
translitTitle = translitTitle.replace(&amp;quot;:&amp;quot;,&amp;quot;&amp;quot;)
translitTitle = translitTitle.replace(&amp;quot;'&amp;quot;,&amp;quot;&amp;quot;)
translitTitle = translitTitle.replace(&amp;quot;«&amp;quot;,&amp;quot;&amp;quot;)
translitTitle = translitTitle.replace(&amp;quot;»&amp;quot;,&amp;quot;&amp;quot;)
translitTitle = translitTitle.replace(&amp;quot;;&amp;quot;,&amp;quot;&amp;quot;)
else:
translitTitle = '{0.hour:02d}-{0.minute:02d}-{0.second:02d}'.format(date)
outFile = outFile+'-'+translitTitle
f = open(outdir+'/'+str(outFile)+'.md', 'w')
f.write(fullPost)
f.close()
&lt;/code>&lt;/pre>
&lt;p>Conversion can be performed using the command:&lt;/p>
&lt;pre>&lt;code class="language-bash">./xml2md &amp;lt;file&amp;gt;
&lt;/code>&lt;/pre>
&lt;p>This creates the &lt;em>markdown&lt;/em> directory and the conversion result is placed in it.&lt;/p></description></item></channel></rss>