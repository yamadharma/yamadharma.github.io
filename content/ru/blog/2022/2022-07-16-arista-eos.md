---
title: "Arista EOS"
author: ["Dmitry S. Kulyabov"]
date: 2022-07-16T11:30:00+03:00
lastmod: 2023-07-16T17:16:00+03:00
tags: ["network", "education"]
categories: ["computer-science"]
draft: false
slug: "arista-eos"
---

Операционная система Arista EOS.

<!--more-->

{{< toc >}}


## <span class="section-num">1</span> Общая информация {#общая-информация}

-   Репозиторий образов: <https://www.arista.com/en/support/software-download>.
    -   Требуется регистрация.
    -   Блокируются российские ip-адреса.


### <span class="section-num">1.1</span> Компания Arista {#компания-arista}

-   Arista Networks (ранее Arastra) --- американская компьютерная сетевая компания со штаб-квартирой в Санта-Кларе, Калифорния.
-   Компания разрабатывает и продаёт многоуровневые сетевые коммутаторы для предоставления программно-определяемых сетей (SDN) для крупных центров обработки данных, облачных вычислений, высокопроизводительных вычислений и высокочастотных торговых сред.
-   Собственная сетевая операционная система Arista на базе Linux, расширяемая операционная система (EOS), работает на всех продуктах Arista.


## <span class="section-num">2</span> Расширяемая операционная система {#расширяемая-операционная-система}


### <span class="section-num">2.1</span> Общая информация {#общая-информация}

-   EOS --- это сетевая операционная система Arista, представляющая собой единый образ, который работает на всех устройствах Arista или на виртуальной машине (ВМ).
-   У Arista пока получается делать единый файл с ОС для всей линейки.
-   EOS базируется на Fedora.
-   Слово _Extensible_ в _Extensible Operating System_ по задумке говорит о расширяемости функционала ОС. Достигается это за счет возможности установки своих программ, демонов, скриптов на коммутатор.
-   ОС работает на отдельном CPU, что позволяет разделить Control Plane (плоскость управления --- CPU, EOS) и Data Plane (плоскость передачи данных --- ASIC).
-   Основные элементы:
    -   драйверы, управляющие коммутацией специализированных интегральных схем (ASIC);
    -   интерфейс командной строки (CLI);
    -   протоколы маршрутизации;
    -   состояние коммутатора и его различных протоколов централизовано в процессе _Sysdb_.
-   Компоненты, необходимые для работы коммутатора, не обмениваются данными друг с другом напрямую, а делают это только через менеджер-базу _Sysdb_.
-   Sysdb является как общей шиной для коммуникации между процессами, так и базой данных для рабочей информации этих процессов.
-   С помощью работы через Sysdb получается обеспечить большую выживаемость и стабильность. После запуска все сервисы обращаются к Sysdb и, если там уже есть их данные, то они их восстанавливают и продолжают с ними работать.


### <span class="section-num">2.2</span> Именование образов {#именование-образов}

-   Образы помечаются буквами _F_ или _M_:
    -   `F` : добавлены новые функции;
    -   `M` : поддерживающий релиз.


### <span class="section-num">2.3</span> Командный интерфейс {#командный-интерфейс}

-   В EOS у всех запускаемых приложений от Arista имена с заглавной буквы.
-   Команды CLI написаны на Python.
-   Пользователям можно изменять как встроенные команды, так и писать свои.
-   Работа в CLI похожа на работу в CLI Cisco IOS.


### <span class="section-num">2.4</span> Загрузчик `aboot` {#загрузчик-aboot}

-   Aboot --- загрузчик EOS.
-   Представляет из себя образ на основе BusyBox.
-   Все данные, включая образы EOS и логи, хранятся на встроенной флешке.
-   Aboot позволяет получить к ней доступ (а так же доступ к внешним USB накопителям, подключенным к USB портам) и восстановить работоспособность устройства в случае проблем.
-   Вход в _aboot_: `CRTL+C`.\*\* Возможности EOS
-   _CloudVision_ позволяет подключать коммутаторы Arista к XMPP серверу в роли клиентов. В «чаты» с ними можно писать команды CLI, и свитчи будут отвечать результатами их выполнения. Можно добавить несколько устройств в групповой чат и выполнять команды на всех участниках группы одновременно.
-   _Advanced Event Management_ --- это что-то вроде Cisco EEM или Junos Event Scripts: можно запрограммировать действия (команды CLI, выполнение скриптов) на определенные события (например: упал порт).
-   _Event Monitor_ ведет логирование изменений MAC, ARP и таблицы маршрутизации на встроенной флеш памяти в виде базы SQLite.
-   _eAPI_ (External API) позволяет работать с коммутатором по JSON-RPC: ввод и вывод данных в виде JSON объектов.
-   _Zero Touch Provisioning_ (ZTP) позволяет автоматизировать настройку нового коммутатора.
    -   Коммутатор с настройками по умолчанию грузится в режиме ZTP и пытается получить сетевые настройки по DHCP.
    -   Используя `option bootfile-name`, которую тоже можно передать по DHCP, коммутатору можно указать URL для загрузки скрипта (на shell, или, например, на языке встроенного CLI, т.к. он является одним из вариантов shell).
    -   Если скрипт скачается успешно, то устройство его выполнит.
-   _DirectFlow_ позволяет задавать правила (такие, как зеркалирование; изменение приоритета, VLAN, SRC/DST и т.д.), применяемые к трафику (на основе, например, SRC/DST (IP, MAC, port) или номера протокола, или номера VLAN и т.д.) из CLI.


## <span class="section-num">3</span> Ethernet-коммутаторы {#ethernet-коммутаторы}


### <span class="section-num">3.1</span> Основные семейства {#основные-семейства}

-   Серия 7500R: модульное шасси с матрицей виртуальной очереди вывода (VOQ), поддерживающей от 4 до 16 линейных карт хранения и переадресации, обеспечивающее неблокирующую производительность 10GbE, 40GbE и 100GbE на линейной скорости в фабрика 150 Тбит/с, поддерживающая до 576 портов 100GbE с буфером пакетов 384 ГБ. Каждый порт 100GbE также может работать как порт 40GbE или 4 порта 10GbE, что эффективно обеспечивает 2304 порта 10GbE с линейной скоростью и большими таблицами маршрутизации.
-   Серии 7300X, 7300X3 и 7320X: модульное шасси с 4 или 8 линейными картами в вариантах 10G, 40G и 100G с пропускной способностью 6,4 Тбит/с на линейную карту для коммутационной сети общей пропускной способностью до 50 Тбит/с для 1024 порта 10GbE. В отличие от серии 7500, 10GBASE-T доступен на линейных картах серии 7300.
-   Серия 7280R: Системы 1U и 2U с общей архитектурой для серии 7500R, глубоким буфером VOQ и большими таблицами маршрутизации. Множество различных комбинаций скоростей и портов от 10GbE до 100GbE.
-   Серия 7200X: коммутаторы 2U с высокой плотностью и малой задержкой, линейной скоростью 100GbE и 40GbE и пропускной способностью до 12,8 Тбит/с.
-   Серия 7170: высокопроизводительные многофункциональные программируемые платформы, набор стационарных 100-гигабитных платформ на основе пакетного процессора Barefoot Tofino, позволяющий настраивать плоскость данных с использованием профилей EOS и P4.
-   Серия 7160: программируемый высокопроизводительный диапазон 1U 10 GbE, 25 GbE и 100 GbE с поддержкой технологии AlgoMatch и пакетным процессором с возможностью обновления программного обеспечения.
-   Серия 7150S: коммутаторы 1U со сверхнизкой задержкой и линейной скоростью 10 Гбит/с. Задержка между портами составляет менее 380 нс, независимо от размера кадра. В отличие от более ранней серии 7100, микросхему коммутатора можно перепрограммировать для добавления новых функций, работающих на скорости передачи данных, таких как виртуальная расширяемая локальная сеть (VXLAN) или преобразование сетевых адресов (NAT/PAT).
-   Серия 7130 (7130, 7130L, 7130E): 1U и 2U коммутатор уровня 1 со сверхнизкой задержкой и программируемые коммутаторы. Коммутация уровня 1 обеспечивает зеркалирование и программно-определяемую маршрутизацию портов с задержкой между портами от 4 нс в зависимости от физического расстояния. Варианты E и L позволяют запускать пользовательские приложения FPGA непосредственно на коммутаторе с задержкой от порта к FPGA всего 3 нс. Эта серия происходит из оригинальной линейки продуктов Metamako, приобретенной Arista Networks в 2018 году, и работает на комбинации операционных систем MOS и Arista EOS.
-   Серии 7050X и 7060X: 1U и 2U сквозные коммутаторы с линейной скоростью 10GbE/25GbE, 40GbE и 100GbE с малой задержкой. Эта линейка продуктов предлагает более высокую плотность портов, чем серия 7150, в более широком выборе вариантов портов и скоростей интерфейса за счет немного увеличенной задержки (1 мкс или меньше).
-   Серии 7050X и 7060X основаны на коммерческих микросхемах Broadcom Trident и Tomahawk.
-   Серия 7020R: линейная скорость хранения и пересылки 1U с возможностью выбора между коммутатором наверху стойки 1 Гбит/с с восходящими каналами 6x10 Гбит или 10 Гбит/с с восходящими каналами 100 Гбит/с. Эти коммутаторы используют архитектуру глубокого буфера с 3 ГБ пакетной памяти.
-   Серия 7010: коммутатор 1U с низким энергопотреблением (52 Вт) с пропускной способностью 1 Гбит/с, устанавливаемый поверх стойки, с 4 восходящими линиями связи по 10 Гбит/с.
-   Устройства Arista представляют собой многоуровневые коммутаторы, которые поддерживают ряд протоколов уровня 3, включая IGMP, протокол резервирования виртуального маршрутизатора (VRRP), RIP, BGP, OSPF, IS-IS и OpenFlow.


### <span class="section-num">3.2</span> Аппаратная часть {#аппаратная-часть}

-   Data Plane (плоскость передачи данных) в коммутаторах Arista построен с использованием интегральных схем специального назначения --- ASIC.
-   По типу происхождения ASIC делятся на:
    -   _Custom Silicon_ --- микросхемы, которые обычно разработаны и произведены компанией, которая производит на этих чипах коммутаторы.
    -   _Merchant Silicon_ --- «коммерчески» доступные микросхемы, разработанные и произведенные компанией, которая не производит на них коммутаторы.
-   Arista не разрабатывает собственные ASIC, а использует в своих коммутаторах Merchant Silicon от Intel и Broadcom.


### <span class="section-num">3.3</span> Основные конкуренты {#основные-конкуренты}

-   Extreme Networks.
-   Juniper Networks.
-   Cisco Systems.
-   Hewlett Packard Enterprise (подразделение Aruba Networks).
